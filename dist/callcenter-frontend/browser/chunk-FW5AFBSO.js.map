{
  "version": 3,
  "sources": ["src/app/collection-management/services/payment-schedule.service.ts", "src/app/collection-management/components/installment-status-dialog/installment-status-dialog.component.ts", "src/app/collection-management/components/payment-schedule-view/payment-schedule-view.component.ts", "src/app/shared/components/select-supervisor-modal/select-supervisor-modal.component.ts", "src/app/collection-management/services/comprobante.service.ts", "src/app/collection-management/components/comprobante-upload-dialog/comprobante-upload-dialog.component.ts", "src/app/collection-management/components/voucher-payment-dialog/voucher-payment-dialog.component.ts", "src/app/features/dialer/call-notes/confirm-carta-dialog/confirm-carta-dialog.component.ts", "src/app/collection-management/services/system-config.service.ts", "src/app/maintenance/services/customer-output-config.service.ts", "src/app/customers/services/customer.service.ts", "src/app/core/services/carta-acuerdo.service.ts", "src/app/collection-management/pages/collection-management.page.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\n\r\nexport interface PaymentScheduleResource {\r\n  scheduleId: string;\r\n  customerId: string;\r\n  managementId: string;\r\n  totalAmount: number;\r\n  numberOfInstallments: number;\r\n  startDate: string;\r\n  isActive: boolean;\r\n  installments: InstallmentResource[];\r\n}\r\n\r\nexport interface InstallmentResource {\r\n  id: number;\r\n  installmentNumber: number;\r\n  amount: number;\r\n  dueDate: string;\r\n  paidDate?: string;\r\n  status: string;\r\n  statusDescription: string;\r\n}\r\n\r\nexport interface InstallmentStatusHistoryResource {\r\n  id: number;\r\n  installmentId: number;\r\n  managementId: string;\r\n  status: string;\r\n  statusDescription: string;\r\n  changeDate: string;\r\n  actualPaymentDate?: string;\r\n  amountPaid?: number;\r\n  observations?: string;\r\n  registeredBy: string;\r\n}\r\n\r\nexport interface UpdateInstallmentStatusRequest {\r\n  status: string; // \"COMPLETADO\", \"VENCIDO\", \"CANCELADO\"\r\n  paymentDate?: string;\r\n  amountPaid?: number;\r\n  observations?: string;\r\n  registeredBy: string;\r\n}\r\n\r\nexport interface CreatePaymentScheduleRequest {\r\n  customerId: string;\r\n  managementId: string;\r\n  scheduleType: string; // \"FINANCIERA\" o \"CONFIANZA\"\r\n  negotiatedAmount: number | null;\r\n  installments: InstallmentRequest[];\r\n}\r\n\r\nexport interface InstallmentRequest {\r\n  installmentNumber: number;\r\n  amount: number;\r\n  dueDate: string; // formato: \"YYYY-MM-DD\"\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class PaymentScheduleService {\r\n  private readonly baseUrl = `${environment.tipificacionUrl}/payment-schedules`;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  /**\r\n   * Crea un nuevo cronograma de pagos\r\n   */\r\n  createPaymentSchedule(request: CreatePaymentScheduleRequest): Observable<PaymentScheduleResource> {\r\n    return this.http.post<PaymentScheduleResource>(`${environment.tipificacionUrl}/payments/schedules`, request);\r\n  }\r\n\r\n  /**\r\n   * Obtiene el cronograma de pagos asociado a una gesti√≥n\r\n   */\r\n  getPaymentScheduleByManagementId(managementId: number): Observable<PaymentScheduleResource> {\r\n    return this.http.get<PaymentScheduleResource>(`${this.baseUrl}/management/${managementId}`);\r\n  }\r\n\r\n  /**\r\n   * Actualiza el estado de una cuota (crea un nuevo registro en el historial)\r\n   */\r\n  updateInstallmentStatus(\r\n    installmentId: number,\r\n    request: UpdateInstallmentStatusRequest\r\n  ): Observable<InstallmentStatusHistoryResource> {\r\n    return this.http.post<InstallmentStatusHistoryResource>(\r\n      `${this.baseUrl}/installments/${installmentId}/status`,\r\n      request\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Obtiene el historial completo de estados de una cuota\r\n   */\r\n  getInstallmentHistory(installmentId: number): Observable<InstallmentStatusHistoryResource[]> {\r\n    return this.http.get<InstallmentStatusHistoryResource[]>(\r\n      `${this.baseUrl}/installments/${installmentId}/history`\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Obtiene el √∫ltimo estado de cada cuota de una gesti√≥n\r\n   */\r\n  getLatestStatusByManagement(managementId: number): Observable<InstallmentStatusHistoryResource[]> {\r\n    return this.http.get<InstallmentStatusHistoryResource[]>(\r\n      `${this.baseUrl}/management/${managementId}/latest-status`\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Obtiene cronogramas activos de un cliente desde registros_gestion_v2\r\n   */\r\n  getActiveSchedulesByCustomer(customerId: number): Observable<any[]> {\r\n    return this.http.get<any[]>(\r\n      `${environment.gatewayUrl}/v2/management-records/payment-schedule/client/${customerId}`\r\n    );\r\n  }\r\n}\r\n", "import { Component, signal, computed, effect } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { PaymentScheduleService, InstallmentResource, UpdateInstallmentStatusRequest } from '../../services/payment-schedule.service';\n\n@Component({\n  selector: 'app-installment-status-dialog',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  template: `\n    @if (isOpen()) {\n      <div class=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fadeIn\">\n        <div class=\"bg-white dark:bg-slate-900 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col animate-slideInUp border border-slate-200 dark:border-slate-700\">\n\n          <!-- Header -->\n          <div class=\"bg-gradient-to-r from-purple-600 to-purple-700 dark:from-purple-700 dark:to-purple-800 text-white px-6 py-4 flex items-center justify-between\">\n            <div class=\"flex items-center gap-3\">\n              <div>\n                <h2 class=\"text-lg font-bold\">Actualizar Estado de Cuota</h2>\n                <p class=\"text-sm opacity-90\">Cuota #{{ installment()?.installmentNumber }}</p>\n              </div>\n            </div>\n            <button\n              (click)=\"close()\"\n              class=\"p-2 hover:bg-white/20 rounded-lg transition-colors\"\n              type=\"button\">\n            </button>\n          </div>\n\n          <!-- Content -->\n          <div class=\"flex-1 overflow-y-auto p-6 space-y-6\">\n\n            <!-- Informaci√≥n de la cuota -->\n            <div class=\"bg-purple-50 dark:bg-purple-950/30 border border-purple-200 dark:border-purple-800 rounded-lg p-4\">\n              <div class=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span class=\"text-slate-600 dark:text-slate-400\">Monto:</span>\n                  <span class=\"font-bold text-purple-900 dark:text-purple-200 ml-2\">\n                    S/ {{ installment()?.amount | number:'1.2-2' }}\n                  </span>\n                </div>\n                <div>\n                  <span class=\"text-slate-600 dark:text-slate-400\">Fecha Vencimiento:</span>\n                  <span class=\"font-bold text-purple-900 dark:text-purple-200 ml-2\">\n                    {{ formatDate(installment()?.dueDate) }}\n                  </span>\n                </div>\n                <div>\n                  <span class=\"text-slate-600 dark:text-slate-400\">Estado Actual:</span>\n                  <span class=\"ml-2 px-2 py-0.5 rounded text-xs font-bold\"\n                        [class]=\"getStatusBadgeClass(installment()?.status || 'PENDIENTE')\">\n                    {{ installment()?.statusDescription || 'Pendiente' }}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <!-- Selector de nuevo estado -->\n            <div>\n              <label class=\"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2\">\n                Nuevo Estado\n              </label>\n              <div class=\"grid grid-cols-3 gap-3\">\n                <button\n                  type=\"button\"\n                  (click)=\"selectedStatus.set('COMPLETADO')\"\n                  [class]=\"selectedStatus() === 'COMPLETADO'\n                    ? 'bg-green-100 dark:bg-green-900/30 border-green-500 dark:border-green-600 text-green-900 dark:text-green-300'\n                    : 'bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:border-green-400'\"\n                  class=\"border-2 rounded-lg p-4 flex flex-col items-center gap-2 transition-all\">\n                  <span class=\"text-sm font-bold\">Completado</span>\n                </button>\n\n                <button\n                  type=\"button\"\n                  (click)=\"selectedStatus.set('VENCIDO')\"\n                  [class]=\"selectedStatus() === 'VENCIDO'\n                    ? 'bg-red-100 dark:bg-red-900/30 border-red-500 dark:border-red-600 text-red-900 dark:text-red-300'\n                    : 'bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:border-red-400'\"\n                  class=\"border-2 rounded-lg p-4 flex flex-col items-center gap-2 transition-all\">\n                  <span class=\"text-sm font-bold\">Vencido</span>\n                </button>\n\n                <button\n                  type=\"button\"\n                  (click)=\"selectedStatus.set('CANCELADO')\"\n                  [class]=\"selectedStatus() === 'CANCELADO'\n                    ? 'bg-gray-100 dark:bg-gray-700/30 border-gray-500 dark:border-gray-600 text-gray-900 dark:text-gray-300'\n                    : 'bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:border-gray-400'\"\n                  class=\"border-2 rounded-lg p-4 flex flex-col items-center gap-2 transition-all\">\n                  <span class=\"text-sm font-bold\">Cancelado</span>\n                </button>\n              </div>\n            </div>\n\n            <!-- Campos adicionales para COMPLETADO -->\n            @if (selectedStatus() === 'COMPLETADO') {\n              <div class=\"space-y-4 p-4 bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg\">\n                <div>\n                  <label class=\"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2\">\n                    Fecha de Pago *\n                  </label>\n                  <input\n                    type=\"datetime-local\"\n                    [(ngModel)]=\"paymentDate\"\n                    class=\"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg\n                           bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100\n                           focus:ring-2 focus:ring-green-500 dark:focus:ring-green-600 focus:border-transparent\"\n                    required>\n                </div>\n\n                <div>\n                  <label class=\"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2\">\n                    Monto Pagado *\n                  </label>\n                  <div class=\"relative\">\n                    <span class=\"absolute left-3 top-2 text-slate-500 dark:text-slate-400\">S/</span>\n                    <input\n                      type=\"number\"\n                      step=\"0.01\"\n                      [(ngModel)]=\"amountPaid\"\n                      class=\"w-full pl-10 pr-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg\n                             bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100\n                             focus:ring-2 focus:ring-green-500 dark:focus:ring-green-600 focus:border-transparent\"\n                      required>\n                  </div>\n                </div>\n              </div>\n            }\n\n            <!-- Observaciones -->\n            <div>\n              <label class=\"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2\">\n                Observaciones\n              </label>\n              <textarea\n                [(ngModel)]=\"observations\"\n                rows=\"3\"\n                placeholder=\"Ingrese notas o comentarios adicionales...\"\n                class=\"w-full px-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg\n                       bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100\n                       focus:ring-2 focus:ring-purple-500 dark:focus:ring-purple-600 focus:border-transparent\n                       placeholder:text-slate-400 dark:placeholder:text-slate-500\"></textarea>\n            </div>\n\n            <!-- Error message -->\n            @if (errorMessage()) {\n              <div class=\"bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-300 px-4 py-3 rounded-lg flex items-start gap-2\">\n                <span class=\"text-sm\">{{ errorMessage() }}</span>\n              </div>\n            }\n          </div>\n\n          <!-- Footer -->\n          <div class=\"px-6 py-4 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700 flex justify-end gap-3\">\n            <button\n              type=\"button\"\n              (click)=\"close()\"\n              class=\"px-4 py-2 text-sm font-semibold text-slate-700 dark:text-slate-300\n                     hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors\">\n              Cancelar\n            </button>\n            <button\n              type=\"button\"\n              (click)=\"save()\"\n              [disabled]=\"!canSave() || isSaving()\"\n              class=\"px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-purple-600 to-purple-700\n                     hover:from-purple-700 hover:to-purple-800 rounded-lg transition-all\n                     disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-purple-600\n                     flex items-center gap-2\">\n              @if (isSaving()) {\n                <span>Guardando...</span>\n              } @else {\n                <span>Guardar</span>\n              }\n            </button>\n          </div>\n\n        </div>\n      </div>\n    }\n  `,\n  styles: [`\n    @keyframes fadeIn {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n\n    @keyframes slideInUp {\n      from {\n        opacity: 0;\n        transform: translateY(20px);\n      }\n      to {\n        opacity: 1;\n        transform: translateY(0);\n      }\n    }\n\n    .animate-fadeIn {\n      animation: fadeIn 0.2s ease-out;\n    }\n\n    .animate-slideInUp {\n      animation: slideInUp 0.3s ease-out;\n    }\n  `]\n})\nexport class InstallmentStatusDialogComponent {\n  isOpen = signal(false);\n  installment = signal<InstallmentResource | null>(null);\n  managementId = signal<number>(0);\n\n  selectedStatus = signal<'COMPLETADO' | 'VENCIDO' | 'CANCELADO' | null>(null);\n  paymentDate = '';\n  amountPaid: number | null = null;\n  observations = '';\n\n  isSaving = signal(false);\n  errorMessage = signal<string | null>(null);\n\n  onSave?: (success: boolean) => void;\n\n  canSave = computed(() => {\n    if (!this.selectedStatus()) return false;\n\n    if (this.selectedStatus() === 'COMPLETADO') {\n      return !!this.paymentDate && this.amountPaid !== null && this.amountPaid > 0;\n    }\n\n    return true;\n  });\n\n  constructor(private paymentScheduleService: PaymentScheduleService) {\n    // Reset form when dialog closes\n    effect(() => {\n      if (!this.isOpen()) {\n        this.resetForm();\n      }\n    });\n  }\n\n  open(installment: InstallmentResource, managementId: number) {\n    this.installment.set(installment);\n    this.managementId.set(managementId);\n    this.isOpen.set(true);\n\n    // Pre-llenar con el monto de la cuota\n    this.amountPaid = installment.amount;\n\n    // Pre-llenar fecha actual\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, '0');\n    const day = String(now.getDate()).padStart(2, '0');\n    const hours = String(now.getHours()).padStart(2, '0');\n    const minutes = String(now.getMinutes()).padStart(2, '0');\n    this.paymentDate = `${year}-${month}-${day}T${hours}:${minutes}`;\n  }\n\n  close() {\n    this.isOpen.set(false);\n  }\n\n  resetForm() {\n    this.selectedStatus.set(null);\n    this.paymentDate = '';\n    this.amountPaid = null;\n    this.observations = '';\n    this.errorMessage.set(null);\n    this.installment.set(null);\n    this.managementId.set(0);\n  }\n\n  save() {\n    const installment = this.installment();\n    if (!installment || !this.canSave()) return;\n\n    this.isSaving.set(true);\n    this.errorMessage.set(null);\n\n    const request: UpdateInstallmentStatusRequest = {\n      status: this.selectedStatus()!,\n      observations: this.observations || undefined,\n      registeredBy: 'USUARIO' // TODO: Obtener del usuario actual\n    };\n\n    // Agregar campos espec√≠ficos para COMPLETADO\n    if (this.selectedStatus() === 'COMPLETADO') {\n      request.paymentDate = this.paymentDate;\n      request.amountPaid = this.amountPaid!;\n    }\n\n    this.paymentScheduleService.updateInstallmentStatus(installment.id, request).subscribe({\n      next: () => {\n        console.log('‚úÖ Estado de cuota actualizado exitosamente');\n        this.isSaving.set(false);\n        this.close();\n        if (this.onSave) {\n          this.onSave(true);\n        }\n      },\n      error: (error) => {\n        console.error('‚ùå Error actualizando estado de cuota:', error);\n        this.errorMessage.set('Error al actualizar el estado. Intente nuevamente.');\n        this.isSaving.set(false);\n        if (this.onSave) {\n          this.onSave(false);\n        }\n      }\n    });\n  }\n\n  formatDate(dateStr: string | undefined): string {\n    if (!dateStr) return '-';\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('es-PE', { day: '2-digit', month: '2-digit', year: 'numeric' });\n  }\n\n  getStatusBadgeClass(status: string): string {\n    switch (status.toUpperCase()) {\n      case 'COMPLETED':\n      case 'COMPLETADO':\n        return 'bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 border border-green-300 dark:border-green-700';\n      case 'PENDING':\n      case 'PENDIENTE':\n        return 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300 border border-yellow-300 dark:border-yellow-700';\n      case 'OVERDUE':\n      case 'VENCIDO':\n        return 'bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 border border-red-300 dark:border-red-700';\n      case 'CANCELLED':\n      case 'CANCELADO':\n        return 'bg-gray-100 dark:bg-gray-700/30 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-600';\n      default:\n        return 'bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-300';\n    }\n  }\n}", "import { Component, Input, signal, computed, ViewChild, OnChanges, SimpleChanges } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PaymentScheduleService, PaymentScheduleResource, InstallmentResource, InstallmentStatusHistoryResource } from '../../services/payment-schedule.service';\nimport { InstallmentStatusDialogComponent } from '../installment-status-dialog/installment-status-dialog.component';\n\ninterface InstallmentWithStatus extends InstallmentResource {\n  latestStatus?: InstallmentStatusHistoryResource;\n}\n\n@Component({\n  selector: 'app-payment-schedule-view',\n  standalone: true,\n  imports: [CommonModule, InstallmentStatusDialogComponent],\n  template: `\n    <div class=\"bg-white dark:bg-slate-900 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden\">\n\n      <!-- Header -->\n      <div class=\"bg-gradient-to-r from-purple-600 to-purple-700 dark:from-purple-700 dark:to-purple-800 text-white px-6 py-4\">\n        <div class=\"flex items-center justify-between\">\n          <div class=\"flex items-center gap-3\">\n            <div>\n              <h3 class=\"text-lg font-bold\">Cronograma de Pagos</h3>\n              <p class=\"text-sm opacity-90\">{{ installmentsWithStatus().length }} cuotas programadas</p>\n            </div>\n          </div>\n          <div class=\"text-right\">\n            <div class=\"text-sm opacity-90\">Monto Total</div>\n            <div class=\"text-2xl font-bold\">S/ {{ schedule()?.totalAmount | number:'1.2-2' }}</div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Loading state -->\n      @if (isLoading()) {\n        <div class=\"p-8 flex items-center justify-center\">\n          <div class=\"flex items-center gap-3 text-slate-600 dark:text-slate-400\">\n            <span>Cargando estados...</span>\n          </div>\n        </div>\n      }\n\n      <!-- Installments Table -->\n      @if (!isLoading() && installmentsWithStatus().length > 0) {\n        <div class=\"overflow-x-auto\">\n          <table class=\"w-full\">\n            <thead class=\"bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700\">\n              <tr>\n                <th class=\"px-4 py-3 text-left text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider\">#</th>\n                <th class=\"px-4 py-3 text-left text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider\">Fecha Vencimiento</th>\n                <th class=\"px-4 py-3 text-right text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider\">Monto</th>\n                <th class=\"px-4 py-3 text-center text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider\">Estado</th>\n                <th class=\"px-4 py-3 text-left text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider\">Fecha Pago</th>\n                <th class=\"px-4 py-3 text-center text-xs font-bold text-slate-700 dark:text-slate-300 uppercase tracking-wider\">Acciones</th>\n              </tr>\n            </thead>\n            <tbody class=\"divide-y divide-slate-200 dark:divide-slate-700\">\n              @for (installment of installmentsWithStatus(); track installment.id) {\n                <tr class=\"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors\">\n                  <!-- N√∫mero de cuota -->\n                  <td class=\"px-4 py-3\">\n                    <div class=\"flex items-center gap-2\">\n                      <div class=\"w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center\">\n                        <span class=\"text-xs font-bold text-purple-700 dark:text-purple-300\">\n                          {{ installment.installmentNumber }}\n                        </span>\n                      </div>\n                    </div>\n                  </td>\n\n                  <!-- Fecha Vencimiento -->\n                  <td class=\"px-4 py-3\">\n                    <div class=\"text-sm text-slate-900 dark:text-slate-100\">\n                      {{ formatDate(installment.dueDate) }}\n                    </div>\n                  </td>\n\n                  <!-- Monto -->\n                  <td class=\"px-4 py-3 text-right\">\n                    <div class=\"text-sm font-bold text-slate-900 dark:text-slate-100\">\n                      S/ {{ installment.amount | number:'1.2-2' }}\n                    </div>\n                  </td>\n\n                  <!-- Estado -->\n                  <td class=\"px-4 py-3\">\n                    <div class=\"flex justify-center\">\n                      <span class=\"px-2 py-1 rounded text-xs font-bold\"\n                            [class]=\"getStatusBadgeClass(installment.latestStatus?.status || 'PENDIENTE')\">\n                        {{ installment.latestStatus?.statusDescription || 'Pendiente' }}\n                      </span>\n                    </div>\n                  </td>\n\n                  <!-- Fecha Pago Real -->\n                  <td class=\"px-4 py-3\">\n                    @if (installment.latestStatus?.actualPaymentDate) {\n                      <div class=\"text-sm text-slate-900 dark:text-slate-100\">\n                        {{ formatDateTime(installment.latestStatus!.actualPaymentDate!) }}\n                      </div>\n                    } @else {\n                      <div class=\"text-sm text-slate-400 dark:text-slate-500\">-</div>\n                    }\n                  </td>\n\n                  <!-- Acciones -->\n                  <td class=\"px-4 py-3\">\n                    <div class=\"flex items-center justify-center gap-2\">\n                      <!-- Bot√≥n editar estado -->\n                      <button\n                        type=\"button\"\n                        (click)=\"openStatusDialog(installment)\"\n                        class=\"p-1.5 hover:bg-purple-100 dark:hover:bg-purple-900/30 rounded transition-colors\"\n                        title=\"Actualizar estado\">\n                      </button>\n\n                      <!-- Bot√≥n ver historial -->\n                      <button\n                        type=\"button\"\n                        (click)=\"toggleHistory(installment.id)\"\n                        [class]=\"expandedHistory() === installment.id\n                          ? 'bg-slate-200 dark:bg-slate-700'\n                          : 'hover:bg-slate-100 dark:hover:bg-slate-800'\"\n                        class=\"p-1.5 rounded transition-colors\"\n                        title=\"Ver historial\">\n                      </button>\n                    </div>\n                  </td>\n                </tr>\n\n                <!-- Historial expandible -->\n                @if (expandedHistory() === installment.id && installmentHistory()) {\n                  <tr>\n                    <td colspan=\"6\" class=\"px-4 py-3 bg-slate-50 dark:bg-slate-800/50\">\n                      <div class=\"space-y-2\">\n                        <div class=\"flex items-center gap-2 text-sm font-bold text-slate-700 dark:text-slate-300 mb-2\">\n                          <span>Historial de Estados</span>\n                        </div>\n\n                        @if (isLoadingHistory()) {\n                          <div class=\"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400 py-2\">\n                            <span>Cargando historial...</span>\n                          </div>\n                        } @else if (installmentHistory() && installmentHistory()!.length > 0) {\n                          <div class=\"space-y-2\">\n                            @for (historyItem of installmentHistory(); track historyItem.id) {\n                              <div class=\"flex items-start gap-3 text-xs p-2 bg-white dark:bg-slate-900 rounded border border-slate-200 dark:border-slate-700\">\n                                <div class=\"flex-shrink-0 w-24 text-slate-600 dark:text-slate-400\">\n                                  {{ formatDateTime(historyItem.changeDate) }}\n                                </div>\n                                <div class=\"flex-1\">\n                                  <span class=\"px-2 py-0.5 rounded font-bold\"\n                                        [class]=\"getStatusBadgeClass(historyItem.status)\">\n                                    {{ historyItem.statusDescription }}\n                                  </span>\n                                  @if (historyItem.amountPaid) {\n                                    <span class=\"ml-2 text-slate-700 dark:text-slate-300\">\n                                      S/ {{ historyItem.amountPaid | number:'1.2-2' }}\n                                    </span>\n                                  }\n                                  @if (historyItem.observations) {\n                                    <div class=\"mt-1 text-slate-600 dark:text-slate-400\">\n                                      {{ historyItem.observations }}\n                                    </div>\n                                  }\n                                </div>\n                                <div class=\"flex-shrink-0 text-slate-500 dark:text-slate-500\">\n                                  {{ historyItem.registeredBy }}\n                                </div>\n                              </div>\n                            }\n                          </div>\n                        }\n                      </div>\n                    </td>\n                  </tr>\n                }\n              }\n            </tbody>\n          </table>\n        </div>\n\n        <!-- Summary -->\n        <div class=\"px-6 py-4 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700\">\n          <div class=\"grid grid-cols-4 gap-4 text-sm\">\n            <div class=\"text-center\">\n              <div class=\"text-slate-600 dark:text-slate-400 mb-1\">Completadas</div>\n              <div class=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n                {{ summaryStats().completed }}\n              </div>\n            </div>\n            <div class=\"text-center\">\n              <div class=\"text-slate-600 dark:text-slate-400 mb-1\">Pendientes</div>\n              <div class=\"text-2xl font-bold text-yellow-600 dark:text-yellow-400\">\n                {{ summaryStats().pending }}\n              </div>\n            </div>\n            <div class=\"text-center\">\n              <div class=\"text-slate-600 dark:text-slate-400 mb-1\">Vencidas</div>\n              <div class=\"text-2xl font-bold text-red-600 dark:text-red-400\">\n                {{ summaryStats().overdue }}\n              </div>\n            </div>\n            <div class=\"text-center\">\n              <div class=\"text-slate-600 dark:text-slate-400 mb-1\">Canceladas</div>\n              <div class=\"text-2xl font-bold text-gray-600 dark:text-gray-400\">\n                {{ summaryStats().cancelled }}\n              </div>\n            </div>\n          </div>\n        </div>\n      }\n\n    </div>\n\n    <!-- Dialog -->\n    <app-installment-status-dialog #statusDialog />\n  `,\n  styles: []\n})\nexport class PaymentScheduleViewComponent implements OnChanges {\n  @Input() managementId: number = 0;\n  @ViewChild('statusDialog') statusDialog!: InstallmentStatusDialogComponent;\n\n  schedule = signal<PaymentScheduleResource | null>(null);\n  latestStatuses = signal<InstallmentStatusHistoryResource[]>([]);\n  isLoading = signal(false);\n\n  expandedHistory = signal<number | null>(null);\n  installmentHistory = signal<InstallmentStatusHistoryResource[] | null>(null);\n  isLoadingHistory = signal(false);\n\n  installmentsWithStatus = computed<InstallmentWithStatus[]>(() => {\n    const sched = this.schedule();\n    const statuses = this.latestStatuses();\n\n    if (!sched) return [];\n\n    return sched.installments.map(installment => {\n      const latestStatus = statuses.find(s => s.installmentId === installment.id);\n      return {\n        ...installment,\n        latestStatus\n      };\n    });\n  });\n\n  summaryStats = computed(() => {\n    const installments = this.installmentsWithStatus();\n    return {\n      completed: installments.filter(i => ['COMPLETED', 'COMPLETADO'].includes(i.latestStatus?.status || '')).length,\n      pending: installments.filter(i => ['PENDING', 'PENDIENTE'].includes(i.latestStatus?.status || '')).length,\n      overdue: installments.filter(i => ['OVERDUE', 'VENCIDO'].includes(i.latestStatus?.status || '')).length,\n      cancelled: installments.filter(i => ['CANCELLED', 'CANCELADO'].includes(i.latestStatus?.status || '')).length,\n    };\n  });\n\n  constructor(private paymentScheduleService: PaymentScheduleService) {}\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes['managementId'] && this.managementId) {\n      this.loadSchedule();\n    }\n  }\n\n  loadSchedule() {\n    this.isLoading.set(true);\n\n    this.paymentScheduleService.getPaymentScheduleByManagementId(this.managementId).subscribe({\n      next: (schedule) => {\n        console.log('üìä Cronograma cargado:', schedule);\n        this.schedule.set(schedule);\n        this.loadLatestStatuses();\n      },\n      error: (error) => {\n        console.error('‚ùå Error cargando cronograma:', error);\n        this.isLoading.set(false);\n      }\n    });\n  }\n\n  loadLatestStatuses() {\n    this.paymentScheduleService.getLatestStatusByManagement(this.managementId).subscribe({\n      next: (statuses) => {\n        console.log('üìã Estados m√°s recientes cargados:', statuses);\n        this.latestStatuses.set(statuses);\n        this.isLoading.set(false);\n      },\n      error: (error) => {\n        console.error('‚ùå Error cargando estados:', error);\n        this.isLoading.set(false);\n      }\n    });\n  }\n\n  openStatusDialog(installment: InstallmentWithStatus) {\n    this.statusDialog.open(installment, this.managementId);\n    this.statusDialog.onSave = (success) => {\n      if (success) {\n        // Recargar estados\n        this.loadLatestStatuses();\n        // Recargar historial si est√° expandido\n        if (this.expandedHistory() === installment.id) {\n          this.loadInstallmentHistory(installment.id);\n        }\n      }\n    };\n  }\n\n  toggleHistory(installmentId: number) {\n    if (this.expandedHistory() === installmentId) {\n      this.expandedHistory.set(null);\n      this.installmentHistory.set(null);\n    } else {\n      this.expandedHistory.set(installmentId);\n      this.loadInstallmentHistory(installmentId);\n    }\n  }\n\n  loadInstallmentHistory(installmentId: number) {\n    this.isLoadingHistory.set(true);\n    this.paymentScheduleService.getInstallmentHistory(installmentId).subscribe({\n      next: (history) => {\n        console.log('üìú Historial de cuota cargado:', history);\n        this.installmentHistory.set(history);\n        this.isLoadingHistory.set(false);\n      },\n      error: (error) => {\n        console.error('‚ùå Error cargando historial:', error);\n        this.isLoadingHistory.set(false);\n      }\n    });\n  }\n\n  formatDate(dateStr: string): string {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString('es-PE', { day: '2-digit', month: '2-digit', year: 'numeric' });\n  }\n\n  formatDateTime(dateStr: string): string {\n    const date = new Date(dateStr);\n    return date.toLocaleString('es-PE', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  }\n\n  getStatusBadgeClass(status: string): string {\n    switch (status.toUpperCase()) {\n      case 'COMPLETED':\n      case 'COMPLETADO':\n        return 'bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 border border-green-300 dark:border-green-700';\n      case 'PENDING':\n      case 'PENDIENTE':\n        return 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-300 border border-yellow-300 dark:border-yellow-700';\n      case 'OVERDUE':\n      case 'VENCIDO':\n        return 'bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 border border-red-300 dark:border-red-700';\n      case 'CANCELLED':\n      case 'CANCELADO':\n        return 'bg-gray-100 dark:bg-gray-700/30 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-600';\n      default:\n        return 'bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-300';\n    }\n  }\n}\n", "import { Component, EventEmitter, Input, Output, OnInit, OnChanges, SimpleChanges, signal } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { AutorizacionService, SupervisorEnLinea } from '../../../core/services/autorizacion.service';\r\n\r\n@Component({\r\n  selector: 'app-select-supervisor-modal',\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule],\r\n  template: `\r\n    @if (visible) {\r\n      <div class=\"modal-overlay\" (click)=\"onOverlayClick($event)\">\r\n        <div class=\"modal-container\">\r\n          <!-- Header -->\r\n          <div class=\"modal-header\">\r\n            <h2>üîê Seleccionar Supervisor para Autorizaci√≥n</h2>\r\n            <button class=\"close-btn\" (click)=\"onCancel()\">&times;</button>\r\n          </div>\r\n\r\n          <!-- Content -->\r\n          <div class=\"modal-content\">\r\n            @if (cargando()) {\r\n              <div class=\"loading-container\">\r\n                <div class=\"spinner\"></div>\r\n                <p>Buscando supervisores en l√≠nea...</p>\r\n              </div>\r\n            } @else if (supervisores().length === 0) {\r\n              <div class=\"no-supervisors\">\r\n                <span class=\"warning-icon\">‚ö†Ô∏è</span>\r\n                <p class=\"title\">No hay supervisores en l√≠nea</p>\r\n                <p class=\"subtitle\">Intenta de nuevo m√°s tarde o contacta a un administrador</p>\r\n                <button class=\"retry-btn\" (click)=\"cargarSupervisores()\">\r\n                  üîÑ Reintentar\r\n                </button>\r\n              </div>\r\n            } @else {\r\n              <p class=\"instruction\">Selecciona a qui√©n enviar la solicitud de autorizaci√≥n:</p>\r\n\r\n              <div class=\"supervisors-list\">\r\n                @for (supervisor of supervisores(); track supervisor.idUsuario) {\r\n                  <div\r\n                    class=\"supervisor-card\"\r\n                    [class.selected]=\"supervisorSeleccionado?.idUsuario === supervisor.idUsuario\"\r\n                    (click)=\"selectSupervisor(supervisor)\">\r\n                    <div class=\"radio-container\">\r\n                      <input\r\n                        type=\"radio\"\r\n                        [name]=\"'supervisor'\"\r\n                        [value]=\"supervisor.idUsuario\"\r\n                        [checked]=\"supervisorSeleccionado?.idUsuario === supervisor.idUsuario\"\r\n                        (change)=\"selectSupervisor(supervisor)\">\r\n                    </div>\r\n                    <div class=\"supervisor-info\">\r\n                      <div class=\"name\">\r\n                        <span class=\"user-icon\">üë§</span>\r\n                        {{ supervisor.nombreCompleto }}\r\n                      </div>\r\n                      <div class=\"details\">\r\n                        <span class=\"rol-badge\" [class.admin]=\"supervisor.rol === 'ADMIN'\">\r\n                          {{ supervisor.rol }}\r\n                        </span>\r\n                        <span class=\"estado-badge\" [class]=\"getEstadoClass(supervisor.estado)\">\r\n                          {{ supervisor.estado }}\r\n                        </span>\r\n                        @if (supervisor.solicitudesPendientes && supervisor.solicitudesPendientes > 0) {\r\n                          <span class=\"pendientes-badge\">\r\n                            {{ supervisor.solicitudesPendientes }} pendiente(s)\r\n                          </span>\r\n                        }\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                }\r\n              </div>\r\n            }\r\n          </div>\r\n\r\n          <!-- Footer -->\r\n          <div class=\"modal-footer\">\r\n            <button class=\"btn btn-cancel\" (click)=\"onCancel()\">\r\n              Cancelar\r\n            </button>\r\n            <button\r\n              class=\"btn btn-primary\"\r\n              [disabled]=\"!supervisorSeleccionado || cargando()\"\r\n              (click)=\"onConfirm()\">\r\n              üì§ Enviar Solicitud\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    }\r\n  `,\r\n  styles: [`\r\n    .modal-overlay {\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      background: rgba(0, 0, 0, 0.5);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      z-index: 10000;\r\n      animation: fadeIn 0.2s ease-out;\r\n    }\r\n\r\n    @keyframes fadeIn {\r\n      from { opacity: 0; }\r\n      to { opacity: 1; }\r\n    }\r\n\r\n    .modal-container {\r\n      background: white;\r\n      border-radius: 12px;\r\n      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\r\n      width: 90%;\r\n      max-width: 550px;\r\n      max-height: 90vh;\r\n      display: flex;\r\n      flex-direction: column;\r\n      animation: slideUp 0.3s ease-out;\r\n    }\r\n\r\n    @keyframes slideUp {\r\n      from {\r\n        opacity: 0;\r\n        transform: translateY(20px);\r\n      }\r\n      to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n      }\r\n    }\r\n\r\n    .modal-header {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      padding: 1rem 1.5rem;\r\n      border-bottom: 1px solid #e5e7eb;\r\n      background: linear-gradient(135deg, #3b82f6, #1d4ed8);\r\n      border-radius: 12px 12px 0 0;\r\n      color: white;\r\n    }\r\n\r\n    .modal-header h2 {\r\n      margin: 0;\r\n      font-size: 1.1rem;\r\n      font-weight: 600;\r\n    }\r\n\r\n    .close-btn {\r\n      background: none;\r\n      border: none;\r\n      color: white;\r\n      font-size: 1.5rem;\r\n      cursor: pointer;\r\n      padding: 0;\r\n      line-height: 1;\r\n      opacity: 0.8;\r\n      transition: opacity 0.2s;\r\n    }\r\n\r\n    .close-btn:hover {\r\n      opacity: 1;\r\n    }\r\n\r\n    .modal-content {\r\n      padding: 1.5rem;\r\n      overflow-y: auto;\r\n      flex: 1;\r\n      min-height: 200px;\r\n    }\r\n\r\n    .loading-container,\r\n    .no-supervisors {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      min-height: 200px;\r\n      text-align: center;\r\n    }\r\n\r\n    .spinner {\r\n      width: 40px;\r\n      height: 40px;\r\n      border: 3px solid #e5e7eb;\r\n      border-top-color: #3b82f6;\r\n      border-radius: 50%;\r\n      animation: spin 1s linear infinite;\r\n      margin-bottom: 1rem;\r\n    }\r\n\r\n    @keyframes spin {\r\n      to { transform: rotate(360deg); }\r\n    }\r\n\r\n    .warning-icon {\r\n      font-size: 3rem;\r\n      margin-bottom: 1rem;\r\n    }\r\n\r\n    .no-supervisors .title {\r\n      font-size: 1.1rem;\r\n      font-weight: 600;\r\n      color: #374151;\r\n      margin: 0 0 0.5rem 0;\r\n    }\r\n\r\n    .no-supervisors .subtitle {\r\n      color: #6b7280;\r\n      margin: 0 0 1rem 0;\r\n    }\r\n\r\n    .retry-btn {\r\n      padding: 0.5rem 1rem;\r\n      border: 1px solid #3b82f6;\r\n      background: white;\r\n      color: #3b82f6;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n    }\r\n\r\n    .retry-btn:hover {\r\n      background: #eff6ff;\r\n    }\r\n\r\n    .instruction {\r\n      color: #6b7280;\r\n      margin: 0 0 1rem 0;\r\n      font-size: 0.875rem;\r\n    }\r\n\r\n    .supervisors-list {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 0.75rem;\r\n    }\r\n\r\n    .supervisor-card {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 1rem;\r\n      padding: 1rem;\r\n      border: 2px solid #e5e7eb;\r\n      border-radius: 10px;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n    }\r\n\r\n    .supervisor-card:hover {\r\n      border-color: #93c5fd;\r\n      background: #f0f9ff;\r\n    }\r\n\r\n    .supervisor-card.selected {\r\n      border-color: #3b82f6;\r\n      background: #eff6ff;\r\n    }\r\n\r\n    .radio-container {\r\n      flex-shrink: 0;\r\n    }\r\n\r\n    .radio-container input[type=\"radio\"] {\r\n      width: 18px;\r\n      height: 18px;\r\n      accent-color: #3b82f6;\r\n      cursor: pointer;\r\n    }\r\n\r\n    .supervisor-info {\r\n      flex: 1;\r\n    }\r\n\r\n    .name {\r\n      font-weight: 600;\r\n      color: #1f2937;\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 0.5rem;\r\n      margin-bottom: 0.5rem;\r\n    }\r\n\r\n    .user-icon {\r\n      font-size: 1rem;\r\n    }\r\n\r\n    .details {\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      gap: 0.5rem;\r\n    }\r\n\r\n    .rol-badge {\r\n      padding: 0.2rem 0.5rem;\r\n      border-radius: 4px;\r\n      font-size: 0.7rem;\r\n      font-weight: 600;\r\n      text-transform: uppercase;\r\n      background: #dbeafe;\r\n      color: #1d4ed8;\r\n    }\r\n\r\n    .rol-badge.admin {\r\n      background: #fee2e2;\r\n      color: #dc2626;\r\n    }\r\n\r\n    .estado-badge {\r\n      padding: 0.2rem 0.5rem;\r\n      border-radius: 4px;\r\n      font-size: 0.7rem;\r\n      font-weight: 600;\r\n    }\r\n\r\n    .estado-badge.disponible {\r\n      background: #dcfce7;\r\n      color: #166534;\r\n    }\r\n\r\n    .estado-badge.en-llamada {\r\n      background: #fef3c7;\r\n      color: #92400e;\r\n    }\r\n\r\n    .estado-badge.desconectado {\r\n      background: #fee2e2;\r\n      color: #dc2626;\r\n    }\r\n\r\n    .pendientes-badge {\r\n      padding: 0.2rem 0.5rem;\r\n      border-radius: 4px;\r\n      font-size: 0.7rem;\r\n      font-weight: 600;\r\n      background: #fef3c7;\r\n      color: #92400e;\r\n    }\r\n\r\n    .modal-footer {\r\n      display: flex;\r\n      justify-content: flex-end;\r\n      gap: 0.75rem;\r\n      padding: 1rem 1.5rem;\r\n      border-top: 1px solid #e5e7eb;\r\n      background: #f9fafb;\r\n      border-radius: 0 0 12px 12px;\r\n    }\r\n\r\n    .btn {\r\n      padding: 0.625rem 1.25rem;\r\n      border-radius: 8px;\r\n      font-weight: 500;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n    }\r\n\r\n    .btn-cancel {\r\n      background: white;\r\n      border: 1px solid #d1d5db;\r\n      color: #374151;\r\n    }\r\n\r\n    .btn-cancel:hover {\r\n      background: #f3f4f6;\r\n    }\r\n\r\n    .btn-primary {\r\n      background: #3b82f6;\r\n      border: none;\r\n      color: white;\r\n    }\r\n\r\n    .btn-primary:hover:not(:disabled) {\r\n      background: #2563eb;\r\n    }\r\n\r\n    .btn-primary:disabled {\r\n      background: #93c5fd;\r\n      cursor: not-allowed;\r\n    }\r\n  `]\r\n})\r\nexport class SelectSupervisorModalComponent implements OnInit, OnChanges {\r\n  @Input() visible = false;\r\n  @Output() visibleChange = new EventEmitter<boolean>();\r\n  @Output() supervisorSelected = new EventEmitter<SupervisorEnLinea>();\r\n  @Output() cancelled = new EventEmitter<void>();\r\n\r\n  supervisores = signal<SupervisorEnLinea[]>([]);\r\n  cargando = signal<boolean>(false);\r\n  supervisorSeleccionado: SupervisorEnLinea | null = null;\r\n\r\n  constructor(private autorizacionService: AutorizacionService) {}\r\n\r\n  ngOnInit(): void {}\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes['visible'] && changes['visible'].currentValue === true) {\r\n      this.cargarSupervisores();\r\n    }\r\n  }\r\n\r\n  cargarSupervisores(): void {\r\n    this.cargando.set(true);\r\n    this.autorizacionService.obtenerSupervisoresEnLinea().subscribe({\r\n      next: (supervisores) => {\r\n        this.supervisores.set(supervisores);\r\n        this.cargando.set(false);\r\n      },\r\n      error: (error) => {\r\n        console.error('[SELECT-SUPERVISOR] Error al cargar supervisores:', error);\r\n        this.cargando.set(false);\r\n      }\r\n    });\r\n  }\r\n\r\n  selectSupervisor(supervisor: SupervisorEnLinea): void {\r\n    this.supervisorSeleccionado = supervisor;\r\n  }\r\n\r\n  getEstadoClass(estado: string): string {\r\n    switch (estado) {\r\n      case 'DISPONIBLE':\r\n      case 'CONECTADO':\r\n        return 'disponible';\r\n      case 'EN_LLAMADA':\r\n        return 'en-llamada';\r\n      case 'DESCONECTADO':\r\n        return 'desconectado';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  onOverlayClick(event: MouseEvent): void {\r\n    if ((event.target as HTMLElement).classList.contains('modal-overlay')) {\r\n      this.onCancel();\r\n    }\r\n  }\r\n\r\n  onConfirm(): void {\r\n    if (this.supervisorSeleccionado) {\r\n      this.supervisorSelected.emit(this.supervisorSeleccionado);\r\n      this.closeModal();\r\n    }\r\n  }\r\n\r\n  onCancel(): void {\r\n    this.cancelled.emit();\r\n    this.closeModal();\r\n  }\r\n\r\n  private closeModal(): void {\r\n    this.visible = false;\r\n    this.visibleChange.emit(false);\r\n    this.supervisorSeleccionado = null;\r\n  }\r\n}\r\n", "import { Injectable, inject } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\nimport {\r\n  ComprobanteUploadResponse,\r\n  ComprobanteUploadRequest,\r\n  AdjuntoGestion\r\n} from '../models/comprobante.model';\r\n\r\n/**\r\n * Servicio para gestionar comprobantes de pago\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ComprobanteService {\r\n  private http = inject(HttpClient);\r\n  private baseUrl = `${environment.apiUrl}/v2/comprobantes`;\r\n\r\n  /**\r\n   * Sube un comprobante de pago y lo valida con OCR\r\n   * @param file Archivo de imagen del comprobante\r\n   * @param request Datos de la solicitud\r\n   */\r\n  uploadComprobante(\r\n    file: File,\r\n    request: ComprobanteUploadRequest\r\n  ): Observable<ComprobanteUploadResponse> {\r\n    const formData = new FormData();\r\n    formData.append('file', file);\r\n    formData.append('idCuota', request.idCuota.toString());\r\n    formData.append('idAgente', request.idAgente.toString());\r\n\r\n    if (request.montoEsperado !== undefined) {\r\n      formData.append('montoEsperado', request.montoEsperado.toString());\r\n    }\r\n    if (request.documentoEsperado) {\r\n      formData.append('documentoEsperado', request.documentoEsperado);\r\n    }\r\n    if (request.nombreEsperado) {\r\n      formData.append('nombreEsperado', request.nombreEsperado);\r\n    }\r\n    if (request.idGestion !== undefined) {\r\n      formData.append('idGestion', request.idGestion.toString());\r\n    }\r\n    if (request.descripcion) {\r\n      formData.append('descripcion', request.descripcion);\r\n    }\r\n    if (request.validarConOcr !== undefined) {\r\n      formData.append('validarConOcr', request.validarConOcr.toString());\r\n    }\r\n\r\n    return this.http.post<ComprobanteUploadResponse>(\r\n      `${this.baseUrl}/upload`,\r\n      formData\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Obtiene los comprobantes asociados a una cuota\r\n   * @param cuotaId ID de la cuota\r\n   */\r\n  getComprobantesByCuota(cuotaId: number): Observable<AdjuntoGestion[]> {\r\n    return this.http.get<AdjuntoGestion[]>(`${this.baseUrl}/cuota/${cuotaId}`);\r\n  }\r\n\r\n  /**\r\n   * Asocia un comprobante existente a una gesti√≥n\r\n   * @param uuid UUID del comprobante\r\n   * @param idGestion ID de la gesti√≥n\r\n   */\r\n  asociarAGestion(uuid: string, idGestion: number): Observable<void> {\r\n    return this.http.post<void>(\r\n      `${this.baseUrl}/${uuid}/asociar-gestion/${idGestion}`,\r\n      {}\r\n    );\r\n  }\r\n}\r\n", "import { Component, Inject, signal, computed } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MAT_DIALOG_DATA, MatDialogRef, MatDialogModule } from '@angular/material/dialog';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\r\nimport { ComprobanteService } from '../../services/comprobante.service';\r\nimport { ComprobanteUploadResponse, ValidationResult } from '../../models/comprobante.model';\r\n\r\nexport interface ComprobanteUploadDialogData {\r\n  idCuota: number;\r\n  montoEsperado: number;\r\n  documentoEsperado: string;\r\n  nombreCliente: string;\r\n  idAgente: number;\r\n}\r\n\r\nexport interface ComprobanteUploadDialogResult {\r\n  uploaded: boolean;\r\n  response?: ComprobanteUploadResponse;\r\n  validacionesOk: boolean;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-comprobante-upload-dialog',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    MatDialogModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatProgressSpinnerModule,\r\n    MatProgressBarModule\r\n  ],\r\n  template: `\r\n    <!-- Header compacto -->\r\n    <div class=\"dialog-header bg-gradient-to-r from-indigo-600 to-blue-600 dark:from-indigo-700 dark:to-blue-700 text-white px-5 py-3 -mx-6 -mt-6 mb-4 rounded-t-2xl\">\r\n      <div class=\"flex items-center gap-3\">\r\n        <div class=\"p-2 bg-white/20 rounded-lg\">\r\n          <mat-icon class=\"!text-2xl\">receipt_long</mat-icon>\r\n        </div>\r\n        <div>\r\n          <h2 class=\"text-lg font-bold m-0\">Subir Comprobante de Pago</h2>\r\n          <p class=\"text-xs text-white/80 m-0\">Validaci√≥n autom√°tica con IA</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <mat-dialog-content class=\"!overflow-x-hidden !overflow-y-auto !w-full\">\r\n      <!-- Info de la cuota compacta -->\r\n      <div class=\"mb-4 p-3 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm\">\r\n        <div class=\"grid grid-cols-3 gap-3\">\r\n          <div class=\"min-w-0\">\r\n            <p class=\"text-[10px] text-slate-500 dark:text-slate-400 uppercase tracking-wide font-semibold mb-0.5\">Cliente</p>\r\n            <p class=\"font-semibold text-sm text-slate-800 dark:text-slate-100 truncate\">{{ data.nombreCliente }}</p>\r\n          </div>\r\n          <div>\r\n            <p class=\"text-[10px] text-slate-500 dark:text-slate-400 uppercase tracking-wide font-semibold mb-0.5\">Documento</p>\r\n            <p class=\"font-semibold text-sm text-slate-800 dark:text-slate-100\">{{ data.documentoEsperado }}</p>\r\n          </div>\r\n          <div>\r\n            <p class=\"text-[10px] text-slate-500 dark:text-slate-400 uppercase tracking-wide font-semibold mb-0.5\">Monto esperado</p>\r\n            <p class=\"font-bold text-lg text-indigo-600 dark:text-indigo-400\">S/ {{ data.montoEsperado | number:'1.2-2' }}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- √Årea de drag & drop compacta -->\r\n      @if (!selectedFile()) {\r\n        <div\r\n          class=\"border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl p-6 text-center cursor-pointer\r\n                 hover:border-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-950/20\r\n                 transition-all duration-300 group bg-white dark:bg-slate-800/30\"\r\n          (click)=\"fileInput.click()\"\r\n          (dragover)=\"onDragOver($event)\"\r\n          (drop)=\"onDrop($event)\"\r\n        >\r\n          <div class=\"w-14 h-14 mx-auto mb-3 bg-slate-100 dark:bg-slate-700 rounded-xl flex items-center justify-center group-hover:bg-indigo-100 dark:group-hover:bg-indigo-900/30 transition-colors\">\r\n            <mat-icon class=\"!text-4xl text-slate-400 dark:text-slate-500 group-hover:text-indigo-500 transition-colors\">cloud_upload</mat-icon>\r\n          </div>\r\n          <p class=\"text-slate-700 dark:text-slate-200 font-semibold mb-1\">Arrastra una imagen aqu√≠</p>\r\n          <p class=\"text-slate-500 dark:text-slate-400 text-sm\">\r\n            o <span class=\"text-indigo-600 dark:text-indigo-400 font-semibold hover:underline\">haz clic para seleccionar</span>\r\n          </p>\r\n          <p class=\"text-xs text-slate-400 dark:text-slate-500 mt-2\">JPG, PNG, WebP - M√°ximo 5MB</p>\r\n        </div>\r\n        <input #fileInput type=\"file\" accept=\"image/jpeg,image/png,image/webp\" class=\"hidden\" (change)=\"onFileSelected($event)\" />\r\n      }\r\n\r\n      <!-- Preview de imagen antes de subir -->\r\n      @if (selectedFile() && !isUploading() && !uploadResponse()) {\r\n        <div class=\"relative rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 shadow-sm\">\r\n          <img [src]=\"previewUrl()\" alt=\"Preview\" class=\"w-full max-h-48 object-contain p-2\" />\r\n          <button mat-icon-button class=\"!absolute top-2 right-2 !bg-red-500 !text-white hover:!bg-red-600 shadow-lg !rounded-lg !w-8 !h-8\" (click)=\"removeFile()\">\r\n            <mat-icon class=\"!text-lg\">close</mat-icon>\r\n          </button>\r\n          <div class=\"px-3 py-2 bg-slate-100 dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700\">\r\n            <p class=\"text-xs text-slate-700 dark:text-slate-300 flex items-center gap-1.5\">\r\n              <mat-icon class=\"!text-sm text-slate-500 dark:text-slate-400\">insert_drive_file</mat-icon>\r\n              <span class=\"truncate\">{{ selectedFile()?.name }}</span>\r\n              <span class=\"text-slate-400 dark:text-slate-500 flex-shrink-0\">-</span>\r\n              <span class=\"text-slate-500 dark:text-slate-400 flex-shrink-0\">{{ formatFileSize(selectedFile()?.size || 0) }}</span>\r\n            </p>\r\n          </div>\r\n        </div>\r\n      }\r\n\r\n      <!-- Spinner compacto -->\r\n      @if (isUploading()) {\r\n        <div class=\"py-8 text-center bg-slate-50 dark:bg-slate-800/30 rounded-xl\">\r\n          <div class=\"relative inline-block\">\r\n            <div class=\"w-16 h-16 border-4 border-indigo-200 dark:border-indigo-900/50 rounded-full animate-pulse\"></div>\r\n            <mat-spinner diameter=\"56\" class=\"!absolute top-1 left-1\" strokeWidth=\"3\"></mat-spinner>\r\n            <div class=\"absolute inset-0 flex items-center justify-center\">\r\n              <mat-icon class=\"text-indigo-500 dark:text-indigo-400 animate-pulse !text-xl\">document_scanner</mat-icon>\r\n            </div>\r\n          </div>\r\n          <p class=\"text-slate-800 dark:text-slate-100 font-semibold mt-4\">Analizando con IA...</p>\r\n          <div class=\"flex justify-center gap-1 mt-3\">\r\n            <span class=\"w-2 h-2 bg-indigo-500 rounded-full animate-bounce\" style=\"animation-delay: 0ms\"></span>\r\n            <span class=\"w-2 h-2 bg-indigo-500 rounded-full animate-bounce\" style=\"animation-delay: 150ms\"></span>\r\n            <span class=\"w-2 h-2 bg-indigo-500 rounded-full animate-bounce\" style=\"animation-delay: 300ms\"></span>\r\n          </div>\r\n        </div>\r\n      }\r\n\r\n      <!-- Resultado del OCR con imagen a la derecha -->\r\n      @if (uploadResponse()) {\r\n        <div class=\"flex gap-4\">\r\n          <!-- Columna izquierda: Resultados -->\r\n          <div class=\"flex-1 min-w-0 space-y-3\">\r\n            <!-- Mensaje general compacto -->\r\n            <div class=\"p-3 rounded-xl flex items-center gap-3\" [class]=\"getResultBgClass()\">\r\n              <div class=\"p-2 rounded-lg flex-shrink-0\" [class]=\"getResultIconBgClass()\">\r\n                <mat-icon class=\"!text-xl\">{{ getResultIcon() }}</mat-icon>\r\n              </div>\r\n              <div class=\"flex-1 min-w-0\">\r\n                <p class=\"font-bold text-sm\">{{ getResultTitle() }}</p>\r\n                <p class=\"text-xs opacity-80 truncate\">{{ uploadResponse()?.mensaje }}</p>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Grid de validaciones 3 columnas -->\r\n            @if (uploadResponse()?.ocrResult?.success) {\r\n              <div class=\"grid grid-cols-3 gap-2\">\r\n              <!-- Monto -->\r\n              <div class=\"p-3 rounded-xl border-2 transition-all\" [class]=\"getValidationCardClass(uploadResponse()?.validacionMonto)\">\r\n                <div class=\"flex items-center justify-between mb-1\">\r\n                  <span class=\"text-[10px] font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400\">Monto</span>\r\n                  @if (uploadResponse()?.validacionMonto) {\r\n                    <mat-icon class=\"!text-base\" [class]=\"uploadResponse()?.validacionMonto?.coincide ? 'text-green-500' : 'text-amber-500'\">\r\n                      {{ uploadResponse()?.validacionMonto?.coincide ? 'check_circle' : 'warning' }}\r\n                    </mat-icon>\r\n                  }\r\n                </div>\r\n                <p class=\"text-lg font-bold text-slate-800 dark:text-slate-100\">S/ {{ uploadResponse()?.ocrResult?.monto | number:'1.2-2' }}</p>\r\n                @if (uploadResponse()?.validacionMonto) {\r\n                  <p class=\"text-[10px] mt-1 font-medium flex items-center gap-0.5\" [class]=\"uploadResponse()?.validacionMonto?.coincide ? 'text-green-600 dark:text-green-400' : 'text-amber-600 dark:text-amber-400'\">\r\n                    <mat-icon class=\"!text-xs\">{{ uploadResponse()?.validacionMonto?.coincide ? 'check' : 'priority_high' }}</mat-icon>\r\n                    {{ uploadResponse()?.validacionMonto?.coincide ? 'OK' : 'No coincide' }}\r\n                  </p>\r\n                }\r\n              </div>\r\n\r\n              <!-- Documento -->\r\n              <div class=\"p-3 rounded-xl border-2 transition-all\" [class]=\"getValidationCardClass(uploadResponse()?.validacionDocumento)\">\r\n                <div class=\"flex items-center justify-between mb-1\">\r\n                  <span class=\"text-[10px] font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400\">Documento</span>\r\n                  @if (uploadResponse()?.validacionDocumento) {\r\n                    <mat-icon class=\"!text-base\" [class]=\"uploadResponse()?.validacionDocumento?.coincide ? 'text-green-500' : 'text-amber-500'\">\r\n                      {{ uploadResponse()?.validacionDocumento?.coincide ? 'check_circle' : 'warning' }}\r\n                    </mat-icon>\r\n                  }\r\n                </div>\r\n                <p class=\"text-sm font-bold text-slate-800 dark:text-slate-100 truncate\">{{ uploadResponse()?.ocrResult?.documento || '-' }}</p>\r\n                @if (uploadResponse()?.validacionDocumento) {\r\n                  <p class=\"text-[10px] mt-1 font-medium flex items-center gap-0.5\" [class]=\"uploadResponse()?.validacionDocumento?.coincide ? 'text-green-600 dark:text-green-400' : 'text-amber-600 dark:text-amber-400'\">\r\n                    <mat-icon class=\"!text-xs\">{{ uploadResponse()?.validacionDocumento?.coincide ? 'check' : 'priority_high' }}</mat-icon>\r\n                    {{ uploadResponse()?.validacionDocumento?.coincide ? 'OK' : 'No coincide' }}\r\n                  </p>\r\n                }\r\n              </div>\r\n\r\n              <!-- Nombre -->\r\n              <div class=\"p-3 rounded-xl border-2 transition-all\" [class]=\"getValidationCardClass(uploadResponse()?.validacionNombre)\">\r\n                <div class=\"flex items-center justify-between mb-1\">\r\n                  <span class=\"text-[10px] font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400\">Nombre</span>\r\n                  @if (uploadResponse()?.validacionNombre) {\r\n                    <mat-icon class=\"!text-base\" [class]=\"uploadResponse()?.validacionNombre?.coincide ? 'text-green-500' : 'text-amber-500'\">\r\n                      {{ uploadResponse()?.validacionNombre?.coincide ? 'check_circle' : 'warning' }}\r\n                    </mat-icon>\r\n                  }\r\n                </div>\r\n                <p class=\"text-sm font-bold text-slate-800 dark:text-slate-100 truncate\">{{ uploadResponse()?.ocrResult?.nombre || '-' }}</p>\r\n                @if (uploadResponse()?.validacionNombre) {\r\n                  <p class=\"text-[10px] mt-1 font-medium flex items-center gap-0.5\" [class]=\"uploadResponse()?.validacionNombre?.coincide ? 'text-green-600 dark:text-green-400' : 'text-amber-600 dark:text-amber-400'\">\r\n                    <mat-icon class=\"!text-xs\">{{ uploadResponse()?.validacionNombre?.coincide ? 'check' : 'priority_high' }}</mat-icon>\r\n                    {{ uploadResponse()?.validacionNombre?.coincide ? 'OK' : 'No coincide' }}\r\n                  </p>\r\n                }\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Info adicional compacta -->\r\n            @if (uploadResponse()?.ocrResult?.banco || uploadResponse()?.ocrResult?.numeroOperacion || uploadResponse()?.ocrResult?.fecha) {\r\n              <div class=\"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-200 dark:border-slate-700\">\r\n                <div class=\"flex items-center gap-4 text-sm\">\r\n                  @if (uploadResponse()?.ocrResult?.banco) {\r\n                    <div class=\"flex items-center gap-1.5\">\r\n                      <mat-icon class=\"!text-base text-slate-400\">account_balance</mat-icon>\r\n                      <span class=\"font-semibold text-slate-800 dark:text-slate-100\">{{ uploadResponse()?.ocrResult?.banco }}</span>\r\n                    </div>\r\n                  }\r\n                  @if (uploadResponse()?.ocrResult?.numeroOperacion) {\r\n                    <div class=\"flex items-center gap-1.5\">\r\n                      <mat-icon class=\"!text-base text-slate-400\">tag</mat-icon>\r\n                      <span class=\"font-semibold text-slate-800 dark:text-slate-100\">{{ uploadResponse()?.ocrResult?.numeroOperacion }}</span>\r\n                    </div>\r\n                  }\r\n                  @if (uploadResponse()?.ocrResult?.fecha) {\r\n                    <div class=\"flex items-center gap-1.5\">\r\n                      <mat-icon class=\"!text-base text-slate-400\">event</mat-icon>\r\n                      <span class=\"font-semibold text-slate-800 dark:text-slate-100\">{{ uploadResponse()?.ocrResult?.fecha }}</span>\r\n                    </div>\r\n                  }\r\n                </div>\r\n              </div>\r\n            }\r\n          } @else if (uploadResponse()?.ocrResult && !uploadResponse()?.ocrResult?.success) {\r\n            <div class=\"p-3 bg-amber-50 dark:bg-amber-950/30 rounded-xl border border-amber-200 dark:border-amber-800 flex items-center gap-3\">\r\n              <mat-icon class=\"text-amber-500\">info</mat-icon>\r\n              <p class=\"text-sm text-amber-800 dark:text-amber-200\">Comprobante guardado sin validaci√≥n OCR</p>\r\n            </div>\r\n          }\r\n\r\n            <!-- Advertencia compacta -->\r\n            @if (showWarning()) {\r\n              <div class=\"p-3 bg-amber-50 dark:bg-amber-950/30 border-2 border-amber-300 dark:border-amber-700 rounded-xl flex items-center gap-3\">\r\n                <mat-icon class=\"text-amber-600 dark:text-amber-400\">warning</mat-icon>\r\n                <div>\r\n                  <p class=\"text-amber-800 dark:text-amber-200 font-semibold text-sm\">Hay diferencias en la validaci√≥n</p>\r\n                  <p class=\"text-amber-700 dark:text-amber-300 text-xs\">Verifica visualmente el comprobante.</p>\r\n                </div>\r\n              </div>\r\n            }\r\n          </div>\r\n\r\n          <!-- Columna derecha: Imagen con zoom -->\r\n          <div class=\"w-96 flex-shrink-0\">\r\n            <div class=\"sticky top-0 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 overflow-hidden\">\r\n              <div class=\"p-2 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between\">\r\n                <span class=\"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase\">Comprobante</span>\r\n                <div class=\"flex items-center gap-1\">\r\n                  <button mat-icon-button class=\"!w-7 !h-7\" (click)=\"zoomOut()\" [disabled]=\"zoomLevel() <= 0.5\">\r\n                    <mat-icon class=\"!text-base text-slate-500 dark:text-slate-400\">remove</mat-icon>\r\n                  </button>\r\n                  <span class=\"text-xs text-slate-500 dark:text-slate-400 w-10 text-center\">{{ (zoomLevel() * 100) | number:'1.0-0' }}%</span>\r\n                  <button mat-icon-button class=\"!w-7 !h-7\" (click)=\"zoomIn()\" [disabled]=\"zoomLevel() >= 3\">\r\n                    <mat-icon class=\"!text-base text-slate-500 dark:text-slate-400\">add</mat-icon>\r\n                  </button>\r\n                  <button mat-icon-button class=\"!w-7 !h-7\" (click)=\"resetZoom()\">\r\n                    <mat-icon class=\"!text-base text-slate-500 dark:text-slate-400\">fit_screen</mat-icon>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div class=\"overflow-auto max-h-80 bg-white dark:bg-slate-900\"\r\n                   (wheel)=\"onWheel($event)\"\r\n                   style=\"cursor: grab;\">\r\n                <img [src]=\"previewUrl()\"\r\n                     alt=\"Comprobante\"\r\n                     class=\"transition-transform duration-150\"\r\n                     [style.transform]=\"'scale(' + zoomLevel() + ')'\"\r\n                     [style.transform-origin]=\"'top left'\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      }\r\n\r\n      <!-- Error compacto -->\r\n      @if (errorMessage()) {\r\n        <div class=\"p-3 bg-red-50 dark:bg-red-950/30 rounded-xl border border-red-200 dark:border-red-800 flex items-center gap-3\">\r\n          <mat-icon class=\"text-red-500\">error</mat-icon>\r\n          <p class=\"text-sm text-red-700 dark:text-red-300\">{{ errorMessage() }}</p>\r\n        </div>\r\n      }\r\n    </mat-dialog-content>\r\n\r\n    <mat-dialog-actions align=\"end\" class=\"!px-5 !py-3 border-t border-slate-200 dark:border-slate-700 gap-2 bg-slate-50 dark:bg-slate-800/50 -mx-6 -mb-6 rounded-b-2xl\">\r\n      <button mat-button class=\"!text-slate-600 dark:!text-slate-300 !rounded-lg !px-4 hover:!bg-slate-200 dark:hover:!bg-slate-700\" (click)=\"cancel()\">\r\n        Cancelar\r\n      </button>\r\n\r\n      @if (!uploadResponse()) {\r\n        <button mat-raised-button color=\"primary\" [disabled]=\"!selectedFile() || isUploading()\" (click)=\"upload()\"\r\n          class=\"!px-5 !rounded-lg !bg-indigo-600 hover:!bg-indigo-700 !shadow-md\">\r\n          @if (isUploading()) {\r\n            <mat-spinner diameter=\"16\" class=\"mr-2\"></mat-spinner>\r\n          } @else {\r\n            <mat-icon class=\"mr-1 !text-lg\">upload</mat-icon>\r\n          }\r\n          Subir y Validar\r\n        </button>\r\n      } @else {\r\n        <button mat-raised-button [color]=\"showWarning() ? 'warn' : 'primary'\" (click)=\"confirm()\"\r\n          class=\"!px-5 !rounded-lg !shadow-md\" [class]=\"showWarning() ? '!bg-amber-500 hover:!bg-amber-600' : '!bg-green-600 hover:!bg-green-700'\">\r\n          <mat-icon class=\"mr-1 !text-lg\">{{ showWarning() ? 'check' : 'done_all' }}</mat-icon>\r\n          {{ showWarning() ? 'Continuar' : 'Confirmar' }}\r\n        </button>\r\n      }\r\n    </mat-dialog-actions>\r\n  `,\r\n  styles: [`\r\n    :host {\r\n      display: block;\r\n    }\r\n  `]\r\n})\r\nexport class ComprobanteUploadDialogComponent {\r\n  // Signals\r\n  selectedFile = signal<File | null>(null);\r\n  previewUrl = signal<string>('');\r\n  isUploading = signal(false);\r\n  uploadResponse = signal<ComprobanteUploadResponse | null>(null);\r\n  errorMessage = signal<string>('');\r\n  zoomLevel = signal<number>(1);\r\n\r\n  // Computed\r\n  showWarning = computed(() => {\r\n    const response = this.uploadResponse();\r\n    if (!response) return false;\r\n    return (\r\n      (response.validacionMonto && !response.validacionMonto.coincide) ||\r\n      (response.validacionDocumento && !response.validacionDocumento.coincide) ||\r\n      (response.validacionNombre && !response.validacionNombre.coincide)\r\n    );\r\n  });\r\n\r\n  constructor(\r\n    public dialogRef: MatDialogRef<ComprobanteUploadDialogComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: ComprobanteUploadDialogData,\r\n    private comprobanteService: ComprobanteService\r\n  ) {}\r\n\r\n  onDragOver(event: DragEvent): void {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n  }\r\n\r\n  onDrop(event: DragEvent): void {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    const files = event.dataTransfer?.files;\r\n    if (files && files.length > 0) {\r\n      this.handleFile(files[0]);\r\n    }\r\n  }\r\n\r\n  onFileSelected(event: Event): void {\r\n    const input = event.target as HTMLInputElement;\r\n    if (input.files && input.files.length > 0) {\r\n      this.handleFile(input.files[0]);\r\n    }\r\n  }\r\n\r\n  private handleFile(file: File): void {\r\n    // Validar tipo\r\n    if (!['image/jpeg', 'image/png', 'image/webp'].includes(file.type)) {\r\n      this.errorMessage.set('Tipo de archivo no permitido. Solo JPG, PNG o WebP.');\r\n      return;\r\n    }\r\n\r\n    // Validar tama√±o (5MB)\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      this.errorMessage.set('El archivo es muy grande. M√°ximo 5MB.');\r\n      return;\r\n    }\r\n\r\n    this.errorMessage.set('');\r\n    this.selectedFile.set(file);\r\n\r\n    // Crear preview\r\n    const reader = new FileReader();\r\n    reader.onload = () => {\r\n      this.previewUrl.set(reader.result as string);\r\n    };\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  removeFile(): void {\r\n    this.selectedFile.set(null);\r\n    this.previewUrl.set('');\r\n    this.uploadResponse.set(null);\r\n    this.errorMessage.set('');\r\n  }\r\n\r\n  upload(): void {\r\n    const file = this.selectedFile();\r\n    if (!file) return;\r\n\r\n    this.isUploading.set(true);\r\n    this.errorMessage.set('');\r\n\r\n    this.comprobanteService.uploadComprobante(file, {\r\n      idCuota: this.data.idCuota,\r\n      montoEsperado: this.data.montoEsperado,\r\n      documentoEsperado: this.data.documentoEsperado,\r\n      nombreEsperado: this.data.nombreCliente,\r\n      idAgente: this.data.idAgente\r\n    }).subscribe({\r\n      next: (response) => {\r\n        this.isUploading.set(false);\r\n        this.uploadResponse.set(response);\r\n        if (!response.success) {\r\n          this.errorMessage.set(response.error || 'Error al procesar el comprobante');\r\n        }\r\n      },\r\n      error: (err) => {\r\n        this.isUploading.set(false);\r\n        this.errorMessage.set(err.error?.error || 'Error de conexi√≥n');\r\n      }\r\n    });\r\n  }\r\n\r\n  confirm(): void {\r\n    const response = this.uploadResponse();\r\n    const result: ComprobanteUploadDialogResult = {\r\n      uploaded: true,\r\n      response: response || undefined,\r\n      validacionesOk: !this.showWarning()\r\n    };\r\n    this.dialogRef.close(result);\r\n  }\r\n\r\n  cancel(): void {\r\n    this.dialogRef.close({ uploaded: false, validacionesOk: false });\r\n  }\r\n\r\n  formatFileSize(bytes: number): string {\r\n    if (bytes < 1024) return bytes + ' B';\r\n    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';\r\n    return (bytes / (1024 * 1024)).toFixed(1) + ' MB';\r\n  }\r\n\r\n  getResultBgClass(): string {\r\n    const response = this.uploadResponse();\r\n    if (!response?.success) return 'bg-red-50 dark:bg-red-950/30 text-red-700 dark:text-red-300';\r\n    if (this.showWarning()) return 'bg-amber-50 dark:bg-amber-950/30 text-amber-700 dark:text-amber-300';\r\n    return 'bg-green-50 dark:bg-green-950/30 text-green-700 dark:text-green-300';\r\n  }\r\n\r\n  getResultIconBgClass(): string {\r\n    const response = this.uploadResponse();\r\n    if (!response?.success) return 'bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400';\r\n    if (this.showWarning()) return 'bg-amber-100 dark:bg-amber-900/50 text-amber-600 dark:text-amber-400';\r\n    return 'bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400';\r\n  }\r\n\r\n  getResultIcon(): string {\r\n    const response = this.uploadResponse();\r\n    if (!response?.success) return 'error';\r\n    if (this.showWarning()) return 'warning';\r\n    return 'check_circle';\r\n  }\r\n\r\n  getResultTitle(): string {\r\n    const response = this.uploadResponse();\r\n    if (!response?.success) return 'Error al procesar';\r\n    if (this.showWarning()) return 'Comprobante con advertencias';\r\n    return 'Comprobante validado';\r\n  }\r\n\r\n  getValidationClass(validation?: ValidationResult): string {\r\n    if (!validation) return 'border-slate-200 dark:border-slate-700';\r\n    return validation.coincide\r\n      ? 'border-green-300 bg-green-50 dark:bg-green-950/20'\r\n      : 'border-amber-300 bg-amber-50 dark:bg-amber-950/20';\r\n  }\r\n\r\n  getValidationCardClass(validation?: ValidationResult): string {\r\n    if (!validation) return 'border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50';\r\n    return validation.coincide\r\n      ? 'border-green-400 dark:border-green-600 bg-green-50 dark:bg-green-950/30'\r\n      : 'border-amber-400 dark:border-amber-600 bg-amber-50 dark:bg-amber-950/30';\r\n  }\r\n\r\n  // Zoom methods\r\n  zoomIn(): void {\r\n    if (this.zoomLevel() < 3) {\r\n      this.zoomLevel.update(z => Math.min(3, z + 0.25));\r\n    }\r\n  }\r\n\r\n  zoomOut(): void {\r\n    if (this.zoomLevel() > 0.5) {\r\n      this.zoomLevel.update(z => Math.max(0.5, z - 0.25));\r\n    }\r\n  }\r\n\r\n  resetZoom(): void {\r\n    this.zoomLevel.set(1);\r\n  }\r\n\r\n  onWheel(event: WheelEvent): void {\r\n    event.preventDefault();\r\n    if (event.deltaY < 0) {\r\n      this.zoomIn();\r\n    } else {\r\n      this.zoomOut();\r\n    }\r\n  }\r\n}\r\n", "import { Component, Inject, signal, computed, OnInit, OnDestroy } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MAT_DIALOG_DATA, MatDialogRef, MatDialogModule } from '@angular/material/dialog';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { ComprobanteService } from '../../services/comprobante.service';\r\nimport { ComprobanteUploadResponse, ValidationResult } from '../../models/comprobante.model';\r\n\r\nexport interface VoucherPaymentDialogData {\r\n  nombreCliente: string;\r\n  documentoCliente: string;\r\n  idCliente: number;\r\n  idAgente: number;\r\n  cuotas: CuotaPromesa[];\r\n  grupoPromesaUuid: string;\r\n}\r\n\r\nexport interface CuotaPromesa {\r\n  id: number;\r\n  numeroCuota: number;\r\n  monto: number;\r\n  dueDate: string;\r\n  status: string;\r\n  montoPagadoReal?: number;\r\n}\r\n\r\nexport interface VoucherPaymentDialogResult {\r\n  confirmed: boolean;\r\n  autoSelect?: {\r\n    categoriaId: string;\r\n    detalleId: string;\r\n    cuotaSeleccionada: CuotaPromesa;\r\n    observaciones: string;\r\n  };\r\n  ocrResponse?: ComprobanteUploadResponse;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-voucher-payment-dialog',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    MatDialogModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatProgressSpinnerModule\r\n  ],\r\n  template: `\r\n    <div class=\"voucher-dialog\" [class.dark-mode]=\"isDarkMode()\">\r\n      <!-- Header elegante -->\r\n      <div class=\"dialog-header\">\r\n        <div class=\"header-content\">\r\n          <div class=\"header-icon\">\r\n            <mat-icon>receipt_long</mat-icon>\r\n          </div>\r\n          <div class=\"header-text\">\r\n            <h2>Registrar Pago</h2>\r\n            <span class=\"header-subtitle\">\r\n              <mat-icon class=\"inline-icon\">smart_toy</mat-icon>\r\n              Validaci√≥n autom√°tica con IA\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <button mat-icon-button class=\"close-btn\" (click)=\"cancel()\">\r\n          <mat-icon>close</mat-icon>\r\n        </button>\r\n      </div>\r\n\r\n      <mat-dialog-content class=\"dialog-body\">\r\n        <div class=\"two-column-layout\">\r\n          <!-- Columna izquierda: Informaci√≥n y validaciones -->\r\n          <div class=\"left-column\">\r\n            <!-- Card de informaci√≥n del cliente -->\r\n            <div class=\"info-card client-card\">\r\n              <div class=\"card-header\">\r\n                <mat-icon>person</mat-icon>\r\n                <span>Informaci√≥n del Cliente</span>\r\n              </div>\r\n              <div class=\"card-body\">\r\n                <div class=\"info-row\">\r\n                  <div class=\"info-item\">\r\n                    <span class=\"info-label\">Cliente</span>\r\n                    <span class=\"info-value\">{{ data.nombreCliente }}</span>\r\n                  </div>\r\n                  <div class=\"info-item\">\r\n                    <span class=\"info-label\">Documento</span>\r\n                    <span class=\"info-value highlight\">{{ data.documentoCliente }}</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Card de cuotas pendientes -->\r\n            <div class=\"info-card installments-card\">\r\n              <div class=\"card-header\">\r\n                <mat-icon>payments</mat-icon>\r\n                <span>Cuotas Pendientes</span>\r\n              </div>\r\n              <div class=\"card-body\">\r\n                <div class=\"installments-grid\">\r\n                  @for (cuota of cuotasPendientes(); track cuota.numeroCuota) {\r\n                    <div class=\"installment-chip\" [class.active]=\"cuota.numeroCuota === cuotaMasProxima()?.numeroCuota\">\r\n                      <span class=\"chip-number\">C{{ cuota.numeroCuota }}</span>\r\n                      @if (cuota.montoPagadoReal && cuota.montoPagadoReal > 0) {\r\n                        <span class=\"chip-amount-original\">S/{{ cuota.monto | number:'1.2-2' }}</span>\r\n                        <span class=\"chip-amount\">S/{{ getSaldoPendiente(cuota) | number:'1.2-2' }}</span>\r\n                      } @else {\r\n                        <span class=\"chip-amount\">S/{{ cuota.monto | number:'1.2-2' }}</span>\r\n                      }\r\n                    </div>\r\n                  }\r\n                </div>\r\n                <div class=\"next-installment\">\r\n                  <mat-icon>arrow_forward</mat-icon>\r\n                  <span>Pr√≥xima cuota:</span>\r\n                  @if (cuotaMasProxima()?.montoPagadoReal && cuotaMasProxima()!.montoPagadoReal! > 0) {\r\n                    <strong>C{{ cuotaMasProxima()?.numeroCuota }} - S/{{ getSaldoPendiente(cuotaMasProxima()!) | number:'1.2-2' }}</strong>\r\n                    <span class=\"partial-badge\">Parcial</span>\r\n                  } @else {\r\n                    <strong>C{{ cuotaMasProxima()?.numeroCuota }} - S/{{ cuotaMasProxima()?.monto | number:'1.2-2' }}</strong>\r\n                  }\r\n                  <span class=\"date-badge\">{{ formatDate(cuotaMasProxima()?.dueDate) }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Resultados de validaci√≥n OCR -->\r\n            @if (uploadResponse()) {\r\n              <!-- Estado general -->\r\n              <div class=\"result-banner\" [class]=\"getResultClass()\">\r\n                <div class=\"result-icon\">\r\n                  <mat-icon>{{ getResultIcon() }}</mat-icon>\r\n                </div>\r\n                <div class=\"result-text\">\r\n                  <span class=\"result-title\">{{ getResultTitle() }}</span>\r\n                  <span class=\"result-subtitle\">{{ getResultSubtitle() }}</span>\r\n                </div>\r\n              </div>\r\n\r\n              @if (uploadResponse()?.ocrResult?.success) {\r\n                <!-- Grid de validaciones -->\r\n                <div class=\"validations-grid\">\r\n                  <!-- Monto -->\r\n                  <div class=\"validation-card\" [class]=\"getValidationClass(uploadResponse()?.validacionMonto)\">\r\n                    <div class=\"validation-icon\">\r\n                      <mat-icon>{{ uploadResponse()?.validacionMonto?.coincide ? 'check_circle' : 'warning' }}</mat-icon>\r\n                    </div>\r\n                    <div class=\"validation-content\">\r\n                      <span class=\"validation-label\">Monto</span>\r\n                      <span class=\"validation-value\">S/{{ uploadResponse()?.ocrResult?.monto | number:'1.2-2' }}</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <!-- Documento -->\r\n                  <div class=\"validation-card\" [class]=\"getValidationClass(uploadResponse()?.validacionDocumento)\">\r\n                    <div class=\"validation-icon\">\r\n                      <mat-icon>{{ uploadResponse()?.validacionDocumento?.coincide ? 'check_circle' : 'warning' }}</mat-icon>\r\n                    </div>\r\n                    <div class=\"validation-content\">\r\n                      <span class=\"validation-label\">Documento</span>\r\n                      <span class=\"validation-value\">{{ uploadResponse()?.ocrResult?.documento || '-' }}</span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <!-- Nombre -->\r\n                  <div class=\"validation-card\" [class]=\"getValidationClass(uploadResponse()?.validacionNombre)\">\r\n                    <div class=\"validation-icon\">\r\n                      <mat-icon>{{ uploadResponse()?.validacionNombre?.coincide ? 'check_circle' : 'warning' }}</mat-icon>\r\n                    </div>\r\n                    <div class=\"validation-content\">\r\n                      <span class=\"validation-label\">Nombre</span>\r\n                      <span class=\"validation-value truncate\">{{ uploadResponse()?.ocrResult?.nombre || '-' }}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <!-- Detalles del banco -->\r\n                @if (uploadResponse()?.ocrResult?.banco || uploadResponse()?.ocrResult?.numeroOperacion) {\r\n                  <div class=\"bank-details\">\r\n                    @if (uploadResponse()?.ocrResult?.banco) {\r\n                      <div class=\"detail-item\">\r\n                        <mat-icon>account_balance</mat-icon>\r\n                        <span>{{ uploadResponse()?.ocrResult?.banco }}</span>\r\n                      </div>\r\n                    }\r\n                    @if (uploadResponse()?.ocrResult?.numeroOperacion) {\r\n                      <div class=\"detail-item\">\r\n                        <mat-icon>tag</mat-icon>\r\n                        <span>Op. {{ uploadResponse()?.ocrResult?.numeroOperacion }}</span>\r\n                      </div>\r\n                    }\r\n                    @if (uploadResponse()?.ocrResult?.fecha) {\r\n                      <div class=\"detail-item\">\r\n                        <mat-icon>event</mat-icon>\r\n                        <span>{{ uploadResponse()?.ocrResult?.fecha }}</span>\r\n                      </div>\r\n                    }\r\n                  </div>\r\n                }\r\n\r\n                <!-- Cuota a registrar -->\r\n                <div class=\"selected-installment\" [class]=\"cuotaCoincidente() ? 'success' : 'warning'\">\r\n                  <mat-icon>{{ cuotaCoincidente() ? 'check_circle' : 'info' }}</mat-icon>\r\n                  <span>Se registrar√°:</span>\r\n                  <strong>Cuota {{ (cuotaCoincidente() || cuotaMasProxima())?.numeroCuota }}</strong>\r\n                  <span class=\"amount\">(S/{{ (cuotaCoincidente() || cuotaMasProxima())?.monto | number:'1.2-2' }})</span>\r\n                </div>\r\n\r\n                <!-- Auto-selecci√≥n info -->\r\n                <div class=\"auto-select-info\">\r\n                  <mat-icon>auto_awesome</mat-icon>\r\n                  <span>Al confirmar se seleccionar√° autom√°ticamente: <strong>Contacto Directo ‚Üí Cancelaci√≥n</strong></span>\r\n                </div>\r\n              }\r\n            }\r\n\r\n            <!-- Error message -->\r\n            @if (errorMessage()) {\r\n              <div class=\"error-message\">\r\n                <mat-icon>error_outline</mat-icon>\r\n                <span>{{ errorMessage() }}</span>\r\n              </div>\r\n            }\r\n          </div>\r\n\r\n          <!-- Columna derecha: Visor de imagen -->\r\n          <div class=\"right-column\">\r\n            <div class=\"image-viewer\">\r\n              <div class=\"viewer-header\">\r\n                <span class=\"viewer-title\">\r\n                  <mat-icon>image</mat-icon>\r\n                  Voucher de Pago\r\n                </span>\r\n                @if (previewUrl()) {\r\n                  <div class=\"zoom-controls\">\r\n                    <button mat-icon-button (click)=\"zoomOut()\" [disabled]=\"zoomLevel() <= 0.5\" class=\"zoom-btn\">\r\n                      <mat-icon>remove</mat-icon>\r\n                    </button>\r\n                    <span class=\"zoom-level\">{{ (zoomLevel() * 100) | number:'1.0-0' }}%</span>\r\n                    <button mat-icon-button (click)=\"zoomIn()\" [disabled]=\"zoomLevel() >= 3\" class=\"zoom-btn\">\r\n                      <mat-icon>add</mat-icon>\r\n                    </button>\r\n                    <div class=\"zoom-divider\"></div>\r\n                    <button mat-icon-button (click)=\"removeFile()\" class=\"delete-btn\">\r\n                      <mat-icon>delete_outline</mat-icon>\r\n                    </button>\r\n                  </div>\r\n                }\r\n              </div>\r\n\r\n              <div class=\"viewer-body\">\r\n                @if (!previewUrl()) {\r\n                  <!-- √Årea de drag & drop -->\r\n                  <div class=\"upload-area\" (click)=\"fileInput.click()\" (dragover)=\"onDragOver($event)\" (drop)=\"onDrop($event)\">\r\n                    <div class=\"upload-content\">\r\n                      <div class=\"upload-icon\">\r\n                        <mat-icon>cloud_upload</mat-icon>\r\n                      </div>\r\n                      <p class=\"upload-title\">Arrastra tu voucher aqu√≠</p>\r\n                      <p class=\"upload-subtitle\">o haz clic para seleccionar</p>\r\n                      <div class=\"upload-formats\">\r\n                        <span class=\"format-badge\">JPG</span>\r\n                        <span class=\"format-badge\">PNG</span>\r\n                        <span class=\"format-badge\">WebP</span>\r\n                        <span class=\"size-info\">Max 5MB</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <input #fileInput type=\"file\" accept=\"image/jpeg,image/png,image/webp\" class=\"hidden\" (change)=\"onFileSelected($event)\" />\r\n                } @else {\r\n                  <!-- Preview con zoom -->\r\n                  <div class=\"image-container\" (wheel)=\"onWheel($event)\">\r\n                    <img [src]=\"previewUrl()\" alt=\"Voucher\" [style.transform]=\"'scale(' + zoomLevel() + ')'\" />\r\n                  </div>\r\n\r\n                  <!-- Spinner overlay -->\r\n                  @if (isUploading()) {\r\n                    <div class=\"loading-overlay\">\r\n                      <div class=\"loading-content\">\r\n                        <mat-spinner diameter=\"48\"></mat-spinner>\r\n                        <p>Analizando voucher...</p>\r\n                        <span>Procesando con IA</span>\r\n                      </div>\r\n                    </div>\r\n                  }\r\n                }\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </mat-dialog-content>\r\n\r\n      <mat-dialog-actions class=\"dialog-actions\">\r\n        <button mat-button class=\"btn-cancel\" (click)=\"cancel()\">\r\n          <mat-icon>close</mat-icon>\r\n          Cancelar\r\n        </button>\r\n\r\n        <div class=\"action-buttons\">\r\n          @if (!uploadResponse()) {\r\n            <button mat-flat-button class=\"btn-analyze\" [disabled]=\"!selectedFile() || isUploading()\" (click)=\"upload()\">\r\n              <mat-icon>psychology</mat-icon>\r\n              Analizar con IA\r\n            </button>\r\n          } @else {\r\n            <button mat-flat-button class=\"btn-confirm\" [class]=\"showWarning() ? 'warning' : 'success'\" (click)=\"confirm()\">\r\n              <mat-icon>done_all</mat-icon>\r\n              Confirmar Pago\r\n            </button>\r\n          }\r\n        </div>\r\n      </mat-dialog-actions>\r\n    </div>\r\n  `,\r\n  styles: [`\r\n    :host { display: block; }\r\n\r\n    .voucher-dialog {\r\n      display: flex;\r\n      flex-direction: column;\r\n      max-height: 85vh;\r\n      min-width: 900px;\r\n      background: #ffffff;\r\n      overflow: hidden;\r\n    }\r\n    .voucher-dialog.dark-mode { background: #0f172a; }\r\n\r\n    /* Header */\r\n    .dialog-header {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      padding: 18px 24px;\r\n      background: linear-gradient(135deg, #059669 0%, #10b981 100%);\r\n      color: white;\r\n    }\r\n\r\n    .header-content { display: flex; align-items: center; gap: 16px; }\r\n\r\n    .header-icon {\r\n      width: 48px; height: 48px;\r\n      background: rgba(255, 255, 255, 0.2);\r\n      border-radius: 12px;\r\n      display: flex; align-items: center; justify-content: center;\r\n    }\r\n    .header-icon mat-icon { font-size: 26px; width: 26px; height: 26px; }\r\n\r\n    .header-text h2 { margin: 0; font-size: 20px; font-weight: 600; }\r\n    .header-subtitle { font-size: 13px; opacity: 0.9; display: flex; align-items: center; gap: 6px; }\r\n    .inline-icon { font-size: 14px !important; width: 14px !important; height: 14px !important; }\r\n\r\n    .close-btn { color: white !important; opacity: 0.8; transition: opacity 0.2s; }\r\n    .close-btn:hover { opacity: 1; }\r\n\r\n    /* Body */\r\n    .dialog-body {\r\n      flex: 1;\r\n      padding: 24px !important;\r\n      overflow-y: auto !important;\r\n      overflow-x: hidden !important;\r\n      background: #f8fafc;\r\n      max-height: calc(85vh - 160px);\r\n    }\r\n    .dark-mode .dialog-body { background: #0f172a; }\r\n\r\n    .two-column-layout { display: grid; grid-template-columns: 1fr 380px; gap: 24px; }\r\n\r\n    /* Left column */\r\n    .left-column { display: flex; flex-direction: column; gap: 16px; min-width: 0; }\r\n\r\n    /* Info cards */\r\n    .info-card {\r\n      background: white;\r\n      border-radius: 14px;\r\n      border: 1px solid #e2e8f0;\r\n      overflow: hidden;\r\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\r\n    }\r\n    .dark-mode .info-card { background: #1e293b; border-color: #334155; }\r\n\r\n    .card-header {\r\n      display: flex; align-items: center; gap: 10px;\r\n      padding: 12px 16px;\r\n      background: #f1f5f9;\r\n      border-bottom: 1px solid #e2e8f0;\r\n      font-size: 13px; font-weight: 600; color: #475569;\r\n    }\r\n    .dark-mode .card-header { background: #334155; border-color: #475569; color: #cbd5e1; }\r\n    .card-header mat-icon { font-size: 18px; width: 18px; height: 18px; color: #64748b; }\r\n    .dark-mode .card-header mat-icon { color: #94a3b8; }\r\n\r\n    .card-body { padding: 16px; }\r\n\r\n    .info-row { display: grid; grid-template-columns: 1.5fr 1fr; gap: 20px; }\r\n    .info-item { display: flex; flex-direction: column; gap: 6px; }\r\n    .info-label { font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 500; }\r\n    .dark-mode .info-label { color: #94a3b8; }\r\n    .info-value { font-size: 14px; font-weight: 600; color: #1e293b; word-break: break-word; }\r\n    .dark-mode .info-value { color: #f1f5f9; }\r\n    .info-value.highlight { color: #059669; font-family: 'SF Mono', Monaco, monospace; font-size: 15px; }\r\n\r\n    /* Installments */\r\n    .installments-grid { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 14px; }\r\n\r\n    .installment-chip {\r\n      display: flex; align-items: center; gap: 8px;\r\n      padding: 8px 14px;\r\n      background: #f1f5f9;\r\n      border-radius: 10px;\r\n      border: 1.5px solid #e2e8f0;\r\n      transition: all 0.2s;\r\n    }\r\n    .dark-mode .installment-chip { background: #334155; border-color: #475569; }\r\n    .installment-chip.active { background: #dcfce7; border-color: #22c55e; }\r\n    .dark-mode .installment-chip.active { background: rgba(34, 197, 94, 0.2); border-color: #22c55e; }\r\n\r\n    .chip-number { font-size: 12px; font-weight: 700; color: #64748b; }\r\n    .installment-chip.active .chip-number { color: #16a34a; }\r\n    .dark-mode .installment-chip.active .chip-number { color: #4ade80; }\r\n\r\n    .chip-amount { font-size: 13px; font-weight: 600; color: #1e293b; }\r\n    .dark-mode .chip-amount { color: #e2e8f0; }\r\n    .installment-chip.active .chip-amount { color: #15803d; }\r\n    .dark-mode .installment-chip.active .chip-amount { color: #86efac; }\r\n\r\n    .chip-amount-original { font-size: 12px; color: #64748b; margin-right: 4px; opacity: 0.8; }\r\n    .dark-mode .chip-amount-original { color: #94a3b8; }\r\n    .installment-chip.active .chip-amount-original { color: #22c55e; opacity: 0.7; }\r\n\r\n    .partial-badge {\r\n      font-size: 10px; font-weight: 600;\r\n      padding: 2px 6px;\r\n      background: #f59e0b;\r\n      color: white;\r\n      border-radius: 4px;\r\n      margin-left: 4px;\r\n    }\r\n\r\n    .next-installment {\r\n      display: flex; align-items: center; gap: 10px; flex-wrap: wrap;\r\n      padding: 12px 14px;\r\n      background: #f0fdf4;\r\n      border-radius: 10px;\r\n      font-size: 13px; color: #166534;\r\n    }\r\n    .dark-mode .next-installment { background: rgba(34, 197, 94, 0.15); color: #86efac; }\r\n    .next-installment mat-icon { font-size: 18px; width: 18px; height: 18px; color: #22c55e; }\r\n    .next-installment strong { font-weight: 700; }\r\n\r\n    .date-badge {\r\n      margin-left: auto;\r\n      padding: 5px 10px;\r\n      background: white;\r\n      border-radius: 8px;\r\n      font-size: 12px; font-weight: 600;\r\n      color: #059669;\r\n      border: 1px solid #bbf7d0;\r\n    }\r\n    .dark-mode .date-badge { background: #1e293b; border-color: #22c55e; color: #4ade80; }\r\n\r\n    /* Result banner */\r\n    .result-banner {\r\n      display: flex; align-items: center; gap: 14px;\r\n      padding: 14px 16px;\r\n      border-radius: 12px;\r\n      border: 1.5px solid;\r\n    }\r\n    .result-banner.success { background: #dcfce7; border-color: #86efac; }\r\n    .dark-mode .result-banner.success { background: rgba(34, 197, 94, 0.15); border-color: #22c55e; }\r\n    .result-banner.warning { background: #fef3c7; border-color: #fcd34d; }\r\n    .dark-mode .result-banner.warning { background: rgba(245, 158, 11, 0.15); border-color: #f59e0b; }\r\n    .result-banner.error { background: #fee2e2; border-color: #fca5a5; }\r\n    .dark-mode .result-banner.error { background: rgba(239, 68, 68, 0.15); border-color: #ef4444; }\r\n\r\n    .result-icon {\r\n      width: 40px; height: 40px;\r\n      border-radius: 50%;\r\n      display: flex; align-items: center; justify-content: center;\r\n      flex-shrink: 0;\r\n    }\r\n    .result-banner.success .result-icon { background: #22c55e; color: white; }\r\n    .result-banner.warning .result-icon { background: #f59e0b; color: white; }\r\n    .result-banner.error .result-icon { background: #ef4444; color: white; }\r\n\r\n    .result-text { display: flex; flex-direction: column; gap: 3px; }\r\n    .result-title { font-size: 14px; font-weight: 700; color: #1e293b; }\r\n    .dark-mode .result-title { color: #f1f5f9; }\r\n    .result-subtitle { font-size: 12px; color: #64748b; }\r\n    .dark-mode .result-subtitle { color: #94a3b8; }\r\n\r\n    /* Validations grid */\r\n    .validations-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }\r\n\r\n    .validation-card {\r\n      display: flex; align-items: center; gap: 12px;\r\n      padding: 12px 14px;\r\n      border-radius: 12px;\r\n      border: 1.5px solid;\r\n      background: white;\r\n    }\r\n    .dark-mode .validation-card { background: #1e293b; }\r\n    .validation-card.success { border-color: #86efac; background: #f0fdf4; }\r\n    .dark-mode .validation-card.success { border-color: #22c55e; background: rgba(34, 197, 94, 0.1); }\r\n    .validation-card.warning { border-color: #fcd34d; background: #fffbeb; }\r\n    .dark-mode .validation-card.warning { border-color: #f59e0b; background: rgba(245, 158, 11, 0.1); }\r\n    .validation-card.neutral { border-color: #e2e8f0; }\r\n    .dark-mode .validation-card.neutral { border-color: #475569; }\r\n\r\n    .validation-icon mat-icon { font-size: 22px; width: 22px; height: 22px; }\r\n    .validation-card.success .validation-icon mat-icon { color: #22c55e; }\r\n    .validation-card.warning .validation-icon mat-icon { color: #f59e0b; }\r\n\r\n    .validation-content { display: flex; flex-direction: column; gap: 3px; min-width: 0; flex: 1; }\r\n    .validation-label { font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; color: #94a3b8; font-weight: 500; }\r\n    .validation-value { font-size: 13px; font-weight: 600; color: #1e293b; overflow: hidden; text-overflow: ellipsis; }\r\n    .dark-mode .validation-value { color: #f1f5f9; }\r\n    .truncate { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }\r\n\r\n    /* Bank details */\r\n    .bank-details {\r\n      display: flex; flex-wrap: wrap; gap: 16px;\r\n      padding: 12px 16px;\r\n      background: #f8fafc;\r\n      border-radius: 10px;\r\n      border: 1px solid #e2e8f0;\r\n    }\r\n    .dark-mode .bank-details { background: #1e293b; border-color: #334155; }\r\n    .detail-item { display: flex; align-items: center; gap: 8px; font-size: 13px; color: #475569; }\r\n    .dark-mode .detail-item { color: #94a3b8; }\r\n    .detail-item mat-icon { font-size: 16px; width: 16px; height: 16px; color: #94a3b8; }\r\n\r\n    /* Selected installment */\r\n    .selected-installment {\r\n      display: flex; align-items: center; gap: 10px;\r\n      padding: 14px 16px;\r\n      border-radius: 12px;\r\n      font-size: 14px;\r\n      border: 2px solid;\r\n    }\r\n    .selected-installment.success { background: #dcfce7; border-color: #22c55e; color: #166534; }\r\n    .dark-mode .selected-installment.success { background: rgba(34, 197, 94, 0.15); color: #86efac; }\r\n    .selected-installment.warning { background: #fef3c7; border-color: #f59e0b; color: #92400e; }\r\n    .dark-mode .selected-installment.warning { background: rgba(245, 158, 11, 0.15); color: #fcd34d; }\r\n    .selected-installment mat-icon { font-size: 20px; width: 20px; height: 20px; }\r\n    .selected-installment .amount { opacity: 0.8; }\r\n\r\n    /* Auto select info */\r\n    .auto-select-info {\r\n      display: flex; align-items: center; gap: 10px;\r\n      padding: 12px 16px;\r\n      background: #eff6ff;\r\n      border-radius: 10px;\r\n      border: 1px solid #bfdbfe;\r\n      font-size: 12px; color: #1d4ed8;\r\n    }\r\n    .dark-mode .auto-select-info { background: rgba(59, 130, 246, 0.1); border-color: #3b82f6; color: #93c5fd; }\r\n    .auto-select-info mat-icon { font-size: 18px; width: 18px; height: 18px; color: #3b82f6; }\r\n\r\n    /* Error message */\r\n    .error-message {\r\n      display: flex; align-items: center; gap: 12px;\r\n      padding: 14px 16px;\r\n      background: #fef2f2;\r\n      border-radius: 10px;\r\n      border: 1px solid #fecaca;\r\n      font-size: 13px; color: #dc2626;\r\n    }\r\n    .dark-mode .error-message { background: rgba(239, 68, 68, 0.1); border-color: #ef4444; color: #fca5a5; }\r\n\r\n    /* Right column - Image viewer */\r\n    .right-column { display: flex; }\r\n\r\n    .image-viewer {\r\n      flex: 1;\r\n      display: flex; flex-direction: column;\r\n      background: white;\r\n      border-radius: 14px;\r\n      border: 1px solid #e2e8f0;\r\n      overflow: hidden;\r\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\r\n    }\r\n    .dark-mode .image-viewer { background: #1e293b; border-color: #334155; }\r\n\r\n    .viewer-header {\r\n      display: flex; align-items: center; justify-content: space-between;\r\n      padding: 12px 16px;\r\n      background: #f8fafc;\r\n      border-bottom: 1px solid #e2e8f0;\r\n    }\r\n    .dark-mode .viewer-header { background: #0f172a; border-color: #334155; }\r\n\r\n    .viewer-title { display: flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 600; color: #475569; }\r\n    .dark-mode .viewer-title { color: #94a3b8; }\r\n    .viewer-title mat-icon { font-size: 18px; width: 18px; height: 18px; }\r\n\r\n    .zoom-controls { display: flex; align-items: center; gap: 6px; }\r\n    .zoom-btn {\r\n      width: 30px !important; height: 30px !important;\r\n      background: white !important;\r\n      border: 1px solid #e2e8f0 !important;\r\n      border-radius: 8px !important;\r\n    }\r\n    .dark-mode .zoom-btn { background: #334155 !important; border-color: #475569 !important; }\r\n    .zoom-btn mat-icon { font-size: 18px !important; width: 18px !important; height: 18px !important; color: #64748b; }\r\n    .dark-mode .zoom-btn mat-icon { color: #94a3b8; }\r\n\r\n    .zoom-level { font-size: 12px; font-weight: 600; color: #64748b; min-width: 40px; text-align: center; }\r\n    .dark-mode .zoom-level { color: #94a3b8; }\r\n\r\n    .zoom-divider { width: 1px; height: 24px; background: #e2e8f0; margin: 0 6px; }\r\n    .dark-mode .zoom-divider { background: #475569; }\r\n\r\n    .delete-btn {\r\n      width: 30px !important; height: 30px !important;\r\n      background: #fef2f2 !important;\r\n      border: 1px solid #fecaca !important;\r\n      border-radius: 8px !important;\r\n    }\r\n    .dark-mode .delete-btn { background: rgba(239, 68, 68, 0.15) !important; border-color: #ef4444 !important; }\r\n    .delete-btn mat-icon { font-size: 18px !important; width: 18px !important; height: 18px !important; color: #ef4444; }\r\n\r\n    .viewer-body { flex: 1; min-height: 380px; position: relative; background: #f1f5f9; }\r\n    .dark-mode .viewer-body { background: #0f172a; }\r\n\r\n    /* Upload area */\r\n    .upload-area {\r\n      position: absolute; inset: 16px;\r\n      border: 2px dashed #cbd5e1;\r\n      border-radius: 14px;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n      display: flex; align-items: center; justify-content: center;\r\n      background: white;\r\n    }\r\n    .dark-mode .upload-area { border-color: #475569; background: #1e293b; }\r\n    .upload-area:hover { border-color: #22c55e; background: #f0fdf4; }\r\n    .dark-mode .upload-area:hover { border-color: #22c55e; background: rgba(34, 197, 94, 0.1); }\r\n\r\n    .upload-content { text-align: center; padding: 24px; }\r\n\r\n    .upload-icon {\r\n      width: 72px; height: 72px;\r\n      margin: 0 auto 20px;\r\n      background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);\r\n      border-radius: 18px;\r\n      display: flex; align-items: center; justify-content: center;\r\n    }\r\n    .dark-mode .upload-icon { background: linear-gradient(135deg, rgba(34, 197, 94, 0.2) 0%, rgba(34, 197, 94, 0.3) 100%); }\r\n    .upload-icon mat-icon { font-size: 36px; width: 36px; height: 36px; color: #22c55e; }\r\n\r\n    .upload-title { font-size: 16px; font-weight: 600; color: #1e293b; margin: 0 0 6px; }\r\n    .dark-mode .upload-title { color: #f1f5f9; }\r\n    .upload-subtitle { font-size: 13px; color: #64748b; margin: 0 0 20px; }\r\n    .dark-mode .upload-subtitle { color: #94a3b8; }\r\n\r\n    .upload-formats { display: flex; align-items: center; justify-content: center; gap: 8px; }\r\n    .format-badge { padding: 5px 10px; background: #f1f5f9; border-radius: 6px; font-size: 11px; font-weight: 600; color: #64748b; }\r\n    .dark-mode .format-badge { background: #334155; color: #94a3b8; }\r\n    .size-info { font-size: 11px; color: #94a3b8; }\r\n\r\n    /* Image container */\r\n    .image-container { position: absolute; inset: 0; overflow: auto; cursor: grab; display: flex; }\r\n    .image-container:active { cursor: grabbing; }\r\n    .image-container img { max-width: none; transition: transform 0.15s ease; transform-origin: top left; }\r\n\r\n    /* Loading overlay */\r\n    .loading-overlay {\r\n      position: absolute; inset: 0;\r\n      background: rgba(0, 0, 0, 0.75);\r\n      display: flex; align-items: center; justify-content: center;\r\n      backdrop-filter: blur(6px);\r\n    }\r\n    .loading-content { text-align: center; color: white; }\r\n    .loading-content mat-spinner { margin: 0 auto 16px; }\r\n    .loading-content p { font-size: 16px; font-weight: 600; margin: 0 0 6px; }\r\n    .loading-content span { font-size: 13px; opacity: 0.8; }\r\n\r\n    /* Dialog actions */\r\n    .dialog-actions {\r\n      display: flex !important;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      padding: 18px 24px !important;\r\n      background: #f8fafc;\r\n      border-top: 1px solid #e2e8f0;\r\n    }\r\n    .dark-mode .dialog-actions { background: #1e293b; border-color: #334155; }\r\n\r\n    .btn-cancel {\r\n      display: flex; align-items: center; gap: 8px;\r\n      padding: 10px 20px !important;\r\n      border-radius: 10px !important;\r\n      font-size: 14px !important; font-weight: 500 !important;\r\n      color: #64748b !important;\r\n      border: 1px solid #e2e8f0 !important;\r\n      background: white !important;\r\n      transition: all 0.2s;\r\n    }\r\n    .dark-mode .btn-cancel { color: #94a3b8 !important; border-color: #475569 !important; background: #0f172a !important; }\r\n    .btn-cancel:hover { background: #f1f5f9 !important; border-color: #cbd5e1 !important; }\r\n    .dark-mode .btn-cancel:hover { background: #334155 !important; }\r\n    .btn-cancel mat-icon { font-size: 18px; width: 18px; height: 18px; }\r\n\r\n    .action-buttons { display: flex; gap: 12px; }\r\n\r\n    .btn-analyze, .btn-confirm {\r\n      display: flex !important; align-items: center; gap: 10px;\r\n      padding: 12px 24px !important;\r\n      border-radius: 12px !important;\r\n      font-size: 14px !important; font-weight: 600 !important;\r\n      transition: all 0.2s;\r\n    }\r\n\r\n    .btn-analyze {\r\n      background: linear-gradient(135deg, #059669 0%, #10b981 100%) !important;\r\n      color: white !important;\r\n      box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);\r\n    }\r\n    .btn-analyze:hover:not(:disabled) { box-shadow: 0 6px 16px rgba(5, 150, 105, 0.4); transform: translateY(-2px); }\r\n    .btn-analyze:disabled { background: #cbd5e1 !important; box-shadow: none; }\r\n    .dark-mode .btn-analyze:disabled { background: #475569 !important; }\r\n\r\n    .btn-confirm.success {\r\n      background: linear-gradient(135deg, #059669 0%, #10b981 100%) !important;\r\n      color: white !important;\r\n      box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);\r\n    }\r\n    .btn-confirm.warning {\r\n      background: linear-gradient(135deg, #d97706 0%, #f59e0b 100%) !important;\r\n      color: white !important;\r\n      box-shadow: 0 4px 12px rgba(217, 119, 6, 0.3);\r\n    }\r\n    .btn-confirm:hover { transform: translateY(-2px); }\r\n\r\n    .btn-analyze mat-icon, .btn-confirm mat-icon { font-size: 20px; width: 20px; height: 20px; }\r\n\r\n    .hidden { display: none; }\r\n  `]\r\n})\r\nexport class VoucherPaymentDialogComponent implements OnInit, OnDestroy {\r\n  selectedFile = signal<File | null>(null);\r\n  previewUrl = signal<string>('');\r\n  isUploading = signal(false);\r\n  uploadResponse = signal<ComprobanteUploadResponse | null>(null);\r\n  errorMessage = signal<string>('');\r\n  zoomLevel = signal<number>(1);\r\n  isDarkMode = signal<boolean>(false);\r\n  private darkModeObserver?: MutationObserver;\r\n\r\n  cuotasPendientes = computed(() => {\r\n    return this.data.cuotas\r\n      .filter(c => c.status !== 'PAGADA' && c.status !== 'PAGADO' && c.status !== 'CUMPLIDO' && c.status !== 'CANCELADA')\r\n      .sort((a, b) => new Date(a.dueDate).getTime() - new Date(b.dueDate).getTime());\r\n  });\r\n\r\n  cuotaMasProxima = computed(() => {\r\n    const pendientes = this.cuotasPendientes();\r\n    return pendientes.length > 0 ? pendientes[0] : null;\r\n  });\r\n\r\n  cuotaCoincidente = computed(() => {\r\n    const response = this.uploadResponse();\r\n    if (!response?.ocrResult?.monto) return null;\r\n    const montoVoucher = response.ocrResult.monto;\r\n    const pendientes = this.cuotasPendientes();\r\n    return pendientes.find(c => Math.abs(c.monto - montoVoucher) < 0.01) || null;\r\n  });\r\n\r\n  showWarning = computed(() => {\r\n    const response = this.uploadResponse();\r\n    if (!response) return false;\r\n\r\n    // Advertencia si alguna validaci√≥n no coincide\r\n    const validacionFalla = (\r\n      (response.validacionMonto && !response.validacionMonto.coincide) ||\r\n      (response.validacionDocumento && !response.validacionDocumento.coincide) ||\r\n      (response.validacionNombre && !response.validacionNombre.coincide)\r\n    );\r\n\r\n    // Advertencia si no se detectaron datos importantes del OCR\r\n    const ocrResult = response.ocrResult;\r\n    const sinDatosOcr = !ocrResult?.monto && !ocrResult?.documento && !ocrResult?.nombre;\r\n\r\n    return validacionFalla || sinDatosOcr;\r\n  });\r\n\r\n  // Computed para detectar si no se encontraron datos\r\n  noDataDetected = computed(() => {\r\n    const response = this.uploadResponse();\r\n    if (!response?.ocrResult) return true;\r\n    const ocr = response.ocrResult;\r\n    return !ocr.monto && !ocr.documento && !ocr.nombre;\r\n  });\r\n\r\n  constructor(\r\n    public dialogRef: MatDialogRef<VoucherPaymentDialogComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: VoucherPaymentDialogData,\r\n    private comprobanteService: ComprobanteService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    // Check initial dark mode\r\n    this.isDarkMode.set(document.documentElement.classList.contains('dark'));\r\n\r\n    // Set up observer for dark mode changes\r\n    this.darkModeObserver = new MutationObserver((mutations) => {\r\n      mutations.forEach((mutation) => {\r\n        if (mutation.attributeName === 'class') {\r\n          this.isDarkMode.set(document.documentElement.classList.contains('dark'));\r\n        }\r\n      });\r\n    });\r\n\r\n    this.darkModeObserver.observe(document.documentElement, { attributes: true });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.darkModeObserver?.disconnect();\r\n  }\r\n\r\n  onDragOver(event: DragEvent): void {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n  }\r\n\r\n  onDrop(event: DragEvent): void {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    const files = event.dataTransfer?.files;\r\n    if (files && files.length > 0) this.handleFile(files[0]);\r\n  }\r\n\r\n  onFileSelected(event: Event): void {\r\n    const input = event.target as HTMLInputElement;\r\n    if (input.files && input.files.length > 0) this.handleFile(input.files[0]);\r\n  }\r\n\r\n  private handleFile(file: File): void {\r\n    if (!['image/jpeg', 'image/png', 'image/webp'].includes(file.type)) {\r\n      this.errorMessage.set('Solo JPG, PNG o WebP.');\r\n      return;\r\n    }\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      this.errorMessage.set('M√°ximo 5MB.');\r\n      return;\r\n    }\r\n    this.errorMessage.set('');\r\n    this.selectedFile.set(file);\r\n    this.uploadResponse.set(null);\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = () => this.previewUrl.set(reader.result as string);\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  removeFile(): void {\r\n    this.selectedFile.set(null);\r\n    this.previewUrl.set('');\r\n    this.uploadResponse.set(null);\r\n    this.errorMessage.set('');\r\n    this.zoomLevel.set(1);\r\n  }\r\n\r\n  upload(): void {\r\n    const file = this.selectedFile();\r\n    const cuota = this.cuotaMasProxima();\r\n    if (!file || !cuota) return;\r\n\r\n    this.isUploading.set(true);\r\n    this.errorMessage.set('');\r\n\r\n    this.comprobanteService.uploadComprobante(file, {\r\n      idCuota: cuota.id,\r\n      montoEsperado: this.getSaldoPendiente(cuota),\r\n      documentoEsperado: this.data.documentoCliente,\r\n      nombreEsperado: this.data.nombreCliente,\r\n      idAgente: this.data.idAgente\r\n    }).subscribe({\r\n      next: (response) => {\r\n        this.isUploading.set(false);\r\n        this.uploadResponse.set(response);\r\n        if (!response.success) this.errorMessage.set(response.error || 'Error al procesar');\r\n      },\r\n      error: (err) => {\r\n        this.isUploading.set(false);\r\n        this.errorMessage.set(err.error?.error || 'Error de conexi√≥n');\r\n      }\r\n    });\r\n  }\r\n\r\n  confirm(): void {\r\n    const response = this.uploadResponse();\r\n    const cuotaSeleccionada = this.cuotaCoincidente() || this.cuotaMasProxima();\r\n    if (!cuotaSeleccionada) return;\r\n\r\n    const ocrData = response?.ocrResult;\r\n    let observaciones = 'Pago validado por OCR';\r\n    if (ocrData?.banco) observaciones += ` - ${ocrData.banco}`;\r\n    if (ocrData?.numeroOperacion) observaciones += ` - Op. #${ocrData.numeroOperacion}`;\r\n    if (ocrData?.fecha) observaciones += ` - Fecha: ${ocrData.fecha}`;\r\n    if (ocrData?.monto) observaciones += ` - Monto: S/ ${ocrData.monto.toFixed(2)}`;\r\n\r\n    this.dialogRef.close({\r\n      confirmed: true,\r\n      autoSelect: {\r\n        categoriaId: 'CD',\r\n        detalleId: 'CA',\r\n        cuotaSeleccionada,\r\n        observaciones\r\n      },\r\n      ocrResponse: response || undefined\r\n    } as VoucherPaymentDialogResult);\r\n  }\r\n\r\n  cancel(): void {\r\n    this.dialogRef.close({ confirmed: false });\r\n  }\r\n\r\n  formatDate(dateValue?: string): string {\r\n    if (!dateValue) return '-';\r\n    if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateValue)) {\r\n      const [y, m, d] = dateValue.split('-').map(Number);\r\n      return new Date(y, m - 1, d).toLocaleDateString('es-PE', { day: '2-digit', month: '2-digit', year: 'numeric' });\r\n    }\r\n    return dateValue;\r\n  }\r\n\r\n  getResultClass(): string {\r\n    const r = this.uploadResponse();\r\n    if (!r?.success) return 'error';\r\n    if (this.showWarning()) return 'warning';\r\n    return 'success';\r\n  }\r\n\r\n  getResultIcon(): string {\r\n    const r = this.uploadResponse();\r\n    if (!r?.success) return 'error';\r\n    if (this.showWarning()) return 'warning';\r\n    return 'check_circle';\r\n  }\r\n\r\n  getResultTitle(): string {\r\n    const r = this.uploadResponse();\r\n    if (!r?.success) return 'Error al procesar';\r\n    if (this.noDataDetected()) return 'No se detectaron datos';\r\n    if (this.showWarning()) return 'Voucher con advertencias';\r\n    return 'Voucher validado correctamente';\r\n  }\r\n\r\n  getResultSubtitle(): string {\r\n    const r = this.uploadResponse();\r\n    if (!r?.success) return 'No se pudo analizar el voucher';\r\n    if (this.noDataDetected()) return 'La imagen no parece ser un comprobante de pago v√°lido';\r\n    if (this.showWarning()) return 'Algunos datos no coinciden exactamente';\r\n    return 'Todos los datos coinciden con el cliente';\r\n  }\r\n\r\n  getValidationClass(v?: ValidationResult): string {\r\n    if (!v) return 'neutral';\r\n    return v.coincide ? 'success' : 'warning';\r\n  }\r\n\r\n  /**\r\n   * Calcula el saldo pendiente de una cuota\r\n   * saldoPendiente = monto - montoPagadoReal\r\n   */\r\n  getSaldoPendiente(cuota: CuotaPromesa): number {\r\n    const pagado = cuota.montoPagadoReal || 0;\r\n    return Math.max(0, cuota.monto - pagado);\r\n  }\r\n\r\n  zoomIn(): void { if (this.zoomLevel() < 3) this.zoomLevel.update(z => z + 0.25); }\r\n  zoomOut(): void { if (this.zoomLevel() > 0.5) this.zoomLevel.update(z => z - 0.25); }\r\n\r\n  onWheel(event: WheelEvent): void {\r\n    event.preventDefault();\r\n    event.deltaY < 0 ? this.zoomIn() : this.zoomOut();\r\n  }\r\n}\r\n", "import { Component, Inject } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatDialogModule, MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\n\r\nexport interface ConfirmCartaDialogData {\r\n  idGestion: number;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-confirm-carta-dialog',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    MatDialogModule,\r\n    MatButtonModule,\r\n    MatIconModule\r\n  ],\r\n  template: `\r\n    <div class=\"dialog-container\">\r\n      <div class=\"dialog-header\">\r\n        <div class=\"success-badge\">\r\n          <mat-icon>check</mat-icon>\r\n        </div>\r\n        <h2>Promesa Registrada</h2>\r\n        <p class=\"subtitle\">La promesa de pago se ha guardado correctamente</p>\r\n      </div>\r\n\r\n      <mat-dialog-content>\r\n        <div class=\"card-preview\">\r\n          <mat-icon class=\"card-icon\">description</mat-icon>\r\n          <div class=\"card-info\">\r\n            <span class=\"card-title\">Carta de Acuerdo</span>\r\n            <span class=\"card-desc\">Documento PDF con los t√©rminos del acuerdo</span>\r\n          </div>\r\n        </div>\r\n        <p class=\"question\">¬øDesea generar la Carta de Acuerdo ahora?</p>\r\n      </mat-dialog-content>\r\n\r\n      <mat-dialog-actions>\r\n        <button mat-stroked-button (click)=\"onNoClick()\" class=\"btn-secondary\">\r\n          M√°s tarde\r\n        </button>\r\n        <button mat-flat-button color=\"primary\" (click)=\"onGenerateClick()\" class=\"btn-primary\">\r\n          <mat-icon>download</mat-icon>\r\n          Generar y Descargar\r\n        </button>\r\n      </mat-dialog-actions>\r\n    </div>\r\n  `,\r\n  styles: [`\r\n    .dialog-container {\r\n      padding: 8px;\r\n    }\r\n\r\n    .dialog-header {\r\n      text-align: center;\r\n      margin-bottom: 24px;\r\n    }\r\n\r\n    .success-badge {\r\n      width: 56px;\r\n      height: 56px;\r\n      border-radius: 50%;\r\n      background: linear-gradient(135deg, #4caf50, #66bb6a);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      margin: 0 auto 16px;\r\n      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);\r\n    }\r\n\r\n    .success-badge mat-icon {\r\n      color: white;\r\n      font-size: 32px;\r\n      width: 32px;\r\n      height: 32px;\r\n    }\r\n\r\n    h2 {\r\n      margin: 0 0 8px 0;\r\n      font-size: 1.25rem;\r\n      font-weight: 600;\r\n      color: var(--mat-dialog-headline-color, inherit);\r\n    }\r\n\r\n    .subtitle {\r\n      margin: 0;\r\n      font-size: 0.875rem;\r\n      opacity: 0.7;\r\n    }\r\n\r\n    mat-dialog-content {\r\n      padding: 0 8px;\r\n    }\r\n\r\n    .card-preview {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 16px;\r\n      padding: 16px;\r\n      border-radius: 12px;\r\n      background: var(--mat-sidenav-content-background-color, rgba(0,0,0,0.04));\r\n      margin-bottom: 20px;\r\n    }\r\n\r\n    :host-context(.dark-theme) .card-preview,\r\n    :host-context([class*=\"dark\"]) .card-preview {\r\n      background: rgba(255, 255, 255, 0.05);\r\n    }\r\n\r\n    .card-icon {\r\n      font-size: 40px;\r\n      width: 40px;\r\n      height: 40px;\r\n      color: #1976d2;\r\n    }\r\n\r\n    :host-context(.dark-theme) .card-icon,\r\n    :host-context([class*=\"dark\"]) .card-icon {\r\n      color: #64b5f6;\r\n    }\r\n\r\n    .card-info {\r\n      display: flex;\r\n      flex-direction: column;\r\n      gap: 4px;\r\n    }\r\n\r\n    .card-title {\r\n      font-weight: 600;\r\n      font-size: 0.95rem;\r\n    }\r\n\r\n    .card-desc {\r\n      font-size: 0.8rem;\r\n      opacity: 0.6;\r\n    }\r\n\r\n    .question {\r\n      text-align: center;\r\n      font-weight: 500;\r\n      margin: 0;\r\n      font-size: 0.9rem;\r\n    }\r\n\r\n    mat-dialog-actions {\r\n      display: flex;\r\n      gap: 12px;\r\n      padding: 16px 8px 8px;\r\n      justify-content: flex-end;\r\n    }\r\n\r\n    .btn-secondary {\r\n      flex: 1;\r\n    }\r\n\r\n    .btn-primary {\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      gap: 8px;\r\n    }\r\n\r\n    .btn-primary mat-icon {\r\n      font-size: 20px;\r\n      width: 20px;\r\n      height: 20px;\r\n    }\r\n  `]\r\n})\r\nexport class ConfirmCartaDialogComponent {\r\n  constructor(\r\n    public dialogRef: MatDialogRef<ConfirmCartaDialogComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: ConfirmCartaDialogData\r\n  ) {}\r\n\r\n  onNoClick(): void {\r\n    this.dialogRef.close('cancel');\r\n  }\r\n\r\n  onGenerateClick(): void {\r\n    this.dialogRef.close('generate');\r\n  }\r\n}\r\n", "import { Injectable } from '@angular/core';\nimport { SystemConfig, ManagementClassification } from '../models/system-config.model';\nimport { ApiSystemConfigService } from './api-system-config.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SystemConfigService {\n  constructor(private apiService: ApiSystemConfigService) {}\n  private readonly systemConfig: SystemConfig = {\n    campana: {\n      id: 'CAMP-001',\n      nombre: 'Cartera Vencida Q3 2025',\n      tipo: 'Cobranza Temprana'\n    },\n    \n    tipificaciones: {\n      contacto: [\n        { id: 'CPC', codigo: 'CPC', label: 'Contacto con Cliente' },\n        { id: 'CTT', codigo: 'CTT', label: 'Contacto con Tercero' },\n        { id: 'NCL', codigo: 'NCL', label: 'No Contesta' },\n        { id: 'BZN', codigo: 'BZN', label: 'Buz√≥n de Voz' },\n        { id: 'OCP', codigo: 'OCP', label: 'Ocupado' },\n        { id: 'FTN', codigo: 'FTN', label: 'Fuera de Tono' },\n        { id: 'NEQ', codigo: 'NEQ', label: 'N√∫mero Equivocado' },\n        { id: 'TEL', codigo: 'TEL', label: 'Tel√©fono Inv√°lido' },\n        { id: 'CLG', codigo: 'CLG', label: 'Cliente Colg√≥' },\n        { id: 'RCH', codigo: 'RCH', label: 'Rechaz√≥ Llamada' },\n      ],\n      \n      gestion: [\n        { id: 'ACP', codigo: 'ACP', label: 'Acepta Compromiso de Pago', requiere_pago: true, requiere_fecha: true },\n        { id: 'PGR', codigo: 'PGR', label: 'Pago Realizado - Completo', requiere_pago: true },\n        { id: 'PGP', codigo: 'PGP', label: 'Pago Parcial Realizado', requiere_pago: true },\n        { id: 'PGT', codigo: 'PGT', label: 'Pago Total de Deuda', requiere_pago: true },\n        { id: 'PPR', codigo: 'PPR', label: 'Pago Programado', requiere_pago: true, requiere_fecha: true },\n        { id: 'SRP', codigo: 'SRP', label: 'Solicita Refinanciamiento', requiere_seguimiento: true },\n        { id: 'SQA', codigo: 'SQA', label: 'Solicita Quita o Descuento', requiere_seguimiento: true },\n        { id: 'SCN', codigo: 'SCN', label: 'Solicita Congelamiento', requiere_seguimiento: true },\n        { id: 'SPL', codigo: 'SPL', label: 'Solicita Ampliaci√≥n de Plazo', requiere_seguimiento: true },\n        { id: 'DPD', codigo: 'DPD', label: 'Disputa de Deuda', requiere_seguimiento: true },\n        { id: 'NRD', codigo: 'NRD', label: 'No Reconoce Deuda', requiere_seguimiento: true },\n        { id: 'DIF', codigo: 'DIF', label: 'Dificultad Financiera Temporal', requiere_seguimiento: true },\n        { id: 'DSE', codigo: 'DSE', label: 'Desempleo', requiere_seguimiento: true },\n        { id: 'ENF', codigo: 'ENF', label: 'Enfermedad/Incapacidad', requiere_seguimiento: true },\n        { id: 'FLC', codigo: 'FLC', label: 'Fallecimiento del Titular', requiere_seguimiento: true },\n        { id: 'RCL', codigo: 'RCL', label: 'Reclamo Registrado', requiere_seguimiento: true },\n        { id: 'FRD', codigo: 'FRD', label: 'Reporte de Fraude', requiere_seguimiento: true },\n        { id: 'NCB', codigo: 'NCB', label: 'Sin Capacidad de Pago', requiere_seguimiento: true },\n        { id: 'VJE', codigo: 'VJE', label: 'Viaje/Fuera del Pa√≠s', requiere_fecha: true },\n        { id: 'SLL', codigo: 'SLL', label: 'Solicita Llamar Despu√©s', requiere_fecha: true },\n        { id: 'NIN', codigo: 'NIN', label: 'No est√° Interesado' },\n        { id: 'AGR', codigo: 'AGR', label: 'Cliente Agresivo/Hostil' },\n        { id: 'NBL', codigo: 'NBL', label: 'No Desea Ser Contactado' },\n        { id: 'LGL', codigo: 'LGL', label: 'Amenaza Legal' },\n        \n        // TIPIFICACIONES PARA CONVENIOS Y CRONOGRAMAS\n        { id: 'CNV', codigo: 'CNV', label: 'Acepta Convenio de Pago', requiere_cronograma: true, requiere_fecha: true },\n        { id: 'CRO', codigo: 'CRO', label: 'Solicita Cronograma de Pagos', requiere_cronograma: true, requiere_cuotas: true },\n        { id: 'CPP', codigo: 'CPP', label: 'Convenio con Pago Parcial Inicial', requiere_cronograma: true, requiere_monto_inicial: true },\n        { id: 'CTT', codigo: 'CTT', label: 'Convenio a Plazo Total', requiere_cronograma: true, requiere_periodicidad: true },\n        { id: 'CCG', codigo: 'CCG', label: 'Convenio con Congelamiento', requiere_cronograma: true, requiere_fecha: true },\n        { id: 'CRF', codigo: 'CRF', label: 'Convenio con Refinanciamiento', requiere_cronograma: true, requiere_seguimiento: true },\n        { id: 'CQT', codigo: 'CQT', label: 'Convenio con Quita/Descuento', requiere_cronograma: true, requiere_pago: true },\n        { id: 'CAP', codigo: 'CAP', label: 'Convenio Aprobado por Supervisor', requiere_cronograma: true, requiere_autorizacion: true },\n        { id: 'CRC', codigo: 'CRC', label: 'Cliente Rechaza Convenio Propuesto', requiere_seguimiento: true },\n        { id: 'CEV', codigo: 'CEV', label: 'Convenio en Evaluaci√≥n', requiere_seguimiento: true, requiere_fecha: true },\n      ],\n      \n      motivo_no_pago: [\n        { id: 'FRE', label: 'Falta de Recursos Econ√≥micos' },\n        { id: 'DSP', label: 'Desempleo Reciente' },\n        { id: 'RDS', label: 'Reducci√≥n de Salario' },\n        { id: 'EMR', label: 'Emergencia M√©dica' },\n        { id: 'GSF', label: 'Gastos Familiares Imprevistos' },\n        { id: 'OGS', label: 'Otros Gastos Prioritarios' },\n        { id: 'NGC', label: 'Negocio/Comercio en Crisis' },\n        { id: 'DCP', label: 'Desconoce el Cargo/Producto' },\n        { id: 'IFC', label: 'Inconformidad con Servicio' },\n        { id: 'FCC', label: 'Fraude o Cargo no Reconocido' },\n        { id: 'OLV', label: 'Olvido de Fecha de Pago' },\n        { id: 'PRG', label: 'Problemas con M√©todo de Pago' },\n        { id: 'BNK', label: 'Problemas Bancarios' },\n        { id: 'OTR', label: 'Otro Motivo' },\n      ],\n    },\n    \n    metodos_pago: [\n      { id: 'TDC', codigo: 'TDC', label: 'Tarjeta de Cr√©dito', icono: 'üí≥', requiere_ultimos4: true },\n      { id: 'TDD', codigo: 'TDD', label: 'Tarjeta de D√©bito', icono: 'üí≥', requiere_ultimos4: true },\n      { id: 'TRF', codigo: 'TRF', label: 'Transferencia Bancaria', icono: 'üè¶', requiere_banco: true },\n      { id: 'DEP', codigo: 'DEP', label: 'Dep√≥sito en Cuenta', icono: 'üè¶', requiere_banco: true },\n      { id: 'EFE', codigo: 'EFE', label: 'Efectivo en Agencia', icono: 'üíµ', requiere_agencia: true },\n      { id: 'CAU', codigo: 'CAU', label: 'Cargo Autom√°tico', icono: 'üîÑ', requiere_autorizacion: true },\n      { id: 'YPE', codigo: 'YPE', label: 'Yape', icono: 'üì±', requiere_telefono: true },\n      { id: 'PLN', codigo: 'PLN', label: 'Plin', icono: 'üì±', requiere_telefono: true },\n      { id: 'TNK', codigo: 'TNK', label: 'Tunki', icono: 'üì±', requiere_telefono: true },\n      { id: 'PGW', codigo: 'PGW', label: 'Pasarela Web/Link de Pago', icono: 'üåê', requiere_email: true },\n    ],\n    \n    bancos: [\n      'BCP - Banco de Cr√©dito del Per√∫',\n      'BBVA',\n      'Interbank',\n      'Scotiabank',\n      'BanBif',\n      'Banco Pichincha',\n      'Banco Falabella',\n      'Banco Ripley',\n      'Banco Azteca',\n      'Otros',\n    ],\n\n    cronograma_config: {\n      periodicidades: [\n        { id: 'SEM', label: 'Semanal', dias: 7 },\n        { id: 'QUI', label: 'Quincenal', dias: 15 },\n        { id: 'MEN', label: 'Mensual', dias: 30 },\n        { id: 'BIM', label: 'Bimestral', dias: 60 },\n        { id: 'TRI', label: 'Trimestral', dias: 90 },\n      ],\n      \n      tipos_cronograma: [\n        { id: 'FIJ', label: 'Cuotas Fijas', descripcion: 'Mismo monto cada cuota' },\n        { id: 'DEC', label: 'Decreciente', descripcion: 'Cuotas van disminuyendo' },\n        { id: 'ESC', label: 'Escalonado', descripcion: 'Cuotas aumentan gradualmente' },\n        { id: 'PER', label: 'Personalizado', descripcion: 'Montos espec√≠ficos por cuota' },\n      ],\n      \n      campos_requeridos: {\n        requiere_cronograma: ['numero_cuotas', 'periodicidad', 'fecha_primera_cuota'],\n        requiere_cuotas: ['numero_cuotas', 'monto_cuota'],\n        requiere_monto_inicial: ['monto_inicial', 'fecha_pago_inicial'],\n        requiere_periodicidad: ['periodicidad', 'dia_pago'],\n        requiere_autorizacion: ['supervisor_id', 'codigo_autorizacion'],\n      },\n      \n      validaciones: {\n        numero_cuotas_max: 48,\n        numero_cuotas_min: 2,\n        monto_minimo_cuota: 50.00,\n        porcentaje_quita_max: 30,\n        dias_gracia_max: 90,\n      }\n    },\n  };\n\n  getSystemConfig(): SystemConfig {\n    return this.systemConfig;\n  }\n\n  getCampaign() {\n    // Usar campa√±a activa del API si est√° disponible, sino usar fallback est√°tico\n    const activeCampaign = this.apiService.getActiveCampaign();\n    return activeCampaign || this.systemConfig.campana;\n  }\n\n  getContactClassifications() {\n    // Primero intentar usar clasificaciones habilitadas del tenant\n    const tenantData = this.apiService.tenantClassifications();\n\n    if (tenantData.length > 0) {\n      const contactClassifications = tenantData\n        .filter(c => c.typification.tipoClasificacion === 'CONTACT_RESULT' && c.isEnabled)\n        .map(c => ({\n          id: c.typification.id, // Usar ID num√©rico para comparaciones\n          codigo: c.typification.codigo,\n          label: c.customName || c.typification.nombre\n        }));\n\n      if (contactClassifications.length > 0) {\n        return contactClassifications;\n      }\n    }\n\n    // Si no hay configuraciones de tenant, usar API general o fallback\n    const apiData = this.apiService.getContactClassificationsForUI();\n    return apiData.length > 0 ? apiData : this.systemConfig.tipificaciones.contacto;\n  }\n\n  getManagementClassifications(): ManagementClassification[] {\n    // Primero intentar usar clasificaciones habilitadas del tenant\n    const tenantData = this.apiService.tenantClassifications();\n\n    if (tenantData.length > 0) {\n      // Mapear TODAS las clasificaciones habilitadas (el backend ya filtr√≥ por tenant/portfolio)\n      // No filtrar por tipo - el tenant decide qu√© clasificaciones habilitar\n      const managementClassifications: ManagementClassification[] = tenantData\n        .filter(c => c.isEnabled)\n        .map(c => {\n          // Parsear metadataSchema para obtener los flags reales\n          const metadata = c.typification.metadataSchema ? JSON.parse(c.typification.metadataSchema) : {};\n\n          return {\n            id: String(c.typification.id), // Convertir a string para el tipo ManagementClassification\n            codigo: c.typification.codigo,\n            label: c.customName || c.typification.nombre,\n            requiere_pago: metadata.requiresPayment || false,\n            requiere_cronograma: metadata.requiresSchedule || false,\n            requiere_seguimiento: metadata.requiresFollowUp || false,\n            parentId: c.typification.parentTypificationId,\n            hierarchyLevel: c.typification.nivelJerarquia,\n            // Campos del tipo de clasificaci√≥n\n            suggestsFullAmount: c.typification.suggestsFullAmount,\n            allowsInstallmentSelection: c.typification.allowsInstallmentSelection,\n            requiresManualAmount: c.typification.requiresManualAmount\n          } as ManagementClassification;\n        });\n\n      if (managementClassifications.length > 0) {\n        return managementClassifications;\n      }\n    }\n\n    // Si no hay configuraciones de tenant, usar API general\n    const apiData = this.apiService.getManagementClassificationsForUI();\n    return apiData.length > 0 ? apiData : this.systemConfig.tipificaciones.gestion;\n  }\n\n  getPaymentNoReasons() {\n    return this.systemConfig.tipificaciones.motivo_no_pago;\n  }\n\n  getPaymentMethods() {\n    return this.systemConfig.metodos_pago;\n  }\n\n  getBanks() {\n    return this.systemConfig.bancos;\n  }\n\n  getScheduleConfig() {\n    return this.systemConfig.cronograma_config;\n  }\n\n  getManagementClassificationById(id: string | number) {\n    // Primero buscar en las clasificaciones cargadas desde getManagementClassifications()\n    const managementClassifications = this.getManagementClassifications();\n\n    // Buscar por ID (puede ser n√∫mero o string)\n    const found = managementClassifications.find((g: any) => g.id == id); // Usar == para comparar n√∫mero con string\n\n    return found;\n  }\n}", "import { Injectable, inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { environment } from '../../../environments/environment';\n\n/**\n * Interfaz que representa la configuraci√≥n de outputs guardada en backend\n *\n * MAPEO CON BACKEND:\n * ‚Üí Entidad: CustomerOutputConfig.java\n * ‚Üí Tabla BD: customer_output_config\n * ‚Üí Endpoints:\n *   - POST /api/v1/customer-outputs/config\n *   - GET /api/v1/customer-outputs/config?tenantId=X&portfolioId=Y\n */\nexport interface CustomerOutputConfigResponse {\n  id: number;\n  tenantId: number;\n  portfolioId?: number;\n  fieldsConfig: string;  // JSON serializado\n}\n\n/**\n * Request para guardar configuraci√≥n\n */\nexport interface SaveCustomerOutputConfigRequest {\n  tenantId: number;\n  portfolioId?: number;\n  fieldsConfig: string;  // JSON serializado\n}\n\n/**\n * Servicio para gestionar la configuraci√≥n de outputs del cliente\n *\n * FLUJO DE USO:\n * 1. Pantalla mantenimiento: saveConfiguration() ‚Üí Guarda config en BD\n * 2. Pantalla gesti√≥n: getConfiguration() ‚Üí Carga config para mostrar campos\n */\n@Injectable({\n  providedIn: 'root'\n})\nexport class CustomerOutputConfigService {\n  private http = inject(HttpClient);\n  private apiUrl = `${environment.tipificacionUrl}/customer-outputs`;\n\n  /**\n   * Guarda o actualiza configuraci√≥n de outputs\n   *\n   * BACKEND:\n   * POST /api/v1/customer-outputs/config\n   * Controller: CustomerOutputConfigController.saveConfiguration()\n   *\n   * L√ìGICA:\n   * - Si existe config para tenant+portfolio ‚Üí actualiza\n   * - Si no existe ‚Üí crea nueva\n   */\n  saveConfiguration(request: SaveCustomerOutputConfigRequest): Observable<CustomerOutputConfigResponse> {\n    return this.http.post<CustomerOutputConfigResponse>(`${this.apiUrl}/config`, request);\n  }\n\n  /**\n   * Obtiene configuraci√≥n de outputs para tenant y portfolio\n   *\n   * BACKEND:\n   * GET /api/v1/customer-outputs/config?tenantId=X&portfolioId=Y\n   * Controller: CustomerOutputConfigController.getConfiguration()\n   *\n   * L√ìGICA DE B√öSQUEDA:\n   * 1. Si portfolioId != null ‚Üí busca configuraci√≥n espec√≠fica del portfolio\n   * 2. Si no encuentra espec√≠fica ‚Üí busca configuraci√≥n general del tenant\n   * 3. Si no encuentra ninguna ‚Üí 404 (usar valores por defecto en frontend)\n   */\n  getConfiguration(tenantId: number, portfolioId?: number): Observable<CustomerOutputConfigResponse> {\n    const params: any = { tenantId };\n    if (portfolioId !== undefined && portfolioId !== null) {\n      params.portfolioId = portfolioId;\n    }\n\n    return this.http.get<CustomerOutputConfigResponse>(`${this.apiUrl}/config`, { params });\n  }\n}\n", "import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { environment } from '../../../environments/environment';\n\nexport interface CustomerStaticData {\n  id: number;\n  documentType: string;\n  documentNumber: string;\n  firstName: string;\n  lastName: string;\n  fullName: string;\n  birthDate: string;\n  age: number;\n  gender: string;\n  civilStatus: string;\n  occupation: string;\n  monthlyIncome: number;\n  address: string;\n  district: string;\n  city: string;\n  department: string;\n  phone: string;\n  alternativePhone?: string;\n  workPhone?: string;\n  email: string;\n  alternativeEmail?: string;\n  employmentStatus: string;\n  companyName?: string;\n  companyPhone?: string;\n  companyAddress?: string;\n  referenceContact1?: string;\n  referencePhone1?: string;\n  referenceContact2?: string;\n  referencePhone2?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface CustomerField {\n  fieldCode: string;\n  fieldName: string;\n  value: string | number | null;\n  dataType: string;\n  category: string;\n  icon?: string;\n  color?: string;\n}\n\nexport interface CustomerDetail {\n  documento: string;\n  campos: CustomerField[];\n}\n\nexport interface ContactMethodResource {\n  id: number;\n  contactType: string;\n  subtype: string;\n  value: string;\n  label: string;\n  importDate: string | null;\n  status: string;\n}\n\nexport interface CustomerResource {\n  id: number;\n  customerId: string;\n  identificationCode: string;\n  accountNumber?: string;\n  // Informaci√≥n financiera/deuda\n  overdueDays?: number | null;\n  overdueAmount?: number | null;\n  principalAmount?: number | null;\n  documentNumber: string;\n  fullName: string;\n  documentType: string;\n  birthDate: string | null;\n  age: number | null;\n  // Nombres\n  firstName?: string;\n  secondName?: string;\n  firstLastName?: string;\n  secondLastName?: string;\n  // Datos personales\n  maritalStatus?: string;\n  occupation?: string;\n  customerType?: string;\n  // Ubicaci√≥n\n  address?: string;\n  district?: string;\n  province?: string;\n  department?: string;\n  // Referencias\n  personalReference?: string;\n  // Estado\n  status?: string;\n  importDate?: string;\n  // M√©todos de contacto\n  contactMethods?: ContactMethodResource[];\n  // Informaci√≥n de subcartera\n  tenantId?: number;\n  tenantName?: string;\n  portfolioId?: number;\n  portfolioName?: string;\n  subPortfolioId?: number;\n  subPortfolioName?: string;\n  subPortfolioCode?: string;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CustomerService {\n  private apiUrl = `${environment.apiUrl}/customers`;\n\n  constructor(private http: HttpClient) {}\n\n  getAllCustomers(): Observable<CustomerStaticData[]> {\n    return this.http.get<CustomerStaticData[]>(this.apiUrl);\n  }\n\n  getCustomerById(id: number): Observable<CustomerStaticData> {\n    return this.http.get<CustomerStaticData>(`${this.apiUrl}/${id}`);\n  }\n\n  getCustomerByDocument(documentNumber: string): Observable<CustomerStaticData> {\n    return this.http.get<CustomerStaticData>(`${this.apiUrl}/document/${documentNumber}`);\n  }\n\n  searchCustomers(searchTerm: string): Observable<CustomerStaticData[]> {\n    return this.http.get<CustomerStaticData[]>(`${this.apiUrl}/search`, {\n      params: { q: searchTerm }\n    });\n  }\n\n  filterCustomers(filters: {\n    documentType?: string;\n    employmentStatus?: string;\n    minAge?: number;\n    maxAge?: number;\n  }): Observable<CustomerStaticData[]> {\n    return this.http.get<CustomerStaticData[]>(`${this.apiUrl}/filter`, {\n      params: { ...filters } as any\n    });\n  }\n\n  createCustomer(customer: Partial<CustomerStaticData>): Observable<CustomerStaticData> {\n    return this.http.post<CustomerStaticData>(this.apiUrl, customer);\n  }\n\n  updateCustomer(id: number, customer: Partial<CustomerStaticData>): Observable<CustomerStaticData> {\n    return this.http.put<CustomerStaticData>(`${this.apiUrl}/${id}`, customer);\n  }\n\n  deleteCustomer(id: number): Observable<void> {\n    return this.http.delete<void>(`${this.apiUrl}/${id}`);\n  }\n\n  getCustomerDetail(document: string, subPortfolioId: number): Observable<CustomerDetail> {\n    return this.http.get<CustomerDetail>(`${this.apiUrl}/detail/${document}`, {\n      params: { subPortfolioId: subPortfolioId.toString() }\n    });\n  }\n\n  searchCustomerByCriteria(tenantId: number, searchBy: string, value: string): Observable<CustomerResource> {\n    return this.http.get<CustomerResource>(`${this.apiUrl}/search-by`, {\n      params: {\n        tenantId: tenantId.toString(),\n        searchBy: searchBy,\n        value: value\n      }\n    });\n  }\n\n  searchCustomersByCriteria(tenantId: number, searchBy: string, value: string): Observable<CustomerResource[]> {\n    return this.http.get<CustomerResource[]>(`${this.apiUrl}/search-by-multi`, {\n      params: {\n        tenantId: tenantId.toString(),\n        searchBy: searchBy,\n        value: value\n      }\n    });\n  }\n\n  searchCustomersAcrossAllTenants(searchBy: string, value: string): Observable<CustomerResource[]> {\n    return this.http.get<CustomerResource[]>(`${this.apiUrl}/search-all-tenants`, {\n      params: {\n        searchBy: searchBy,\n        value: value\n      }\n    });\n  }\n\n  getRecentCustomers(): Observable<{document: string, fullName: string, tenantName: string, portfolioName: string, subPortfolioName: string}[]> {\n    return this.http.get<{document: string, fullName: string, tenantName: string, portfolioName: string, subPortfolioName: string}[]>(`${this.apiUrl}/recent`);\n  }\n\n  registerCustomerAccess(customerId: number): Observable<void> {\n    return this.http.post<void>(`${this.apiUrl}/${customerId}/access`, {});\n  }\n\n  /**\n   * Busca un cliente por documento exacto en la tabla din√°mica\n   * Retorna TODOS los campos de la tabla ini_* incluyendo montos financieros\n   */\n  findClientByDocumento(\n    tenantId: number,\n    portfolioId: number,\n    subPortfolioId: number,\n    documento: string\n  ): Observable<Record<string, any>> {\n    return this.http.get<Record<string, any>>(`${environment.apiUrl}/client-search/find`, {\n      params: {\n        tenantId: tenantId.toString(),\n        portfolioId: portfolioId.toString(),\n        subPortfolioId: subPortfolioId.toString(),\n        documento: documento\n      }\n    });\n  }\n}\n", "import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\n\r\nexport interface VerificarPromesaResponse {\r\n  tienePromesaPendiente: boolean;\r\n  idGestion?: number;\r\n}\r\n\r\nexport interface CartaGeneradaHistorial {\r\n  id: number;\r\n  idGestion: number;\r\n  idCliente: number;\r\n  idAgente: number;\r\n  codigoPlantilla: string;\r\n  fechaGeneracion: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CartaAcuerdoService {\r\n  private apiUrl = `${environment.apiUrl}/cartas`;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  /**\r\n   * Verifica si un cliente tiene una promesa de pago pendiente\r\n   */\r\n  verificarPromesaPendiente(idCliente: number): Observable<VerificarPromesaResponse> {\r\n    return this.http.get<VerificarPromesaResponse>(`${this.apiUrl}/verificar-promesa/${idCliente}`);\r\n  }\r\n\r\n  /**\r\n   * Genera la carta de acuerdo autom√°ticamente desde una gesti√≥n\r\n   * Retorna el PDF como Blob\r\n   */\r\n  generarCarta(idGestion: number, idAgente: number): Observable<Blob> {\r\n    return this.http.post(`${this.apiUrl}/generar/${idGestion}?idAgente=${idAgente}`, null, {\r\n      responseType: 'blob',\r\n      headers: new HttpHeaders({\r\n        'Accept': 'application/pdf'\r\n      })\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Obtiene el historial de cartas generadas para un cliente\r\n   */\r\n  obtenerHistorial(idCliente: number): Observable<CartaGeneradaHistorial[]> {\r\n    return this.http.get<CartaGeneradaHistorial[]>(`${this.apiUrl}/historial/${idCliente}`);\r\n  }\r\n\r\n  /**\r\n   * Descarga el PDF generado\r\n   */\r\n  descargarPdf(blob: Blob, nombreArchivo: string): void {\r\n    const url = window.URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = nombreArchivo;\r\n    link.click();\r\n    window.URL.revokeObjectURL(url);\r\n  }\r\n}\r\n", "import { Component, OnInit, OnDestroy, signal, computed, ViewChild } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { LucideAngularModule } from 'lucide-angular';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { catchError, of, Subscription } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\n\r\nimport { SystemConfigService } from '../services/system-config.service';\r\nimport { ManagementService, CreateManagementRequest, StartCallRequest, EndCallRequest, RegisterPaymentRequest, PaymentScheduleRequest, ConfiguracionCabecera } from '../services/management.service';\r\nimport { PaymentScheduleService } from '../services/payment-schedule.service';\r\nimport { ThemeService } from '../../shared/services/theme.service';\r\nimport { ManagementClassification } from '../models/system-config.model';\r\nimport { CustomerData } from '../models/customer.model';\r\nimport { ManagementForm, ValidationErrors } from '../models/management.model';\r\nimport { Tenant } from '../../maintenance/models/tenant.model';\r\nimport { Portfolio } from '../../maintenance/models/portfolio.model';\r\nimport { TypificationService } from '../../maintenance/services/typification.service';\r\nimport { TypificationV2Service } from '../../maintenance/services/typification-v2.service';\r\nimport { CampoOpcionDTO } from '../../maintenance/models/typification-v2.model';\r\nimport { ApiSystemConfigService } from '../services/api-system-config.service';\r\nimport { DynamicFieldRendererComponent } from '../components/dynamic-field-renderer/dynamic-field-renderer.component';\r\nimport { MetadataSchema, FieldConfig } from '../../maintenance/models/field-config.model';\r\nimport { AmountOption } from '../../shared/components/payment-schedule/payment-schedule.component';\r\nimport { CustomerOutputConfigService } from '../../maintenance/services/customer-output-config.service';\r\nimport { PaymentScheduleViewComponent } from '../components/payment-schedule-view/payment-schedule-view.component';\r\nimport { CustomerService } from '../../customers/services/customer.service';\r\nimport { SipService, CallState } from '../../core/services/sip.service';\r\nimport { AgentService } from '../../core/services/agent.service';\r\nimport { AgentState, AgentStatus } from '../../core/models/agent-status.model';\r\nimport { AgentStatusService } from '../../core/services/agent-status.service';\r\nimport { AuthService } from '../../core/services/auth.service';\r\nimport { StatusAlarmClockComponent } from '../../shared/components/status-alarm-clock/status-alarm-clock.component';\r\nimport { AutorizacionService, SupervisorEnLinea, CrearSolicitudRequest, SolicitudAutorizacion } from '../../core/services/autorizacion.service';\r\nimport { SelectSupervisorModalComponent } from '../../shared/components/select-supervisor-modal/select-supervisor-modal.component';\r\nimport { RecordatoriosService } from '../../core/services/recordatorios.service';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { RecordatoriosModalComponent } from '../../shared/components/recordatorios-modal/recordatorios-modal.component';\r\nimport { ComprobanteService } from '../services/comprobante.service';\r\nimport { ComprobanteUploadDialogComponent, ComprobanteUploadDialogData, ComprobanteUploadDialogResult } from '../components/comprobante-upload-dialog/comprobante-upload-dialog.component';\r\nimport { VoucherPaymentDialogComponent, VoucherPaymentDialogData, VoucherPaymentDialogResult } from '../components/voucher-payment-dialog/voucher-payment-dialog.component';\r\nimport { ComprobanteUploadResponse } from '../models/comprobante.model';\r\nimport { CartaAcuerdoService } from '../../core/services/carta-acuerdo.service';\r\nimport { ConfirmCartaDialogComponent } from '../../features/dialer/call-notes/confirm-carta-dialog/confirm-carta-dialog.component';\r\n\r\n@Component({\r\n  selector: 'app-collection-management',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    LucideAngularModule,\r\n    DynamicFieldRendererComponent,\r\n    PaymentScheduleViewComponent,\r\n    SelectSupervisorModalComponent,\r\n    StatusAlarmClockComponent\r\n  ],\r\n  template: `\r\n    <div class=\"collection-management-container h-[100dvh] flex flex-col overflow-hidden\">\r\n      <!-- Notificaci√≥n de √©xito -->\r\n      @if (showSuccess()) {\r\n        <div class=\"fixed top-4 right-4 z-50 animate-[slideInRight_0.5s_ease-out]\">\r\n          <div class=\"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-3\">\r\n            <div>\r\n              <div class=\"font-bold\">¬°Gesti√≥n Guardada!</div>\r\n              <div class=\"text-sm opacity-90\">Los datos se registraron correctamente</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      }\r\n\r\n\r\n      <!-- Header Principal - ULTRA COMPACTO -->\r\n      <div class=\"bg-gradient-to-r from-blue-600 via-blue-700 to-blue-600 dark:from-slate-950 dark:via-blue-950 dark:to-slate-950 text-white shadow-md relative overflow-hidden\">\r\n        <div class=\"relative px-4 py-2\">\r\n          <div class=\"flex items-center justify-between\">\r\n            <!-- Lado Izquierdo: T√≠tulo -->\r\n            <div class=\"flex items-center gap-2\">\r\n              <div class=\"w-8 h-8 bg-blue-500/30 dark:bg-blue-600/30 rounded-lg flex items-center justify-center\">\r\n                <lucide-angular name=\"clipboard-list\" [size]=\"18\" class=\"text-white\"></lucide-angular>\r\n              </div>\r\n              <h1 class=\"text-base font-bold\">Gesti√≥n de Cobranza</h1>\r\n            </div>\r\n\r\n            <!-- Lado Derecho: Estado, Indicador de Tiempo y Cron√≥metro -->\r\n            <div class=\"flex items-center gap-4\">\r\n              <div class=\"text-right\">\r\n                <div class=\"text-blue-200 dark:text-blue-300 text-[10px]\">Estado</div>\r\n                <div [class]=\"'font-semibold text-sm transition-all duration-300 ' + (callActive() ? 'text-green-400 animate-pulse' : isTipifying() ? 'text-yellow-400' : 'text-white/80')\">\r\n                  {{ callActive() ? '‚óè EN LLAMADA' : isTipifying() ? '‚úé TIPIFICANDO' : '‚óã DISPONIBLE' }}\r\n                </div>\r\n              </div>\r\n              <!-- Indicador de umbral de tiempo (reloj de alarma) -->\r\n              <app-status-alarm-clock\r\n                [color]=\"colorIndicador()\"\r\n                [excedido]=\"excedeTiempoMaximo()\"\r\n                [size]=\"22\">\r\n              </app-status-alarm-clock>\r\n              <div [class]=\"'px-4 py-1.5 rounded-lg font-mono text-lg font-bold transition-all duration-300 ' + (callActive() ? 'bg-gradient-to-r from-red-600 to-red-700 animate-pulse shadow-lg shadow-red-500/30' : 'bg-blue-800/50 dark:bg-gray-900/80')\">\r\n                {{ formatTime(callDuration()) }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Contenido Principal - LAYOUT 3 COLUMNAS + HISTORIAL -->\r\n      <div class=\"flex-1 flex flex-col overflow-hidden\">\r\n        <!-- Upper section with 3 columns -->\r\n        <div class=\"flex-1 flex overflow-hidden min-h-0\">\r\n          <!-- PANEL IZQUIERDO - Info Cliente -->\r\n        <div class=\"w-72 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 shadow-lg overflow-hidden flex flex-col transition-colors duration-300\">\r\n          <!-- Tabs -->\r\n          <div class=\"flex border-b border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-950\">\r\n            @for (tab of tabs; track tab.id) {\r\n              <button\r\n                (click)=\"activeTab.set(tab.id)\"\r\n                [class]=\"'flex-1 px-2 py-1.5 text-[11px] font-semibold transition-all relative ' +\r\n                  (activeTab() === tab.id ? 'text-blue-700 dark:text-blue-200 bg-blue-50 dark:bg-blue-950/50' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800')\"\r\n              >\r\n                {{ tab.label }}\r\n                @if (activeTab() === tab.id) {\r\n                  <div class=\"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-500\"></div>\r\n                }\r\n              </button>\r\n            }\r\n          </div>\r\n\r\n          <!-- Contenido de tabs -->\r\n          <div class=\"flex-1 overflow-y-auto p-2\">\r\n            <div>\r\n              @if (activeTab() === 'cliente') {\r\n                <div class=\"space-y-2\">\r\n                  <!-- Lista vertical de campos (excluyendo contacto que va abajo) -->\r\n                  @for (field of customerOutputFields(); track field.id) {\r\n                    @if (!isContactField(field.field)) {\r\n                      <div class=\"pb-1.5 border-b border-slate-100 dark:border-slate-800\">\r\n                        <div class=\"text-[10px] text-slate-500 dark:text-slate-400 uppercase font-medium\">{{ field.label }}</div>\r\n                        <div class=\"text-[12px] font-semibold text-slate-800 dark:text-white break-words\">\r\n                          {{ formatFieldValue(getFieldValue(field.field), field.format) }}\r\n                        </div>\r\n                      </div>\r\n                    }\r\n                  }\r\n                  @if (customerOutputFields().length === 0) {\r\n                    <div class=\"text-center py-2 text-slate-400 text-[10px]\">\r\n                      Sin campos configurados\r\n                    </div>\r\n                  }\r\n\r\n                  <!-- Informaci√≥n de Contacto -->\r\n                  <div class=\"space-y-1.5 mt-1\">\r\n                    <!-- Tel√©fono Principal -->\r\n                    <div class=\"flex items-center gap-2 p-1.5 bg-green-50 dark:bg-green-950/30 rounded border border-green-200 dark:border-green-800\">\r\n                      <lucide-angular name=\"smartphone\" [size]=\"14\" class=\"text-green-600 dark:text-green-400\"></lucide-angular>\r\n                      <div class=\"flex-1 min-w-0\">\r\n                        <div class=\"text-[9px] text-green-600 dark:text-green-400\">Principal</div>\r\n                        <div class=\"text-[11px] font-bold text-green-700 dark:text-green-300 truncate\">{{ customerData().contacto.telefono_principal }}</div>\r\n                      </div>\r\n                    </div>\r\n                    <!-- Tel√©fono Alternativo -->\r\n                    @if (customerData().contacto.telefono_alternativo) {\r\n                      <div class=\"flex items-center gap-2 p-1.5 bg-slate-50 dark:bg-slate-800 rounded border border-slate-200 dark:border-slate-700\">\r\n                        <lucide-angular name=\"phone\" [size]=\"14\" class=\"text-slate-500 dark:text-slate-400\"></lucide-angular>\r\n                        <div class=\"flex-1 min-w-0\">\r\n                          <div class=\"text-[9px] text-slate-500 dark:text-slate-400\">Alternativo</div>\r\n                          <div class=\"text-[11px] font-semibold text-slate-700 dark:text-slate-300 truncate\">{{ customerData().contacto.telefono_alternativo }}</div>\r\n                        </div>\r\n                      </div>\r\n                    }\r\n                    <!-- Tel√©fono Trabajo -->\r\n                    @if (customerData().contacto.telefono_trabajo) {\r\n                      <div class=\"flex items-center gap-2 p-1.5 bg-slate-50 dark:bg-slate-800 rounded border border-slate-200 dark:border-slate-700\">\r\n                        <lucide-angular name=\"building-2\" [size]=\"14\" class=\"text-slate-500 dark:text-slate-400\"></lucide-angular>\r\n                        <div class=\"flex-1 min-w-0\">\r\n                          <div class=\"text-[9px] text-slate-500 dark:text-slate-400\">Trabajo</div>\r\n                          <div class=\"text-[11px] font-semibold text-slate-700 dark:text-slate-300 truncate\">{{ customerData().contacto.telefono_trabajo }}</div>\r\n                        </div>\r\n                      </div>\r\n                    }\r\n                    <!-- Email -->\r\n                    @if (customerData().contacto.email) {\r\n                      <div class=\"flex items-center gap-2 p-1.5 bg-blue-50 dark:bg-blue-950/30 rounded border border-blue-200 dark:border-blue-800\">\r\n                        <lucide-angular name=\"mail\" [size]=\"14\" class=\"text-blue-500 dark:text-blue-400\"></lucide-angular>\r\n                        <div class=\"flex-1 min-w-0\">\r\n                          <div class=\"text-[9px] text-blue-500 dark:text-blue-400\">Email</div>\r\n                          <div class=\"text-[11px] font-semibold text-blue-700 dark:text-blue-300 truncate\">{{ customerData().contacto.email }}</div>\r\n                        </div>\r\n                      </div>\r\n                    }\r\n                    <!-- Direcci√≥n -->\r\n                    @if (customerData().contacto.direccion) {\r\n                      <div class=\"flex items-center gap-2 p-1.5 bg-orange-50 dark:bg-orange-950/30 rounded border border-orange-200 dark:border-orange-800\">\r\n                        <lucide-angular name=\"map-pin\" [size]=\"14\" class=\"text-orange-500 dark:text-orange-400 flex-shrink-0\"></lucide-angular>\r\n                        <div class=\"flex-1 min-w-0\">\r\n                          <div class=\"text-[9px] text-orange-500 dark:text-orange-400\">Direcci√≥n</div>\r\n                          <div class=\"text-[11px] font-semibold text-orange-700 dark:text-orange-300 line-clamp-2\">{{ customerData().contacto.direccion }}</div>\r\n                        </div>\r\n                      </div>\r\n                    }\r\n                  </div>\r\n                </div>\r\n              }\r\n\r\n              @if (activeTab() === 'historial') {\r\n                <div class=\"space-y-1\">\r\n                  @if (historialGestiones().length === 0) {\r\n                    <div class=\"text-center py-4\">\r\n                      <p class=\"text-[10px] text-gray-400\">Sin gestiones previas</p>\r\n                      <button (click)=\"loadManagementHistory()\" class=\"mt-2 px-2 py-1 bg-blue-500 text-white text-[9px] rounded\">Recargar</button>\r\n                    </div>\r\n                  } @else {\r\n                    @for (gestion of historialGestiones(); track $index) {\r\n                      <div class=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-1.5\">\r\n                        <div class=\"flex justify-between items-center text-[9px]\">\r\n                          <span class=\"font-bold text-gray-600 dark:text-gray-300\">{{ gestion.fecha }}</span>\r\n                          <span class=\"text-gray-400\">{{ gestion.nombreAgente }}</span>\r\n                        </div>\r\n                        <div class=\"text-[10px] font-semibold text-blue-600 dark:text-blue-300 mt-0.5\">{{ gestion.tipificacionCompleta }}</div>\r\n                        <div class=\"text-[9px] text-gray-500 dark:text-gray-400 truncate\">{{ gestion.observacion }}</div>\r\n                        @if (gestion.schedule) {\r\n                          <button (click)=\"openScheduleDetail(gestion.id)\" class=\"text-[8px] text-purple-600 dark:text-purple-400 mt-0.5 hover:underline\">\r\n                            Ver cronograma ‚Üí\r\n                          </button>\r\n                        }\r\n                      </div>\r\n                    }\r\n                  }\r\n                </div>\r\n              }\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Panel Central - ULTRA COMPACTO -->\r\n        <div class=\"flex-1 overflow-y-auto bg-gradient-to-br from-gray-50 via-slate-50 to-blue-50 dark:from-slate-900 dark:via-gray-900 dark:to-slate-900 transition-colors duration-300\">\r\n          <div class=\"p-3 space-y-2\">\r\n            <!-- Control de Llamada - COMPACTO -->\r\n            <div [class]=\"'bg-white dark:bg-gray-800 rounded-lg shadow-md border p-2 transition-colors duration-300 ' + (callActive() ? 'border-green-400 dark:border-green-500' : 'border-gray-200 dark:border-gray-700')\">\r\n              <div class=\"flex items-center justify-between\">\r\n                <h3 class=\"font-bold text-gray-800 dark:text-white flex items-center gap-2 text-xs\">\r\n                  <div [class]=\"'p-1 rounded transition-all duration-300 ' + (callActive() ? 'bg-green-100 dark:bg-green-900/30 animate-pulse' : 'bg-blue-100 dark:bg-blue-900/30')\">\r\n                  </div>\r\n                  Control de Llamada\r\n                </h3>\r\n                <div class=\"flex gap-2\">\r\n                  <button\r\n                    (click)=\"toggleMute()\"\r\n                    [disabled]=\"!callActive()\"\r\n                    [class]=\"'px-4 py-1.5 rounded-lg font-bold flex items-center gap-2 transition-all duration-300 text-xs shadow-md hover:shadow-lg ' +\r\n                      (callActive()\r\n                        ? (isMuted()\r\n                          ? 'bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 text-white'\r\n                          : 'bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white')\r\n                        : 'bg-gray-400 text-gray-200 cursor-not-allowed')\"\r\n                  >\r\n                    {{ isMuted() ? 'üîá Activar' : 'üîä Silenciar' }}\r\n                  </button>\r\n                  <button\r\n                    (click)=\"endCall()\"\r\n                    [disabled]=\"!callActive()\"\r\n                    class=\"px-4 py-1.5 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 disabled:from-gray-400 disabled:to-gray-500 text-white dark:text-white disabled:text-gray-200 rounded-lg font-bold flex items-center gap-2 transition-all duration-300 text-xs shadow-md hover:shadow-lg\"\r\n                  >\r\n                    Finalizar\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            @if (!usesHierarchicalClassifications()) {\r\n            <!-- Resultado de Contacto - COMPACTO -->\r\n            <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 p-2 hover:border-blue-300 dark:hover:border-blue-600 transition-colors duration-300\">\r\n              <label class=\"block font-bold text-gray-800 dark:text-white mb-1 text-[11px] flex items-center gap-1\">\r\n                <div class=\"w-1.5 h-1.5 bg-red-500 rounded-full\"></div>\r\n                Resultado de Contacto *\r\n              </label>\r\n              <div class=\"relative\">\r\n                <select\r\n                  [(ngModel)]=\"managementForm.resultadoContacto\"\r\n                  (ngModelChange)=\"onContactResultChange()\"\r\n                  [class]=\"'w-full p-2 pr-8 border rounded-lg font-semibold text-gray-700 dark:text-white appearance-none cursor-pointer transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-800 hover:border-blue-400 dark:hover:border-blue-600 text-xs ' +\r\n                    (errors().resultadoContacto ? 'border-red-500 bg-red-50 dark:bg-red-950/30 dark:border-red-600' : 'border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900') + ' ' +\r\n                    (managementForm.resultadoContacto ? 'bg-blue-50 dark:bg-blue-950/30 border-blue-400 dark:border-blue-600' : '')\"\r\n                >\r\n                  <option value=\"\">-- Seleccionar resultado --</option>\r\n                  @for (tip of contactClassifications(); track tip.id) {\r\n                    <option [value]=\"tip.id\">[{{ tip.codigo }}] {{ tip.label }}</option>\r\n                  }\r\n                </select>\r\n              </div>\r\n              @if (errors().resultadoContacto) {\r\n                <div class=\"text-red-600 text-[10px] mt-1 flex items-center gap-1\">\r\n                  Requerido\r\n                </div>\r\n              }\r\n            </div>\r\n            }\r\n\r\n            <!-- Alerta de Promesa de Pago Activa - Compacto -->\r\n            @if (activePaymentSchedules() && activePaymentSchedules().length > 0) {\r\n              <div class=\"animate-[slideInDown_0.3s_ease-out]\">\r\n                @for (schedule of activePaymentSchedules(); track schedule.id) {\r\n                  <div class=\"bg-gradient-to-r from-amber-500 via-yellow-500 to-orange-500 dark:from-amber-600 dark:via-yellow-600 dark:to-orange-600 text-white rounded-md shadow-md mb-1.5 overflow-hidden border border-amber-400 dark:border-amber-500\">\r\n                    <!-- Header -->\r\n                    <div class=\"px-3 py-2 bg-black/10 flex items-center justify-between\">\r\n                      <div class=\"flex items-center gap-2\">\r\n                        <div class=\"w-6 h-6 bg-white/20 rounded flex items-center justify-center\">\r\n                          <lucide-angular name=\"alert-triangle\" [size]=\"14\" class=\"text-white\"></lucide-angular>\r\n                        </div>\r\n                        <div>\r\n                          <div class=\"font-bold text-xs\">PROMESA DE PAGO ACTIVA</div>\r\n                          <div class=\"text-[10px] opacity-80\">No puede registrar otra promesa</div>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"flex items-center gap-2\">\r\n                        <button\r\n                          (click)=\"openVoucherPaymentDialog(schedule)\"\r\n                          class=\"px-2.5 py-1 bg-white/20 hover:bg-white/30 rounded text-[11px] font-semibold transition-all flex items-center gap-1 border border-white/30\"\r\n                          title=\"Validar voucher con IA\">\r\n                          <lucide-angular name=\"scan-line\" [size]=\"12\"></lucide-angular>\r\n                          Voucher\r\n                        </button>\r\n                        <div class=\"text-right\">\r\n                          <div class=\"text-base font-bold\">S/ {{ schedule.totalAmount?.toFixed(2) || '0.00' }}</div>\r\n                          <div class=\"text-[10px] opacity-80\">Total</div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <!-- Detalle de cuotas -->\r\n                    <div class=\"px-3 py-2 bg-black/5\">\r\n                      <div class=\"text-[10px] font-semibold mb-1.5 opacity-90\">DETALLE DE CUOTAS:</div>\r\n                      <div class=\"flex flex-wrap gap-1.5\">\r\n                        @for (cuota of schedule.installments; track cuota.numeroCuota) {\r\n                          <div class=\"flex items-center gap-1.5 text-[11px] bg-white/20 rounded px-2 py-1\">\r\n                            <span class=\"font-bold\">C{{ cuota.numeroCuota }}</span>\r\n                            <span class=\"opacity-70\">|</span>\r\n                            @if (tienePagoParcial(cuota)) {\r\n                              <span class=\"text-[10px] opacity-70\">S/ {{ cuota.monto?.toFixed(2) }}</span>\r\n                              <span class=\"font-bold text-xs\">S/ {{ getSaldoPendienteCuota(cuota).toFixed(2) }}</span>\r\n                            } @else {\r\n                              <span class=\"font-bold text-xs\">S/ {{ cuota.monto?.toFixed(2) || '0.00' }}</span>\r\n                            }\r\n                            <span class=\"opacity-70\">|</span>\r\n                            <span class=\"font-medium flex items-center gap-0.5\">\r\n                              <lucide-angular name=\"calendar\" [size]=\"11\"></lucide-angular>\r\n                              {{ formatDate(cuota.dueDate) }}\r\n                            </span>\r\n                            @if (cuota.status === 'PAGADA' || cuota.status === 'PAGADO' || cuota.status === 'CUMPLIDO') {\r\n                              <span class=\"bg-green-600 text-[10px] px-1 py-0.5 rounded font-semibold flex items-center\"><lucide-angular name=\"check\" [size]=\"10\"></lucide-angular></span>\r\n                            } @else if (cuota.status === 'PARCIAL') {\r\n                              <span class=\"bg-amber-500 text-[10px] px-1 py-0.5 rounded font-semibold\">Parcial</span>\r\n                            } @else if (cuota.status === 'VENCIDA' || cuota.status === 'VENCIDO') {\r\n                              <span class=\"bg-red-600 text-[10px] px-1 py-0.5 rounded font-semibold flex items-center\"><lucide-angular name=\"alert-triangle\" [size]=\"10\"></lucide-angular></span>\r\n                            } @else if (cuota.status === 'CANCELADA' || cuota.status === 'CANCELADO') {\r\n                              <span class=\"bg-gray-600 text-[10px] px-1 py-0.5 rounded font-semibold flex items-center\"><lucide-angular name=\"x\" [size]=\"10\"></lucide-angular></span>\r\n                            } @else {\r\n                              <span class=\"bg-blue-600 text-[10px] px-1 py-0.5 rounded font-semibold flex items-center\"><lucide-angular name=\"clock\" [size]=\"10\"></lucide-angular></span>\r\n                            }\r\n                          </div>\r\n                        }\r\n                      </div>\r\n                      @if (schedule.cuotasPendientes > 0 && schedule.nextDueDate) {\r\n                        <div class=\"mt-1.5 text-[10px] opacity-80\">\r\n                          <span class=\"font-semibold\">{{ schedule.cuotasPendientes }}</span> pendiente(s) ¬∑ Pr√≥x: <span class=\"font-semibold\">{{ formatDate(schedule.nextDueDate) }}</span>\r\n                        </div>\r\n                      }\r\n                    </div>\r\n                  </div>\r\n                }\r\n              </div>\r\n            }\r\n\r\n            <!-- Tipo de Gesti√≥n - DROPDOWNS EN L√çNEA -->\r\n            @if (usesHierarchicalClassifications()) {\r\n              <div class=\"bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 p-3\">\r\n                <div class=\"text-[10px] font-bold text-gray-600 dark:text-gray-300 uppercase mb-2\">Clasificaci√≥n</div>\r\n                <div class=\"flex flex-wrap gap-2\">\r\n                  @for (level of hierarchyLevels(); track $index) {\r\n                    @if (shouldShowLevel($index)) {\r\n                      <div class=\"flex-1 min-w-[140px]\">\r\n                        <label class=\"block text-[9px] text-gray-500 dark:text-gray-400 mb-0.5\">\r\n                          {{ getDynamicLevelLabel($index) }}{{ $index === 0 ? ' *' : '' }}\r\n                        </label>\r\n                        <select\r\n                          [ngModel]=\"selectedClassifications()[$index]\"\r\n                          (ngModelChange)=\"onClassificationLevelChange($index, $event)\"\r\n                          [class]=\"'w-full p-1.5 border rounded text-[11px] font-medium transition-all focus:outline-none focus:ring-1 focus:ring-blue-400 ' +\r\n                            (errors().tipoGestion && $index === 0 ? 'border-red-400 bg-red-50 dark:bg-red-950/30' : 'border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 text-gray-700 dark:text-white') + ' ' +\r\n                            (selectedClassifications()[$index] ? 'border-green-400 bg-green-50 dark:bg-green-950/30' : '')\"\r\n                        >\r\n                          <option value=\"\">Seleccionar...</option>\r\n                          @for (option of level; track option.id) {\r\n                            <option [value]=\"option.id\">[{{ option.codigo }}] {{ option.label }}</option>\r\n                          }\r\n                        </select>\r\n                      </div>\r\n                    }\r\n                  }\r\n                </div>\r\n                @if (errors().tipoGestion) {\r\n                  <div class=\"text-red-500 text-[9px] mt-1\">Seleccione una clasificaci√≥n</div>\r\n                }\r\n              </div>\r\n            }\r\n\r\n            <!-- Secci√≥n de Campos Din√°micos - NUEVA -->\r\n            @if (isLoadingDynamicFields()) {\r\n              <div class=\"bg-indigo-50 dark:bg-indigo-950/20 border border-indigo-200 dark:border-indigo-900/50 rounded-lg shadow-md p-3\">\r\n                <div class=\"flex items-center justify-center gap-2 text-indigo-600 dark:text-indigo-400\">\r\n                  <span class=\"text-xs\">Cargando campos adicionales...</span>\r\n                </div>\r\n              </div>\r\n            }\r\n            \r\n            @if (!isLoadingDynamicFields() && isLeafClassification() && dynamicFields().length === 0) {\r\n              <div class=\"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-700 rounded-lg shadow-md p-3\">\r\n                <div class=\"flex items-center justify-center gap-2 text-gray-500 dark:text-gray-400\">\r\n                  <span class=\"text-xs\">Esta clasificaci√≥n no tiene campos adicionales configurados</span>\r\n                </div>\r\n              </div>\r\n            }\r\n\r\n            <!-- Componente de Campos Din√°micos -->\r\n            @if (!isLoadingDynamicFields() && isLeafClassification() && dynamicFieldsSchema()) {\r\n              <app-dynamic-field-renderer\r\n                #dynamicFieldRendererComponent\r\n                [schema]=\"dynamicFieldsSchema()\"\r\n                [externalUpdates]=\"externalFieldUpdates()\"\r\n                [selectedClassification]=\"selectedClassification()\"\r\n                [customerAmounts]=\"customerPaymentAmounts()\"\r\n                (dataChange)=\"onDynamicFieldsChange($event)\"\r\n                (customAmountDetected)=\"onCustomAmountDetected($event)\"\r\n              />\r\n            }\r\n\r\n            <!-- Schedule Helper - Payment Schedule Information -->\r\n            @if (isLoadingSchedules()) {\r\n              <div class=\"bg-purple-50 dark:bg-purple-950/20 border border-purple-200 dark:border-purple-900/50 rounded-lg shadow-md p-3 animate-pulse\">\r\n                <div class=\"flex items-center justify-center gap-2 text-purple-600 dark:text-purple-400\">\r\n                  <span class=\"text-xs font-semibold\">Cargando cronogramas pendientes...</span>\r\n                </div>\r\n              </div>\r\n            }\r\n\r\n            @if (!isLoadingSchedules() && showScheduleHelper() && activeSchedules().length > 0) {\r\n              <div class=\"bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-950/30 dark:to-indigo-950/30 border-2 border-purple-300 dark:border-purple-700 rounded-lg shadow-lg p-3 space-y-2\">\r\n                <div class=\"flex items-center justify-between\">\r\n                  <div class=\"flex items-center gap-2\">\r\n                    <div class=\"p-1.5 bg-purple-500 dark:bg-purple-600 rounded\">\r\n                    </div>\r\n                    <div>\r\n                      <h4 class=\"text-xs font-bold text-purple-900 dark:text-purple-100\">Cronograma Activo Detectado</h4>\r\n                      <p class=\"text-[9px] text-purple-600 dark:text-purple-300\">Cliente tiene {{ activeSchedules().length }} cronograma(s) pendiente(s)</p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                @for (schedule of activeSchedules(); track schedule.id) {\r\n                  <div class=\"bg-white dark:bg-gray-800 rounded-lg border border-purple-200 dark:border-purple-700 p-2 space-y-2\">\r\n                    <!-- Schedule Summary -->\r\n                    <div class=\"flex items-center justify-between\">\r\n                      <div class=\"flex items-center gap-2\">\r\n                        <div class=\"text-xs font-bold text-purple-900 dark:text-purple-100\">\r\n                          {{ schedule.scheduleType || 'CRONOGRAMA' }}\r\n                        </div>\r\n                        <div class=\"text-[9px] px-1.5 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded font-semibold\">\r\n                          ACTIVO\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"text-xs font-bold text-purple-900 dark:text-purple-100\">\r\n                        S/ {{ schedule.totalAmount | number:'1.2-2' }}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <!-- Pending Installments -->\r\n                    <div class=\"space-y-1\">\r\n                      <div class=\"text-[9px] font-bold text-gray-600 dark:text-gray-300 uppercase\">Cuotas Pendientes</div>\r\n                      @for (installment of getPendingInstallments(schedule); track installment.id; let idx = $index) {\r\n                        @if (idx < 3) {\r\n                          <div class=\"flex items-center justify-between text-[10px] bg-gray-50 dark:bg-gray-900 p-1.5 rounded\">\r\n                            <div class=\"flex items-center gap-2\">\r\n                              <span class=\"font-semibold text-gray-700 dark:text-gray-300\">Cuota #{{ installment.installmentNumber }}</span>\r\n                              <span class=\"text-gray-500 dark:text-gray-400\">Vence: {{ formatDate(installment.dueDate) }}</span>\r\n                            </div>\r\n                            <span class=\"font-bold text-purple-700 dark:text-purple-300\">S/ {{ installment.amount | number:'1.2-2' }}</span>\r\n                          </div>\r\n                        }\r\n                      }\r\n                      @if (getPendingInstallments(schedule).length > 3) {\r\n                        <div class=\"text-[9px] text-center text-gray-500 dark:text-gray-400 italic\">\r\n                          + {{ getPendingInstallments(schedule).length - 3 }} cuotas m√°s\r\n                        </div>\r\n                      }\r\n                    </div>\r\n\r\n                    <!-- Quick Actions -->\r\n                    <div class=\"flex gap-2 pt-1\">\r\n                      <!-- Bot√≥n Usar Pr√≥xima Cuota - Mostrar si allowsInstallmentSelection es true -->\r\n                      @if (selectedClassification()?.allowsInstallmentSelection === true) {\r\n                        <button\r\n                          type=\"button\"\r\n                          (click)=\"applyNextInstallmentPayment()\"\r\n                          class=\"flex-1 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 dark:bg-purple-700 dark:hover:bg-purple-600 text-white text-[10px] font-bold rounded transition-colors flex items-center justify-center gap-1\">\r\n                          Usar Pr√≥xima Cuota\r\n                        </button>\r\n                      }\r\n\r\n                      <!-- Bot√≥n Pagar Todo - Mostrar si suggestsFullAmount es true -->\r\n                      @if (selectedClassification()?.suggestsFullAmount === true) {\r\n                        <button\r\n                          type=\"button\"\r\n                          (click)=\"applyFullSchedulePayment()\"\r\n                          class=\"flex-1 px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-700 dark:hover:bg-indigo-600 text-white text-[10px] font-bold rounded transition-colors flex items-center justify-center gap-1\">\r\n                          Pagar Todo (S/ {{ calculatePendingAmount(schedule) | number:'1.2-2' }})\r\n                        </button>\r\n                      }\r\n                    </div>\r\n\r\n                    <!-- Info Note -->\r\n                    <div class=\"text-[9px] text-purple-600 dark:text-purple-400 bg-purple-100 dark:bg-purple-900/20 p-1.5 rounded flex items-start gap-1\">\r\n                      <span>El pago se aplicar√° autom√°ticamente a las cuotas pendientes en orden de vencimiento</span>\r\n                    </div>\r\n                  </div>\r\n                }\r\n              </div>\r\n            }\r\n\r\n            <!-- Selector de Cuota para Cancelaci√≥n -->\r\n            @if (isCancellationTypification() && (pendingInstallmentsForCancellation().length > 0 || overdueInstallments().length > 0)) {\r\n              <div class=\"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/30 dark:to-emerald-950/30 border border-green-200 dark:border-green-800 rounded-lg p-3 space-y-2\">\r\n                <div class=\"flex items-center gap-2\">\r\n                  <span class=\"text-lg\">üí∞</span>\r\n                  <div>\r\n                    <h4 class=\"text-xs font-bold text-green-900 dark:text-green-100\">Seleccionar Cuota a Cancelar</h4>\r\n                    <p class=\"text-[9px] text-green-600 dark:text-green-300\">Elija qu√© cuota de la promesa de pago est√° cancelando</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <!-- Cuotas disponibles para cancelar -->\r\n                @if (pendingInstallmentsForCancellation().length > 0) {\r\n                  <div class=\"space-y-1.5\">\r\n                    @for (cuota of pendingInstallmentsForCancellation(); track cuota.numeroCuota) {\r\n                      <label\r\n                        class=\"flex items-center justify-between p-2 rounded-lg cursor-pointer transition-all\"\r\n                        [class]=\"selectedInstallmentForCancellation()?.numeroCuota === cuota.numeroCuota\r\n                          ? 'bg-green-500 text-white shadow-md'\r\n                          : 'bg-white dark:bg-gray-800 hover:bg-green-100 dark:hover:bg-green-900/30 border border-green-200 dark:border-green-700'\"\r\n                      >\r\n                        <div class=\"flex items-center gap-3\">\r\n                          <input\r\n                            type=\"radio\"\r\n                            name=\"cuotaCancelacion\"\r\n                            [value]=\"cuota\"\r\n                            [checked]=\"selectedInstallmentForCancellation()?.numeroCuota === cuota.numeroCuota\"\r\n                            (change)=\"onSelectCuotaForCancellation(cuota)\"\r\n                            class=\"w-4 h-4 text-green-600\"\r\n                          />\r\n                          <div>\r\n                            <span class=\"font-bold text-xs\">Cuota {{ cuota.numeroCuota }}</span>\r\n                            <span class=\"text-[10px] ml-2\" [class]=\"selectedInstallmentForCancellation()?.numeroCuota === cuota.numeroCuota ? 'text-green-100' : 'text-gray-500 dark:text-gray-400'\">\r\n                              Vence: {{ formatDate(cuota.dueDate) }}\r\n                            </span>\r\n                            @if (tienePagoParcial(cuota)) {\r\n                              <span class=\"text-[9px] ml-1 px-1 py-0.5 rounded\" [class]=\"selectedInstallmentForCancellation()?.numeroCuota === cuota.numeroCuota ? 'bg-green-400 text-white' : 'bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-300'\">Parcial</span>\r\n                            }\r\n                          </div>\r\n                        </div>\r\n                        <div class=\"text-right\">\r\n                          @if (tienePagoParcial(cuota)) {\r\n                            <span class=\"text-xs opacity-70 mr-1\">S/ {{ cuota.monto?.toFixed(2) }}</span>\r\n                            <span class=\"font-bold text-sm\">S/ {{ getSaldoPendienteCuota(cuota).toFixed(2) }}</span>\r\n                          } @else {\r\n                            <span class=\"font-bold text-sm\">S/ {{ cuota.monto?.toFixed(2) || '0.00' }}</span>\r\n                          }\r\n                        </div>\r\n                      </label>\r\n                    }\r\n                  </div>\r\n                }\r\n\r\n                <!-- Cuotas VENCIDAS (no se pueden cancelar) -->\r\n                @if (overdueInstallments().length > 0) {\r\n                  <div class=\"mt-3 pt-3 border-t border-red-200 dark:border-red-800\">\r\n                    <div class=\"flex items-center gap-2 mb-2\">\r\n                      <span class=\"text-sm\">‚õî</span>\r\n                      <span class=\"text-[10px] font-bold text-red-700 dark:text-red-400\">CUOTAS VENCIDAS (No se pueden cancelar)</span>\r\n                    </div>\r\n                    <div class=\"space-y-1\">\r\n                      @for (cuota of overdueInstallments(); track cuota.numeroCuota) {\r\n                        <div class=\"flex items-center justify-between p-2 rounded-lg bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 opacity-75\">\r\n                          <div class=\"flex items-center gap-3\">\r\n                            <span class=\"text-red-500 dark:text-red-400 text-xs\">‚úó</span>\r\n                            <div>\r\n                              <span class=\"font-bold text-xs text-red-800 dark:text-red-300\">Cuota {{ cuota.numeroCuota }}</span>\r\n                              <span class=\"text-[10px] ml-2 text-red-600 dark:text-red-400\">\r\n                                Venci√≥: {{ formatDate(cuota.dueDate) }}\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n                          <span class=\"font-bold text-sm text-red-700 dark:text-red-400\">S/ {{ cuota.monto?.toFixed(2) || '0.00' }}</span>\r\n                        </div>\r\n                      }\r\n                    </div>\r\n                    <div class=\"text-[9px] text-red-600 dark:text-red-400 mt-2\">\r\n                      La fecha de pago ya pas√≥. Estas cuotas ser√°n marcadas como promesa rota.\r\n                    </div>\r\n                  </div>\r\n                }\r\n\r\n                <!-- Mensaje cuando no hay cuotas disponibles para cancelar -->\r\n                @if (pendingInstallmentsForCancellation().length === 0 && overdueInstallments().length > 0) {\r\n                  <div class=\"text-[10px] text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-2 rounded flex items-center gap-1\">\r\n                    <span>üö´</span>\r\n                    <span>No hay cuotas disponibles para cancelar. Todas las cuotas est√°n vencidas.</span>\r\n                  </div>\r\n                } @else if (!selectedInstallmentForCancellation() && pendingInstallmentsForCancellation().length > 0) {\r\n                  <div class=\"text-[10px] text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/20 p-2 rounded flex items-center gap-1\">\r\n                    <span>‚ö†Ô∏è</span>\r\n                    <span>Debe seleccionar una cuota para registrar la cancelaci√≥n</span>\r\n                  </div>\r\n                }\r\n\r\n                <!-- Campos editables de monto y fecha cuando hay cuota seleccionada -->\r\n                @if (selectedInstallmentForCancellation()) {\r\n                  <div class=\"mt-3 pt-3 border-t border-green-200 dark:border-green-700\">\r\n                    <div class=\"flex items-center gap-2 mb-2\">\r\n                      <span class=\"text-sm\">‚úèÔ∏è</span>\r\n                      <span class=\"text-[10px] font-bold text-green-800 dark:text-green-300\">Datos del Pago (editables)</span>\r\n                    </div>\r\n                    <div class=\"grid grid-cols-2 gap-3\">\r\n                      <!-- Monto pagado -->\r\n                      <div>\r\n                        <label class=\"block text-[10px] font-semibold text-green-700 dark:text-green-300 mb-1\">Monto Pagado</label>\r\n                        <div class=\"relative\">\r\n                          <span class=\"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-gray-500 dark:text-gray-400\">S/</span>\r\n                          <input\r\n                            type=\"number\"\r\n                            step=\"0.01\"\r\n                            min=\"0\"\r\n                            [value]=\"montoPagoEditable()\"\r\n                            (input)=\"onMontoPagoChange($event)\"\r\n                            class=\"w-full pl-7 pr-2 py-1.5 text-sm font-semibold rounded-lg border border-green-300 dark:border-green-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-green-500\"\r\n                          />\r\n                        </div>\r\n                        <p class=\"text-[10px] text-green-700 dark:text-green-300 mt-0.5 font-medium\">\r\n                          Pendiente: S/ {{ tienePagoParcial(selectedInstallmentForCancellation()) ? getSaldoPendienteCuota(selectedInstallmentForCancellation()).toFixed(2) : selectedInstallmentForCancellation()?.monto?.toFixed(2) }}\r\n                        </p>\r\n                      </div>\r\n                      <!-- Fecha del pago -->\r\n                      <div>\r\n                        <label class=\"block text-[10px] font-semibold text-green-700 dark:text-green-300 mb-1\">Fecha del Pago</label>\r\n                        <input\r\n                          type=\"date\"\r\n                          [value]=\"fechaPagoEditable()\"\r\n                          (input)=\"onFechaPagoChange($event)\"\r\n                          class=\"w-full px-2 py-1.5 text-sm rounded-lg border border-green-300 dark:border-green-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-green-500\"\r\n                        />\r\n                        <p class=\"text-[9px] text-green-600 dark:text-green-400 mt-0.5\">\r\n                          Por defecto: hoy\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <!-- Info de distribuci√≥n si el monto es diferente -->\r\n                    @if (montoPagoEditable() !== selectedInstallmentForCancellation()?.monto) {\r\n                      <div class=\"mt-2 p-2 rounded-lg text-[10px]\"\r\n                           [class]=\"montoPagoEditable() < selectedInstallmentForCancellation()?.monto\r\n                             ? 'bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-300 border border-amber-200 dark:border-amber-700'\r\n                             : 'bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700'\">\r\n                        @if (montoPagoEditable() < selectedInstallmentForCancellation()?.monto) {\r\n                          <span class=\"flex items-center gap-1\">\r\n                            <span>‚ö†Ô∏è</span>\r\n                            <span><strong>Pago parcial:</strong> La cuota quedar√° con saldo pendiente de S/ {{ (selectedInstallmentForCancellation()?.monto - montoPagoEditable()).toFixed(2) }}</span>\r\n                          </span>\r\n                        } @else {\r\n                          <span class=\"flex items-center gap-1\">\r\n                            <span>‚ÑπÔ∏è</span>\r\n                            <span><strong>Pago mayor:</strong> El excedente de S/ {{ (montoPagoEditable() - selectedInstallmentForCancellation()?.monto).toFixed(2) }} se aplicar√° a las siguientes cuotas</span>\r\n                          </span>\r\n                        }\r\n                      </div>\r\n                    }\r\n                  </div>\r\n                }\r\n              </div>\r\n            }\r\n\r\n            <!-- Bot√≥n para subir comprobante (opcional) -->\r\n            @if (isCancellationTypification() && selectedInstallmentForCancellation()) {\r\n              <div class=\"bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-purple-950/30 dark:to-indigo-950/30 border border-purple-200 dark:border-purple-800 rounded-lg p-3\">\r\n                <div class=\"flex items-center justify-between\">\r\n                  <div class=\"flex items-center gap-2\">\r\n                    <span class=\"text-lg\">üìé</span>\r\n                    <div>\r\n                      <h4 class=\"text-xs font-bold text-purple-900 dark:text-purple-100\">Comprobante de Pago</h4>\r\n                      <p class=\"text-[9px] text-purple-600 dark:text-purple-300\">Opcional: Sube una imagen del voucher para validaci√≥n OCR</p>\r\n                    </div>\r\n                  </div>\r\n                  <button\r\n                    type=\"button\"\r\n                    (click)=\"openComprobanteUploadDialog()\"\r\n                    class=\"px-3 py-1.5 text-xs font-medium rounded-lg transition-all\"\r\n                    [class]=\"uploadedComprobante()\r\n                      ? 'bg-green-500 hover:bg-green-600 text-white'\r\n                      : 'bg-purple-600 hover:bg-purple-700 text-white'\"\r\n                  >\r\n                    @if (uploadedComprobante()) {\r\n                      ‚úÖ Comprobante Subido\r\n                    } @else {\r\n                      üì§ Subir Comprobante\r\n                    }\r\n                  </button>\r\n                </div>\r\n                @if (uploadedComprobante()) {\r\n                  <div class=\"mt-2 p-2 bg-white dark:bg-gray-800 rounded text-[10px] space-y-1\">\r\n                    <p class=\"text-gray-600 dark:text-gray-400\">{{ uploadedComprobante()?.mensaje }}</p>\r\n                    @if (uploadedComprobante()?.ocrResult?.monto) {\r\n                      <p><strong>Monto detectado:</strong> S/ {{ uploadedComprobante()?.ocrResult?.monto | number:'1.2-2' }}</p>\r\n                    }\r\n                    @if (uploadedComprobante()?.ocrResult?.banco) {\r\n                      <p><strong>Banco:</strong> {{ uploadedComprobante()?.ocrResult?.banco }}</p>\r\n                    }\r\n                    <button\r\n                      type=\"button\"\r\n                      (click)=\"uploadedComprobante.set(null)\"\r\n                      class=\"text-red-500 hover:text-red-700 text-[9px] underline\"\r\n                    >\r\n                      Quitar comprobante\r\n                    </button>\r\n                  </div>\r\n                }\r\n              </div>\r\n            }\r\n\r\n            <!-- Botones de Acci√≥n - COMPACTOS -->\r\n            <div class=\"flex gap-2 pt-2\">\r\n              @if (requiresAuthorization()) {\r\n                <!-- Bot√≥n de Solicitar Autorizaci√≥n (cuando es monto personalizado) -->\r\n                <button\r\n                  (click)=\"openSupervisorSelectionModal()\"\r\n                  [disabled]=\"saving() || !isFormValid() || waitingForAuthorization()\"\r\n                  class=\"flex-1 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 disabled:from-gray-400 disabled:to-gray-500 text-white dark:text-white disabled:text-gray-200 py-2 px-4 rounded-lg font-bold text-xs flex items-center justify-center gap-2 transition-all duration-300 shadow-lg hover:shadow-xl disabled:cursor-not-allowed\"\r\n                >\r\n                  @if (waitingForAuthorization()) {\r\n                    <span class=\"animate-pulse\">‚è≥ Esperando Autorizaci√≥n...</span>\r\n                  } @else {\r\n                    üîê Solicitar Autorizaci√≥n\r\n                  }\r\n                </button>\r\n              } @else {\r\n                <!-- Bot√≥n Normal de Guardar -->\r\n                <button\r\n                  (click)=\"saveManagement()\"\r\n                  [disabled]=\"saving() || !isFormValid() || (isCancellationTypification() && (pendingInstallmentsForCancellation().length > 0 || overdueInstallments().length > 0) && !selectedInstallmentForCancellation()) || (isCancellationTypification() && pendingInstallmentsForCancellation().length === 0 && overdueInstallments().length > 0)\"\r\n                  [title]=\"'Guardando: ' + saving() + ' | V√°lido: ' + isFormValid()\"\r\n                  class=\"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 disabled:from-gray-400 disabled:to-gray-500 text-white dark:text-white disabled:text-gray-200 py-2 px-4 rounded-lg font-bold text-xs flex items-center justify-center gap-2 transition-all duration-300 shadow-lg hover:shadow-xl disabled:cursor-not-allowed\"\r\n                >\r\n                  @if (saving()) {\r\n                    Guardando...\r\n                  } @else {\r\n                    Guardar Gesti√≥n\r\n                  }\r\n                </button>\r\n              }\r\n              <button\r\n                (click)=\"cancelarTipificacion()\"\r\n                class=\"px-6 bg-gradient-to-r from-gray-400 to-gray-500 hover:from-gray-500 hover:to-gray-600 text-white dark:text-white py-2 rounded-lg font-bold text-xs flex items-center justify-center gap-2 transition-all duration-300 shadow-md hover:shadow-lg\"\r\n              >\r\n                Cancelar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- PANEL DERECHO - Resumen Deuda y Montos -->\r\n        <div class=\"w-72 bg-white dark:bg-slate-900 border-l border-slate-200 dark:border-slate-800 shadow-lg overflow-hidden flex flex-col transition-colors duration-300\">\r\n          <!-- Resumen R√°pido Deuda -->\r\n          <div class=\"p-2 bg-red-100 dark:bg-red-950/20\">\r\n            <div class=\"text-center\">\r\n              <div class=\"text-[9px] uppercase font-bold\" [ngClass]=\"themeService.isDarkMode() ? 'text-red-400' : 'text-red-800'\">{{ getPrimaryAmountLabel() }}</div>\r\n              <div class=\"text-xl font-black\" [ngClass]=\"themeService.isDarkMode() ? 'text-red-400' : 'text-red-800'\">{{ formatCurrency(getPrimaryAmountValue()) }}</div>\r\n              <div class=\"text-[11px] font-semibold\" [ngClass]=\"themeService.isDarkMode() ? 'text-orange-400' : 'text-orange-700'\">{{ clientDiasMora() }} d√≠as mora</div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Montos de la Cuenta -->\r\n          <div class=\"p-2 flex-1 overflow-y-auto\">\r\n            @if (clientAmountFields().length > 0) {\r\n              <div class=\"space-y-1.5\">\r\n                @for (field of clientAmountFields(); track field.field; let i = $index) {\r\n                  <div class=\"flex justify-between items-center py-1 px-2 rounded text-xs\"\r\n                       [class]=\"getAmountRowClass(i)\">\r\n                    <span class=\"truncate mr-2 font-medium\" [ngClass]=\"themeService.isDarkMode() ? 'text-red-300' : 'text-red-800'\">{{ field.label }}</span>\r\n                    <span class=\"font-bold whitespace-nowrap text-sm\" [ngClass]=\"themeService.isDarkMode() ? 'text-red-300' : 'text-red-800'\">\r\n                      {{ formatCurrency(field.value) }}\r\n                    </span>\r\n                  </div>\r\n                }\r\n              </div>\r\n            }\r\n          </div>\r\n        </div>\r\n        </div>\r\n\r\n        <!-- SECCION DE HISTORIAL DE GESTIONES - Compacto -->\r\n        <div class=\"h-44 bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex flex-col transition-colors duration-300\">\r\n          <div class=\"px-3 py-1.5 bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between\">\r\n            <div class=\"flex items-center gap-2\">\r\n              <span class=\"text-sm\">üìã</span>\r\n              <h3 class=\"text-xs font-bold text-slate-700 dark:text-slate-200\">Historial de Gestiones</h3>\r\n              <span class=\"text-[10px] text-slate-500 dark:text-slate-400\">({{ historialGestiones().length }} registros)</span>\r\n            </div>\r\n            <button (click)=\"loadManagementHistory()\" class=\"text-[10px] text-blue-600 dark:text-blue-400 hover:underline flex items-center gap-1\">\r\n              <span>‚Üª</span> Actualizar\r\n            </button>\r\n          </div>\r\n          <div class=\"flex-1 overflow-auto\">\r\n            @if (historialGestiones().length === 0) {\r\n              <div class=\"flex items-center justify-center h-full text-slate-400 dark:text-slate-500 text-xs\">\r\n                Sin gestiones registradas para este cliente\r\n              </div>\r\n            } @else {\r\n              <table class=\"w-full text-[10px]\">\r\n                <thead class=\"bg-slate-100 dark:bg-slate-800 sticky top-0\">\r\n                  <tr class=\"text-left text-slate-600 dark:text-slate-300\">\r\n                    <th class=\"px-2 py-1 font-semibold\">Fecha</th>\r\n                    <th class=\"px-2 py-1 font-semibold\">Agente</th>\r\n                    <th class=\"px-2 py-1 font-semibold\">Tipificaci√≥n</th>\r\n                    <th class=\"px-2 py-1 font-semibold\">Tel√©fono</th>\r\n                    <th class=\"px-2 py-1 font-semibold\">Observaci√≥n</th>\r\n                    <th class=\"px-2 py-1 font-semibold\">Canal</th>\r\n                    <th class=\"px-2 py-1 font-semibold\">M√©todo</th>\r\n                    <th class=\"px-2 py-1 font-semibold text-right\">Monto Promesa</th>\r\n                    <th class=\"px-2 py-1 font-semibold text-center\">Estado Pago</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  @for (gestion of historialGestiones(); track gestion.id) {\r\n                    <tr class=\"border-b border-slate-100 dark:border-slate-700/50 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors\">\r\n                      <td class=\"px-2 py-1.5 text-slate-600 dark:text-slate-300 whitespace-nowrap\">{{ gestion.fecha }}</td>\r\n                      <td class=\"px-2 py-1.5 text-slate-700 dark:text-slate-200 font-medium whitespace-nowrap\" [title]=\"gestion.nombreAgente\">{{ gestion.nombreAgente }}</td>\r\n                      <td class=\"px-2 py-1.5 max-w-[180px]\">\r\n                        <span class=\"text-blue-600 dark:text-blue-400 font-medium truncate block\" [title]=\"gestion.tipificacionCompleta\">\r\n                          {{ gestion.tipificacionCompleta }}\r\n                        </span>\r\n                      </td>\r\n                      <td class=\"px-2 py-1.5 text-slate-600 dark:text-slate-300 font-mono whitespace-nowrap\">{{ gestion.telefono || '-' }}</td>\r\n                      <td class=\"px-2 py-1.5 text-slate-500 dark:text-slate-400 max-w-[120px] truncate\" [title]=\"gestion.observacion\">\r\n                        {{ gestion.observacion || '-' }}\r\n                      </td>\r\n                      <td class=\"px-2 py-1.5\">\r\n                        <span [class]=\"'px-1.5 py-0.5 rounded text-[9px] font-semibold ' +\r\n                          (gestion.canal?.includes('SALIENTE') ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300' :\r\n                           gestion.canal?.includes('ENTRANTE') ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300' :\r\n                           gestion.canal === 'WHATSAPP' ? 'bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300' :\r\n                           gestion.canal === 'SMS' ? 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300' :\r\n                           'bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300')\">\r\n                          {{ gestion.canalDisplay }}\r\n                        </span>\r\n                      </td>\r\n                      <td class=\"px-2 py-1.5\">\r\n                        <span [class]=\"'px-1.5 py-0.5 rounded text-[9px] font-semibold ' +\r\n                          (gestion.metodo === 'GESTION_MANUAL' ? 'bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300' :\r\n                           gestion.metodo === 'GESTION_PROGRESIVO' ? 'bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300' :\r\n                           gestion.metodo === 'GESTION_PREDICTIVO' ? 'bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300' :\r\n                           'bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300')\">\r\n                          {{ gestion.metodoDisplay }}\r\n                        </span>\r\n                      </td>\r\n                      <td class=\"px-2 py-1.5 text-right font-mono whitespace-nowrap\">\r\n                        @if (gestion.montoPromesa && gestion.montoPromesa > 0) {\r\n                          <span class=\"text-green-600 dark:text-green-400 font-semibold\">S/ {{ gestion.montoPromesa | number:'1.2-2' }}</span>\r\n                        } @else {\r\n                          <span class=\"text-slate-400 dark:text-slate-600\">-</span>\r\n                        }\r\n                      </td>\r\n                      <td class=\"px-2 py-1.5 text-center\">\r\n                        @if (gestion.estadoPago) {\r\n                          <span [class]=\"'px-1.5 py-0.5 rounded text-[9px] font-semibold ' +\r\n                            (gestion.estadoPago === 'PAGADA' ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300' :\r\n                             gestion.estadoPago === 'PENDIENTE' ? 'bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300' :\r\n                             gestion.estadoPago === 'VENCIDA' ? 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300' :\r\n                             gestion.estadoPago === 'PARCIAL' ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300' :\r\n                             'bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300')\">\r\n                            {{ gestion.estadoPagoDisplay }}\r\n                          </span>\r\n                        } @else {\r\n                          <span class=\"text-slate-400 dark:text-slate-600\">-</span>\r\n                        }\r\n                      </td>\r\n                    </tr>\r\n                  }\r\n                </tbody>\r\n              </table>\r\n            }\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Modal de Cronograma Detallado -->\r\n      @if (showScheduleDetail() && scheduleManagementId()) {\r\n        <div class=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fadeIn\">\r\n          <div class=\"bg-white dark:bg-slate-900 rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col animate-slideInUp\">\r\n            <!-- Header del modal -->\r\n            <div class=\"bg-gradient-to-r from-purple-600 to-purple-700 dark:from-purple-700 dark:to-purple-800 text-white px-6 py-4 flex items-center justify-between\">\r\n              <div class=\"flex items-center gap-3\">\r\n                <div>\r\n                  <h2 class=\"text-lg font-bold\">Cronograma de Pagos</h2>\r\n                  <p class=\"text-sm opacity-90\">Gesti√≥n {{ scheduleManagementId() }}</p>\r\n                </div>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                (click)=\"closeScheduleDetail()\"\r\n                class=\"p-2 hover:bg-white/20 rounded-lg transition-colors\">\r\n              </button>\r\n            </div>\r\n\r\n            <!-- Contenido del modal -->\r\n            <div class=\"flex-1 overflow-y-auto p-6\">\r\n              <app-payment-schedule-view [managementId]=\"scheduleManagementId()!\" />\r\n            </div>\r\n\r\n            <!-- Footer del modal -->\r\n            <div class=\"px-6 py-4 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700 flex justify-end\">\r\n              <button\r\n                type=\"button\"\r\n                (click)=\"closeScheduleDetail()\"\r\n                class=\"px-4 py-2 text-sm font-semibold text-slate-700 dark:text-slate-300\r\n                       hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors\">\r\n                Cerrar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      }\r\n\r\n      <!-- Modal de Selecci√≥n de Supervisor para Autorizaci√≥n -->\r\n      <app-select-supervisor-modal\r\n        [(visible)]=\"showSupervisorModal\"\r\n        (supervisorSelected)=\"onSupervisorSelected($event)\"\r\n        (cancelled)=\"onSupervisorSelectionCancelled()\">\r\n      </app-select-supervisor-modal>\r\n    </div>\r\n  `,\r\n  styles: [`\r\n    @keyframes slideInRight {\r\n      from {\r\n        transform: translateX(100%);\r\n        opacity: 0;\r\n      }\r\n      to {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n      }\r\n    }\r\n\r\n    @keyframes fadeIn {\r\n      from {\r\n        opacity: 0;\r\n        transform: translateY(10px);\r\n      }\r\n      to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n      }\r\n    }\r\n\r\n    @keyframes slideInUp {\r\n      from {\r\n        opacity: 0;\r\n        transform: translateY(20px);\r\n      }\r\n      to {\r\n        opacity: 1;\r\n        transform: translateY(0);\r\n      }\r\n    }\r\n  `]\r\n})\r\nexport class CollectionManagementPage implements OnInit, OnDestroy {\r\n  protected callActive = signal(false);\r\n  protected callDuration = signal(0);\r\n  protected saving = signal(false);\r\n  protected showScheduleDetail = signal(false);\r\n  protected scheduleManagementId = signal<number | null>(null);\r\n  protected showOutputSelector = false; // Para el dropdown de campos del cliente\r\n  protected errors = signal<ValidationErrors>({});\r\n  protected showSuccess = signal(false);\r\n  protected animateEntry = signal(true);\r\n  protected activeTab = signal('cliente');\r\n  protected isTipifying = signal(false); // Bloquea llamadas entrantes durante tipificaci√≥n\r\n\r\n  // Signals para indicador de umbral de tiempo (reloj de alarma)\r\n  protected colorIndicador = signal<'verde' | 'amarillo' | 'rojo'>('verde');\r\n  protected excedeTiempoMaximo = signal(false);\r\n  private agentStatusSubscription?: Subscription;\r\n\r\n  // Signals para autorizaci√≥n de montos personalizados\r\n  protected requiresAuthorization = signal(false);\r\n  protected waitingForAuthorization = signal(false);\r\n  showSupervisorModal = false;\r\n  private currentAuthorizationData: CrearSolicitudRequest | null = null;\r\n\r\n  protected historialGestiones = signal<Array<{\r\n    id: number;\r\n    fecha: string;\r\n    nombreAgente: string;\r\n    tipificacionCompleta: string;\r\n    telefono: string;\r\n    observacion: string;\r\n    canal: string;\r\n    canalDisplay: string;\r\n    metodo: string;\r\n    metodoDisplay: string;\r\n    montoPromesa?: number;\r\n    estadoPago?: string;\r\n    estadoPagoDisplay: string;\r\n    hasSchedule: boolean;\r\n    schedule: any;\r\n  }>>([]);\r\n\r\n  selectedTenantId?: number;\r\n  selectedPortfolioId?: number;\r\n  tenants: Tenant[] = [];\r\n  portfolios: Portfolio[] = [];\r\n\r\n  // Testing fields\r\n  testDocument = '';\r\n  testPhone = '';\r\n\r\n  // Configuraci√≥n de outputs del cliente\r\n  customerOutputFields = signal<any[]>([]);\r\n\r\n  campaign = computed(() => this.systemConfigService.getCampaign());\r\n  contactClassifications = computed(() => this.systemConfigService.getContactClassifications());\r\n  managementClassifications = computed(() => this.apiSystemConfigService.getManagementClassificationsForUI());\r\n\r\n  managementClassificationsHierarchical = computed(() => {\r\n    const all: any[] = this.managementClassifications() as any[];\r\n    const byId = new Map<string, any>();\r\n    const children = new Map<string, any[]>();\r\n\r\n    all.forEach((item: any) => {\r\n      const itemId = String(item.id);\r\n      byId.set(itemId, item);\r\n      children.set(itemId, []);\r\n    });\r\n\r\n    all.forEach((item: any) => {\r\n      if (item.parentId) {\r\n        const parentIdStr = String(item.parentId);\r\n        const childList = children.get(parentIdStr);\r\n        if (childList) {\r\n          childList.push(item);\r\n        }\r\n      }\r\n    });\r\n\r\n    const flatten = (items: any[], level: number = 0): any[] => {\r\n      const flattened: any[] = [];\r\n      items.forEach((item: any) => {\r\n        flattened.push({\r\n          ...item,\r\n          indentLevel: level,\r\n          displayLabel: '  '.repeat(level) + (level > 0 ? '‚îî‚îÄ ' : '') + `[${item.codigo}] ${item.label}`\r\n        });\r\n        const itemIdStr = String(item.id);\r\n        const itemChildren = children.get(itemIdStr) || [];\r\n        if (itemChildren.length > 0) {\r\n          flattened.push(...flatten(itemChildren, level + 1));\r\n        }\r\n      });\r\n      return flattened;\r\n    };\r\n\r\n    const roots = all.filter((item: any) => !item.parentId);\r\n    return flatten(roots, 0);\r\n  });\r\n\r\n  paymentMethods = computed(() => this.systemConfigService.getPaymentMethods());\r\n  scheduleTypes = computed(() => this.systemConfigService.getScheduleConfig().tipos_cronograma);\r\n  periodicities = computed(() => this.systemConfigService.getScheduleConfig().periodicidades);\r\n\r\n  // Computed para obtener los montos disponibles del cliente (de la tabla ini_*)\r\n  // Respeta la configuraci√≥n del admin: si hay config, solo muestra las habilitadas\r\n  // Usa nombres visuales de montoCabeceras como fuente de verdad\r\n  customerPaymentAmounts = computed<AmountOption[]>(() => {\r\n    const rawData = this.rawClientData();\r\n    const enabledOptions = this.enabledPaymentOptions();\r\n    const hasConfig = this.hasPaymentOptionsConfig();\r\n    const cabeceras = this.montoCabeceras();\r\n\r\n    if (!rawData || Object.keys(rawData).length === 0) {\r\n      console.log('[PAYMENT] No raw client data available');\r\n      return [];\r\n    }\r\n\r\n    // Crear mapa de c√≥digo -> nombre visual desde cabeceras\r\n    const codigoToNombre = new Map<string, string>();\r\n    for (const c of cabeceras) {\r\n      codigoToNombre.set(c.codigo.toLowerCase(), c.nombre);\r\n    }\r\n\r\n    const amounts: AmountOption[] = [];\r\n\r\n    // Si hay configuraci√≥n en el mantenimiento, solo mostrar las opciones habilitadas\r\n    if (hasConfig) {\r\n      // Solo incluir los campos que est√°n en enabledOptions\r\n      for (const option of enabledOptions) {\r\n        // Handle \"personalizado\" option specially - add as custom option marker\r\n        if (option.codigoOpcion === 'personalizado') {\r\n          amounts.push({\r\n            label: 'Otro monto',\r\n            value: -1, // Special marker for custom amount\r\n            field: 'personalizado',\r\n            generaCartaAcuerdo: option.generaCartaAcuerdo || false\r\n          });\r\n          continue;\r\n        }\r\n\r\n        const fieldName = option.campoTablaDinamica;\r\n        if (!fieldName) continue;\r\n\r\n        // Find the value in rawData (case-insensitive)\r\n        const rawKey = Object.keys(rawData).find(k => k.toLowerCase() === fieldName.toLowerCase());\r\n        if (!rawKey) continue;\r\n\r\n        const value = rawData[rawKey];\r\n        const numValue = typeof value === 'number' ? value : parseFloat(String(value));\r\n\r\n        // Include if value is valid number (including 0, but not NaN)\r\n        if (!isNaN(numValue) && numValue >= 0) {\r\n          // Prioridad: 1) nombre de cabeceras, 2) labelOpcion del backend, 3) formatFieldLabel\r\n          const visualName = codigoToNombre.get(fieldName.toLowerCase())\r\n            || option.labelOpcion\r\n            || this.formatFieldLabel(fieldName);\r\n\r\n          amounts.push({\r\n            label: visualName,\r\n            value: numValue,\r\n            field: fieldName,\r\n            restriccionFecha: option.restriccionFecha || 'SIN_RESTRICCION',\r\n            generaCartaAcuerdo: option.generaCartaAcuerdo || false\r\n          });\r\n        }\r\n      }\r\n\r\n      console.log('[PAYMENT] Amounts from CONFIG (enabled only):', amounts.length);\r\n    } else {\r\n      // No hay configuraci√≥n: usar montoCabeceras si est√°n disponibles\r\n      if (cabeceras.length > 0) {\r\n        // Usar solo los campos definidos en cabeceras (montos reales)\r\n        for (const cabecera of cabeceras) {\r\n          const lowerCodigo = cabecera.codigo.toLowerCase();\r\n          const value = rawData[lowerCodigo] ?? rawData[cabecera.codigo];\r\n\r\n          if (value !== undefined && value !== null) {\r\n            const numValue = typeof value === 'number' ? value : parseFloat(value);\r\n            if (!isNaN(numValue) && numValue >= 0) {\r\n              amounts.push({\r\n                label: cabecera.nombre,\r\n                value: numValue,\r\n                field: lowerCodigo,\r\n                generaCartaAcuerdo: false\r\n              });\r\n            }\r\n          }\r\n        }\r\n        console.log('[PAYMENT] Amounts FALLBACK (from cabeceras):', amounts.length);\r\n      } else {\r\n        // Sin cabeceras ni config: no mostrar nada para evitar datos incorrectos\r\n        console.log('[PAYMENT] No config and no cabeceras - showing empty');\r\n      }\r\n    }\r\n\r\n    // Ordenar por valor descendente (montos m√°s altos primero, pero \"personalizado\" va al final)\r\n    amounts.sort((a, b) => {\r\n      if (a.field === 'personalizado') return 1;\r\n      if (b.field === 'personalizado') return -1;\r\n      return b.value - a.value;\r\n    });\r\n\r\n    return amounts;\r\n  });\r\n\r\n  tabs = [\r\n    { id: 'cliente', label: 'Cliente', icon: 'user' },\r\n    { id: 'historial', label: 'Historial', icon: 'history' }\r\n  ];\r\n\r\n  managementForm: ManagementForm = {\r\n    resultadoContacto: '',\r\n    tipoGestion: '',\r\n    clasificacionNivel1: '',\r\n    clasificacionNivel2: '',\r\n    clasificacionNivel3: '',\r\n    motivoNoPago: '',\r\n    metodoPago: '',\r\n    montoPago: '',\r\n    fechaCompromiso: '',\r\n    horaCompromiso: '',\r\n    ultimos4Tarjeta: '',\r\n    bancoSeleccionado: '',\r\n    observaciones: '',\r\n    notasPrivadas: ''\r\n  };\r\n\r\n  selectedClassifications = signal<string[]>([]);\r\n  dynamicFields = signal<any[]>([]);\r\n  dynamicFieldValues = signal<any>({});\r\n  isLoadingDynamicFields = signal(false);\r\n  isLeafClassification = signal(false);\r\n  dynamicFieldsSchema = signal<MetadataSchema | null>(null);\r\n  externalFieldUpdates = signal<any>({}); // Para comunicar actualizaciones externas al componente hijo\r\n\r\n  // ViewChild para acceder al componente de campos din√°micos\r\n  @ViewChild('dynamicFieldRendererComponent') dynamicFieldRenderer?: DynamicFieldRendererComponent;\r\n\r\n  // Payment schedule signals\r\n  activeSchedules = signal<any[]>([]);\r\n  isLoadingSchedules = signal(false);\r\n  showScheduleHelper = signal(false);\r\n\r\n  // Computed para obtener la clasificaci√≥n seleccionada actual con sus propiedades de tipo\r\n  selectedClassification = computed<ManagementClassification | null>(() => {\r\n    const selectedIds = this.selectedClassifications();\r\n    if (selectedIds.length === 0) return null;\r\n\r\n    const lastSelectedId = selectedIds[selectedIds.length - 1];\r\n    if (!lastSelectedId) return null;\r\n\r\n    const allTypifications = this.managementClassifications();\r\n    const found = allTypifications.find((c: any) => String(c.id) === String(lastSelectedId));\r\n\r\n    // DEBUG: Log para verificar las propiedades\r\n    if (found) {\r\n      console.log('[DEBUG] Selected typification:', found);\r\n      console.log('[DEBUG] suggestsFullAmount:', found.suggestsFullAmount);\r\n      console.log('[DEBUG] allowsInstallmentSelection:', found.allowsInstallmentSelection);\r\n      console.log('[DEBUG] requiresManualAmount:', found.requiresManualAmount);\r\n    }\r\n\r\n    return found as ManagementClassification || null;\r\n  });\r\n\r\n  // Computed para determinar si el formulario es v√°lido y completo para habilitar el bot√≥n guardar\r\n  isFormValid = computed(() => {\r\n    // 1. Verificar clasificaci√≥n seleccionada\r\n    if (this.usesHierarchicalClassifications()) {\r\n      // Sistema jer√°rquico: verificar que se haya seleccionado al menos una clasificaci√≥n\r\n      const selected = this.selectedClassifications();\r\n\r\n      if (selected.length === 0 || !selected[selected.length - 1]) {\r\n        console.log('[isFormValid] ‚ùå No hay clasificaci√≥n seleccionada');\r\n        return false;\r\n      }\r\n\r\n      // Verificar que no haya m√°s niveles disponibles (no debe haber hijos)\r\n      const lastSelectedId = selected[selected.length - 1];\r\n      const all: any[] = this.managementClassifications() as any[];\r\n      const hasChildren = all.some((c: any) => c.parentId && Number(c.parentId) === Number(lastSelectedId));\r\n\r\n      // Solo es v√°lido si no hay hijos disponibles\r\n      if (hasChildren) {\r\n        console.log('[isFormValid] ‚ùå A√∫n hay niveles por seleccionar, lastSelectedId:', lastSelectedId);\r\n        return false;\r\n      }\r\n      console.log('[isFormValid] ‚úÖ Clasificaci√≥n completa:', selected);\r\n    } else {\r\n      // Sistema simple: verificar resultado de contacto\r\n      if (!this.managementForm.resultadoContacto) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    // 2. Verificar campos din√°micos requeridos\r\n    const schema = this.dynamicFieldsSchema();\r\n    const dynamicValues = this.dynamicFieldValues();\r\n\r\n    console.log('[isFormValid] Schema:', schema);\r\n    console.log('[isFormValid] Dynamic Values:', dynamicValues);\r\n\r\n    if (schema && schema.fields && schema.fields.length > 0) {\r\n      for (const field of schema.fields) {\r\n        if (field.required) {\r\n          const value = dynamicValues[field.id];\r\n          console.log(`[isFormValid] Campo '${field.id}' (required=${field.required}): valor='${value}'`);\r\n\r\n          // Campo vac√≠o\r\n          if (value === undefined || value === null || value === '') {\r\n            console.log(`[isFormValid] ‚ùå Campo requerido '${field.id}' est√° vac√≠o`);\r\n            return false;\r\n          }\r\n\r\n          // Tabla sin filas\r\n          if (field.type === 'table') {\r\n            if (!Array.isArray(value) || value.length === 0) {\r\n              console.log(`[isFormValid] ‚ùå Tabla '${field.id}' sin filas`);\r\n              return false;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log('[isFormValid] ‚úÖ Formulario v√°lido!');\r\n    return true;\r\n  });\r\n\r\n  hierarchyLevels = computed(() => {\r\n    const all: any[] = this.managementClassifications() as any[];\r\n    const selected = this.selectedClassifications();\r\n    const levels: any[][] = [];\r\n\r\n    console.log('[hierarchyLevels] Total classifications:', all.length);\r\n    console.log('[hierarchyLevels] Selected:', selected);\r\n\r\n    const roots = all.filter(c => c.hierarchyLevel === 1 || !c.parentId);\r\n    console.log('[hierarchyLevels] Nivel 1 (roots):', roots.length, roots.map((r: any) => `${r.codigo} (ID:${r.id})`));\r\n\r\n    if (roots.length > 0) {\r\n      levels.push(roots);\r\n    }\r\n\r\n    for (let i = 0; i < selected.length; i++) {\r\n      const parentId = selected[i];\r\n      console.log(`[hierarchyLevels] Buscando hijos del nivel ${i+1}, parentId:`, parentId);\r\n\r\n      if (parentId) {\r\n        const children = all.filter((c: any) => c.parentId && Number(c.parentId) === Number(parentId));\r\n        console.log(`[hierarchyLevels] Encontrados ${children.length} hijos:`, children.map((c: any) => `${c.codigo} (ID:${c.id}, parent:${c.parentId})`));\r\n\r\n        if (children.length > 0) {\r\n          levels.push(children);\r\n        } else {\r\n          console.log(`[hierarchyLevels] No se encontraron hijos, deteniendo b√∫squeda`);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log('[hierarchyLevels] Total niveles construidos:', levels.length);\r\n    return levels;\r\n  });\r\n\r\n  scheduleForm = {\r\n    numeroCuotas: '',\r\n    montoCuota: '',\r\n    periodicidad: '',\r\n    fechaPrimeraCuota: '',\r\n    tipoCronograma: '',\r\n    montoInicial: '',\r\n    montoNegociado: '', // Para tipo Financiera\r\n    cuotas: [] as Array<{numero: number, monto: string, fechaVencimiento: string}>\r\n  };\r\n\r\n  customerData = signal<CustomerData>({\r\n    id_cliente: 'CLI-2025-0087453',\r\n    nombre_completo: 'GARC√çA RODRIGUEZ, CARMEN ROSA',\r\n    tipo_documento: 'DNI',\r\n    numero_documento: '45621378',\r\n    fecha_nacimiento: '15/03/1985',\r\n    edad: 40,\r\n    contacto: {\r\n      telefono_principal: '+51 987 654 321',\r\n      telefono_alternativo: '+51 945 123 456',\r\n      telefono_trabajo: '+51 01 4567890',\r\n      email: 'carmen.garcia@email.com',\r\n      direccion: 'Av. Los √Ålamos 458, Dpto 302, San Borja, Lima',\r\n    },\r\n    cuenta: {\r\n      numero_cuenta: '****5678',\r\n      tipo_producto: 'Pr√©stamo Personal',\r\n      fecha_desembolso: '15/01/2024',\r\n      monto_original: 15000.00,\r\n      plazo_meses: 24,\r\n      tasa_interes: 18.5,\r\n    },\r\n    deuda: {\r\n      saldo_capital: 8750.50,\r\n      intereses_vencidos: 456.78,\r\n      mora_acumulada: 234.50,\r\n      gastos_cobranza: 120.00,\r\n      saldo_total: 9561.78,\r\n      dias_mora: 45,\r\n      fecha_ultimo_pago: '15/10/2024',\r\n      monto_ultimo_pago: 458.33,\r\n    }\r\n  });\r\n\r\n  // Cronogramas de pago activos\r\n  activePaymentSchedules = signal<any[]>([]);\r\n\r\n  // Cuota seleccionada para cancelaci√≥n/pago\r\n  selectedInstallmentForCancellation = signal<any | null>(null);\r\n\r\n  // Campos editables para el pago\r\n  montoPagoEditable = signal<number>(0);\r\n  fechaPagoEditable = signal<string>('');\r\n\r\n  // Comprobante subido para la cancelaci√≥n (opcional)\r\n  uploadedComprobante = signal<ComprobanteUploadResponse | null>(null);\r\n\r\n  // Computed para detectar si la tipificaci√≥n seleccionada es de tipo Cancelaci√≥n (c√≥digo CA)\r\n  isCancellationTypification = computed(() => {\r\n    const selected = this.selectedClassification();\r\n    if (!selected) return false;\r\n    // Detectar por c√≥digo \"CA\" o por label que contenga \"CANCELACION\"\r\n    return selected.codigo === 'CA' ||\r\n           selected.label?.toUpperCase().includes('CANCELACION') ||\r\n           selected.label?.toUpperCase().includes('CANCELACI√ìN');\r\n  });\r\n\r\n  // Computed para obtener las cuotas pendientes de todas las promesas activas\r\n  // IMPORTANTE: Solo incluye cuotas que pueden ser canceladas (fecha de pago >= hoy)\r\n  pendingInstallmentsForCancellation = computed(() => {\r\n    const schedules = this.activePaymentSchedules();\r\n    const allPending: any[] = [];\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0); // Normalizar a inicio del d√≠a\r\n\r\n    for (const schedule of schedules) {\r\n      if (schedule.installments) {\r\n        for (const cuota of schedule.installments) {\r\n          // El backend usa PAGADA/CANCELADA, no PAGADO/CANCELADO\r\n          const estado = cuota.status?.toUpperCase();\r\n          if (estado !== 'PAGADA' && estado !== 'PAGADO' && estado !== 'CUMPLIDO' && estado !== 'CANCELADA' && estado !== 'CANCELADO' && estado !== 'VENCIDA' && estado !== 'VENCIDO') {\r\n            // Validar que la fecha de pago no haya pasado\r\n            const fechaPago = cuota.dueDate || cuota.fechaPago;\r\n            if (fechaPago) {\r\n              // Usar parseDateLocal para evitar bug de timezone\r\n              const fechaPagoDate = this.parseDateLocal(fechaPago);\r\n              // Solo incluir si la fecha de pago es hoy o futura\r\n              if (fechaPagoDate >= today) {\r\n                allPending.push({\r\n                  ...cuota,\r\n                  scheduleId: schedule.id,\r\n                  grupoPromesaUuid: schedule.grupoPromesaUuid\r\n                });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return allPending;\r\n  });\r\n\r\n  // Computed para obtener cuotas VENCIDAS (fecha de pago pasada, no se pueden cancelar)\r\n  overdueInstallments = computed(() => {\r\n    const schedules = this.activePaymentSchedules();\r\n    const overdue: any[] = [];\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n\r\n    for (const schedule of schedules) {\r\n      if (schedule.installments) {\r\n        for (const cuota of schedule.installments) {\r\n          const estado = cuota.status?.toUpperCase();\r\n          // Cuotas pendientes con fecha vencida o cuotas ya marcadas como VENCIDA\r\n          if (estado === 'VENCIDA' || estado === 'VENCIDO') {\r\n            overdue.push({\r\n              ...cuota,\r\n              scheduleId: schedule.id,\r\n              grupoPromesaUuid: schedule.grupoPromesaUuid\r\n            });\r\n          } else if (estado === 'PENDIENTE') {\r\n            const fechaPago = cuota.dueDate || cuota.fechaPago;\r\n            if (fechaPago) {\r\n              // Usar parseDateLocal para evitar bug de timezone\r\n              const fechaPagoDate = this.parseDateLocal(fechaPago);\r\n              // Si la fecha de pago ya pas√≥, est√° vencida\r\n              if (fechaPagoDate < today) {\r\n                overdue.push({\r\n                  ...cuota,\r\n                  scheduleId: schedule.id,\r\n                  grupoPromesaUuid: schedule.grupoPromesaUuid\r\n                });\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return overdue;\r\n  });\r\n\r\n  // Raw client data from ini_* table (to detect all numeric columns dynamically)\r\n  rawClientData = signal<Record<string, any>>({});\r\n\r\n  // Computed para extraer campos de MONTOS del cliente para mostrar en panel de negociaci√≥n\r\n  // Usa las cabeceras configuradas para filtrar solo montos reales (decimal) y mostrar nombres visuales\r\n  clientAmountFields = computed(() => {\r\n    const rawData = this.rawClientData();\r\n    const allCabeceras = this.montoCabeceras();\r\n    const amountFields: { label: string; value: number; field: string }[] = [];\r\n\r\n    // Si tenemos cabeceras configuradas, usarlas para filtrar solo montos\r\n    if (allCabeceras.length > 0) {\r\n      // Filtrar solo cabeceras visibles y ordenar por ordenMonto\r\n      const cabeceras = allCabeceras\r\n        .filter(c => c.esVisibleMonto === 1 || c.esVisibleMonto === undefined || c.esVisibleMonto === null)\r\n        .sort((a, b) => (a.ordenMonto || 0) - (b.ordenMonto || 0));\r\n\r\n      for (const cabecera of cabeceras) {\r\n        const lowerCodigo = cabecera.codigo.toLowerCase();\r\n        const value = rawData[lowerCodigo] ?? rawData[cabecera.codigo];\r\n\r\n        if (value !== undefined && value !== null) {\r\n          const numValue = typeof value === 'number' ? value : parseFloat(value);\r\n          if (!isNaN(numValue)) {\r\n            amountFields.push({\r\n              label: cabecera.nombre,  // Usar nombre visual de la cabecera\r\n              value: numValue,\r\n              field: lowerCodigo\r\n            });\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      // Fallback: si no hay cabeceras, usar l√≥gica anterior pero con exclusiones estrictas\r\n      const excludeFields = [\r\n        'id', 'id_campana', 'id_cartera', 'id_subcartera', 'prioridad', 'estado',\r\n        'documento', 'num_cuenta', 'num_cuenta_pmcp', 'numero_cuenta',\r\n        'periodo', 'edad', 'dias_mora', 'dias_mora_asig',\r\n        'telefono_celular', 'telefono_domicilio', 'telefono_laboral',\r\n        'telf_referencia_1', 'telf_referencia_2'\r\n      ];\r\n\r\n      for (const [key, value] of Object.entries(rawData)) {\r\n        const lowerKey = key.toLowerCase();\r\n        // Excluir campos que empiezan con fec_, fecha_, telefono_, telf_\r\n        if (lowerKey.startsWith('fec_') || lowerKey.startsWith('fecha_')) continue;\r\n        if (lowerKey.startsWith('telefono_') || lowerKey.startsWith('telf_')) continue;\r\n        // Excluir campos espec√≠ficos\r\n        if (excludeFields.includes(lowerKey)) continue;\r\n\r\n        const numValue = typeof value === 'number' ? value : parseFloat(value);\r\n        if (!isNaN(numValue) && numValue >= 0) {\r\n          amountFields.push({\r\n            label: this.formatFieldLabel(key),\r\n            value: numValue,\r\n            field: key\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    // Ordenar por valor descendente (mayores primero)\r\n    return amountFields.sort((a, b) => b.value - a.value);\r\n  });\r\n\r\n  // Computed para obtener d√≠as de mora del cliente\r\n  clientDiasMora = computed(() => {\r\n    const rawData = this.rawClientData();\r\n    const diasMora = rawData['dias_mora'] || rawData['dias_mora_asig'] || 0;\r\n    return typeof diasMora === 'number' ? diasMora : parseInt(diasMora) || 0;\r\n  });\r\n\r\n  // Cabeceras de configuraci√≥n para mostrar nombres visuales\r\n  montoCabeceras = signal<{ codigo: string; nombre: string; tipoDato: string; tipoSql: string; esVisibleMonto?: number; ordenMonto?: number }[]>([]);\r\n\r\n  // Enabled payment amount options (configured in maintenance)\r\n  enabledPaymentOptions = signal<CampoOpcionDTO[]>([]);\r\n  paymentScheduleFieldId = signal<number | null>(null);\r\n  // Flag to indicate if payment options have been configured (even if all are disabled)\r\n  hasPaymentOptionsConfig = signal<boolean>(false);\r\n\r\n  private callTimer?: number;\r\n  private managementId?: string;\r\n  private callStartTime?: string;\r\n\r\n  private callStateSubscription?: Subscription;\r\n  private incomingCallSubscription?: Subscription;\r\n  private outgoingCallSubscription?: Subscription;\r\n  public callState: CallState = CallState.IDLE;\r\n  public isMuted = signal(false);\r\n  private incomingPhoneNumber: string | null = null;\r\n  private outgoingPhoneNumber: string | null = null;\r\n\r\n  constructor(\r\n    private systemConfigService: SystemConfigService,\r\n    private managementService: ManagementService,\r\n    private paymentScheduleService: PaymentScheduleService,\r\n    public themeService: ThemeService,\r\n    private classificationService: TypificationService,\r\n    private typificationV2Service: TypificationV2Service,\r\n    private apiSystemConfigService: ApiSystemConfigService,\r\n    private customerOutputConfigService: CustomerOutputConfigService,\r\n    private customerService: CustomerService,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private http: HttpClient,\r\n    private sipService: SipService,\r\n    private agentService: AgentService,\r\n    private agentStatusService: AgentStatusService,\r\n    private authService: AuthService,\r\n    private autorizacionService: AutorizacionService,\r\n    private recordatoriosService: RecordatoriosService,\r\n    private dialog: MatDialog,\r\n    private comprobanteService: ComprobanteService,\r\n    private cartaAcuerdoService: CartaAcuerdoService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.loadTenants();\r\n    this.loadManagementHistory();\r\n\r\n    // Verificar estado inicial de la llamada\r\n    const initialCallState = this.sipService.getCallState();\r\n    console.log('üìû [CollectionManagement] Estado inicial de llamada:', initialCallState);\r\n\r\n    if (initialCallState === CallState.ACTIVE && !this.callActive()) {\r\n      console.log('‚è±Ô∏è Llamada ya est√° activa, iniciando timer autom√°ticamente...');\r\n      this.callActive.set(true);\r\n      this.startCall(); // Iniciar timer autom√°ticamente\r\n    }\r\n\r\n    // Suscribirse a cambios de estado de llamada\r\n    this.callStateSubscription = this.sipService.onCallStatus.subscribe((state: CallState) => {\r\n      console.log('üìû [CollectionManagement] Estado de llamada:', state);\r\n      this.callState = state;\r\n\r\n      // Cuando la llamada se activa, cambiar estado a EN_LLAMADA\r\n      if (state === CallState.ACTIVE && !this.callActive()) {\r\n        this.callActive.set(true);\r\n        this.startCall(); // Iniciar timer\r\n        // Cambiar estado del agente a EN_LLAMADA\r\n        const currentUser = this.authService.getCurrentUser();\r\n        if (currentUser?.id) {\r\n          this.agentService.changeAgentStatus(currentUser.id, { estado: AgentState.EN_LLAMADA }).subscribe({\r\n            next: () => console.log('‚úÖ Estado cambiado a EN_LLAMADA'),\r\n            error: (err: any) => console.error('‚ùå Error cambiando estado:', err)\r\n          });\r\n        }\r\n      }\r\n\r\n      // Cuando la llamada termina, SIEMPRE cambiar estado a TIPIFICANDO\r\n      // El agente debe quedarse en la pantalla para completar la tipificaci√≥n\r\n      if ((state === CallState.ENDED || state === CallState.IDLE) && this.callActive()) {\r\n        this.callActive.set(false);\r\n\r\n        // INMEDIATAMENTE bloquear llamadas entrantes ANTES de cambiar estado en backend\r\n        // Esto previene la race condition con el auto-dialer\r\n        this.isTipifying.set(true);\r\n        this.sipService.blockIncomingCallsMode(true);\r\n        console.log('üö´ Bloqueando llamadas entrantes - agente en tipificaci√≥n');\r\n\r\n        // Obtener la duraci√≥n de la llamada antes de detener el timer\r\n        const finalDuration = this.callDuration();\r\n\r\n        // Detener timer\r\n        if (this.callTimer) {\r\n          clearInterval(this.callTimer);\r\n          this.callTimer = undefined;\r\n        }\r\n\r\n        // SIEMPRE cambiar a TIPIFICANDO cuando termina una llamada\r\n        // El agente debe completar el formulario antes de volver a DISPONIBLE\r\n        console.log(`üìù Llamada terminada (${finalDuration}s), cambiando a TIPIFICANDO`);\r\n        const currentUser = this.authService.getCurrentUser();\r\n        if (currentUser?.id) {\r\n          this.agentService.changeAgentStatus(currentUser.id, { estado: AgentState.TIPIFICANDO }).subscribe({\r\n            next: () => console.log('‚úÖ Estado cambiado a TIPIFICANDO - agente debe completar formulario'),\r\n            error: (err: any) => console.error('‚ùå Error cambiando estado:', err)\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    // Suscribirse a llamadas entrantes para cargar autom√°ticamente el cliente\r\n    this.incomingCallSubscription = this.sipService.onIncomingCall.subscribe((callInfo: { from: string }) => {\r\n      console.log('üì≤ [CollectionManagement] Llamada entrante de:', callInfo.from);\r\n      this.incomingPhoneNumber = callInfo.from;\r\n\r\n      // Buscar y cargar autom√°ticamente el cliente por su n√∫mero de tel√©fono\r\n      if (callInfo.from) {\r\n        this.autoLoadCustomerByPhone(callInfo.from);\r\n      }\r\n    });\r\n\r\n    // Suscribirse a llamadas SALIENTES (desde /dialer manual) para cargar autom√°ticamente el cliente\r\n    this.outgoingCallSubscription = this.sipService.onOutgoingCall.subscribe((callInfo: { to: string }) => {\r\n      console.log('üì§ [CollectionManagement] Llamada saliente a:', callInfo.to);\r\n      this.outgoingPhoneNumber = callInfo.to;\r\n\r\n      // Buscar y cargar autom√°ticamente el cliente por el n√∫mero al que se llama\r\n      if (callInfo.to) {\r\n        this.autoLoadCustomerByPhone(callInfo.to);\r\n      }\r\n    });\r\n\r\n    // Verificar si hay una llamada saliente en curso (navegaci√≥n desde /dialer)\r\n    // El evento onOutgoingCall ya se emiti√≥ antes de navegar aqu√≠, as√≠ que leemos el n√∫mero guardado\r\n    const pendingOutgoingNumber = this.sipService.getCurrentOutgoingNumber();\r\n    // Verificar que no hay cliente REAL cargado (customerData tiene datos mock por defecto,\r\n    // pero sin 'id' num√©rico). Un cliente real tiene 'id' del backend.\r\n    if (pendingOutgoingNumber && !this.customerData()?.id) {\r\n      console.log('üì§ [CollectionManagement] Llamada saliente pendiente detectada:', pendingOutgoingNumber);\r\n      this.outgoingPhoneNumber = pendingOutgoingNumber;\r\n      this.autoLoadCustomerByPhone(pendingOutgoingNumber);\r\n      // Limpiar para evitar cargar de nuevo si el usuario navega de vuelta\r\n      this.sipService.clearCurrentOutgoingNumber();\r\n    }\r\n\r\n    // Verificar si viene desde gesti√≥n manual con par√°metros de cliente\r\n    this.route.queryParams.subscribe(params => {\r\n      if (params['source'] === 'manual' && params['documento']) {\r\n        console.log('üìã [MANUAL] Cargando cliente desde gesti√≥n manual:', params);\r\n        this.loadCustomerByDocumentoFromManual(\r\n          params['documento'],\r\n          Number(params['tenantId']),\r\n          Number(params['portfolioId']),\r\n          Number(params['subPortfolioId'])\r\n        );\r\n      }\r\n    });\r\n\r\n    // Suscribirse a respuestas de autorizaci√≥n\r\n    this.autorizacionService.respuesta$.subscribe(solicitud => {\r\n      if (solicitud && this.waitingForAuthorization()) {\r\n        this.handleAuthorizationResponse(solicitud);\r\n      }\r\n    });\r\n\r\n    // Iniciar polling del estado del agente para el indicador de umbral de tiempo\r\n    const currentUser = this.authService.getCurrentUser();\r\n    if (currentUser?.id) {\r\n      this.agentStatusSubscription = this.agentStatusService.startStatusPolling(currentUser.id).subscribe({\r\n        next: (response) => {\r\n          // Actualizar indicadores de umbral de tiempo\r\n          if (response.colorIndicador) {\r\n            this.colorIndicador.set(response.colorIndicador);\r\n          }\r\n          this.excedeTiempoMaximo.set(response.excedeTiempoMaximo || false);\r\n        },\r\n        error: (err) => console.error('‚ùå Error polling estado del agente:', err)\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Busca y carga autom√°ticamente un cliente por su n√∫mero de tel√©fono\r\n   * Se llama cuando llega una llamada entrante\r\n   * Busca en todos los tenants/carteras/subcarteras\r\n   */\r\n  private autoLoadCustomerByPhone(phoneNumber: string) {\r\n    console.log('üîç [AUTO-LOAD] Buscando cliente por tel√©fono:', phoneNumber);\r\n\r\n    this.customerService.searchCustomersAcrossAllTenants('telefono', phoneNumber).subscribe({\r\n      next: (customers) => {\r\n        if (customers && customers.length > 0) {\r\n          console.log('‚úÖ [AUTO-LOAD] Cliente encontrado:', customers[0]);\r\n          this.loadCustomerFromResource(customers[0]);\r\n        } else {\r\n          console.warn('‚ö†Ô∏è [AUTO-LOAD] No se encontr√≥ cliente con tel√©fono:', phoneNumber);\r\n          // Opcional: mostrar notificaci√≥n al usuario\r\n        }\r\n      },\r\n      error: (error) => {\r\n        console.error('‚ùå [AUTO-LOAD] Error buscando cliente:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Carga un cliente por documento desde la gesti√≥n manual\r\n   * Busca en la tabla din√°mica ini_ de la subcartera especificada\r\n   */\r\n  private loadCustomerByDocumentoFromManual(\r\n    documento: string,\r\n    tenantId: number,\r\n    portfolioId: number,\r\n    subPortfolioId: number\r\n  ) {\r\n    console.log('üîç [MANUAL] Buscando cliente por documento:', documento);\r\n\r\n    // Establecer el contexto de tenant/portfolio/subportfolio para las tipificaciones\r\n    this.selectedTenantId = tenantId;\r\n    this.selectedPortfolioId = portfolioId;\r\n    this.selectedSubPortfolioId = subPortfolioId;\r\n    this.reloadTypifications();\r\n    this.loadCustomerOutputConfig();\r\n\r\n    // Buscar cliente en la tabla din√°mica\r\n    this.http.get<any>(`${environment.apiUrl}/client-search/find`, {\r\n      params: {\r\n        tenantId: tenantId.toString(),\r\n        portfolioId: portfolioId.toString(),\r\n        subPortfolioId: subPortfolioId.toString(),\r\n        documento: documento\r\n      }\r\n    }).pipe(\r\n      catchError((error) => {\r\n        console.error('‚ùå [MANUAL] Error buscando cliente:', error);\r\n        return of(null);\r\n      })\r\n    ).subscribe({\r\n      next: (clientData) => {\r\n        if (clientData) {\r\n          console.log('‚úÖ [MANUAL] Cliente encontrado:', clientData);\r\n          this.loadCustomerFromDynamicTable(clientData);\r\n        } else {\r\n          console.warn('‚ö†Ô∏è [MANUAL] Cliente no encontrado');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Carga los datos de un cliente desde la tabla din√°mica ini_\r\n   * @param client Datos del cliente desde la tabla din√°mica\r\n   * IMPORTANTE: Siempre usa client.id (ini_*.id) para consistencia entre flujos\r\n   */\r\n  private loadCustomerFromDynamicTable(client: any) {\r\n    // Guardar los datos raw del cliente para detectar columnas num√©ricas din√°micamente\r\n    this.rawClientData.set(client);\r\n    console.log('[CUSTOMER] Raw client data from ini_* table:', client);\r\n\r\n    // Cargar cabeceras de montos para esta subcartera\r\n    this.loadMontoCabeceras();\r\n\r\n    // SIEMPRE usar client.id (ini_*.id) - es consistente entre llamada activa y gesti√≥n manual\r\n    const customerId = client.id || 0;\r\n    console.log('[CUSTOMER] Using ini_*.id as customerId:', customerId);\r\n\r\n    // Mapear los datos de la tabla din√°mica al formato de CustomerData\r\n    this.customerData.set({\r\n      id: customerId,\r\n      id_cliente: client.documento,\r\n      nombre_completo: client.nombre || client.nombres + ' ' + (client.apellidos || ''),\r\n      tipo_documento: 'DNI',\r\n      numero_documento: client.documento,\r\n      fecha_nacimiento: '',\r\n      edad: 0,\r\n      contacto: {\r\n        telefono_principal: client.telefono_celular || client.telefono_principal || client.telefono || client.telefono_1 || '',\r\n        telefono_alternativo: client.telefono_domicilio || client.telefono_secundario || client.telefono_2 || '',\r\n        telefono_trabajo: client.telefono_laboral || client.telefono_trabajo || client.telefono_3 || '',\r\n        email: client.email || '',\r\n        direccion: client.direccion || ''\r\n      },\r\n      cuenta: {\r\n        numero_cuenta: client.cuenta || '',\r\n        tipo_producto: client.producto || 'PR√âSTAMO',\r\n        fecha_desembolso: '',\r\n        monto_original: client.monto_original || 0,\r\n        plazo_meses: 0,\r\n        tasa_interes: 0\r\n      },\r\n      deuda: {\r\n        saldo_capital: client.deuda_capital || 0,\r\n        intereses_vencidos: 0,\r\n        mora_acumulada: client.deuda_mora || 0,\r\n        gastos_cobranza: 0,\r\n        saldo_total: (client.deuda_capital || 0) + (client.deuda_mora || 0),\r\n        dias_mora: client.dias_mora || 0,\r\n        fecha_ultimo_pago: '',\r\n        monto_ultimo_pago: 0\r\n      }\r\n    });\r\n\r\n    // Cargar historial de gestiones\r\n    this.loadManagementHistory();\r\n\r\n    // Cargar promesas de pago activas usando el customerId correcto\r\n    if (customerId) {\r\n      this.loadActivePaymentSchedules(customerId);\r\n    }\r\n\r\n    console.log('‚úÖ Cliente cargado exitosamente, customerId:', customerId);\r\n  }\r\n\r\n  /**\r\n   * Carga las cabeceras de montos desde configuracion_cabeceras para mostrar nombres visuales\r\n   */\r\n  private loadMontoCabeceras() {\r\n    if (!this.selectedSubPortfolioId) {\r\n      console.warn('[CABECERAS] No hay subcartera seleccionada');\r\n      return;\r\n    }\r\n\r\n    console.log('[CABECERAS] Cargando cabeceras de montos para subcartera:', this.selectedSubPortfolioId);\r\n\r\n    this.managementService.getMontoCabeceras(this.selectedSubPortfolioId).pipe(\r\n      catchError(error => {\r\n        console.error('[CABECERAS] Error cargando cabeceras:', error);\r\n        return of([]);\r\n      })\r\n    ).subscribe(cabeceras => {\r\n      console.log('[CABECERAS] Cabeceras cargadas:', cabeceras);\r\n      this.montoCabeceras.set(cabeceras.map(c => ({\r\n        codigo: c.codigo,\r\n        nombre: c.nombre,\r\n        tipoDato: c.tipoDato,\r\n        tipoSql: c.tipoSql,\r\n        esVisibleMonto: c.esVisibleMonto,\r\n        ordenMonto: c.ordenMonto\r\n      })));\r\n    });\r\n  }\r\n\r\n  // Variable para almacenar el subPortfolioId seleccionado\r\n  selectedSubPortfolioId?: number;\r\n\r\n  loadTenants() {\r\n    const currentUser = this.authService.getCurrentUser();\r\n    console.log('[V2] Usuario actual:', currentUser);\r\n\r\n    if (currentUser?.tenantId && currentUser?.portfolioId && currentUser?.subPortfolioId) {\r\n      this.selectedTenantId = currentUser.tenantId;\r\n      this.selectedPortfolioId = currentUser.portfolioId;\r\n      this.selectedSubPortfolioId = currentUser.subPortfolioId;\r\n      console.log(`[V2] Usando asignaci√≥n del usuario: tenant=${this.selectedTenantId}, portfolio=${this.selectedPortfolioId}, subPortfolio=${this.selectedSubPortfolioId}`);\r\n\r\n      // Cargar datos SIN llamar a onTenantChange (que resetea portfolioId)\r\n      this.reloadTypifications();\r\n      this.loadCustomerOutputConfig();\r\n      this.loadFirstCustomer();\r\n    } else {\r\n      console.error('[V2] Usuario no tiene asignaci√≥n completa de tenant/portfolio/subportfolio');\r\n      console.error('[V2] Valores recibidos:', {\r\n        tenantId: currentUser?.tenantId,\r\n        portfolioId: currentUser?.portfolioId,\r\n        subPortfolioId: currentUser?.subPortfolioId\r\n      });\r\n    }\r\n  }\r\n\r\n  onTenantChange() {\r\n    this.selectedPortfolioId = undefined;\r\n    this.portfolios = [];\r\n\r\n    if (this.selectedTenantId) {\r\n      this.loadPortfolios();\r\n      this.reloadTypifications();\r\n      this.loadCustomerOutputConfig();\r\n      this.loadFirstCustomer(); // Cargar el primer cliente del tenant\r\n    }\r\n  }\r\n\r\n  loadPortfolios() {\r\n    if (!this.selectedTenantId) return;\r\n\r\n    this.classificationService.getPortfoliosByTenant(this.selectedTenantId).subscribe({\r\n      next: (data) => {\r\n        this.portfolios = data;\r\n      },\r\n      error: (error) => {\r\n        console.error('Error loading portfolios:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  onPortfolioChange() {\r\n    this.reloadTypifications();\r\n    this.loadCustomerOutputConfig();\r\n  }\r\n\r\n  reloadTypifications() {\r\n    if (!this.selectedTenantId) return;\r\n\r\n    this.apiSystemConfigService.setTenantAndPortfolio(\r\n      this.selectedTenantId,\r\n      this.selectedPortfolioId,\r\n      this.selectedSubPortfolioId\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Carga la configuraci√≥n de outputs del cliente desde el backend\r\n   *\r\n   * L√ìGICA:\r\n   * 1. Llama a GET /api/v1/customer-outputs/config?tenantId=X&portfolioId=Y\r\n   * 2. Backend SIEMPRE retorna 200 OK (nunca 404)\r\n   * 3. Si id === null ‚Üí No hay configuraci√≥n guardada ‚Üí Usar campos por defecto\r\n   * 4. Si id !== null ‚Üí Hay configuraci√≥n guardada ‚Üí Usar esos campos (incluso si fieldsConfig=\"[]\")\r\n   *\r\n   * DIFERENCIA IMPORTANTE:\r\n   * - id=null, fieldsConfig=\"[]\": No existe config en BD ‚Üí Mostrar campos DEFAULT\r\n   * - id=123, fieldsConfig=\"[]\": Existe config vac√≠a ‚Üí Admin configur√≥ NO mostrar nada\r\n   */\r\n  loadCustomerOutputConfig() {\r\n    if (!this.selectedTenantId) return;\r\n\r\n    // TEMPORAL: El endpoint customer-outputs/config no existe a√∫n\r\n    // Usar directamente los campos por defecto\r\n    console.log('[TEMPORAL] loadCustomerOutputConfig - endpoint no existe, usando campos por defecto');\r\n    this.setDefaultOutputFields();\r\n    return;\r\n\r\n    /* COMENTADO TEMPORALMENTE - endpoint no existe\r\n    this.customerOutputConfigService.getConfiguration(this.selectedTenantId, this.selectedPortfolioId)\r\n      .pipe(\r\n        catchError((error) => {\r\n          console.error('Error cargando configuraci√≥n:', error);\r\n          this.setDefaultOutputFields();\r\n          return of(null);\r\n        })\r\n      )\r\n      .subscribe({\r\n        next: (response) => {\r\n          if (!response) return; // Si hubo error, ya se manej√≥ en catchError\r\n\r\n          // Verificar si existe configuraci√≥n en BD\r\n          if (response.id === null) {\r\n            // No hay configuraci√≥n guardada ‚Üí usar campos por defecto\r\n            this.setDefaultOutputFields();\r\n            return;\r\n          }\r\n\r\n          // Hay configuraci√≥n guardada ‚Üí usar esos campos (incluso si est√° vac√≠o)\r\n          try {\r\n            const fields = JSON.parse(response.fieldsConfig);\r\n            // Filtrar solo campos visibles y ordenar\r\n            const visibleFields = fields\r\n              .filter((f: any) => f.isVisible)\r\n              .sort((a: any, b: any) => a.displayOrder - b.displayOrder);\r\n\r\n            this.customerOutputFields.set(visibleFields);\r\n          } catch (error) {\r\n            console.error('Error parseando fieldsConfig:', error);\r\n            this.setDefaultOutputFields();\r\n          }\r\n        }\r\n      });\r\n    */\r\n  }\r\n\r\n  /**\r\n   * Carga el cliente de la llamada activa del agente\r\n   * MODIFICADO: Ahora consulta la llamada activa y carga ese contacto din√°micamente\r\n   */\r\n  loadFirstCustomer() {\r\n    // Obtener el usuario actual con su extensi√≥n SIP\r\n    const currentUser = this.authService.getCurrentUser();\r\n\r\n    if (!currentUser || !currentUser.sipExtension) {\r\n      console.error('‚ùå No se pudo obtener la extensi√≥n SIP del agente logueado');\r\n      // Fallback a contacto de prueba\r\n      this.loadClienteDetalle(475);\r\n      return;\r\n    }\r\n\r\n    console.log(`üìã Buscando llamada activa del agente con extensi√≥n SIP ${currentUser.sipExtension}...`);\r\n\r\n    // Primero obtener la llamada activa del agente usando su extensi√≥n SIP\r\n    this.http.get<any>(`${environment.gatewayUrl}/autodialer/active-call/extension/${currentUser.sipExtension}`).pipe(\r\n      catchError((error) => {\r\n        console.warn('‚ö†Ô∏è No hay llamada activa o error consultando:', error);\r\n        // Si no hay llamada activa, usar contacto de prueba (475)\r\n        console.log('üìã Usando contacto de prueba 475');\r\n        return of({ contactId: 475 });\r\n      })\r\n    ).subscribe({\r\n      next: (activeCall) => {\r\n        const contactId = activeCall?.contactId;\r\n\r\n        if (!contactId) {\r\n          console.warn('‚ö†Ô∏è No se obtuvo contactId de la llamada activa');\r\n          return;\r\n        }\r\n\r\n        console.log(`‚úÖ Llamada activa encontrada, contactId: ${contactId}`);\r\n        this.loadClienteDetalle(contactId);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Carga los datos del cliente desde el backend\r\n   * MODIFICADO: Ahora usa el mismo servicio que la b√∫squeda manual para obtener datos completos\r\n   */\r\n  private loadClienteDetalle(contactId: number) {\r\n    console.log(`üìã Cargando datos del cliente para contacto ${contactId}...`);\r\n\r\n    // Primero obtener info b√°sica del contacto para conseguir el documento\r\n    this.http.get<any>(`${environment.gatewayUrl}/contacts/${contactId}/cliente-detalle`).pipe(\r\n      catchError((error) => {\r\n        console.error('‚ùå Error cargando datos del cliente:', error);\r\n        return of(null);\r\n      })\r\n    ).subscribe({\r\n      next: (clienteDetalle) => {\r\n        if (clienteDetalle && clienteDetalle.documento) {\r\n          console.log('‚úÖ Cliente b√°sico cargado, documento:', clienteDetalle.documento);\r\n\r\n          // Obtener tenant, portfolio y subportfolio del usuario actual\r\n          const currentUser = this.authService.getCurrentUser();\r\n          const tenantId = currentUser?.tenantId;\r\n          const portfolioId = currentUser?.portfolioId;\r\n          const subPortfolioId = currentUser?.subPortfolioId;\r\n\r\n          if (!tenantId || !portfolioId || !subPortfolioId) {\r\n            console.error('‚ùå No se pudo obtener asignaci√≥n completa del usuario:', { tenantId, portfolioId, subPortfolioId });\r\n            // Fallback: usar datos limitados del clienteDetalle\r\n            this.loadClienteDetalleFallback(clienteDetalle);\r\n            return;\r\n          }\r\n\r\n          // Usar el endpoint /api/client-search/find que retorna datos COMPLETOS de la tabla din√°mica\r\n          console.log(`üîç Buscando datos completos del cliente con documento ${clienteDetalle.documento} en tenant ${tenantId}, portfolio ${portfolioId}, subportfolio ${subPortfolioId}...`);\r\n          this.customerService.findClientByDocumento(tenantId, portfolioId, subPortfolioId, clienteDetalle.documento).subscribe({\r\n            next: (clienteCompleto) => {\r\n              if (clienteCompleto) {\r\n                console.log('‚úÖ Datos completos del cliente obtenidos:', clienteCompleto);\r\n                // Usar loadCustomerFromDynamicTable - siempre usa ini_*.id\r\n                this.loadCustomerFromDynamicTable(clienteCompleto);\r\n              } else {\r\n                console.warn('‚ö†Ô∏è No se encontr√≥ cliente con documento:', clienteDetalle.documento);\r\n                // Fallback: usar datos limitados del clienteDetalle\r\n                this.loadClienteDetalleFallback(clienteDetalle);\r\n              }\r\n            },\r\n            error: (error) => {\r\n              console.error('‚ùå Error buscando datos completos del cliente:', error);\r\n              // Fallback: usar datos limitados del clienteDetalle\r\n              this.loadClienteDetalleFallback(clienteDetalle);\r\n            }\r\n          });\r\n        } else {\r\n          console.log('‚ö†Ô∏è No se pudieron cargar los datos del cliente');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fallback: carga datos limitados del cliente cuando no se puede obtener datos completos\r\n   * ADVERTENCIA: En este modo NO tenemos el ini_*.id, las gestiones pueden no guardarse correctamente\r\n   * @param clienteDetalle Datos b√°sicos del cliente\r\n   */\r\n  private loadClienteDetalleFallback(clienteDetalle: any) {\r\n    console.warn('‚ö†Ô∏è FALLBACK: No se pudo obtener datos de tabla din√°mica');\r\n    console.warn('‚ö†Ô∏è Las gestiones guardadas pueden no tener el ID correcto del cliente');\r\n\r\n    // Guardar los datos raw del cliente\r\n    this.rawClientData.set(clienteDetalle);\r\n    console.log('[FALLBACK] Raw client data from detalle:', clienteDetalle);\r\n\r\n    // Cargar cabeceras de montos para esta subcartera\r\n    this.loadMontoCabeceras();\r\n\r\n    // FALLBACK: usar clienteDetalle.idCliente (NO es ini_*.id, puede causar inconsistencias)\r\n    const customerId = clienteDetalle.idCliente || 0;\r\n    console.warn('[FALLBACK] Using clienteDetalle.idCliente as customerId:', customerId, '(NOT ini_*.id)');\r\n\r\n    // Mapear los datos del backend al formato del signal\r\n    this.customerData.set({\r\n      id: customerId,\r\n      id_cliente: `CLI-${clienteDetalle.idCliente}`,\r\n      nombre_completo: clienteDetalle.nombreCompleto || '',\r\n      tipo_documento: clienteDetalle.tipoDocumento || 'DNI',\r\n      numero_documento: clienteDetalle.documento || '',\r\n      fecha_nacimiento: clienteDetalle.fechaNacimiento || '',\r\n      edad: clienteDetalle.edad || 0,\r\n      contacto: {\r\n        telefono_principal: clienteDetalle.telefonoPrincipal || '',\r\n        telefono_alternativo: clienteDetalle.telefonoSecundario || '',\r\n        telefono_trabajo: clienteDetalle.telefonoTrabajo || '',\r\n        email: clienteDetalle.email || '',\r\n        direccion: clienteDetalle.direccion || ''\r\n      },\r\n      cuenta: {\r\n        numero_cuenta: clienteDetalle.cuenta || '',\r\n        tipo_producto: clienteDetalle.producto || '',\r\n        fecha_desembolso: '',\r\n        monto_original: 0,\r\n        plazo_meses: 0,\r\n        tasa_interes: 0\r\n      },\r\n      deuda: {\r\n        saldo_capital: clienteDetalle.deudaCapital || 0,\r\n        intereses_vencidos: 0,\r\n        mora_acumulada: 0,\r\n        gastos_cobranza: 0,\r\n        saldo_total: clienteDetalle.deudaTotal || 0,\r\n        dias_mora: clienteDetalle.diasMora || 0,\r\n        fecha_ultimo_pago: '',\r\n        monto_ultimo_pago: 0\r\n      }\r\n    });\r\n\r\n    console.warn('‚ö†Ô∏è Datos del cliente cargados en modo FALLBACK, customerId:', customerId);\r\n\r\n    // üìÖ Cargar cronogramas de promesas de pago activos (puede no encontrar resultados correctos)\r\n    this.loadActivePaymentSchedules(customerId);\r\n  }\r\n\r\n  /**\r\n   * Carga los cronogramas de promesas de pago activos para un cliente\r\n   */\r\n  private loadActivePaymentSchedules(customerId: number) {\r\n    console.log(`üìÖ Cargando cronogramas activos para cliente ${customerId}...`);\r\n\r\n    this.paymentScheduleService.getActiveSchedulesByCustomer(customerId).pipe(\r\n      catchError((error) => {\r\n        console.warn('‚ö†Ô∏è Error cargando cronogramas activos:', error);\r\n        return of([]);\r\n      })\r\n    ).subscribe({\r\n      next: (records: any[]) => {\r\n        console.log('‚úÖ Registros de promesas cargados:', records);\r\n\r\n        if (!records || records.length === 0) {\r\n          this.activePaymentSchedules.set([]);\r\n          return;\r\n        }\r\n\r\n        // El backend devuelve cabeceras con cuotasPromesa incluidas\r\n        // Cada record es una cabecera con su lista de cuotas\r\n        const schedules = records.map((header: any) => {\r\n          const cuotasPromesa = header.cuotasPromesa || [];\r\n\r\n          // Ordenar cuotas por n√∫mero\r\n          cuotasPromesa.sort((a: any, b: any) => (a.numeroCuota || 1) - (b.numeroCuota || 1));\r\n\r\n          // Calcular monto total sumando todas las cuotas (usando montoPromesa del backend)\r\n          const totalAmount = cuotasPromesa.reduce((sum: number, c: any) => sum + (c.montoPromesa || c.monto || 0), 0);\r\n\r\n          // Encontrar cuotas pendientes (excluir PAGADAS, VENCIDAS y CANCELADAS)\r\n          // VENCIDA = promesa rota, el cliente puede crear una nueva\r\n          const pendingCuotas = cuotasPromesa.filter((c: any) =>\r\n            c.estado !== 'PAGADA' && c.estado !== 'PAGADO' && c.estado !== 'CUMPLIDO' &&\r\n            c.estado !== 'CANCELADA' && c.estado !== 'VENCIDA'\r\n          );\r\n          const nextCuota = pendingCuotas[0] || cuotasPromesa[0];\r\n\r\n          return {\r\n            id: header.grupoPromesaUuid || header.id,\r\n            grupoPromesaUuid: header.grupoPromesaUuid,\r\n            totalAmount: totalAmount || header.montoPromesa,\r\n            numberOfInstallments: header.totalCuotas || cuotasPromesa.length,\r\n            fechaGestion: header.fechaGestion,\r\n            installments: cuotasPromesa.map((c: any) => ({\r\n              id: c.id,\r\n              numeroCuota: c.numeroCuota,\r\n              monto: c.montoPromesa || c.monto,\r\n              montoPromesa: c.montoPromesa || c.monto,\r\n              // La fecha de pago viene de CuotaPromesa.fechaPromesa\r\n              dueDate: c.fechaPromesa || c.fechaPago || null,\r\n              fechaPromesa: c.fechaPromesa || c.fechaPago,\r\n              status: c.estado || 'PENDIENTE',\r\n              montoPagadoReal: c.montoPagadoReal || 0\r\n            })),\r\n            nextDueDate: nextCuota?.fechaPromesa || nextCuota?.fechaPago,\r\n            cuotasPendientes: pendingCuotas.length\r\n          };\r\n        });\r\n\r\n        // Filtrar solo cronogramas que tienen al menos una cuota pendiente\r\n        const activeSchedules = schedules.filter((s: any) => s.cuotasPendientes > 0);\r\n\r\n        console.log('üìÖ Cronogramas transformados:', schedules);\r\n        console.log('üìÖ Cronogramas activos (con cuotas pendientes):', activeSchedules);\r\n        this.activePaymentSchedules.set(activeSchedules);\r\n\r\n        if (activeSchedules.length > 0) {\r\n          console.log(`üìÖ ¬°Cliente tiene ${activeSchedules.length} promesa(s) de pago activa(s)!`);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Establece campos por defecto cuando no hay configuraci√≥n guardada\r\n   */\r\n  private setDefaultOutputFields() {\r\n    this.customerOutputFields.set([\r\n      { id: 'numero_documento', label: 'DNI/Documento', field: 'numero_documento', category: 'personal', format: 'text', highlight: true, size: 'medium' },\r\n      { id: 'nombre_completo', label: 'Nombre Completo', field: 'nombre_completo', category: 'personal', format: 'text', highlight: false, size: 'full' },\r\n      { id: 'telefono_principal', label: 'Celular', field: 'contacto.telefono_principal', category: 'contact', format: 'text', highlight: false, size: 'medium' },\r\n      { id: 'email', label: 'Email', field: 'contacto.email', category: 'contact', format: 'text', highlight: false, size: 'medium' },\r\n      { id: 'direccion', label: 'Direcci√≥n', field: 'contacto.direccion', category: 'contact', format: 'text', highlight: false, size: 'full' }\r\n    ]);\r\n  }\r\n\r\n  loadManagementHistory() {\r\n    // Usar documento en lugar de ID para buscar el historial\r\n    // El documento es el identificador √∫nico real del cliente\r\n    const documento = this.customerData()?.numero_documento;\r\n    if (!documento) {\r\n      console.log('[HISTORIAL] No hay documento del cliente, omitiendo carga de historial');\r\n      return;\r\n    }\r\n    console.log('[HISTORIAL] Cargando historial para documento:', documento);\r\n\r\n    this.managementService.getManagementsByDocumento(documento).subscribe({\r\n      next: (managements) => {\r\n        console.log('[HISTORIAL] Gestiones recibidas del backend:', managements);\r\n        console.log('[HISTORIAL] Total de gestiones:', managements.length);\r\n\r\n        // Mapear gestiones\r\n        const historial = managements.map(m => {\r\n          // Formatear solo fecha (sin hora)\r\n          const fecha = m.managementDate\r\n            ? this.formatDateOnly(m.managementDate)\r\n            : '-';\r\n\r\n          // Construir ruta completa de tipificaci√≥n\r\n          const tipificacionParts = [m.level1Name, m.level2Name, m.level3Name, m.level4Name].filter(Boolean);\r\n          const tipificacionCompleta = tipificacionParts.join(' > ') || '-';\r\n\r\n          // Formatear canal para display\r\n          const canalDisplay = this.formatCanalDisplay(m.canalContacto);\r\n\r\n          // Formatear m√©todo para display\r\n          const metodoDisplay = this.formatMetodoDisplay(m.metodoContacto);\r\n\r\n          // Formatear estado de pago para display\r\n          const estadoPagoDisplay = this.formatEstadoPagoDisplay(m.estadoPago);\r\n\r\n          const historyItem = {\r\n            id: m.id,\r\n            fecha: fecha,\r\n            nombreAgente: m.nombreAgente || `Agente ${m.advisorId}`,\r\n            tipificacionCompleta: tipificacionCompleta,\r\n            telefono: m.telefonoContacto || '',\r\n            observacion: m.observations || '',\r\n            canal: m.canalContacto || '',\r\n            canalDisplay: canalDisplay,\r\n            metodo: m.metodoContacto || '',\r\n            metodoDisplay: metodoDisplay,\r\n            montoPromesa: m.montoPromesa || undefined,\r\n            estadoPago: m.estadoPago || undefined,\r\n            estadoPagoDisplay: estadoPagoDisplay,\r\n            hasSchedule: m.typificationRequiresSchedule || false,\r\n            schedule: null as any\r\n          };\r\n\r\n          // Cargar cronograma si existe\r\n          if (historyItem.hasSchedule) {\r\n            this.paymentScheduleService.getPaymentScheduleByManagementId(m.id).subscribe({\r\n              next: (schedule) => {\r\n                if (schedule) {\r\n                  historyItem.schedule = schedule;\r\n                }\r\n              },\r\n              error: () => {\r\n                // Silenciar error si no hay cronograma\r\n              }\r\n            });\r\n          }\r\n\r\n          return historyItem;\r\n        });\r\n\r\n        this.historialGestiones.set(historial);\r\n        console.log('[HISTORIAL] Historial establecido en signal:', this.historialGestiones());\r\n      },\r\n      error: (error) => {\r\n        console.error('[HISTORIAL] Error al cargar historial de gestiones:', error);\r\n        console.error('[HISTORIAL] Detalles del error:', {\r\n          status: error.status,\r\n          statusText: error.statusText,\r\n          message: error.message,\r\n          url: error.url\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  private formatDateTime(dateTimeString: string): string {\r\n    const date = new Date(dateTimeString);\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const year = date.getFullYear();\r\n    const hours = date.getHours().toString().padStart(2, '0');\r\n    const minutes = date.getMinutes().toString().padStart(2, '0');\r\n    return `${day}/${month}/${year} ${hours}:${minutes}`;\r\n  }\r\n\r\n  private calculateCallDuration(callDetail: any): string {\r\n    if (!callDetail.durationSeconds) {\r\n      return '00:00:00';\r\n    }\r\n    return this.formatTime(callDetail.durationSeconds);\r\n  }\r\n\r\n  /**\r\n   * Calcula la duraci√≥n de la llamada en segundos desde callStartTime hasta ahora\r\n   */\r\n  private calculateCallDurationSeconds(): number {\r\n    if (!this.callStartTime) return 0;\r\n    const startTime = new Date(this.callStartTime).getTime();\r\n    const now = new Date().getTime();\r\n    return Math.floor((now - startTime) / 1000);\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.callTimer) {\r\n      clearInterval(this.callTimer);\r\n    }\r\n\r\n    // IMPORTANTE: Desbloquear llamadas si el componente se destruye\r\n    // Esto cubre el caso cuando el usuario navega fuera sin guardar\r\n    if (this.isTipifying()) {\r\n      this.isTipifying.set(false);\r\n      this.sipService.blockIncomingCallsMode(false);\r\n      console.log('üîì [ngOnDestroy] Desbloqueando llamadas entrantes al salir del componente');\r\n    }\r\n\r\n    // Limpiar suscripciones\r\n    if (this.callStateSubscription) {\r\n      this.callStateSubscription.unsubscribe();\r\n    }\r\n    if (this.incomingCallSubscription) {\r\n      this.incomingCallSubscription.unsubscribe();\r\n    }\r\n    if (this.outgoingCallSubscription) {\r\n      this.outgoingCallSubscription.unsubscribe();\r\n    }\r\n    if (this.agentStatusSubscription) {\r\n      this.agentStatusSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  cancelarTipificacion() {\r\n    console.log('‚ùå Cancelando tipificaci√≥n...');\r\n\r\n    // Desbloquear llamadas entrantes\r\n    this.isTipifying.set(false);\r\n    this.sipService.blockIncomingCallsMode(false);\r\n    console.log('üîì Desbloqueando llamadas entrantes - tipificaci√≥n cancelada');\r\n\r\n    // Cambiar estado a DISPONIBLE y LUEGO navegar\r\n    const currentUser = this.authService.getCurrentUser();\r\n    const agentId = currentUser?.id || 1;\r\n    this.agentService.changeAgentStatus(agentId, { estado: AgentState.DISPONIBLE }).subscribe({\r\n      next: () => {\r\n        console.log('‚úÖ Estado cambiado a DISPONIBLE, navegando al agent-dashboard...');\r\n        // Navegar DESPU√âS de cambiar el estado exitosamente\r\n        this.router.navigate(['/agent-dashboard']);\r\n      },\r\n      error: (error) => {\r\n        console.error('‚ùå Error al cambiar estado:', error);\r\n        // Navegar igual aunque falle el cambio de estado\r\n        this.router.navigate(['/agent-dashboard']);\r\n      }\r\n    });\r\n  }\r\n\r\n  protected openScheduleDetail(managementId: number) {\r\n    this.scheduleManagementId.set(managementId);\r\n    this.showScheduleDetail.set(true);\r\n  }\r\n\r\n  protected closeScheduleDetail() {\r\n    this.showScheduleDetail.set(false);\r\n    this.scheduleManagementId.set(null);\r\n  }\r\n\r\n  // ===== M√âTODOS DE AUTORIZACI√ìN PARA MONTOS PERSONALIZADOS =====\r\n\r\n  /**\r\n   * Detecta cuando el usuario selecciona un monto personalizado en el cronograma de pagos\r\n   */\r\n  onCustomAmountDetected(isCustom: boolean): void {\r\n    console.log('üîê [Authorization] Custom amount detected:', isCustom);\r\n    this.requiresAuthorization.set(isCustom);\r\n    if (!isCustom) {\r\n      this.waitingForAuthorization.set(false);\r\n      this.currentAuthorizationData = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Abre el modal de selecci√≥n de supervisor para solicitar autorizaci√≥n\r\n   */\r\n  openSupervisorSelectionModal(): void {\r\n    console.log('üìã [Authorization] Opening supervisor selection modal');\r\n\r\n    // Preparar los datos de la solicitud antes de abrir el modal\r\n    const dynamicValues = this.dynamicFieldValues();\r\n    const schema = this.dynamicFieldsSchema();\r\n    let paymentScheduleData = null;\r\n\r\n    if (schema && schema.fields) {\r\n      const paymentScheduleField = schema.fields.find(f => f.type === 'payment_schedule');\r\n      if (paymentScheduleField && dynamicValues[paymentScheduleField.id]) {\r\n        paymentScheduleData = dynamicValues[paymentScheduleField.id];\r\n      }\r\n    }\r\n\r\n    if (!paymentScheduleData) {\r\n      alert('‚ö†Ô∏è No hay datos de cronograma de pago para autorizar');\r\n      return;\r\n    }\r\n\r\n    const currentUser = this.authService.getCurrentUser();\r\n\r\n    // Obtener tipificaci√≥n seleccionada\r\n    const selectedClassifs = this.selectedClassifications();\r\n    const allTypifications = this.managementClassifications();\r\n    const lastSelectedId = selectedClassifs[selectedClassifs.length - 1];\r\n    const selectedTypification = allTypifications.find((c: any) => c.id.toString() === lastSelectedId);\r\n\r\n    const nombreAgente = currentUser\r\n      ? `${currentUser.firstName || ''} ${currentUser.lastName || ''}`.trim() || currentUser.username\r\n      : 'Agente';\r\n\r\n    this.currentAuthorizationData = {\r\n      idTenant: this.selectedTenantId!,\r\n      idCartera: this.selectedPortfolioId,\r\n      idSubcartera: this.selectedSubPortfolioId,\r\n      idAgenteSolicitante: currentUser?.id || 0,\r\n      nombreAgente: nombreAgente,\r\n      idSupervisor: 0, // Se completar√° cuando seleccione supervisor\r\n      idCliente: this.customerData().id || 0,\r\n      nombreCliente: this.customerData().nombre_completo || '',\r\n      documentoCliente: this.customerData().numero_documento || '',\r\n      idTipificacion: selectedTypification?.id ? Number(selectedTypification.id) : 0,\r\n      nombreTipificacion: selectedTypification?.label || '',\r\n      montoTotal: paymentScheduleData.montoTotal,\r\n      numeroCuotas: paymentScheduleData.numeroCuotas,\r\n      campoMontoOrigen: paymentScheduleData.campoMontoOrigen,\r\n      montoBase: paymentScheduleData.montoBase,  // Monto original del campo (antes de excepci√≥n)\r\n      cuotas: paymentScheduleData.cuotas.map((c: any) => ({\r\n        numeroCuota: c.numeroCuota,\r\n        monto: c.monto,\r\n        fechaPago: c.fechaPago\r\n      })),\r\n      observacionesAgente: this.managementForm.observaciones || 'Solicitud de monto personalizado'\r\n    };\r\n\r\n    this.showSupervisorModal = true;\r\n  }\r\n\r\n  /**\r\n   * Callback cuando el agente selecciona un supervisor\r\n   */\r\n  onSupervisorSelected(supervisor: SupervisorEnLinea): void {\r\n    console.log('üë§ [Authorization] Supervisor selected:', supervisor);\r\n    this.showSupervisorModal = false;\r\n\r\n    if (!this.currentAuthorizationData) {\r\n      console.error('‚ùå No authorization data prepared');\r\n      return;\r\n    }\r\n\r\n    // Agregar el ID del supervisor a la solicitud\r\n    const solicitudCompleta: CrearSolicitudRequest = {\r\n      ...this.currentAuthorizationData,\r\n      idSupervisor: supervisor.idUsuario\r\n    };\r\n\r\n    // Enviar la solicitud\r\n    this.autorizacionService.crearSolicitud(solicitudCompleta).subscribe({\r\n      next: (solicitud) => {\r\n        console.log('‚úÖ [Authorization] Request created:', solicitud);\r\n        this.waitingForAuthorization.set(true);\r\n        // Mostrar mensaje de espera\r\n        alert(`üì§ Solicitud enviada a ${supervisor.nombreCompleto}\\n\\nEsperando autorizaci√≥n...`);\r\n      },\r\n      error: (error) => {\r\n        console.error('‚ùå [Authorization] Error creating request:', error);\r\n        alert('‚ùå Error al enviar la solicitud de autorizaci√≥n');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Callback cuando el agente cancela la selecci√≥n de supervisor\r\n   */\r\n  onSupervisorSelectionCancelled(): void {\r\n    console.log('‚ùå [Authorization] Supervisor selection cancelled');\r\n    this.showSupervisorModal = false;\r\n  }\r\n\r\n  /**\r\n   * Maneja la respuesta de autorizaci√≥n (aprobada o rechazada)\r\n   */\r\n  private handleAuthorizationResponse(solicitud: SolicitudAutorizacion): void {\r\n    console.log('üì¨ [Authorization] Response received:', solicitud);\r\n    this.waitingForAuthorization.set(false);\r\n\r\n    if (solicitud.estado === 'APROBADA') {\r\n      // Autorizaci√≥n aprobada - guardar autom√°ticamente\r\n      alert('‚úÖ ¬°Autorizaci√≥n APROBADA!\\n\\nGuardando gesti√≥n autom√°ticamente...');\r\n      this.requiresAuthorization.set(false); // Desactivar para que el guardado sea normal\r\n      this.saveManagement(); // Guardar la gesti√≥n\r\n    } else if (solicitud.estado === 'RECHAZADA') {\r\n      // Autorizaci√≥n rechazada - mostrar mensaje\r\n      const motivo = solicitud.comentariosSupervisor || 'Sin motivo especificado';\r\n      alert(`‚ùå Autorizaci√≥n RECHAZADA\\n\\nMotivo: ${motivo}\\n\\nPuede modificar los datos y volver a solicitar autorizaci√≥n.`);\r\n    } else if (solicitud.estado === 'EXPIRADA') {\r\n      alert('‚è∞ La solicitud de autorizaci√≥n ha expirado.\\n\\nPuede volver a solicitarla seleccionando otro supervisor.');\r\n    }\r\n  }\r\n\r\n  toggleCall() {\r\n    if (this.callActive()) {\r\n      this.endCall();\r\n    } else {\r\n      this.startCall();\r\n    }\r\n  }\r\n\r\n  startCall() {\r\n    this.callActive.set(true);\r\n    this.callDuration.set(0);\r\n    this.callStartTime = new Date().toISOString();\r\n\r\n    this.callTimer = window.setInterval(() => {\r\n      this.callDuration.update(duration => duration + 1);\r\n    }, 1000);\r\n  }\r\n\r\n  endCall(navigate: boolean = false) {\r\n    console.log('üìµ Finalizando llamada...');\r\n\r\n    // Colgar la llamada SIP\r\n    this.sipService.hangup();\r\n\r\n    // Detener el timer\r\n    this.callActive.set(false);\r\n    if (this.callTimer) {\r\n      clearInterval(this.callTimer);\r\n      this.callTimer = undefined;\r\n    }\r\n\r\n    // NO navegar - el agente debe quedarse en tipificaci√≥n\r\n    // Solo navegar√° cuando guarde la gesti√≥n (onSaveSuccess)\r\n    if (navigate) {\r\n      this.router.navigate(['/agent-dashboard']);\r\n    }\r\n  }\r\n\r\n  formatTime(seconds: number): string {\r\n    const hrs = Math.floor(seconds / 3600);\r\n    const mins = Math.floor((seconds % 3600) / 60);\r\n    const secs = seconds % 60;\r\n    return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n  }\r\n\r\n  /**\r\n   * Formatea una fecha ISO (YYYY-MM-DD) a formato legible (DD/MM/YYYY)\r\n   */\r\n  private formatDateOnly(dateStr: string): string {\r\n    if (!dateStr) return '-';\r\n    const parts = dateStr.split('-');\r\n    if (parts.length === 3) {\r\n      return `${parts[2]}/${parts[1]}/${parts[0]}`;\r\n    }\r\n    return dateStr;\r\n  }\r\n\r\n  /**\r\n   * Formatea el canal de contacto para mostrar\r\n   */\r\n  private formatCanalDisplay(canal: string | undefined): string {\r\n    if (!canal) return '-';\r\n    const canalMap: { [key: string]: string } = {\r\n      'LLAMADA_SALIENTE': 'Llamada Saliente',\r\n      'LLAMADA_ENTRANTE': 'Llamada Entrante',\r\n      'SMS': 'SMS',\r\n      'WHATSAPP': 'WhatsApp',\r\n      'EMAIL': 'Email'\r\n    };\r\n    return canalMap[canal] || this.formatSnakeCase(canal);\r\n  }\r\n\r\n  /**\r\n   * Formatea el m√©todo de contacto para mostrar\r\n   */\r\n  private formatMetodoDisplay(metodo: string | undefined): string {\r\n    if (!metodo) return '-';\r\n    const metodoMap: { [key: string]: string } = {\r\n      'GESTION_MANUAL': 'Manual',\r\n      'GESTION_PROGRESIVO': 'Progresivo',\r\n      'GESTION_PREDICTIVO': 'Predictivo',\r\n      'GESTION_AUTOMATICA': 'Autom√°tica'\r\n    };\r\n    return metodoMap[metodo] || this.formatSnakeCase(metodo);\r\n  }\r\n\r\n  /**\r\n   * Formatea el estado de pago para mostrar\r\n   */\r\n  private formatEstadoPagoDisplay(estado: string | undefined | null): string {\r\n    if (!estado) return '-';\r\n    const estadoMap: { [key: string]: string } = {\r\n      'PENDIENTE': 'Pendiente',\r\n      'PAGADA': 'Pagada',\r\n      'VENCIDA': 'Vencida',\r\n      'PARCIAL': 'Parcial',\r\n      'CANCELADA': 'Cancelada'\r\n    };\r\n    return estadoMap[estado] || this.formatSnakeCase(estado);\r\n  }\r\n\r\n  /**\r\n   * Convierte SNAKE_CASE a Title Case\r\n   * Ejemplo: \"LLAMADA_SALIENTE\" -> \"Llamada Saliente\"\r\n   */\r\n  private formatSnakeCase(value: string): string {\r\n    if (!value) return '-';\r\n    return value\r\n      .toLowerCase()\r\n      .split('_')\r\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1))\r\n      .join(' ');\r\n  }\r\n\r\n  onContactResultChange() {\r\n    this.managementForm.tipoGestion = '';\r\n    this.managementForm.motivoNoPago = '';\r\n  }\r\n\r\n  onManagementTypeChange() {\r\n  }\r\n\r\n  showManagementType(): boolean {\r\n    return this.managementForm.resultadoContacto === 'CPC' || this.managementForm.resultadoContacto === 'CTT';\r\n  }\r\n\r\n  usesHierarchicalClassifications(): boolean {\r\n    const levels = this.hierarchyLevels();\r\n    return levels.length > 0 && levels[0].length > 0;\r\n  }\r\n\r\n  getTypificationsForLevel(levelIndex: number): any[] {\r\n    const levels = this.hierarchyLevels();\r\n    return levels[levelIndex] || [];\r\n  }\r\n\r\n  onClassificationLevelChange(levelIndex: number, value: string) {\r\n    const newSelections = [...this.selectedClassifications()];\r\n    newSelections[levelIndex] = value;\r\n\r\n    this.selectedClassifications.set(newSelections.slice(0, levelIndex + 1));\r\n\r\n    if (levelIndex === 0) {\r\n      this.managementForm.clasificacionNivel1 = value;\r\n      this.managementForm.clasificacionNivel2 = '';\r\n      this.managementForm.clasificacionNivel3 = '';\r\n    } else if (levelIndex === 1) {\r\n      this.managementForm.clasificacionNivel2 = value;\r\n      this.managementForm.clasificacionNivel3 = '';\r\n    } else if (levelIndex === 2) {\r\n      this.managementForm.clasificacionNivel3 = value;\r\n    }\r\n\r\n    if (value) {\r\n      this.managementForm.tipoGestion = value;\r\n      const numValue = Number(value);\r\n      if (!isNaN(numValue) && numValue > 0) {\r\n        this.loadDynamicFields(numValue);\r\n      } else {\r\n        this.dynamicFields.set([]);\r\n        this.dynamicFieldValues.set({});\r\n        this.isLeafClassification.set(false);\r\n      }\r\n    } else {\r\n      const lastValid = this.selectedClassifications().filter(v => v).pop();\r\n      this.managementForm.tipoGestion = lastValid || '';\r\n      this.dynamicFields.set([]);\r\n      this.dynamicFieldValues.set({});\r\n      this.isLeafClassification.set(false);\r\n    }\r\n  }\r\n\r\n  private loadDynamicFields(typificationId: number) {\r\n    // Cargar campos din√°micos desde el backend\r\n    this.isLoadingDynamicFields.set(true);\r\n    this.apiSystemConfigService.getClassificationFields(typificationId).subscribe({\r\n      next: (response) => {\r\n        this.isLeafClassification.set(response.isLeaf);\r\n        this.dynamicFields.set(response.fields || []);\r\n\r\n        // Convertir campos del backend al formato MetadataSchema\r\n        // Los tipos ya vienen en lowercase desde el backend, no necesitan conversi√≥n\r\n        const fieldConfigs: FieldConfig[] = (response.fields || []).map((field: any, index: number) => {\r\n          return {\r\n          id: field.fieldCode,\r\n          label: field.fieldName,\r\n          type: field.fieldType.toLowerCase(), // Asegurar lowercase por compatibilidad\r\n          required: field.isRequired || false,\r\n          placeholder: field.description || '',\r\n          helpText: field.description,\r\n          displayOrder: field.displayOrder || 0,\r\n          // Para campos select, mapear options\r\n          options: field.options ? field.options.map((opt: any) => {\r\n            if (typeof opt === 'string') {\r\n              return { value: opt, label: opt };\r\n            }\r\n            return { value: opt.value || opt, label: opt.label || opt };\r\n          }) : undefined,\r\n          min: field.validationRules?.min,\r\n          max: field.validationRules?.max,\r\n          minLength: field.validationRules?.minLength,\r\n          maxLength: field.validationRules?.maxLength,\r\n          // Para campos tipo tabla, incluir columnas\r\n          columns: field.fieldType.toLowerCase() === 'table' && field.columns ? field.columns.map((col: any) => ({\r\n            id: col.id || col.fieldCode,\r\n            label: col.label || col.fieldName,\r\n            type: (col.type || col.fieldType).toLowerCase(), // Asegurar lowercase\r\n            required: col.required || col.isRequired || false,\r\n            // Para columnas tipo select, mapear options\r\n            options: col.options ? col.options.map((opt: any) => {\r\n              if (typeof opt === 'string') {\r\n                return { value: opt, label: opt };\r\n              }\r\n              return { value: opt.value || opt, label: opt.label || opt };\r\n            }) : undefined\r\n          })) : undefined,\r\n          allowAddRow: field.fieldType.toLowerCase() === 'table',\r\n          allowDeleteRow: field.fieldType.toLowerCase() === 'table',\r\n          minRows: field.minRows || 0,\r\n          maxRows: field.maxRows,\r\n          // For table fields, copy linkedToField property if present\r\n          ...(field.linkedToField && { linkedToField: field.linkedToField })\r\n          };\r\n        });\r\n\r\n        const schema: MetadataSchema = {\r\n          fields: fieldConfigs\r\n        };\r\n\r\n        this.dynamicFieldsSchema.set(schema);\r\n        this.isLoadingDynamicFields.set(false);\r\n\r\n        // Check if there's a payment_schedule field and load its enabled options\r\n        const paymentScheduleField = (response.fields || []).find((f: any) =>\r\n          f.fieldType.toLowerCase() === 'payment_schedule'\r\n        );\r\n        if (paymentScheduleField && paymentScheduleField.id) {\r\n          this.paymentScheduleFieldId.set(paymentScheduleField.id);\r\n          this.loadEnabledPaymentOptions(paymentScheduleField.id);\r\n        } else {\r\n          this.paymentScheduleFieldId.set(null);\r\n          this.enabledPaymentOptions.set([]);\r\n          this.hasPaymentOptionsConfig.set(false);\r\n        }\r\n\r\n        // Check if this is a payment typification and load schedules\r\n        this.checkAndLoadPaymentSchedules();\r\n      },\r\n      error: (error) => {\r\n        console.error('Error cargando campos din√°micos:', error);\r\n        this.isLoadingDynamicFields.set(false);\r\n        this.isLeafClassification.set(false);\r\n        this.dynamicFields.set([]);\r\n        this.dynamicFieldsSchema.set(null);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Loads enabled payment options for a payment_schedule field\r\n   * Uses getOpcionesCampo to get ALL options (to know if config exists)\r\n   * then filters to only show enabled ones\r\n   */\r\n  private loadEnabledPaymentOptions(fieldId: number) {\r\n    console.log('[PAYMENT] Loading options for field ID:', fieldId);\r\n\r\n    // Get ALL options (enabled and disabled) to know if config exists\r\n    this.typificationV2Service.getOpcionesCampo(fieldId).subscribe({\r\n      next: (allOpciones) => {\r\n        // If there are any options in DB, config has been initialized\r\n        const hasConfig = allOpciones && allOpciones.length > 0;\r\n        this.hasPaymentOptionsConfig.set(hasConfig);\r\n\r\n        // Filter only enabled options\r\n        const enabledOpciones = hasConfig\r\n          ? allOpciones.filter(o => o.estaHabilitada)\r\n          : [];\r\n\r\n        console.log('[PAYMENT] Options config exists:', hasConfig, '| Total:', allOpciones?.length || 0, '| Enabled:', enabledOpciones.length);\r\n        this.enabledPaymentOptions.set(enabledOpciones);\r\n      },\r\n      error: (error) => {\r\n        console.warn('[PAYMENT] Error loading options, showing all amounts:', error);\r\n        // If error, assume no config exists ‚Üí show all amounts\r\n        this.hasPaymentOptionsConfig.set(false);\r\n        this.enabledPaymentOptions.set([]);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Checks if the current selected typification requires payment\r\n   * and loads active schedules if needed\r\n   */\r\n  private checkAndLoadPaymentSchedules() {\r\n    // Get the currently selected typification\r\n    const selected = this.selectedClassifications();\r\n    if (selected.length === 0) {\r\n      this.showScheduleHelper.set(false);\r\n      return;\r\n    }\r\n\r\n    const lastSelectedId = selected[selected.length - 1];\r\n    const allTypifications = this.managementClassifications();\r\n    const currentClass = allTypifications.find((c: any) => c.id.toString() === lastSelectedId);\r\n\r\n    // Check if this typification requires payment (codes: PC, PT, PP, PPT)\r\n    if (currentClass && currentClass.requiere_pago) {\r\n      console.log('[SCHEDULE] Payment typification detected:', currentClass.codigo);\r\n      console.log('[DEBUG-SCHEDULE] Full typification object:', currentClass);\r\n      console.log('[DEBUG-SCHEDULE] suggestsFullAmount:', currentClass.suggestsFullAmount);\r\n      console.log('[DEBUG-SCHEDULE] allowsInstallmentSelection:', currentClass.allowsInstallmentSelection);\r\n      console.log('[DEBUG-SCHEDULE] requiresManualAmount:', currentClass.requiresManualAmount);\r\n      this.loadActiveSchedules();\r\n    } else {\r\n      this.showScheduleHelper.set(false);\r\n      this.activeSchedules.set([]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Loads active payment schedules for the current customer\r\n   */\r\n  private loadActiveSchedules() {\r\n    // Usar documento en lugar de ID para buscar cronogramas\r\n    const documento = this.customerData()?.numero_documento;\r\n    if (!documento) {\r\n      console.log('[SCHEDULE] No hay documento del cliente, omitiendo carga de cronogramas');\r\n      return;\r\n    }\r\n    console.log('[SCHEDULE] Loading active schedules for documento:', documento);\r\n\r\n    this.isLoadingSchedules.set(true);\r\n    this.managementService.getActiveSchedulesByDocumento(documento).subscribe({\r\n      next: (schedules) => {\r\n        console.log('[SCHEDULE] Active schedules loaded:', schedules);\r\n        this.activeSchedules.set(schedules);\r\n        this.showScheduleHelper.set(schedules.length > 0);\r\n        this.isLoadingSchedules.set(false);\r\n\r\n        // Auto-suggest payment amount from next pending installment\r\n        if (schedules.length > 0) {\r\n          this.suggestPaymentAmount(schedules[0]);\r\n        }\r\n      },\r\n      error: (error) => {\r\n        console.error('[SCHEDULE] Error loading schedules:', error);\r\n        this.isLoadingSchedules.set(false);\r\n        this.showScheduleHelper.set(false);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Suggests payment amount based on next pending installment\r\n   */\r\n  private suggestPaymentAmount(schedule: any) {\r\n    if (!schedule.installments || schedule.installments.length === 0) return;\r\n\r\n    // Find first pending installment\r\n    const pendingInstallment = schedule.installments\r\n      .filter((inst: any) => inst.status.status === 'PENDING') // Corregido: el backend usa 'PENDING' en ingl√©s\r\n      .sort((a: any, b: any) => new Date(a.dueDate).getTime() - new Date(b.dueDate).getTime())[0];\r\n\r\n    if (pendingInstallment) {\r\n      console.log('[SCHEDULE] Suggested payment amount:', pendingInstallment.amount);\r\n\r\n      // Pre-fill the payment amount in managementForm if not already set\r\n      if (!this.managementForm.montoPago) {\r\n        this.managementForm.montoPago = pendingInstallment.amount.toFixed(2);\r\n      }\r\n\r\n      // Also pre-fill the dynamic fields for compatibility\r\n      const currentValues = { ...this.dynamicFieldValues() };\r\n      if (!currentValues['monto_pagado']) {\r\n        currentValues['monto_pagado'] = pendingInstallment.amount;\r\n        this.dynamicFieldValues.set(currentValues);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Applies full payment from schedule\r\n   */\r\n  // Force recompile\r\n  applyFullSchedulePayment() {\r\n    const schedules = this.activeSchedules();\r\n    if (schedules.length === 0) return;\r\n\r\n    const schedule = schedules[0];\r\n    const pendingAmount = this.calculatePendingAmount(schedule);\r\n\r\n    console.log('[BUTTON] Pagar Todo clicked. Amount:', pendingAmount);\r\n\r\n    // Buscar el campo de monto en el schema\r\n    const schema = this.dynamicFieldsSchema();\r\n    const montoField = schema?.fields.find(f =>\r\n      f.type === 'currency' || f.id.toLowerCase().includes('monto')\r\n    );\r\n\r\n    if (montoField) {\r\n      console.log('[BUTTON] Found monto field:', montoField.id);\r\n\r\n      // Actualizar el signal de actualizaciones externas\r\n      const updates: any = {};\r\n      updates[montoField.id] = pendingAmount;\r\n\r\n      // Si hay campo saldo_pendiente, calcularlo (ser√° 0 porque se paga todo)\r\n      const hasSaldoField = schema?.fields.some(f => f.id === 'saldo_pendiente');\r\n      if (hasSaldoField) {\r\n        updates.saldo_pendiente = 0; // Al pagar todo, el saldo pendiente es 0\r\n        console.log('[BUTTON] Saldo pendiente ser√° 0 (pago total)');\r\n\r\n        // Actualizar tambi√©n dynamicFieldValues para que la validaci√≥n pase\r\n        const currentValues = { ...this.dynamicFieldValues() };\r\n        currentValues[montoField.id] = pendingAmount;\r\n        currentValues.saldo_pendiente = 0;\r\n        this.dynamicFieldValues.set(currentValues);\r\n      }\r\n\r\n      this.externalFieldUpdates.set(updates);\r\n      console.log('[BUTTON] Updated externalFieldUpdates:', updates);\r\n\r\n      // Limpiar despu√©s de un breve delay para permitir futuras actualizaciones\r\n      setTimeout(() => this.externalFieldUpdates.set({}), 100);\r\n    } else {\r\n      console.warn('[BUTTON] No se encontr√≥ campo de monto en el schema');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Applies next installment payment\r\n   */\r\n  applyNextInstallmentPayment() {\r\n    console.log('[BUTTON-PP] Usar Pr√≥xima Cuota clicked!');\r\n    const schedules = this.activeSchedules();\r\n    console.log('[BUTTON-PP] Active schedules:', schedules);\r\n\r\n    if (schedules.length === 0) {\r\n      console.warn('[BUTTON-PP] No schedules found');\r\n      return;\r\n    }\r\n\r\n    const schedule = schedules[0];\r\n    console.log('[BUTTON-PP] Using schedule:', schedule);\r\n    console.log('[BUTTON-PP] Schedule installments:', schedule.installments);\r\n\r\n    const pendingInstallments = schedule.installments\r\n      .filter((inst: any) => {\r\n        console.log('[BUTTON-PP] Checking installment:', inst, 'Status:', inst.status?.status);\r\n        return inst.status.status === 'PENDING'; // Corregido: el backend usa 'PENDING' en ingl√©s\r\n      });\r\n\r\n    console.log('[BUTTON-PP] Pending installments:', pendingInstallments);\r\n\r\n    const pendingInstallment = pendingInstallments\r\n      .sort((a: any, b: any) => new Date(a.dueDate).getTime() - new Date(b.dueDate).getTime())[0];\r\n\r\n    console.log('[BUTTON-PP] Next pending installment:', pendingInstallment);\r\n\r\n    if (pendingInstallment) {\r\n      console.log('[BUTTON-PP] Usar Pr√≥xima Cuota - Amount:', pendingInstallment.amount);\r\n\r\n      // Buscar el campo de monto en el schema\r\n      const schema = this.dynamicFieldsSchema();\r\n      const montoField = schema?.fields.find(f =>\r\n        f.type === 'currency' || f.id.toLowerCase().includes('monto')\r\n      );\r\n\r\n      if (montoField) {\r\n        console.log('[BUTTON-PP] Found monto field:', montoField.id);\r\n\r\n        // Actualizar el signal de actualizaciones externas\r\n        const updates: any = {};\r\n        updates[montoField.id] = pendingInstallment.amount;\r\n\r\n        // Si hay campo saldo_pendiente, calcularlo\r\n        const hasSaldoField = schema?.fields.some(f => f.id === 'saldo_pendiente');\r\n        if (hasSaldoField) {\r\n          const totalPendiente = this.calculatePendingAmount(schedule);\r\n          const saldoPendiente = Math.max(0, totalPendiente - pendingInstallment.amount);\r\n          updates.saldo_pendiente = saldoPendiente;\r\n          console.log('[BUTTON-PP] Saldo pendiente calculado:', saldoPendiente, '= Total', totalPendiente, '- Monto', pendingInstallment.amount);\r\n\r\n          // Actualizar tambi√©n dynamicFieldValues para que la validaci√≥n pase\r\n          const currentValues = { ...this.dynamicFieldValues() };\r\n          currentValues[montoField.id] = pendingInstallment.amount;\r\n          currentValues.saldo_pendiente = saldoPendiente;\r\n          this.dynamicFieldValues.set(currentValues);\r\n        }\r\n\r\n        this.externalFieldUpdates.set(updates);\r\n        console.log('[BUTTON-PP] Updated externalFieldUpdates:', updates);\r\n\r\n        // Limpiar despu√©s de un breve delay para permitir futuras actualizaciones\r\n        setTimeout(() => this.externalFieldUpdates.set({}), 100);\r\n      } else {\r\n        console.warn('[BUTTON-PP] No se encontr√≥ campo de monto en el schema');\r\n      }\r\n    } else {\r\n      console.warn('[BUTTON-PP] No pending installment found');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calculates total pending amount from schedule\r\n   */\r\n  calculatePendingAmount(schedule: any): number {\r\n    console.log('[CALC] Schedule:', schedule);\r\n    console.log('[CALC] Installments:', schedule.installments);\r\n    const pendingInstallments = schedule.installments\r\n      .filter((inst: any) => {\r\n        console.log('[CALC] Installment status:', inst.status, 'Status value:', inst.status?.status);\r\n        return inst.status.status === 'PENDING'; // Corregido: el backend usa 'PENDING' en ingl√©s\r\n      });\r\n    console.log('[CALC] Pending installments:', pendingInstallments);\r\n    const total = pendingInstallments.reduce((sum: number, inst: any) => sum + inst.amount, 0);\r\n    console.log('[CALC] Total pending amount:', total);\r\n    return total;\r\n  }\r\n\r\n  /**\r\n   * Gets pending installments from schedule\r\n   */\r\n  protected getPendingInstallments(schedule: any): any[] {\r\n    if (!schedule.installments) return [];\r\n    return schedule.installments\r\n      .filter((inst: any) => inst.status.status === 'PENDING') // Corregido: el backend usa 'PENDING' en ingl√©s\r\n      .sort((a: any, b: any) => new Date(a.dueDate).getTime() - new Date(b.dueDate).getTime());\r\n  }\r\n\r\n  /**\r\n   * Maneja cambios en los campos din√°micos del componente\r\n   * Calcula saldo_pendiente en tiempo real para mostrar a la asesora\r\n   * Tambi√©n se calcula en backend al guardar para hist√≥rico\r\n   */\r\n  onDynamicFieldsChange(data: any) {\r\n    this.dynamicFieldValues.set(data);\r\n\r\n    // Calcular saldo pendiente en tiempo real cuando cambia monto_pagado\r\n    if (data.monto_pagado !== undefined && data.monto_pagado !== null) {\r\n      this.calculateAndUpdatePendingBalance(data.monto_pagado);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calcula y actualiza el saldo pendiente en tiempo real\r\n   * para que la asesora pueda informar al cliente\r\n   * F√≥rmula: Saldo Pendiente = (Suma de cuotas pendientes) - (Monto Pagado)\r\n   */\r\n  private calculateAndUpdatePendingBalance(montoPagado: number) {\r\n    const schedules = this.activeSchedules();\r\n\r\n    if (schedules.length === 0) {\r\n      console.log('[SALDO] No hay cronogramas activos');\r\n      return;\r\n    }\r\n\r\n    const schedule = schedules[0];\r\n    const totalPendiente = this.calculatePendingAmount(schedule);\r\n    const saldoPendiente = Math.max(0, totalPendiente - (montoPagado || 0));\r\n\r\n    console.log('[SALDO] Total pendiente:', totalPendiente);\r\n    console.log('[SALDO] Monto pagado:', montoPagado);\r\n    console.log('[SALDO] Saldo pendiente calculado:', saldoPendiente);\r\n\r\n    // Actualizar el campo saldo_pendiente para que la asesora lo vea\r\n    const schema = this.dynamicFieldsSchema();\r\n    const hasSaldoField = schema?.fields.some(f => f.id === 'saldo_pendiente');\r\n\r\n    if (hasSaldoField) {\r\n      console.log('[SALDO] Actualizando campo saldo_pendiente con:', saldoPendiente);\r\n\r\n      // Actualizar tanto en el componente hijo (para mostrar) como en dynamicFieldValues (para validaci√≥n)\r\n      const updates: any = { saldo_pendiente: saldoPendiente };\r\n      this.externalFieldUpdates.set(updates);\r\n\r\n      // Tambi√©n actualizar directamente dynamicFieldValues para que la validaci√≥n pase\r\n      const currentValues = { ...this.dynamicFieldValues() };\r\n      currentValues.saldo_pendiente = saldoPendiente;\r\n      this.dynamicFieldValues.set(currentValues);\r\n\r\n      setTimeout(() => this.externalFieldUpdates.set({}), 100);\r\n    }\r\n  }\r\n\r\n  getDynamicLevelLabel(levelIndex: number): string {\r\n    if (levelIndex === 0) {\r\n      const level1 = this.hierarchyLevels()[0] || [];\r\n      if (level1.length === 0) return 'Nivel 1';\r\n      const codes = level1.map((c: any) => c.codigo);\r\n      if (codes.includes('RP') || codes.includes('CSA')) {\r\n        return 'Tipo de Resultado';\r\n      }\r\n      return 'Categor√≠a Principal';\r\n    }\r\n\r\n    const parentIndex = levelIndex - 1;\r\n    const parentId = this.selectedClassifications()[parentIndex];\r\n\r\n    if (!parentId) return `Nivel ${levelIndex + 1}`;\r\n\r\n    const parent = this.managementClassifications().find(c => c.id == parentId);\r\n    if (!parent) return `Nivel ${levelIndex + 1}`;\r\n\r\n    if (levelIndex === 1) {\r\n      const labelMap: Record<string, string> = {\r\n        'RP': 'Intenci√≥n de Pago',\r\n        'CSA': 'Motivo de No Atenci√≥n',\r\n        'SC': 'Raz√≥n de No Contacto',\r\n        'GA': 'Tipo de Gesti√≥n'\r\n      };\r\n      return labelMap[parent.codigo] || `Detalle de ${parent.label}`;\r\n    }\r\n\r\n    return `Detalle de ${parent.label}`;\r\n  }\r\n\r\n  shouldShowLevel(levelIndex: number): boolean {\r\n    if (levelIndex === 0) {\r\n      return this.usesHierarchicalClassifications();\r\n    }\r\n\r\n    const previousLevel = levelIndex - 1;\r\n    const previousValue = this.selectedClassifications()[previousLevel];\r\n\r\n    if (!previousValue) return false;\r\n\r\n    const options = this.getTypificationsForLevel(levelIndex);\r\n    return options.length > 0;\r\n  }\r\n\r\n  /**\r\n   * Formatea el nombre de un campo de la tabla ini_* para mostrarlo de forma legible\r\n   * Convierte snake_case a Title Case y aplica traducciones comunes\r\n   */\r\n  formatFieldLabel(fieldName: string): string {\r\n    // Traducciones comunes de campos de cobranza\r\n    const translations: Record<string, string> = {\r\n      'deuda_total': 'Deuda Total',\r\n      'saldo_total': 'Saldo Total',\r\n      'saldo_capital': 'Saldo Capital',\r\n      'capital': 'Capital',\r\n      'deuda_capital': 'Deuda Capital',\r\n      'intereses': 'Intereses',\r\n      'intereses_vencidos': 'Intereses Vencidos',\r\n      'mora': 'Mora',\r\n      'mora_acumulada': 'Mora Acumulada',\r\n      'deuda_mora': 'Deuda Mora',\r\n      'gastos': 'Gastos',\r\n      'gastos_cobranza': 'Gastos Cobranza',\r\n      'monto_original': 'Monto Original',\r\n      'monto_desembolso': 'Monto Desembolso',\r\n      'saldo_vencido': 'Saldo Vencido',\r\n      'cuota_vencida': 'Cuota Vencida',\r\n      'cuotas_vencidas': 'Cuotas Vencidas',\r\n      'monto_cuota': 'Monto Cuota',\r\n      'dias_mora': 'D√≠as Mora',\r\n      'monto_minimo': 'Monto M√≠nimo',\r\n      'monto_total': 'Monto Total',\r\n      'deuda': 'Deuda',\r\n      'saldo': 'Saldo'\r\n    };\r\n\r\n    // Buscar traducci√≥n exacta\r\n    const lowerField = fieldName.toLowerCase();\r\n    if (translations[lowerField]) {\r\n      return translations[lowerField];\r\n    }\r\n\r\n    // Si no hay traducci√≥n, convertir snake_case a Title Case\r\n    return fieldName\r\n      .split('_')\r\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\r\n      .join(' ');\r\n  }\r\n\r\n  /**\r\n   * Formatea un valor num√©rico como moneda (Soles)\r\n   */\r\n  formatCurrency(value: number): string {\r\n    return new Intl.NumberFormat('es-PE', {\r\n      style: 'currency',\r\n      currency: 'PEN'\r\n    }).format(value);\r\n  }\r\n\r\n  /**\r\n   * Parsea una fecha string (YYYY-MM-DD) a Date en timezone local.\r\n   * Evita el bug de timezone donde new Date(\"YYYY-MM-DD\") interpreta como UTC.\r\n   */\r\n  private parseDateLocal(dateString: string): Date {\r\n    if (!dateString) return new Date();\r\n    const [year, month, day] = dateString.split('-').map(Number);\r\n    return new Date(year, month - 1, day);\r\n  }\r\n\r\n  /**\r\n   * Obtiene la etiqueta del monto principal (primer campo de montos o \"Deuda Total\")\r\n   */\r\n  getPrimaryAmountLabel(): string {\r\n    const fields = this.clientAmountFields();\r\n    if (fields.length > 0) {\r\n      // Buscar campo que contenga \"total\" en el nombre\r\n      const totalField = fields.find(f =>\r\n        f.label.toLowerCase().includes('total') ||\r\n        f.field.toLowerCase().includes('total')\r\n      );\r\n      return totalField?.label || fields[0].label;\r\n    }\r\n    return 'Deuda Total';\r\n  }\r\n\r\n  /**\r\n   * Obtiene el valor del monto principal\r\n   */\r\n  getPrimaryAmountValue(): number {\r\n    const fields = this.clientAmountFields();\r\n    if (fields.length > 0) {\r\n      // Buscar campo que contenga \"total\" en el nombre\r\n      const totalField = fields.find(f =>\r\n        f.label.toLowerCase().includes('total') ||\r\n        f.field.toLowerCase().includes('total')\r\n      );\r\n      return totalField?.value || fields[0].value;\r\n    }\r\n    return this.customerData().deuda?.saldo_total || 0;\r\n  }\r\n\r\n  /**\r\n   * Obtiene las clases CSS para cada fila de montos seg√∫n su √≠ndice\r\n   * Alterna entre 2 colores para mejor visualizaci√≥n\r\n   */\r\n  getAmountRowClass(index: number): string {\r\n    const colors = [\r\n      'bg-red-50 !text-black dark:bg-red-950/30 dark:!text-red-300',\r\n      'bg-white !text-black dark:bg-gray-800 dark:!text-red-400',\r\n    ];\r\n    return colors[index % colors.length];\r\n  }\r\n\r\n  showPaymentSection(): boolean {\r\n    const selectedManagement = this.managementClassifications().find(c => c.id === this.managementForm.tipoGestion);\r\n    return selectedManagement?.requiere_pago || false;\r\n  }\r\n\r\n  showScheduleSection(): boolean {\r\n    const selectedManagement = this.managementClassifications().find(c => c.id === this.managementForm.tipoGestion);\r\n    return selectedManagement?.requiere_cronograma || false;\r\n  }\r\n\r\n  onInstallmentCountChange() {\r\n    const numInstallments = parseInt(this.scheduleForm.numeroCuotas);\r\n\r\n    if (isNaN(numInstallments) || numInstallments < 1) {\r\n      // If invalid number, clear installments\r\n      this.scheduleForm.cuotas = [];\r\n      return;\r\n    }\r\n\r\n    const currentLength = this.scheduleForm.cuotas.length;\r\n\r\n    if (numInstallments > currentLength) {\r\n      // Add missing installments\r\n      for (let i = currentLength + 1; i <= numInstallments; i++) {\r\n        this.scheduleForm.cuotas.push({\r\n          numero: i,\r\n          monto: '',\r\n          fechaVencimiento: ''\r\n        });\r\n      }\r\n    } else if (numInstallments < currentLength) {\r\n      // Remove extra installments\r\n      this.scheduleForm.cuotas = this.scheduleForm.cuotas.slice(0, numInstallments);\r\n      // Renumber\r\n      this.scheduleForm.cuotas.forEach((cuota, idx) => {\r\n        cuota.numero = idx + 1;\r\n      });\r\n    }\r\n  }\r\n\r\n  generateSchedule() {\r\n    const numCuotas = parseInt(this.scheduleForm.numeroCuotas);\r\n    if (isNaN(numCuotas) || numCuotas < 1) {\r\n      alert('Por favor ingrese un n√∫mero v√°lido de cuotas');\r\n      return;\r\n    }\r\n\r\n    // Generar array de cuotas vac√≠as\r\n    this.scheduleForm.cuotas = [];\r\n    for (let i = 1; i <= numCuotas; i++) {\r\n      this.scheduleForm.cuotas.push({\r\n        numero: i,\r\n        monto: '',\r\n        fechaVencimiento: ''\r\n      });\r\n    }\r\n  }\r\n\r\n  addInstallmentRow() {\r\n    const nextNumber = this.scheduleForm.cuotas.length + 1;\r\n    this.scheduleForm.cuotas.push({\r\n      numero: nextNumber,\r\n      monto: '',\r\n      fechaVencimiento: ''\r\n    });\r\n    // Actualizar el n√∫mero de cuotas\r\n    this.scheduleForm.numeroCuotas = nextNumber.toString();\r\n  }\r\n\r\n  removeInstallmentRow(index: number) {\r\n    if (this.scheduleForm.cuotas.length > 1) {\r\n      this.scheduleForm.cuotas.splice(index, 1);\r\n      // Renumerar las cuotas\r\n      this.scheduleForm.cuotas.forEach((cuota, idx) => {\r\n        cuota.numero = idx + 1;\r\n      });\r\n      // Actualizar el n√∫mero de cuotas\r\n      this.scheduleForm.numeroCuotas = this.scheduleForm.cuotas.length.toString();\r\n    }\r\n  }\r\n\r\n  getTodayDate(): string {\r\n    const today = new Date();\r\n    const year = today.getFullYear();\r\n    const month = String(today.getMonth() + 1).padStart(2, '0');\r\n    const day = String(today.getDate()).padStart(2, '0');\r\n    return `${year}-${month}-${day}`;\r\n  }\r\n\r\n  loadMontoNegociadoFromOutput(fieldId: string) {\r\n    // Buscar el campo en customerOutputFields\r\n    const field = this.customerOutputFields().find((f: any) => f.id === fieldId);\r\n    if (!field) return;\r\n\r\n    // Obtener el valor del campo usando la ruta del field\r\n    const fieldPath = field.field.split('.');\r\n    let value: any = this.customerData();\r\n\r\n    for (const key of fieldPath) {\r\n      if (value && typeof value === 'object') {\r\n        value = value[key];\r\n      } else {\r\n        value = null;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (value) {\r\n      this.scheduleForm.montoNegociado = value.toString();\r\n    }\r\n  }\r\n\r\n  toggleScheduleDetail() {\r\n    this.showScheduleDetail.update(show => !show);\r\n  }\r\n\r\n  saveManagement() {\r\n    if (!this.validateForm()) {\r\n      return;\r\n    }\r\n\r\n    this.saving.set(true);\r\n\r\n    let contactClassification: any;\r\n    let managementClassification: any;\r\n\r\n    if (this.usesHierarchicalClassifications()) {\r\n      // Sistema jer√°rquico: obtener clasificaci√≥n (categor√≠a) y tipificaci√≥n (hoja)\r\n      const selected = this.selectedClassifications();\r\n      const allTypifications = this.managementClassifications();\r\n\r\n      // TIPIFICACI√ìN: La hoja/leaf (√∫ltima selecci√≥n)\r\n      const lastSelectedId = selected[selected.length - 1];\r\n      managementClassification = allTypifications.find((c: any) => c.id.toString() === lastSelectedId);\r\n\r\n      // CLASIFICACI√ìN: La categor√≠a padre de la tipificaci√≥n\r\n      // Si la tipificaci√≥n tiene parent_id, buscar ese parent como clasificaci√≥n\r\n      // Si es root (sin parent), usar el mismo como clasificaci√≥n\r\n      if (managementClassification?.parentId) {\r\n        const parentId = managementClassification.parentId;\r\n        contactClassification = allTypifications.find((c: any) => c.id.toString() === parentId.toString());\r\n      } else {\r\n        // Si no tiene padre, usar la misma como clasificaci√≥n\r\n        contactClassification = managementClassification;\r\n      }\r\n    } else {\r\n      // Sistema simple\r\n      contactClassification = this.contactClassifications().find((c: any) => c.id === this.managementForm.resultadoContacto);\r\n      managementClassification = this.managementClassifications().find((g: any) => g.id === this.managementForm.tipoGestion);\r\n    }\r\n\r\n    // Obtener IDs de las 3 tipificaciones seleccionadas\r\n    const selectedClassifs = this.selectedClassifications();\r\n    const typificationLevel1Id = Number(selectedClassifs[0]);\r\n    const typificationLevel2Id = selectedClassifs[1] ? Number(selectedClassifs[1]) : null;\r\n    const typificationLevel3Id = selectedClassifs[2] ? Number(selectedClassifs[2]) : null;\r\n\r\n    // Get classification names\r\n    const allTypifications = this.managementClassifications();\r\n    const level1 = allTypifications.find((c: any) => c.id.toString() === selectedClassifs[0]);\r\n    const level2 = selectedClassifs[1] ? allTypifications.find((c: any) => c.id.toString() === selectedClassifs[1]) : null;\r\n    const level3 = selectedClassifs[2] ? allTypifications.find((c: any) => c.id.toString() === selectedClassifs[2]) : null;\r\n\r\n    // Verificar si hay un cronograma de pago en los campos din√°micos\r\n    const dynamicValues = this.dynamicFieldValues();\r\n    const schema = this.dynamicFieldsSchema();\r\n    let paymentScheduleData = null;\r\n\r\n    console.log('[SAVE] === DEBUG PAYMENT SCHEDULE ===');\r\n    console.log('[SAVE] dynamicValues:', dynamicValues);\r\n    console.log('[SAVE] schema:', schema);\r\n    console.log('[SAVE] schema.fields:', schema?.fields);\r\n\r\n    // Buscar el campo payment_schedule en el schema y obtener su valor\r\n    if (schema && schema.fields) {\r\n      const paymentScheduleField = schema.fields.find(f => f.type === 'payment_schedule');\r\n      console.log('[SAVE] paymentScheduleField found:', paymentScheduleField);\r\n      if (paymentScheduleField) {\r\n        console.log('[SAVE] Looking for field id:', paymentScheduleField.id);\r\n        console.log('[SAVE] Value in dynamicValues:', dynamicValues[paymentScheduleField.id]);\r\n      }\r\n      if (paymentScheduleField && dynamicValues[paymentScheduleField.id]) {\r\n        paymentScheduleData = dynamicValues[paymentScheduleField.id];\r\n        console.log('[SAVE] Payment schedule detected:', paymentScheduleData);\r\n      }\r\n    }\r\n    console.log('[SAVE] Final paymentScheduleData:', paymentScheduleData);\r\n\r\n    // ‚ö†Ô∏è VALIDACI√ìN: No permitir registrar nueva promesa si hay cuotas pendientes\r\n    if (paymentScheduleData && paymentScheduleData.cuotas && paymentScheduleData.cuotas.length > 0) {\r\n      const activeSchedules = this.activePaymentSchedules();\r\n      const hasPendingInstallments = activeSchedules.some(schedule => schedule.cuotasPendientes > 0);\r\n\r\n      if (hasPendingInstallments) {\r\n        this.saving.set(false);\r\n        alert('‚ö†Ô∏è No puede registrar una nueva Promesa de Pago.\\n\\nEl cliente ya tiene una promesa de pago activa con cuotas pendientes.\\n\\nDebe esperar a que se completen o cancelen las cuotas pendientes antes de registrar una nueva promesa.');\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Si hay cronograma de pago con cuotas, usar el endpoint espec√≠fico\r\n    if (paymentScheduleData && paymentScheduleData.cuotas && paymentScheduleData.cuotas.length > 0) {\r\n      const finalTypificationId = typificationLevel3Id || typificationLevel2Id || typificationLevel1Id;\r\n\r\n      // Determinar si es una llamada activa o gesti√≥n manual\r\n      const isActiveCallSchedule = this.callActive() || !!this.callStartTime;\r\n\r\n      // Obtener el ID del agente actual\r\n      const currentUserSchedule = this.authService.getCurrentUser();\r\n\r\n      const scheduleRequest: PaymentScheduleRequest = {\r\n        idCliente: this.customerData().id || 0,\r\n        nombreCliente: this.customerData().nombre_completo,\r\n        documentoCliente: this.customerData().numero_documento,\r\n        idAgente: currentUserSchedule?.id || 1,\r\n        idTenant: this.selectedTenantId!,\r\n        idCartera: this.selectedPortfolioId || 1,\r\n        idSubcartera: this.selectedSubPortfolioId,\r\n        idTipificacion: finalTypificationId,\r\n        observaciones: this.managementForm.observaciones,\r\n        metodoContacto: isActiveCallSchedule ? 'GESTION_PROGRESIVO' : 'GESTION_MANUAL',\r\n        canalContacto: isActiveCallSchedule ? 'LLAMADA_SALIENTE' : undefined,\r\n        campoMontoOrigen: paymentScheduleData.campoMontoOrigen,  // Campo de origen del monto (ej: sld_mora)\r\n        montoBase: paymentScheduleData.montoBase,  // Monto original del campo (antes de excepci√≥n). null = monto libre\r\n        schedule: {\r\n          montoTotal: paymentScheduleData.montoTotal,\r\n          numeroCuotas: paymentScheduleData.numeroCuotas,\r\n          cuotas: paymentScheduleData.cuotas.map((cuota: any) => ({\r\n            numeroCuota: cuota.numeroCuota,\r\n            monto: cuota.monto,\r\n            fechaPago: cuota.fechaPago\r\n          }))\r\n        }\r\n      };\r\n\r\n      console.log('[SAVE] Creating payment schedule with request:', scheduleRequest);\r\n\r\n      this.managementService.createPaymentSchedule(scheduleRequest).subscribe({\r\n        next: (records) => {\r\n          console.log('[SAVE] Payment schedule created successfully:', records);\r\n          // Mostrar modal para generar Carta de Acuerdo SOLO si el monto seleccionado tiene generaCartaAcuerdo = true\r\n          // records puede ser un array o un objeto con id\r\n          const idGestion = Array.isArray(records) && records.length > 0 ? records[0].id : records?.id;\r\n          const debeGenerarCarta = paymentScheduleData.generaCartaAcuerdo === true;\r\n\r\n          if (idGestion && debeGenerarCarta) {\r\n            console.log('[CARTA] Monto seleccionado requiere carta de acuerdo, mostrando modal...');\r\n            this.mostrarModalGenerarCarta(idGestion, contactClassification?.label || '', managementClassification?.label || '-');\r\n          } else {\r\n            if (idGestion && !debeGenerarCarta) {\r\n              console.log('[CARTA] Monto seleccionado NO requiere carta de acuerdo, omitiendo modal.');\r\n            }\r\n            this.onSaveSuccess(contactClassification?.label || '', managementClassification?.label || '-');\r\n          }\r\n        },\r\n        error: (error) => {\r\n          console.error('Error al guardar cronograma de pago:', error);\r\n          this.saving.set(false);\r\n          alert('‚ö†Ô∏è Error al guardar el cronograma de pago. Por favor intente nuevamente.');\r\n        }\r\n      });\r\n    } else {\r\n      // Gesti√≥n normal sin cronograma de pago\r\n      // Determinar si es una llamada activa o gesti√≥n manual\r\n      const isActiveCall = this.callActive() || !!this.callStartTime;\r\n\r\n      // Obtener informaci√≥n del usuario actual\r\n      const currentUser = this.authService.getCurrentUser();\r\n\r\n      const request: CreateManagementRequest = {\r\n        customerId: String(this.customerData().id),\r\n        customerName: this.customerData().nombre_completo || '',\r\n        customerDocument: this.customerData().numero_documento || '',\r\n        advisorId: 'ADV-001',\r\n\r\n        // Multi-tenant fields\r\n        tenantId: this.selectedTenantId!,\r\n        portfolioId: this.selectedPortfolioId || 1,\r\n        subPortfolioId: 1,\r\n\r\n        // Phone from customer data\r\n        phone: this.customerData().contacto?.telefono_principal || '',\r\n\r\n        // Hierarchy levels with IDs and names\r\n        level1Id: typificationLevel1Id,\r\n        level1Name: level1?.label || '',\r\n        level2Id: typificationLevel2Id,\r\n        level2Name: level2?.label || null,\r\n        level3Id: typificationLevel3Id,\r\n        level3Name: level3?.label || null,\r\n\r\n        observations: this.managementForm.observaciones,\r\n\r\n        // Campos de contexto de gesti√≥n\r\n        metodoContacto: isActiveCall ? 'GESTION_PROGRESIVO' : 'GESTION_MANUAL',\r\n        canalContacto: isActiveCall ? 'LLAMADA_SALIENTE' : undefined,\r\n        idCampana: null,  // Se puede obtener del contexto si hay campa√±a activa\r\n        idLlamada: null,  // Se puede obtener si hay ID de llamada en el sistema\r\n        duracionSegundos: isActiveCall && this.callStartTime ? this.calculateCallDurationSeconds() : null,\r\n\r\n        // Informaci√≥n del agente y dispositivo\r\n        nombreAgente: currentUser?.username || currentUser?.firstName || 'Sistema',\r\n        userAgent: navigator.userAgent\r\n      };\r\n\r\n      this.managementService.createManagement(request).subscribe({\r\n        next: (response) => {\r\n          if (this.callStartTime && this.callActive()) {\r\n            this.registerCallToBackend(response.id);\r\n          }\r\n\r\n          // Si es una cancelaci√≥n y hay cuota seleccionada, registrar el pago\r\n          // Usa el nuevo endpoint que distribuye autom√°ticamente entre cuotas\r\n          const selectedCuota = this.selectedInstallmentForCancellation();\r\n          if (this.isCancellationTypification() && selectedCuota && selectedCuota.id) {\r\n            // Usar los valores editables (monto y fecha)\r\n            const montoPago = this.montoPagoEditable() || selectedCuota.monto;\r\n            const fechaPago = this.fechaPagoEditable() || new Date().toISOString().split('T')[0];\r\n\r\n            console.log('üí∞ Registrando pago:', {\r\n              cuota: selectedCuota.numeroCuota,\r\n              montoOriginal: selectedCuota.monto,\r\n              montoPagado: montoPago,\r\n              fecha: fechaPago\r\n            });\r\n\r\n            // Buscar el grupoPromesaUuid de la cuota\r\n            const schedule = this.activePaymentSchedules().find(s =>\r\n              s.installments?.some((c: any) => c.id === selectedCuota.id)\r\n            );\r\n            const grupoPromesaUuid = schedule?.grupoPromesaUuid || schedule?.id;\r\n\r\n            if (!grupoPromesaUuid) {\r\n              console.error('No se encontr√≥ el grupoPromesaUuid');\r\n              this.selectedInstallmentForCancellation.set(null);\r\n              this.onSaveSuccess(contactClassification?.label || '', managementClassification?.label || '-');\r\n              return;\r\n            }\r\n\r\n            const currentUser = this.authService.getCurrentUser();\r\n\r\n            // Usar el nuevo endpoint de pagos\r\n            this.http.post<any>(`${environment.apiUrl}/pagos/registrar`, {\r\n              grupoPromesaUuid: grupoPromesaUuid,\r\n              monto: montoPago,\r\n              fechaPago: fechaPago,\r\n              banco: null,\r\n              numeroOperacion: null,\r\n              agenteId: currentUser?.id || 1,\r\n              metodoRegistro: 'MANUAL',\r\n              observaciones: this.managementForm.observaciones || 'Pago registrado desde gesti√≥n',\r\n              comprobanteUrl: null\r\n            }).subscribe({\r\n              next: (result) => {\r\n                console.log('‚úÖ Pago registrado exitosamente:', result);\r\n                // Limpiar la selecci√≥n y campos editables\r\n                this.selectedInstallmentForCancellation.set(null);\r\n                this.montoPagoEditable.set(0);\r\n                this.fechaPagoEditable.set('');\r\n                // Recargar los cronogramas activos para reflejar el cambio\r\n                const customerId = this.customerData().id;\r\n                if (customerId) {\r\n                  this.loadActivePaymentSchedules(customerId);\r\n                }\r\n                this.onSaveSuccess(contactClassification?.label || '', managementClassification?.label || '-');\r\n              },\r\n              error: (err) => {\r\n                console.error('‚ö†Ô∏è Error registrando pago:', err);\r\n                if (err.error?.error || err.error?.mensaje) {\r\n                  alert(`‚ö†Ô∏è ${err.error.error || err.error.mensaje || 'Error al registrar el pago.'}`);\r\n                }\r\n                // Aunque falle el pago, la gesti√≥n ya se guard√≥\r\n                this.selectedInstallmentForCancellation.set(null);\r\n                this.onSaveSuccess(contactClassification?.label || '', managementClassification?.label || '-');\r\n              }\r\n            });\r\n          } else {\r\n            this.onSaveSuccess(contactClassification?.label || '', managementClassification?.label || '-');\r\n          }\r\n        },\r\n        error: (error) => {\r\n          console.error('Error al guardar gesti√≥n:', error);\r\n          this.saving.set(false);\r\n          alert('‚ö†Ô∏è Error al guardar la gesti√≥n. Por favor intente nuevamente.');\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  private registerCallToBackend(managementId: number) {\r\n    if (!this.callStartTime) return;\r\n\r\n    const startCallRequest: StartCallRequest = {\r\n      phoneNumber: this.customerData().contacto.telefono_principal,\r\n      startTime: this.callStartTime\r\n    };\r\n\r\n    this.managementService.startCall(managementId, startCallRequest).subscribe({\r\n      next: (response) => {\r\n        if (!this.callActive()) {\r\n          const endCallRequest: EndCallRequest = {\r\n            endTime: new Date().toISOString()\r\n          };\r\n          this.managementService.endCall(managementId, endCallRequest).subscribe({\r\n            next: () => {},\r\n            error: (err) => console.error('Error al finalizar llamada:', err)\r\n          });\r\n        }\r\n      },\r\n      error: (error) => {\r\n        console.error('Error al registrar llamada:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  private registerPaymentToBackend(managementId: string) {\r\n    if (!this.managementForm.montoPago || !this.managementForm.metodoPago) return;\r\n\r\n    const paymentRequest: RegisterPaymentRequest = {\r\n      amount: parseFloat(this.managementForm.montoPago),\r\n      scheduledDate: new Date().toISOString().split('T')[0],\r\n      paymentMethodType: this.managementForm.metodoPago,\r\n      paymentMethodDetails: this.managementForm.ultimos4Tarjeta || undefined,\r\n      voucherNumber: undefined,\r\n      bankName: this.managementForm.bancoSeleccionado || undefined\r\n    };\r\n\r\n    this.managementService.registerPayment(managementId, paymentRequest).subscribe({\r\n      next: (response) => {},\r\n      error: (error) => {\r\n        console.error('Error al registrar pago:', error);\r\n      }\r\n    });\r\n  }\r\n\r\n  private createScheduleToBackend(managementId: string) {\r\n    if (this.scheduleForm.cuotas.length === 0) return;\r\n\r\n    // Validar que todas las cuotas tengan monto y fecha\r\n    const hasInvalidInstallments = this.scheduleForm.cuotas.some(\r\n      cuota => !cuota.monto || !cuota.fechaVencimiento\r\n    );\r\n\r\n    if (hasInvalidInstallments) {\r\n      alert('‚ö†Ô∏è Por favor complete todos los montos y fechas de las cuotas');\r\n      return;\r\n    }\r\n\r\n    const scheduleRequest: any = {\r\n      customerId: String(this.customerData().id),\r\n      managementId: managementId,\r\n      scheduleType: this.scheduleForm.tipoCronograma,\r\n      negotiatedAmount: this.scheduleForm.montoNegociado ? parseFloat(this.scheduleForm.montoNegociado) : null,\r\n      installments: this.scheduleForm.cuotas.map(cuota => ({\r\n        installmentNumber: cuota.numero,\r\n        amount: parseFloat(cuota.monto),\r\n        dueDate: cuota.fechaVencimiento\r\n      }))\r\n    };\r\n\r\n    this.paymentScheduleService.createPaymentSchedule(scheduleRequest).subscribe({\r\n      next: (response) => {},\r\n      error: (error) => {\r\n        console.error('Error al crear cronograma:', error);\r\n        alert('‚ö†Ô∏è Error al crear el cronograma de pagos');\r\n      }\r\n    });\r\n  }\r\n\r\n  private onSaveSuccess(resultadoCodigo: string, gestionCodigo: string) {\r\n    this.saving.set(false);\r\n    this.showSuccess.set(true);\r\n\r\n    // Colgar la llamada SIP y detener timer (sin navegar todav√≠a)\r\n    this.endCall(false);\r\n\r\n    this.loadManagementHistory();\r\n\r\n    this.managementForm = {\r\n      resultadoContacto: '',\r\n      tipoGestion: '',\r\n      clasificacionNivel1: '',\r\n      clasificacionNivel2: '',\r\n      clasificacionNivel3: '',\r\n      motivoNoPago: '',\r\n      metodoPago: '',\r\n      montoPago: '',\r\n      fechaCompromiso: '',\r\n      horaCompromiso: '',\r\n      ultimos4Tarjeta: '',\r\n      bancoSeleccionado: '',\r\n      observaciones: '',\r\n      notasPrivadas: ''\r\n    };\r\n\r\n    this.callDuration.set(0);\r\n    this.callStartTime = undefined;\r\n\r\n    this.activeTab.set('historial');\r\n\r\n    // Desbloquear llamadas entrantes - tipificaci√≥n completada\r\n    this.isTipifying.set(false);\r\n    this.sipService.blockIncomingCallsMode(false);\r\n    console.log('‚úÖ Desbloqueando llamadas entrantes - tipificaci√≥n completada');\r\n\r\n    // Verificar si estamos en modo recordatorio dialer\r\n    const recordatorioEnCurso = sessionStorage.getItem('recordatorioEnCurso');\r\n    if (recordatorioEnCurso) {\r\n      console.log('üîî Modo recordatorio dialer activo, procesando siguiente...');\r\n      this.procesarSiguienteRecordatorio(JSON.parse(recordatorioEnCurso));\r\n      return;\r\n    }\r\n\r\n    // Flujo normal: cambiar estado a DISPONIBLE y volver al dashboard\r\n    console.log('‚úÖ Gesti√≥n guardada, cambiando estado a DISPONIBLE...');\r\n\r\n    const currentUser = this.authService.getCurrentUser();\r\n    const agentId = currentUser?.id || 1; // Fallback a 1 si no se obtiene\r\n    this.agentService.changeAgentStatus(agentId, { estado: AgentState.DISPONIBLE }).subscribe({\r\n      next: () => {\r\n        console.log('‚úÖ Estado cambiado a DISPONIBLE');\r\n        // Esperar 2 segundos para mostrar mensaje de √©xito, luego navegar\r\n        setTimeout(() => {\r\n          this.showSuccess.set(false);\r\n          console.log('üîÑ Navegando a /agent-dashboard...');\r\n          this.router.navigate(['/agent-dashboard']);\r\n        }, 2000);\r\n      },\r\n      error: (err: any) => {\r\n        console.error('‚ùå Error cambiando estado:', err);\r\n        // Navegar de todas formas aunque falle el cambio de estado\r\n        setTimeout(() => {\r\n          this.showSuccess.set(false);\r\n          this.router.navigate(['/agent-dashboard']);\r\n        }, 2000);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Procesa el siguiente recordatorio despu√©s de completar la tipificaci√≥n\r\n   */\r\n  private procesarSiguienteRecordatorio(recordatorioActual: any): void {\r\n    const currentUser = this.authService.getCurrentUser();\r\n    const agentId = currentUser?.id || recordatorioActual.idAgente;\r\n\r\n    // Completar el recordatorio actual en el backend\r\n    this.recordatoriosService.completarActual(agentId, 'CONTESTADO').subscribe({\r\n      next: (response) => {\r\n        console.log('üîî Recordatorio completado:', response);\r\n\r\n        if (response.terminado) {\r\n          // Ya no hay m√°s recordatorios - mostrar modal de finalizaci√≥n\r\n          console.log('üîî Todos los recordatorios completados');\r\n          sessionStorage.removeItem('recordatorioEnCurso');\r\n\r\n          // Mostrar modal de finalizaci√≥n\r\n          setTimeout(() => {\r\n            this.showSuccess.set(false);\r\n            this.mostrarModalRecordatoriosFinalizado(agentId);\r\n          }, 1000);\r\n        } else {\r\n          // Obtener el siguiente recordatorio\r\n          this.recordatoriosService.obtenerSiguiente(agentId).subscribe({\r\n            next: (siguienteResp) => {\r\n              if (siguienteResp.hayMas && siguienteResp.recordatorio) {\r\n                console.log('üîî Siguiente recordatorio:', siguienteResp.recordatorio);\r\n\r\n                // Guardar el nuevo recordatorio en sesi√≥n\r\n                sessionStorage.setItem('recordatorioEnCurso', JSON.stringify({\r\n                  idCuota: siguienteResp.recordatorio.idCuota,\r\n                  idAgente: agentId,\r\n                  idCliente: siguienteResp.recordatorio.idCliente,\r\n                  nombreCliente: siguienteResp.recordatorio.nombreCliente,\r\n                  telefono: siguienteResp.recordatorio.telefono,\r\n                  monto: siguienteResp.recordatorio.monto,\r\n                  numeroCuota: siguienteResp.recordatorio.numeroCuota,\r\n                  totalCuotas: siguienteResp.recordatorio.totalCuotas\r\n                }));\r\n\r\n                // Iniciar cuenta regresiva y luego llamar\r\n                this.showSuccess.set(false);\r\n                this.mostrarCountdownYLlamar(siguienteResp.recordatorio);\r\n              } else {\r\n                // No hay m√°s recordatorios\r\n                sessionStorage.removeItem('recordatorioEnCurso');\r\n                this.showSuccess.set(false);\r\n                this.mostrarModalRecordatoriosFinalizado(agentId);\r\n              }\r\n            },\r\n            error: (err) => {\r\n              console.error('Error obteniendo siguiente recordatorio:', err);\r\n              sessionStorage.removeItem('recordatorioEnCurso');\r\n              this.showSuccess.set(false);\r\n              this.router.navigate(['/agent-dashboard']);\r\n            }\r\n          });\r\n        }\r\n      },\r\n      error: (err) => {\r\n        console.error('Error completando recordatorio:', err);\r\n        sessionStorage.removeItem('recordatorioEnCurso');\r\n        this.showSuccess.set(false);\r\n        this.router.navigate(['/agent-dashboard']);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Muestra countdown animado y luego inicia la llamada\r\n   */\r\n  private mostrarCountdownYLlamar(recordatorio: any): void {\r\n    const dialogRef = this.dialog.open(RecordatoriosModalComponent, {\r\n      width: '450px',\r\n      disableClose: true,\r\n      data: {\r\n        cantidad: 0,\r\n        pendientes: 1,\r\n        idAgente: this.authService.getCurrentUser()?.id || 0,\r\n        // Indicar que es un \"siguiente\" no un inicio\r\n        modoSiguiente: true,\r\n        recordatorio: recordatorio\r\n      }\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      if (result?.action === 'call' && result.recordatorio) {\r\n        // Iniciar la llamada\r\n        this.sipService.call(result.recordatorio.telefono);\r\n      } else if (result?.action === 'cancelled') {\r\n        sessionStorage.removeItem('recordatorioEnCurso');\r\n        this.router.navigate(['/agent-dashboard']);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Muestra el modal de recordatorios finalizados\r\n   */\r\n  private mostrarModalRecordatoriosFinalizado(agentId: number): void {\r\n    const dialogRef = this.dialog.open(RecordatoriosModalComponent, {\r\n      width: '450px',\r\n      disableClose: true,\r\n      data: {\r\n        cantidad: 0,\r\n        pendientes: 0,\r\n        idAgente: agentId,\r\n        modoFinalizado: true\r\n      }\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe(() => {\r\n      // Cambiar estado a disponible y navegar al dashboard\r\n      this.agentService.changeAgentStatus(agentId, { estado: AgentState.DISPONIBLE }).subscribe({\r\n        next: () => this.router.navigate(['/agent-dashboard']),\r\n        error: () => this.router.navigate(['/agent-dashboard'])\r\n      });\r\n    });\r\n  }\r\n\r\n  private validateForm(): boolean {\r\n    const newErrors: ValidationErrors = {};\r\n\r\n    // 1. Validar clasificaci√≥n (sistema jer√°rquico o simple)\r\n    if (this.usesHierarchicalClassifications()) {\r\n      // Sistema jer√°rquico: verificar que se haya seleccionado clasificaci√≥n completa\r\n      const selected = this.selectedClassifications();\r\n      if (selected.length === 0 || !selected[selected.length - 1]) {\r\n        newErrors['typification'] = 'Debe seleccionar una clasificaci√≥n';\r\n      } else {\r\n        // TEMPORAL: No verificar isLeaf, verificar si hay hijos disponibles\r\n        const lastSelectedId = selected[selected.length - 1];\r\n        const all: any[] = this.managementClassifications() as any[];\r\n        const hasChildren = all.some((c: any) => c.parentId && Number(c.parentId) === Number(lastSelectedId));\r\n\r\n        if (hasChildren) {\r\n          newErrors['typification'] = 'Debe completar todos los niveles de clasificaci√≥n';\r\n        }\r\n      }\r\n    } else {\r\n      // Sistema simple: verificar resultado de contacto\r\n      if (!this.managementForm.resultadoContacto) {\r\n        newErrors['resultadoContacto'] = 'Requerido';\r\n      }\r\n\r\n      if (this.showManagementType() && !this.managementForm.tipoGestion) {\r\n        newErrors['tipoGestion'] = 'Requerido';\r\n      }\r\n    }\r\n\r\n    // 2. Validar campos de pago si son requeridos\r\n    // NOTA: Los campos de pago ahora son campos din√°micos (monto_pagado, metodo_pago, etc.)\r\n    // Se validan autom√°ticamente en el paso 3 como parte de los campos din√°micos requeridos\r\n\r\n    // 3. Validar campos din√°micos requeridos\r\n    const schema = this.dynamicFieldsSchema();\r\n    if (schema && schema.fields && schema.fields.length > 0) {\r\n      const dynamicValues = this.dynamicFieldValues();\r\n\r\n      for (const field of schema.fields) {\r\n        if (field.required) {\r\n          const value = dynamicValues[field.id];\r\n\r\n          // Verificar si el campo est√° vac√≠o\r\n          if (value === undefined || value === null || value === '') {\r\n            newErrors[`dynamic_${field.id}`] = `${field.label} es requerido`;\r\n          }\r\n\r\n          // Para campos tipo tabla, verificar que tenga al menos una fila\r\n          if (field.type === 'table' && (!Array.isArray(value) || value.length === 0)) {\r\n            newErrors[`dynamic_${field.id}`] = `${field.label} debe tener al menos una fila`;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    this.errors.set(newErrors);\r\n\r\n    if (Object.keys(newErrors).length > 0) {\r\n      alert('Por favor complete todos los campos requeridos');\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  calculateRemaining(): string {\r\n    if (!this.managementForm.montoPago) return '0.00';\r\n    const monto = parseFloat(this.managementForm.montoPago);\r\n    const restante = this.customerData().deuda.saldo_total - monto;\r\n    return restante.toFixed(2);\r\n  }\r\n\r\n  toggleDarkMode() {\r\n    this.themeService.toggleTheme();\r\n  }\r\n\r\n  /**\r\n   * Obtiene el valor de un campo del cliente usando notaci√≥n de punto\r\n   * Ejemplo: 'contactInfo.mobilePhone' ‚Üí customerData.contactInfo.mobilePhone\r\n   */\r\n  getFieldValue(field: string): any {\r\n    const customer = this.customerData();\r\n    if (!customer) return null;\r\n\r\n    return field.split('.').reduce((obj: any, key: string) => obj?.[key], customer);\r\n  }\r\n\r\n  /**\r\n   * Formatea un valor seg√∫n su tipo\r\n   */\r\n  formatFieldValue(value: any, format?: string): string {\r\n    if (value === null || value === undefined || value === '') {\r\n      return '-';\r\n    }\r\n\r\n    switch (format) {\r\n      case 'currency':\r\n        return 'S/ ' + Number(value).toFixed(2).replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\r\n\r\n      case 'number':\r\n        return String(value);\r\n\r\n      case 'date':\r\n        if (typeof value === 'string') {\r\n          const date = new Date(value);\r\n          return date.toLocaleDateString('es-PE');\r\n        }\r\n        return String(value);\r\n\r\n      default:\r\n        return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Verifica si un campo es de contacto (para excluirlo de la lista principal)\r\n   * ya que estos campos se muestran en la secci√≥n de Contacto\r\n   */\r\n  isContactField(fieldName: string): boolean {\r\n    const contactFields = [\r\n      'celular',\r\n      'telefono',\r\n      'telefono_principal',\r\n      'telefono_alternativo',\r\n      'telefono_trabajo',\r\n      'email',\r\n      'correo',\r\n      'direccion',\r\n      'address'\r\n    ];\r\n    const lowerField = fieldName.toLowerCase();\r\n    return contactFields.some(cf => lowerField.includes(cf));\r\n  }\r\n\r\n  /**\r\n   * Formatea una fecha para mostrar en la UI\r\n   * Usa parseDateLocal para fechas string YYYY-MM-DD para evitar bug de timezone\r\n   */\r\n  formatDate(dateValue: string | Date): string {\r\n    if (!dateValue) return '-';\r\n\r\n    try {\r\n      let date: Date;\r\n      if (typeof dateValue === 'string') {\r\n        // Si es formato YYYY-MM-DD, usar parseDateLocal para evitar bug de timezone\r\n        if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateValue)) {\r\n          date = this.parseDateLocal(dateValue);\r\n        } else {\r\n          date = new Date(dateValue);\r\n        }\r\n      } else {\r\n        date = dateValue;\r\n      }\r\n      return date.toLocaleDateString('es-PE', {\r\n        day: '2-digit',\r\n        month: '2-digit',\r\n        year: 'numeric'\r\n      });\r\n    } catch {\r\n      return String(dateValue);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calcula el saldo pendiente de una cuota\r\n   * saldoPendiente = monto - montoPagadoReal\r\n   */\r\n  getSaldoPendienteCuota(cuota: any): number {\r\n    const pagado = cuota?.montoPagadoReal || 0;\r\n    return Math.max(0, (cuota?.monto || 0) - pagado);\r\n  }\r\n\r\n  /**\r\n   * Verifica si una cuota tiene pago parcial\r\n   */\r\n  tienePagoParcial(cuota: any): boolean {\r\n    return (cuota?.montoPagadoReal || 0) > 0;\r\n  }\r\n\r\n  /**\r\n   * Muestra el detalle de un cronograma de pago\r\n   */\r\n  showPaymentScheduleDetail(schedule: any) {\r\n    console.log('üìÖ Detalle de promesa de pago:', schedule);\r\n\r\n    // Construir mensaje con las cuotas\r\n    let message = `PROMESA DE PAGO\\n\\n`;\r\n    message += `Monto Total: S/ ${schedule.totalAmount?.toFixed(2) || '0.00'}\\n`;\r\n    message += `N√∫mero de Cuotas: ${schedule.numberOfInstallments}\\n\\n`;\r\n    message += `DETALLE DE CUOTAS:\\n`;\r\n\r\n    if (schedule.installments && schedule.installments.length > 0) {\r\n      for (const cuota of schedule.installments) {\r\n        const fechaStr = cuota.dueDate ? this.formatDate(cuota.dueDate) : '-';\r\n        let estadoStr = '‚è≥ Pendiente';\r\n        if (cuota.status === 'PAGADA' || cuota.status === 'PAGADO' || cuota.status === 'CUMPLIDO') {\r\n          estadoStr = '‚úÖ PAGADA';\r\n        } else if (cuota.status === 'VENCIDA' || cuota.status === 'VENCIDO') {\r\n          estadoStr = '‚ö†Ô∏è VENCIDA';\r\n        } else if (cuota.status === 'CANCELADA' || cuota.status === 'CANCELADO') {\r\n          estadoStr = '‚úó CANCELADA';\r\n        }\r\n        message += `  Cuota ${cuota.numeroCuota}: S/ ${cuota.monto?.toFixed(2) || '0.00'} - ${fechaStr} - ${estadoStr}\\n`;\r\n      }\r\n    }\r\n\r\n    alert(message);\r\n  }\r\n\r\n  getContactClassificationLabel(id: string): string {\r\n    const typification = this.contactClassifications().find(c => c.id === id);\r\n    if (!typification) return id;\r\n\r\n    const label = typification.label || typification.codigo;\r\n    return `[${typification.codigo}] ${label}`;\r\n  }\r\n\r\n  getManagementClassificationLabel(id: string): string {\r\n    const typification = this.managementClassifications().find(g => g.id === id);\r\n    if (!typification) return id;\r\n\r\n    const label = typification.label || typification.codigo;\r\n    return `[${typification.codigo}] ${label}`;\r\n  }\r\n\r\n  getTableRows(fieldCode: string): any[] {\r\n    const data = this.dynamicFieldValues()[fieldCode];\r\n    if (Array.isArray(data)) {\r\n      return data;\r\n    }\r\n    return [];\r\n  }\r\n\r\n  addTableRow(fieldCode: string, columns: any[]) {\r\n    if (!Array.isArray(columns)) {\r\n      console.error('addTableRow: columns no es un array v√°lido', columns);\r\n      return;\r\n    }\r\n\r\n    const currentValues = { ...this.dynamicFieldValues() };\r\n    \r\n    if (!Array.isArray(currentValues[fieldCode])) {\r\n      currentValues[fieldCode] = [];\r\n    }\r\n\r\n    const newRow = this.createEmptyTableRow(columns);\r\n    (currentValues[fieldCode] as any[]).push(newRow);\r\n\r\n    this.dynamicFieldValues.set(currentValues);\r\n  }\r\n\r\n  removeTableRow(fieldCode: string, rowIndex: number) {\r\n    const currentValues = { ...this.dynamicFieldValues() };\r\n    \r\n    if (Array.isArray(currentValues[fieldCode])) {\r\n      (currentValues[fieldCode] as any[]).splice(rowIndex, 1);\r\n      this.dynamicFieldValues.set(currentValues);\r\n    }\r\n  }\r\n\r\n  private createEmptyTableRow(columns: any[]): any {\r\n    const row: any = {};\r\n    \r\n    columns.forEach(column => {\r\n      if (column.type === 'auto-number') {\r\n        row[column.id] = null;\r\n      } else if (column.type === 'number' || column.type === 'currency') {\r\n        row[column.id] = column.defaultValue || 0;\r\n      } else if (column.type === 'date') {\r\n        row[column.id] = column.defaultValue || '';\r\n      } else {\r\n        row[column.id] = column.defaultValue || '';\r\n      }\r\n    });\r\n\r\n    return row;\r\n  }\r\n\r\n  /**\r\n   * Busca un cliente por documento de testing\r\n   */\r\n  searchByTestDocument() {\r\n    if (!this.testDocument.trim() || !this.selectedTenantId) {\r\n      console.warn('[TEST] Documento vac√≠o o tenant no seleccionado');\r\n      return;\r\n    }\r\n\r\n    console.log('[TEST] Buscando cliente por documento:', this.testDocument);\r\n    this.customerService.searchCustomersByCriteria(this.selectedTenantId, 'documento', this.testDocument).subscribe({\r\n      next: (customers) => {\r\n        if (customers && customers.length > 0) {\r\n          console.log('[TEST] Cliente encontrado:', customers[0]);\r\n          this.loadCustomerFromResource(customers[0]);\r\n        } else {\r\n          console.warn('[TEST] No se encontr√≥ cliente con documento:', this.testDocument);\r\n          alert('No se encontr√≥ cliente con el documento: ' + this.testDocument);\r\n        }\r\n      },\r\n      error: (error) => {\r\n        console.error('[TEST] Error buscando cliente:', error);\r\n        alert('Error buscando cliente');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Busca un cliente por tel√©fono de testing\r\n   */\r\n  searchByTestPhone() {\r\n    if (!this.testPhone.trim() || !this.selectedTenantId) {\r\n      console.warn('[TEST] Tel√©fono vac√≠o o tenant no seleccionado');\r\n      return;\r\n    }\r\n\r\n    console.log('[TEST] Buscando cliente por tel√©fono:', this.testPhone);\r\n    this.customerService.searchCustomersByCriteria(this.selectedTenantId, 'telefono', this.testPhone).subscribe({\r\n      next: (customers) => {\r\n        if (customers && customers.length > 0) {\r\n          console.log('[TEST] Cliente encontrado:', customers[0]);\r\n          this.loadCustomerFromResource(customers[0]);\r\n        } else {\r\n          console.warn('[TEST] No se encontr√≥ cliente con tel√©fono:', this.testPhone);\r\n          alert('No se encontr√≥ cliente con el tel√©fono: ' + this.testPhone);\r\n        }\r\n      },\r\n      error: (error) => {\r\n        console.error('[TEST] Error buscando cliente:', error);\r\n        alert('Error buscando cliente');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Carga un cliente desde un CustomerResource\r\n   * Similar a loadFirstCustomer pero reutilizable\r\n   */\r\n  private loadCustomerFromResource(customer: any) {\r\n    console.log('[TEST] Cargando cliente:', customer);\r\n\r\n    // Guardar los datos raw del cliente para detectar columnas num√©ricas din√°micamente\r\n    this.rawClientData.set(customer);\r\n    console.log('[PAYMENT] Raw client data from resource:', customer);\r\n\r\n    // Cargar cabeceras de montos para esta subcartera\r\n    this.loadMontoCabeceras();\r\n\r\n    // Mapear CustomerResource a CustomerData\r\n    this.customerData.set({\r\n      id: customer.id,\r\n      id_cliente: customer.documentNumber || customer.identificationCode,\r\n      nombre_completo: customer.fullName || '',\r\n      tipo_documento: customer.documentType || 'DNI',\r\n      numero_documento: customer.documentNumber || '',\r\n      fecha_nacimiento: customer.birthDate || '',\r\n      edad: customer.age || null,\r\n      contacto: {\r\n        telefono_principal: customer.contactMethods?.find((cm: any) => cm.subtype === 'telefono_principal')?.value || '',\r\n        telefono_alternativo: customer.contactMethods?.find((cm: any) => cm.subtype === 'telefono_secundario')?.value || '',\r\n        telefono_trabajo: customer.contactMethods?.find((cm: any) => cm.subtype === 'telefono_trabajo')?.value || '',\r\n        email: customer.contactMethods?.find((cm: any) => cm.contactType === 'email')?.value || '',\r\n        direccion: customer.address || ''\r\n      },\r\n      cuenta: {\r\n        numero_cuenta: customer.accountNumber || '',\r\n        tipo_producto: 'PR√âSTAMO',\r\n        fecha_desembolso: '2024-01-15',\r\n        monto_original: customer.principalAmount || 0,\r\n        plazo_meses: 12,\r\n        tasa_interes: 2.5\r\n      },\r\n      deuda: {\r\n        saldo_capital: customer.principalAmount || 0,\r\n        intereses_vencidos: 0,\r\n        mora_acumulada: customer.overdueAmount || 0,\r\n        gastos_cobranza: 0,\r\n        saldo_total: (customer.principalAmount || 0) + (customer.overdueAmount || 0),\r\n        dias_mora: customer.overdueDays || 0,\r\n        fecha_ultimo_pago: '',\r\n        monto_ultimo_pago: 0\r\n      }\r\n    });\r\n\r\n    // Cargar historial de gestiones del cliente\r\n    this.loadManagementHistory();\r\n\r\n    // Cargar promesas de pago activas\r\n    if (customer.id) {\r\n      this.loadActivePaymentSchedules(customer.id);\r\n    }\r\n\r\n    console.log('[TEST] Cliente cargado exitosamente');\r\n  }\r\n\r\n  // ============================================\r\n  // M√âTODOS DE CONTROL DE LLAMADA (SIP)\r\n  // ============================================\r\n\r\n  /**\r\n   * Colgar llamada activa\r\n   */\r\n  hangupCall() {\r\n    console.log('üìµ Colgando llamada...');\r\n    this.sipService.hangup();\r\n  }\r\n\r\n  /**\r\n   * Alternar mutear/desmutear\r\n   */\r\n  toggleMute() {\r\n    if (this.isMuted()) {\r\n      console.log('üîä Desmuteando...');\r\n      this.sipService.unmute();\r\n      this.isMuted.set(false);\r\n    } else {\r\n      console.log('üîá Muteando...');\r\n      this.sipService.mute();\r\n      this.isMuted.set(true);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Verificar si est√° en llamada activa\r\n   */\r\n  isInActiveCall(): boolean {\r\n    return this.callState === CallState.ACTIVE;\r\n  }\r\n\r\n  /**\r\n   * Obtener texto del estado de llamada\r\n   */\r\n  getCallStateText(): string {\r\n    switch (this.callState) {\r\n      case CallState.IDLE: return 'LISTO';\r\n      case CallState.CONNECTING: return 'CONECTANDO...';\r\n      case CallState.RINGING: return 'TIMBRANDO...';\r\n      case CallState.ACTIVE: return 'EN LLAMADA';\r\n      case CallState.ENDED: return 'FINALIZADA';\r\n      default: return 'DESCONOCIDO';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Abre el modal para subir comprobante de pago\r\n   */\r\n  openComprobanteUploadDialog(): void {\r\n    const cuota = this.selectedInstallmentForCancellation();\r\n    const customer = this.customerData();\r\n    const currentUser = this.authService.getCurrentUser();\r\n\r\n    if (!cuota || !customer) {\r\n      console.warn('[COMPROBANTE] No hay cuota o cliente seleccionado');\r\n      return;\r\n    }\r\n\r\n    const dialogData: ComprobanteUploadDialogData = {\r\n      idCuota: cuota.id,\r\n      montoEsperado: cuota.monto || 0,\r\n      documentoEsperado: customer.numero_documento || '',\r\n      nombreCliente: customer.nombre_completo || '',\r\n      idAgente: currentUser?.id || 1\r\n    };\r\n\r\n    const dialogRef = this.dialog.open(ComprobanteUploadDialogComponent, {\r\n      width: '1100px',\r\n      maxWidth: '95vw',\r\n      data: dialogData,\r\n      disableClose: false,\r\n      backdropClass: 'comprobante-modal-backdrop',\r\n      panelClass: 'comprobante-modal-panel'\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result: ComprobanteUploadDialogResult) => {\r\n      if (result?.uploaded && result.response) {\r\n        console.log('[COMPROBANTE] Comprobante subido:', result.response);\r\n        this.uploadedComprobante.set(result.response);\r\n\r\n        // Actualizar campos editables con los valores detectados por OCR\r\n        const ocrResult = result.response.ocrResult;\r\n        if (ocrResult) {\r\n          // Actualizar monto si fue detectado\r\n          if (ocrResult.monto && ocrResult.monto > 0) {\r\n            console.log('[COMPROBANTE] Actualizando monto con OCR:', ocrResult.monto);\r\n            this.montoPagoEditable.set(ocrResult.monto);\r\n          }\r\n\r\n          // Actualizar fecha si fue detectada (formato esperado: YYYY-MM-DD o similar)\r\n          if (ocrResult.fecha) {\r\n            console.log('[COMPROBANTE] Actualizando fecha con OCR:', ocrResult.fecha);\r\n            // Intentar parsear la fecha del OCR\r\n            const fechaOcr = this.parseFechaOcr(ocrResult.fecha);\r\n            if (fechaOcr) {\r\n              this.fechaPagoEditable.set(fechaOcr);\r\n            }\r\n          }\r\n        }\r\n\r\n        // Mostrar advertencia si no coincide\r\n        if (!result.validacionesOk) {\r\n          console.warn('[COMPROBANTE] El comprobante tiene diferencias con los datos esperados');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Abre el modal para registrar pago con voucher (flujo nuevo)\r\n   * Auto-selecciona: Contacto Directo + Cancelaci√≥n + Cuota m√°s pr√≥xima\r\n   */\r\n  openVoucherPaymentDialog(schedule: any): void {\r\n    const customer = this.customerData();\r\n    const currentUser = this.authService.getCurrentUser();\r\n\r\n    if (!customer) {\r\n      console.warn('[VOUCHER] No hay cliente seleccionado');\r\n      return;\r\n    }\r\n\r\n    if (!schedule.installments || schedule.installments.length === 0) {\r\n      console.warn('[VOUCHER] No hay cuotas en el cronograma');\r\n      return;\r\n    }\r\n\r\n    // Preparar cuotas para el di√°logo\r\n    const cuotas = schedule.installments.map((c: any) => ({\r\n      id: c.id,\r\n      numeroCuota: c.numeroCuota,\r\n      monto: c.monto,\r\n      dueDate: c.dueDate,\r\n      status: c.status,\r\n      montoPagadoReal: c.montoPagadoReal || 0\r\n    }));\r\n\r\n    const dialogData: VoucherPaymentDialogData = {\r\n      nombreCliente: customer.nombre_completo || '',\r\n      documentoCliente: customer.numero_documento || '',\r\n      idCliente: customer.id || 0,\r\n      idAgente: currentUser?.id || 1,\r\n      cuotas: cuotas,\r\n      grupoPromesaUuid: schedule.grupoPromesaUuid || schedule.id\r\n    };\r\n\r\n    const dialogRef = this.dialog.open(VoucherPaymentDialogComponent, {\r\n      width: '1100px',\r\n      maxWidth: '95vw',\r\n      data: dialogData,\r\n      disableClose: false,\r\n      backdropClass: 'voucher-modal-backdrop',\r\n      panelClass: 'voucher-modal-panel'\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result: VoucherPaymentDialogResult) => {\r\n      if (result?.confirmed && result.autoSelect) {\r\n        console.log('[VOUCHER] Pago confirmado, auto-seleccionando:', result.autoSelect);\r\n\r\n        // Auto-seleccionar la clasificaci√≥n: Contacto Directo\r\n        this.autoSelectClassification(result.autoSelect.categoriaId, result.autoSelect.detalleId);\r\n\r\n        // Auto-seleccionar la cuota\r\n        this.selectedInstallmentForCancellation.set(result.autoSelect.cuotaSeleccionada);\r\n\r\n        // Auto-llenar observaciones\r\n        this.managementForm.observaciones = result.autoSelect.observaciones;\r\n\r\n        // Guardar el comprobante subido\r\n        if (result.ocrResponse) {\r\n          this.uploadedComprobante.set(result.ocrResponse);\r\n\r\n          // Auto-llenar monto y fecha con los valores del OCR\r\n          const ocrResult = result.ocrResponse.ocrResult;\r\n          if (ocrResult) {\r\n            // Actualizar monto si fue detectado\r\n            if (ocrResult.monto && ocrResult.monto > 0) {\r\n              console.log('[VOUCHER] Actualizando monto con OCR:', ocrResult.monto);\r\n              this.montoPagoEditable.set(ocrResult.monto);\r\n            } else {\r\n              // Si no hay monto OCR, usar el monto de la cuota seleccionada\r\n              this.montoPagoEditable.set(result.autoSelect.cuotaSeleccionada.monto || 0);\r\n            }\r\n\r\n            // Actualizar fecha si fue detectada\r\n            if (ocrResult.fecha) {\r\n              console.log('[VOUCHER] Actualizando fecha con OCR:', ocrResult.fecha);\r\n              const fechaParsed = this.parseFechaOcr(ocrResult.fecha);\r\n              if (fechaParsed) {\r\n                this.fechaPagoEditable.set(fechaParsed);\r\n              } else {\r\n                // Si no se pudo parsear, usar fecha de hoy\r\n                this.fechaPagoEditable.set(new Date().toISOString().split('T')[0]);\r\n              }\r\n            } else {\r\n              // Si no hay fecha OCR, usar fecha de hoy\r\n              this.fechaPagoEditable.set(new Date().toISOString().split('T')[0]);\r\n            }\r\n          }\r\n        }\r\n\r\n        // Mostrar mensaje de √©xito\r\n        console.log('[VOUCHER] Formulario auto-completado. Listo para guardar.');\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Auto-selecciona la clasificaci√≥n jer√°rquica por c√≥digos o labels\r\n   */\r\n  private autoSelectClassification(categoriaCode: string, detalleCode: string): void {\r\n    // Usar directamente managementClassifications en lugar de hierarchyLevels\r\n    // porque hierarchyLevels depende de selecciones previas\r\n    const allClassifications: any[] = this.managementClassifications() as any[];\r\n\r\n    if (!allClassifications || allClassifications.length === 0) {\r\n      console.warn('[VOUCHER] No hay clasificaciones disponibles');\r\n      return;\r\n    }\r\n\r\n    // Obtener los roots (nivel 1)\r\n    const roots = allClassifications.filter(c => c.hierarchyLevel === 1 || !c.parentId);\r\n\r\n    console.log('[VOUCHER] Total clasificaciones:', allClassifications.length);\r\n    console.log('[VOUCHER] Roots disponibles:', roots.map(r => `${r.codigo}: ${r.label}`));\r\n    console.log('[VOUCHER] Buscando categor√≠a:', categoriaCode, 'y detalle:', detalleCode);\r\n\r\n    // Buscar la categor√≠a (nivel 0) por c√≥digo o por label que contenga \"CONTACTO DIRECTO\"\r\n    const categoria = roots.find((opt: any) =>\r\n      opt.codigo === categoriaCode ||\r\n      opt.codigo?.toUpperCase() === categoriaCode ||\r\n      opt.label?.toUpperCase().includes('CONTACTO DIRECTO') ||\r\n      opt.label?.toUpperCase().includes('CONTACTO_DIRECTO')\r\n    );\r\n\r\n    if (categoria) {\r\n      this.onClassificationLevelChange(0, categoria.id);\r\n      console.log('[VOUCHER] Categor√≠a seleccionada:', categoria.label, '(id:', categoria.id, ')');\r\n\r\n      // Esperar a que se actualice el signal y buscar los hijos directamente\r\n      setTimeout(() => {\r\n        // Buscar hijos del padre seleccionado directamente en allClassifications\r\n        const children = allClassifications.filter((c: any) =>\r\n          c.parentId && Number(c.parentId) === Number(categoria.id)\r\n        );\r\n\r\n        console.log('[VOUCHER] Hijos disponibles:', children.map(c => `${c.codigo}: ${c.label}`));\r\n\r\n        if (children.length > 0) {\r\n          // Buscar detalle por c√≥digo o por label que contenga \"CANCELACION\"\r\n          const detalle = children.find((opt: any) =>\r\n            opt.codigo === detalleCode ||\r\n            opt.codigo?.toUpperCase() === detalleCode ||\r\n            opt.label?.toUpperCase().includes('CANCELACION') ||\r\n            opt.label?.toUpperCase().includes('CANCELACI√ìN')\r\n          );\r\n\r\n          if (detalle) {\r\n            this.onClassificationLevelChange(1, detalle.id);\r\n            console.log('[VOUCHER] Detalle seleccionado:', detalle.label, '(id:', detalle.id, ')');\r\n          } else {\r\n            console.warn('[VOUCHER] No se encontr√≥ detalle \"CANCELACION\". Opciones:', children.map(c => c.label));\r\n          }\r\n        } else {\r\n          console.warn('[VOUCHER] No se encontraron hijos para categor√≠a:', categoria.id);\r\n        }\r\n      }, 150);\r\n    } else {\r\n      console.warn('[VOUCHER] No se encontr√≥ categor√≠a \"CONTACTO DIRECTO\". Opciones:', roots.map(r => r.label));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Selecciona una cuota para cancelaci√≥n e inicializa los campos editables\r\n   */\r\n  onSelectCuotaForCancellation(cuota: any): void {\r\n    this.selectedInstallmentForCancellation.set(cuota);\r\n    // Inicializar monto con el valor de la cuota\r\n    this.montoPagoEditable.set(cuota.monto || 0);\r\n    // Inicializar fecha con hoy\r\n    this.fechaPagoEditable.set(new Date().toISOString().split('T')[0]);\r\n  }\r\n\r\n  /**\r\n   * Maneja cambios en el monto del pago editable\r\n   */\r\n  onMontoPagoChange(event: Event): void {\r\n    const input = event.target as HTMLInputElement;\r\n    const value = parseFloat(input.value) || 0;\r\n    this.montoPagoEditable.set(value);\r\n  }\r\n\r\n  /**\r\n   * Maneja cambios en la fecha del pago editable\r\n   */\r\n  onFechaPagoChange(event: Event): void {\r\n    const input = event.target as HTMLInputElement;\r\n    this.fechaPagoEditable.set(input.value);\r\n  }\r\n\r\n  /**\r\n   * Parsea la fecha del OCR a formato YYYY-MM-DD\r\n   * Soporta formatos comunes: DD/MM/YYYY, DD-MM-YYYY, YYYY-MM-DD, DD/MM/YY\r\n   */\r\n  private parseFechaOcr(fechaStr: string): string | null {\r\n    if (!fechaStr) return null;\r\n\r\n    // Limpiar espacios\r\n    fechaStr = fechaStr.trim();\r\n\r\n    // Si ya est√° en formato YYYY-MM-DD, devolverlo\r\n    if (/^\\d{4}-\\d{2}-\\d{2}$/.test(fechaStr)) {\r\n      return fechaStr;\r\n    }\r\n\r\n    // Formato DD/MM/YYYY o DD-MM-YYYY\r\n    let match = fechaStr.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{4})$/);\r\n    if (match) {\r\n      const day = match[1].padStart(2, '0');\r\n      const month = match[2].padStart(2, '0');\r\n      const year = match[3];\r\n      return `${year}-${month}-${day}`;\r\n    }\r\n\r\n    // Formato DD/MM/YY\r\n    match = fechaStr.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{2})$/);\r\n    if (match) {\r\n      const day = match[1].padStart(2, '0');\r\n      const month = match[2].padStart(2, '0');\r\n      const year = parseInt(match[3]) > 50 ? `19${match[3]}` : `20${match[3]}`;\r\n      return `${year}-${month}-${day}`;\r\n    }\r\n\r\n    console.warn('[COMPROBANTE] No se pudo parsear la fecha OCR:', fechaStr);\r\n    return null;\r\n  }\r\n\r\n  // ==================== CARTA DE ACUERDO ====================\r\n\r\n  /**\r\n   * Muestra el modal de confirmaci√≥n para generar Carta de Acuerdo despu√©s de guardar promesa\r\n   */\r\n  private mostrarModalGenerarCarta(idGestion: number, contactLabel: string, managementLabel: string): void {\r\n    const dialogRef = this.dialog.open(ConfirmCartaDialogComponent, {\r\n      width: '400px',\r\n      disableClose: true,\r\n      data: { idGestion }\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe(result => {\r\n      if (result === 'generate') {\r\n        // Generar carta y luego finalizar\r\n        this.generarCartaYFinalizar(idGestion, contactLabel, managementLabel);\r\n      } else {\r\n        // Usuario eligi√≥ \"Ahora no\", solo finalizar\r\n        this.onSaveSuccess(contactLabel, managementLabel);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Genera la carta de acuerdo y luego finaliza la gesti√≥n\r\n   */\r\n  private generarCartaYFinalizar(idGestion: number, contactLabel: string, managementLabel: string): void {\r\n    const user = this.authService.getCurrentUser();\r\n    if (!user) {\r\n      alert('‚ö†Ô∏è No se puede generar la carta: usuario no encontrado');\r\n      this.onSaveSuccess(contactLabel, managementLabel);\r\n      return;\r\n    }\r\n\r\n    console.log('üìÑ Generando Carta de Acuerdo para gesti√≥n:', idGestion);\r\n\r\n    this.cartaAcuerdoService.generarCarta(idGestion, user.id).subscribe({\r\n      next: (blob) => {\r\n        this.cartaAcuerdoService.descargarPdf(blob, `carta_acuerdo_${idGestion}.pdf`);\r\n        console.log('‚úÖ Carta de Acuerdo generada exitosamente');\r\n        alert('‚úÖ Carta de Acuerdo generada exitosamente');\r\n        this.onSaveSuccess(contactLabel, managementLabel);\r\n      },\r\n      error: (error) => {\r\n        console.error('‚ùå Error generando carta:', error);\r\n        alert('‚ö†Ô∏è Error al generar la Carta de Acuerdo. La gesti√≥n se guard√≥ correctamente.');\r\n        this.onSaveSuccess(contactLabel, managementLabel);\r\n      }\r\n    });\r\n  }\r\n}"],
  "mappings": "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",
  "names": ["_forTrack0", "_forTrack0", "document", "_forTrack0", "currentUser", "allTypifications"]
}
