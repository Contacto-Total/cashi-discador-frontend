import{a as Ht,b as Yt}from"./chunk-EQGDIGWP.js";import{a as Re,c as je}from"./chunk-TNECWQD6.js";import{a as qt}from"./chunk-OTXKMJUH.js";import{b as et,c as Le,f as $t,g as Ut,h as Ve,i as $e}from"./chunk-J4PPL67V.js";import"./chunk-PUCOMFYN.js";import{g as Wt,i as Ze,j as We,k as Lt,n as Je,o as Vt}from"./chunk-CCBXMH6W.js";import"./chunk-BXMREN4B.js";import"./chunk-TTK6GW23.js";import{a as Ie,d as Te,g as Ee,l as Ae}from"./chunk-J6CVX7HQ.js";import{e as Rt}from"./chunk-IIHEXIAR.js";import{A as Q,I as jt,K as X,M as Bt,O as zt,P as Be,Q as Ft,R as Nt,T as ze,U as Fe,V as Ne,a as yt,b as Ot,e as kt,i as Ge,k as St,n as It,s as Tt,u as De,v as Et,w as At,y as Dt}from"./chunk-DMBJOXJI.js";import{$ as ue,$a as Mt,Aa as pe,Ca as x,D as lt,Da as ft,Ea as Y,Fa as _e,Ga as te,K as ce,Ka as q,Kb as K,L as Ye,La as fe,M as le,Ma as be,Mb as ne,N as Ke,Q as S,Qa as f,R as de,Ra as c,S as z,Sa as l,T as F,Ta as v,Tb as ye,U as _,Ua as Qe,Ub as Oe,Va as bt,W as b,X as M,Xb as ke,Y as me,Z as dt,_ as R,_a as k,a as w,ab as C,ac as Se,b as oe,bb as Ct,ca as mt,cb as u,db as Xe,eb as Me,fa as H,fb as Ce,g as se,ga as ut,gb as W,gc as wt,hb as A,ib as D,j as O,k as E,lc as L,ma as $,mb as vt,n as ee,na as ht,nb as xt,oa as m,ob as j,pa as he,pb as ve,qb as h,ra as gt,rb as y,sa as N,sb as T,ta as pt,u as rt,ua as _t,ub as xe,vb as Pe,wb as we,xa as I,xb as Pt,y as re,ya as ge,z as ct,za as U}from"./chunk-G7UR4G7J.js";var _n=["mat-menu-item",""],fn=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],bn=["mat-icon, [matMenuItemIcon]","*"];function Mn(a,r){a&1&&(me(),c(0,"svg",2),v(1,"polygon",3),l())}var Cn=["*"];function vn(a,r){if(a&1){let n=k();Qe(0,"div",0),Ct("click",function(){b(n);let t=u();return M(t.closed.emit("click"))})("animationstart",function(t){b(n);let i=u();return M(i._onAnimationStart(t.animationName))})("animationend",function(t){b(n);let i=u();return M(i._onAnimationDone(t.animationName))})("animationcancel",function(t){b(n);let i=u();return M(i._onAnimationDone(t.animationName))}),Qe(1,"div",1),Me(2),bt()()}if(a&2){let n=u();ve(n._classList),j("mat-menu-panel-animations-disabled",n._animationsDisabled)("mat-menu-panel-exit-animation",n._panelAnimationState==="void")("mat-menu-panel-animating",n._isAnimating()),Mt("id",n.panelId),q("aria-label",n.ariaLabel||null)("aria-labelledby",n.ariaLabelledby||null)("aria-describedby",n.ariaDescribedby||null)}}var nt=new z("MAT_MENU_PANEL"),ie=(()=>{class a{_elementRef=_(H);_document=_(ue);_focusMonitor=_(Ge);_parentMenu=_(nt,{optional:!0});_changeDetectorRef=_(K);role="menuitem";disabled=!1;disableRipple=!1;_hovered=new O;_focused=new O;_highlighted=!1;_triggersSubmenu=!1;constructor(){_(St).load(zt),this._parentMenu?.addItem?.(this)}focus(n,e){this._focusMonitor&&n?this._focusMonitor.focusVia(this._getHostElement(),n,e):this._getHostElement().focus(e),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(n){this.disabled&&(n.preventDefault(),n.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){let n=this._elementRef.nativeElement.cloneNode(!0),e=n.querySelectorAll("mat-icon, .material-icons");for(let t=0;t<e.length;t++)e[t].remove();return n.textContent?.trim()||""}_setHighlighted(n){this._highlighted=n,this._changeDetectorRef.markForCheck()}_setTriggersSubmenu(n){this._triggersSubmenu=n,this._changeDetectorRef.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=I({type:a,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-focus-indicator"],hostVars:8,hostBindings:function(e,t){e&1&&C("click",function(o){return t._checkDisabled(o)})("mouseenter",function(){return t._handleMouseEnter()}),e&2&&(q("role",t.role)("tabindex",t._getTabIndex())("aria-disabled",t.disabled)("disabled",t.disabled||null),j("mat-mdc-menu-item-highlighted",t._highlighted)("mat-mdc-menu-item-submenu-trigger",t._triggersSubmenu))},inputs:{role:"role",disabled:[2,"disabled","disabled",ne],disableRipple:[2,"disableRipple","disableRipple",ne]},exportAs:["matMenuItem"],attrs:_n,ngContentSelectors:bn,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(e,t){e&1&&(Xe(fn),Me(0),c(1,"span",0),Me(2,1),l(),v(3,"div",1),fe(4,Mn,2,0,":svg:svg",2)),e&2&&(m(3),f("matRippleDisabled",t.disableRipple||t.disabled)("matRippleTrigger",t._getHostElement()),m(),be(t._triggersSubmenu?4:-1))},dependencies:[Bt],encapsulation:2,changeDetection:0})}return a})();var xn=new z("MatMenuContent");var Pn=new z("mat-menu-default-options",{providedIn:"root",factory:wn});function wn(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}var tt="_mat-menu-enter",Ue="_mat-menu-exit",Z=(()=>{class a{_elementRef=_(H);_changeDetectorRef=_(K);_injector=_(R);_keyManager;_xPosition;_yPosition;_firstItemFocusRef;_exitFallbackTimeout;_animationsDisabled=X();_allItems;_directDescendantItems=new ut;_classList={};_panelAnimationState="void";_animationDone=new O;_isAnimating=mt(!1);parentMenu;direction;overlayPanelClass;backdropClass;ariaLabel;ariaLabelledby;ariaDescribedby;get xPosition(){return this._xPosition}set xPosition(n){this._xPosition=n,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(n){this._yPosition=n,this.setPositionClasses()}templateRef;items;lazyContent;overlapTrigger;hasBackdrop;set panelClass(n){let e=this._previousPanelClass,t=w({},this._classList);e&&e.length&&e.split(" ").forEach(i=>{t[i]=!1}),this._previousPanelClass=n,n&&n.length&&(n.split(" ").forEach(i=>{t[i]=!0}),this._elementRef.nativeElement.className=""),this._classList=t}_previousPanelClass;get classList(){return this.panelClass}set classList(n){this.panelClass=n}closed=new Y;close=this.closed;panelId=_(De).getId("mat-menu-panel-");constructor(){let n=_(Pn);this.overlayPanelClass=n.overlayPanelClass||"",this._xPosition=n.xPosition,this._yPosition=n.yPosition,this.backdropClass=n.backdropClass,this.overlapTrigger=n.overlapTrigger,this.hasBackdrop=n.hasBackdrop}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new At(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(ce(this._directDescendantItems),Ye(n=>re(...n.map(e=>e._focused)))).subscribe(n=>this._keyManager.updateActiveItem(n)),this._directDescendantItems.changes.subscribe(n=>{let e=this._keyManager;if(this._panelAnimationState==="enter"&&e.activeItem?._hasFocus()){let t=n.toArray(),i=Math.max(0,Math.min(t.length-1,e.activeItemIndex||0));t[i]&&!t[i].disabled?e.setActiveItem(i):e.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusRef?.destroy(),clearTimeout(this._exitFallbackTimeout)}_hovered(){return this._directDescendantItems.changes.pipe(ce(this._directDescendantItems),Ye(e=>re(...e.map(t=>t._hovered))))}addItem(n){}removeItem(n){}_handleKeydown(n){let e=n.keyCode,t=this._keyManager;switch(e){case 27:Et(n)||(n.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&this.direction==="ltr"&&this.closed.emit("keydown");break;case 39:this.parentMenu&&this.direction==="rtl"&&this.closed.emit("keydown");break;default:(e===38||e===40)&&t.setFocusOrigin("keyboard"),t.onKeydown(n);return}}focusFirstItem(n="program"){this._firstItemFocusRef?.destroy(),this._firstItemFocusRef=te(()=>{let e=this._resolvePanel();if(!e||!e.contains(document.activeElement)){let t=this._keyManager;t.setFocusOrigin(n).setFirstItemActive(),!t.activeItem&&e&&e.focus()}},{injector:this._injector})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(n){}setPositionClasses(n=this.xPosition,e=this.yPosition){this._classList=oe(w({},this._classList),{"mat-menu-before":n==="before","mat-menu-after":n==="after","mat-menu-above":e==="above","mat-menu-below":e==="below"}),this._changeDetectorRef.markForCheck()}_onAnimationDone(n){let e=n===Ue;(e||n===tt)&&(e&&(clearTimeout(this._exitFallbackTimeout),this._exitFallbackTimeout=void 0),this._animationDone.next(e?"void":"enter"),this._isAnimating.set(!1))}_onAnimationStart(n){(n===tt||n===Ue)&&this._isAnimating.set(!0)}_setIsOpen(n){if(this._panelAnimationState=n?"enter":"void",n){if(this._keyManager.activeItemIndex===0){let e=this._resolvePanel();e&&(e.scrollTop=0)}}else this._animationsDisabled||(this._exitFallbackTimeout=setTimeout(()=>this._onAnimationDone(Ue),200));this._animationsDisabled&&setTimeout(()=>{this._onAnimationDone(n?tt:Ue)}),this._changeDetectorRef.markForCheck()}_updateDirectDescendants(){this._allItems.changes.pipe(ce(this._allItems)).subscribe(n=>{this._directDescendantItems.reset(n.filter(e=>e._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}_resolvePanel(){let n=null;return this._directDescendantItems.length&&(n=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),n}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=I({type:a,selectors:[["mat-menu"]],contentQueries:function(e,t,i){if(e&1&&(Ce(i,xn,5),Ce(i,ie,5),Ce(i,ie,4)),e&2){let o;A(o=D())&&(t.lazyContent=o.first),A(o=D())&&(t._allItems=o),A(o=D())&&(t.items=o)}},viewQuery:function(e,t){if(e&1&&W(he,5),e&2){let i;A(i=D())&&(t.templateRef=i.first)}},hostVars:3,hostBindings:function(e,t){e&2&&q("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{backdropClass:"backdropClass",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:[2,"overlapTrigger","overlapTrigger",ne],hasBackdrop:[2,"hasBackdrop","hasBackdrop",n=>n==null?null:ne(n)],panelClass:[0,"class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"},exportAs:["matMenu"],features:[Pt([{provide:nt,useExisting:a}])],ngContentSelectors:Cn,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel",3,"click","animationstart","animationend","animationcancel","id"],[1,"mat-mdc-menu-content"]],template:function(e,t){e&1&&(Xe(),ft(0,vn,3,12,"ng-template"))},styles:[`mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;outline:0}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;flex:1;white-space:normal;font-family:var(--mat-menu-item-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-menu-item-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-menu-item-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-menu-item-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-menu-item-label-text-weight, var(--mat-sys-label-large-weight))}@keyframes _mat-menu-enter{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:none}}@keyframes _mat-menu-exit{from{opacity:1}to{opacity:0}}.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;box-sizing:border-box;outline:0;animation:_mat-menu-enter 120ms cubic-bezier(0, 0, 0.2, 1);border-radius:var(--mat-menu-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-menu-container-color, var(--mat-sys-surface-container));box-shadow:var(--mat-menu-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));will-change:transform,opacity}.mat-mdc-menu-panel.mat-menu-panel-exit-animation{animation:_mat-menu-exit 100ms 25ms linear forwards}.mat-mdc-menu-panel.mat-menu-panel-animations-disabled{animation:none}.mat-mdc-menu-panel.mat-menu-panel-animating{pointer-events:none}.mat-mdc-menu-panel.mat-menu-panel-animating:has(.mat-mdc-menu-content:empty){display:none}@media(forced-colors: active){.mat-mdc-menu-panel{outline:solid 1px}}.mat-mdc-menu-panel .mat-divider{color:var(--mat-menu-divider-color, var(--mat-sys-surface-variant));margin-bottom:var(--mat-menu-divider-bottom-spacing, 8px);margin-top:var(--mat-menu-divider-top-spacing, 8px)}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;min-height:48px;padding-left:var(--mat-menu-item-leading-spacing, 12px);padding-right:var(--mat-menu-item-trailing-spacing, 12px);-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-menu-item::-moz-focus-inner{border:0}[dir=rtl] .mat-mdc-menu-item{padding-left:var(--mat-menu-item-trailing-spacing, 12px);padding-right:var(--mat-menu-item-leading-spacing, 12px)}.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-leading-spacing, 12px);padding-right:var(--mat-menu-item-with-icon-trailing-spacing, 12px)}[dir=rtl] .mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-trailing-spacing, 12px);padding-right:var(--mat-menu-item-with-icon-leading-spacing, 12px)}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item:focus{outline:0}.mat-mdc-menu-item .mat-icon{flex-shrink:0;margin-right:var(--mat-menu-item-spacing, 12px);height:var(--mat-menu-item-icon-size, 24px);width:var(--mat-menu-item-icon-size, 24px)}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:var(--mat-menu-item-spacing, 12px)}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}@media(forced-colors: active){.mat-mdc-menu-item{margin-top:1px}}.mat-mdc-menu-submenu-icon{width:var(--mat-menu-item-icon-size, 24px);height:10px;fill:currentColor;padding-left:var(--mat-menu-item-spacing, 12px)}[dir=rtl] .mat-mdc-menu-submenu-icon{padding-right:var(--mat-menu-item-spacing, 12px);padding-left:0}[dir=rtl] .mat-mdc-menu-submenu-icon polygon{transform:scaleX(-1);transform-origin:center}@media(forced-colors: active){.mat-mdc-menu-submenu-icon{fill:CanvasText}}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}
`],encapsulation:2,changeDetection:0})}return a})(),Xt=new z("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{let a=_(R);return()=>et(a)}});function yn(a){let r=_(R);return()=>et(r)}var On={provide:Xt,deps:[],useFactory:yn};var G=new WeakMap,kn=(()=>{class a{_canHaveBackdrop;_element=_(H);_viewContainerRef=_(_t);_menuItemInstance=_(ie,{optional:!0,self:!0});_dir=_(Dt,{optional:!0});_focusMonitor=_(Ge);_ngZone=_(_e);_injector=_(R);_scrollStrategy=_(Xt);_changeDetectorRef=_(K);_animationsDisabled=X();_portal;_overlayRef=null;_menuOpen=!1;_closingActionsSubscription=se.EMPTY;_menuCloseSubscription=se.EMPTY;_pendingRemoval;_parentMaterialMenu;_parentInnerPadding;_openedBy=void 0;get _menu(){return this._menuInternal}set _menu(n){n!==this._menuInternal&&(this._menuInternal=n,this._menuCloseSubscription.unsubscribe(),n&&(this._parentMaterialMenu,this._menuCloseSubscription=n.close.subscribe(e=>{this._destroyMenu(e),(e==="click"||e==="tab")&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(e)})),this._menuItemInstance?._setTriggersSubmenu(this._triggersSubmenu()))}_menuInternal;constructor(n){this._canHaveBackdrop=n;let e=_(nt,{optional:!0});this._parentMaterialMenu=e instanceof Z?e:void 0}ngOnDestroy(){this._menu&&this._ownsMenu(this._menu)&&G.delete(this._menu),this._pendingRemoval?.unsubscribe(),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null)}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this._menu)}_closeMenu(){this._menu?.close.emit()}_openMenu(n){let e=this._menu;if(this._menuOpen||!e)return;this._pendingRemoval?.unsubscribe();let t=G.get(e);G.set(e,this),t&&t!==this&&t._closeMenu();let i=this._createOverlay(e),o=i.getConfig(),s=o.positionStrategy;this._setPosition(e,s),this._canHaveBackdrop?o.hasBackdrop=e.hasBackdrop==null?!this._triggersSubmenu():e.hasBackdrop:o.hasBackdrop=!1,i.hasAttached()||(i.attach(this._getPortal(e)),e.lazyContent?.attach(this.menuData)),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this._closeMenu()),e.parentMenu=this._triggersSubmenu()?this._parentMaterialMenu:void 0,e.direction=this.dir,n&&e.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0),e instanceof Z&&(e._setIsOpen(!0),e._directDescendantItems.changes.pipe(le(e.close)).subscribe(()=>{s.withLockedPosition(!1).reapplyLastPosition(),s.withLockedPosition(!0)}))}focus(n,e){this._focusMonitor&&n?this._focusMonitor.focusVia(this._element,n,e):this._element.nativeElement.focus(e)}_destroyMenu(n){let e=this._overlayRef,t=this._menu;!e||!this.menuOpen||(this._closingActionsSubscription.unsubscribe(),this._pendingRemoval?.unsubscribe(),t instanceof Z&&this._ownsMenu(t)?(this._pendingRemoval=t._animationDone.pipe(lt(1)).subscribe(()=>{e.detach(),G.has(t)||t.lazyContent?.detach()}),t._setIsOpen(!1)):(e.detach(),t?.lazyContent?.detach()),t&&this._ownsMenu(t)&&G.delete(t),this.restoreFocus&&(n==="keydown"||!this._openedBy||!this._triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,this._setIsMenuOpen(!1))}_setIsMenuOpen(n){n!==this._menuOpen&&(this._menuOpen=n,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this._triggersSubmenu()&&this._menuItemInstance._setHighlighted(n),this._changeDetectorRef.markForCheck())}_createOverlay(n){if(!this._overlayRef){let e=this._getOverlayConfig(n);this._subscribeToPositions(n,e.positionStrategy),this._overlayRef=Ve(this._injector,e),this._overlayRef.keydownEvents().subscribe(t=>{this._menu instanceof Z&&this._menu._handleKeydown(t)})}return this._overlayRef}_getOverlayConfig(n){return new Le({positionStrategy:$t(this._injector,this._getOverlayOrigin()).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:n.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:n.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir||"ltr",disableAnimations:this._animationsDisabled})}_subscribeToPositions(n,e){n.setPositionClasses&&e.positionChanges.subscribe(t=>{this._ngZone.run(()=>{let i=t.connectionPair.overlayX==="start"?"after":"before",o=t.connectionPair.overlayY==="top"?"below":"above";n.setPositionClasses(i,o)})})}_setPosition(n,e){let[t,i]=n.xPosition==="before"?["end","start"]:["start","end"],[o,s]=n.yPosition==="above"?["bottom","top"]:["top","bottom"],[d,g]=[o,s],[p,P]=[t,i],V=0;if(this._triggersSubmenu()){if(P=t=n.xPosition==="before"?"start":"end",i=p=t==="end"?"start":"end",this._parentMaterialMenu){if(this._parentInnerPadding==null){let st=this._parentMaterialMenu.items.first;this._parentInnerPadding=st?st._getHostElement().offsetTop:0}V=o==="bottom"?this._parentInnerPadding:-this._parentInnerPadding}}else n.overlapTrigger||(d=o==="top"?"bottom":"top",g=s==="top"?"bottom":"top");e.withPositions([{originX:t,originY:d,overlayX:p,overlayY:o,offsetY:V},{originX:i,originY:d,overlayX:P,overlayY:o,offsetY:V},{originX:t,originY:g,overlayX:p,overlayY:s,offsetY:-V},{originX:i,originY:g,overlayX:P,overlayY:s,offsetY:-V}])}_menuClosingActions(){let n=this._getOutsideClickStream(this._overlayRef),e=this._overlayRef.detachments(),t=this._parentMaterialMenu?this._parentMaterialMenu.closed:ee(),i=this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(ct(o=>this._menuOpen&&o!==this._menuItemInstance)):ee();return re(n,t,i,e)}_getPortal(n){return(!this._portal||this._portal.templateRef!==n.templateRef)&&(this._portal=new We(n.templateRef,this._viewContainerRef)),this._portal}_ownsMenu(n){return G.get(n)===this}static \u0275fac=function(e){pt()};static \u0275dir=U({type:a})}return a})(),Gt=(()=>{class a extends kn{_cleanupTouchstart;_hoverSubscription=se.EMPTY;get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(n){this.menu=n}get menu(){return this._menu}set menu(n){this._menu=n}menuData;restoreFocus=!0;menuOpened=new Y;onMenuOpen=this.menuOpened;menuClosed=new Y;onMenuClose=this.menuClosed;constructor(){super(!0);let n=_(gt);this._cleanupTouchstart=n.listen(this._element.nativeElement,"touchstart",e=>{Ot(e)||(this._openedBy="touch")},{passive:!0})}triggersSubmenu(){return super._triggersSubmenu()}toggleMenu(){return this.menuOpen?this.closeMenu():this.openMenu()}openMenu(){this._openMenu(!0)}closeMenu(){this._closeMenu()}updatePosition(){this._overlayRef?.updatePosition()}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){super.ngOnDestroy(),this._cleanupTouchstart(),this._hoverSubscription.unsubscribe()}_getOverlayOrigin(){return this._element}_getOutsideClickStream(n){return n.backdropClick()}_handleMousedown(n){yt(n)||(this._openedBy=n.button===0?"mouse":void 0,this.triggersSubmenu()&&n.preventDefault())}_handleKeydown(n){let e=n.keyCode;(e===13||e===32)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(e===39&&this.dir==="ltr"||e===37&&this.dir==="rtl")&&(this._openedBy="keyboard",this.openMenu())}_handleClick(n){this.triggersSubmenu()?(n.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){this.triggersSubmenu()&&this._parentMaterialMenu&&(this._hoverSubscription=this._parentMaterialMenu._hovered().subscribe(n=>{n===this._menuItemInstance&&!n.disabled&&this._parentMaterialMenu?._panelAnimationState!=="void"&&(this._openedBy="mouse",this._openMenu(!1))}))}static \u0275fac=function(e){return new(e||a)};static \u0275dir=U({type:a,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],hostVars:3,hostBindings:function(e,t){e&1&&C("click",function(o){return t._handleClick(o)})("mousedown",function(o){return t._handleMousedown(o)})("keydown",function(o){return t._handleKeydown(o)}),e&2&&q("aria-haspopup",t.menu?"menu":null)("aria-expanded",t.menuOpen)("aria-controls",t.menuOpen?t.menu==null?null:t.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:[0,"mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:[0,"matMenuTriggerFor","menu"],menuData:[0,"matMenuTriggerData","menuData"],restoreFocus:[0,"matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"},exportAs:["matMenuTrigger"],features:[pe]})}return a})();var Zt=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=ge({type:a});static \u0275inj=de({providers:[On],imports:[Ft,Q,$e,Wt,Q]})}return a})(),Jt={transformMenu:{type:7,name:"transformMenu",definitions:[{type:0,name:"void",styles:{type:6,styles:{opacity:0,transform:"scale(0.8)"},offset:null}},{type:1,expr:"void => enter",animation:{type:4,styles:{type:6,styles:{opacity:1,transform:"scale(1)"},offset:null},timings:"120ms cubic-bezier(0, 0, 0.2, 1)"},options:null},{type:1,expr:"* => void",animation:{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:"100ms 25ms linear"},options:null}],options:{}},fadeInItems:{type:7,name:"fadeInItems",definitions:[{type:0,name:"showing",styles:{type:6,styles:{opacity:1},offset:null}},{type:1,expr:"void => *",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:null,timings:"400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"}],options:null}],options:{}}},Qi=Jt.fadeInItems,Xi=Jt.transformMenu;var qe=(()=>{let r=class r{constructor(e){this.http=e,this.API_BASE=L.whatsappApiUrl||L.apiUrl}getContacts(){return this.http.get(`${this.API_BASE}/contacts`)}getChats(){return this.http.get(`${this.API_BASE}/chats`)}getMessages(e){return this.http.get(`${this.API_BASE}/chats/${e}/messages`)}sendTextMessage(e,t,i){let o={to:e,message:t};return i&&(o.quotedMessageId=i),this.http.post(`${this.API_BASE}/send-text`,o)}sendMediaMessage(e,t,i,o){let s="document";i.startsWith("image/")?s="image":i.startsWith("video/")?s="video":i.startsWith("audio/")&&(s="audio");let d={to:e,base64:t,kind:s,mime:i};return o&&(d.caption=o),console.log("\u{1F4E4} Enviando media:",{to:e,kind:s,mime:i,captionLength:o?.length||0,mediaLength:t.length}),this.http.post(`${this.API_BASE}/send-media`,d)}markAsRead(e,t){return this.http.post(`${this.API_BASE}/chats/${e}/mark-read`,{})}getWindowStatus(e){return this.http.get(`${this.API_BASE}/chats/${e}/window-status`)}getBlockedChats(){return this.http.get(`${this.API_BASE}/blocked-chats`)}logout(){return this.http.post(`${this.API_BASE}/auth/logout`,{})}};r.\u0275fac=function(t){return new(t||r)(F(Se))},r.\u0275prov=S({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var tn=(()=>{let r=class r{constructor(){this.messagesSubject=new O,this.WS_URL=L.whatsappWsUrl||L.wsUrl,this.reconnectInterval=3e3,this.connect()}connect(){this.socket?.readyState!==WebSocket.OPEN&&(this.socket=new WebSocket(this.WS_URL),this.socket.onopen=()=>{console.log("\u2705 WebSocket conectado"),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=void 0)},this.socket.onmessage=e=>{try{let t=JSON.parse(e.data);this.messagesSubject.next(t)}catch(t){console.error("\u274C Error parsing WebSocket message:",t)}},this.socket.onclose=()=>{console.log("\u{1F50C} WebSocket desconectado. Reconectando..."),this.scheduleReconnect()},this.socket.onerror=e=>{console.error("\u274C WebSocket error:",e),this.socket?.close()})}scheduleReconnect(){this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{this.connect()},this.reconnectInterval))}getMessages(){return this.messagesSubject.asObservable()}disconnect(){this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.socket?.close()}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=S({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var He=(()=>{let r=class r{constructor(e,t){this.apiService=e,this.wsService=t,this.messagesMap=new Map,this.chatsSubject=new E([]),this.contactsSubject=new E([]),this.allItemsSubject=new E([]),this.currentChatSubject=new E(null),this.currentMessagesSubject=new E([]),this.windowStatusUpdateSubject=new E(null),this.chats$=this.chatsSubject.asObservable(),this.contacts$=this.contactsSubject.asObservable(),this.allItems$=this.allItemsSubject.asObservable(),this.currentChat$=this.currentChatSubject.asObservable(),this.currentMessages$=this.currentMessagesSubject.asObservable(),this.windowStatusUpdate$=this.windowStatusUpdateSubject.asObservable(),console.log("\u{1F527} MessageService constructor called"),this.initializeWebSocket(),this.loadChatsAndContacts()}initializeWebSocket(){this.wsService.getMessages().subscribe({next:e=>{console.log("\u{1F4E8} WebSocket mensaje recibido:",e);let t=e.type||e.Type;switch(t){case"INCOMING":case"OUTGOING":case"MESSAGE":this.handleIncomingMessage(e);break;case"RECEIPT":this.handleReceipt(e);break;case"CHAT_UPDATE":this.loadChats();break;case"WINDOW_STATUS":case"WINDOW_UPDATE":case"BLOCKED":case"UNBLOCKED":this.handleWindowStatusUpdate(e);break;default:console.log("\u26A0\uFE0F Tipo de mensaje desconocido:",t)}},error:e=>{console.error("\u274C WebSocket error:",e)}})}handleIncomingMessage(e){if(!e||!e.chat){console.warn("\u26A0\uFE0F Mensaje inv\xE1lido recibido:",e);return}let t=e.chat,i=e.type==="OUTGOING"||e.fromMe===!0,o={msgId:e.msgId||e.id,chat:t,chatTitle:e.chatTitle||t,text:e.text||"",fromMe:i,timestamp:e.timestamp||e.ts||Date.now(),hasMedia:e.hasMedia||!1,media:e.media,status:e.status||(i?"sent":void 0),quotedMessageId:e.quotedMessageId,quotedText:e.quotedText,quotedSender:e.quotedSender,quotedFromMe:e.quotedFromMe};console.log(`\u{1F4E8} Procesando mensaje ${i?"OUTGOING":"INCOMING"}: ${o.msgId}`),this.messagesMap.has(t)||this.messagesMap.set(t,[]);let s=this.messagesMap.get(t),d=s.findIndex(p=>p.msgId===o.msgId);if(d===-1&&i&&(d=s.findIndex(p=>p.msgId.startsWith("temp_")&&p.text===o.text&&Math.abs(p.timestamp-o.timestamp)<5e3),d!==-1&&console.log(`\u{1F504} Reemplazando mensaje temporal ${s[d].msgId} con ${o.msgId}`)),d===-1){if(s.push(o),console.log(`\u2705 Mensaje nuevo agregado: ${o.msgId}`),!i){let p=this.currentChatSubject.value;(!p||p.jid!==t)&&this.incrementUnreadCount(t)}}else s[d]=w(w({},s[d]),o),console.log(`\u{1F504} Mensaje actualizado: ${o.msgId}`);let g=this.currentChatSubject.value;g&&g.jid===t&&(this.currentMessagesSubject.next([...s]),!i&&d===-1&&setTimeout(()=>{this.apiService.markAsRead(t,o.msgId).subscribe()},500)),this.updateChatInList(t,o)}handleReceipt(e){if(!e||!e.chat)return;let t=e.chat,i=Array.isArray(e.ids)?e.ids:e.msgId?[e.msgId]:e.id?[e.id]:[],o=e.status||e.receipt;if(!this.messagesMap.has(t))return;let s=this.messagesMap.get(t),d=!1;if(i.forEach(g=>{let p=s.find(P=>P.msgId===g);p&&p.fromMe&&(p.status=o,d=!0,console.log(`\u2705 Estado actualizado: ${g} \u2192 ${o}`))}),d){let g=this.currentChatSubject.value;g&&g.jid===t&&this.currentMessagesSubject.next([...s])}}handleWindowStatusUpdate(e){console.log("\u{1F514} Actualizaci\xF3n de estado de ventana recibida:",e),this.windowStatusUpdateSubject.next(e)}loadChats(){this.loadChatsAndContacts()}loadChatsAndContacts(){console.log("\u{1F4E5} Cargando chats y contactos desde BD..."),rt({chats:this.apiService.getChats(),contacts:this.apiService.getContacts()}).subscribe({next:({chats:e,contacts:t})=>{console.log("\u2705 Datos cargados - Chats:",e.length,"| Contactos:",t.length),this.chatsSubject.next(e),this.contactsSubject.next(t);let i=e.filter(o=>o.lastMsgTs&&o.lastMsgTs>0).sort((o,s)=>(s.lastMsgTs||0)-(o.lastMsgTs||0));console.log("\u{1F4CB} Chats con mensajes:",i.length),this.allItemsSubject.next(i)},error:e=>{console.error("\u274C Error cargando chats/contactos:",e)}})}selectChat(e){if(e===null){console.log("\u{1F4AC} Chat deseleccionado"),this.currentChatSubject.next(null),this.currentMessagesSubject.next([]);return}console.log("\u{1F4AC} Chat seleccionado:",e.name),this.currentChatSubject.next(e),this.loadMessages(e.jid),setTimeout(()=>{this.updateChatUnreadCount(e.jid,0)},300)}loadMessages(e){console.log("\u{1F4E8} Cargando mensajes desde BD para:",e),this.apiService.getMessages(e).subscribe({next:t=>{console.log("\u2705 Mensajes cargados desde BD:",t.length);let i=t.map(s=>({msgId:s.msgId,chat:s.chat,chatTitle:s.chatTitle,text:s.text||"",fromMe:s.fromMe,timestamp:s.timestamp,hasMedia:s.hasMedia||!1,media:s.media,status:s.status||(s.fromMe?"sent":void 0),quotedMessageId:s.quotedMessageId,quotedText:s.quotedText,quotedSender:s.quotedSender,quotedFromMe:s.quotedFromMe}));this.messagesMap.set(e,i),this.currentMessagesSubject.next([...i]),i.some(s=>!s.fromMe)&&i.length>0&&setTimeout(()=>{let s=i[i.length-1];this.apiService.markAsRead(e,s.msgId).subscribe()},500)},error:t=>console.error("\u274C Error loading messages:",t)})}sendMessage(e,t,i){let o=`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,s={msgId:o,chat:e,text:t,fromMe:!0,timestamp:Date.now(),status:"pending"};if(i){let p=(this.messagesMap.get(e)||[]).find(P=>P.msgId===i);p&&(s.quotedMessageId=i,s.quotedText=p.text,s.quotedSender=p.fromMe?"T\xFA":p.chatTitle||"Usuario",s.quotedFromMe=p.fromMe)}this.messagesMap.has(e)||this.messagesMap.set(e,[]);let d=this.messagesMap.get(e);d.push(s),this.currentMessagesSubject.next([...d]),this.updateChatInList(e,s),this.apiService.sendTextMessage(e,t,i).subscribe({next:g=>{console.log("\u2705 Mensaje enviado correctamente:",g)},error:g=>{let p=d.findIndex(P=>P.msgId===o);p!==-1&&(d[p].status="error",this.currentMessagesSubject.next([...d])),console.error("\u274C Error sending message:",g)}})}sendMedia(e,t,i,o){let s=`temp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,d={msgId:s,chat:e,text:o||"",fromMe:!0,timestamp:Date.now(),hasMedia:!0,media:{mime:i,url:t},status:"pending"};this.messagesMap.has(e)||this.messagesMap.set(e,[]);let g=this.messagesMap.get(e);g.push(d),this.currentMessagesSubject.next([...g]),this.updateChatInList(e,d),this.apiService.sendMediaMessage(e,t,i,o).subscribe({next:p=>{console.log("\u2705 Media enviado correctamente:",p)},error:p=>{let P=g.findIndex(V=>V.msgId===s);P!==-1&&(g[P].status="error",this.currentMessagesSubject.next([...g])),console.error("\u274C Error sending media:",p)}})}updateChatInList(e,t){let i=[...this.allItemsSubject.value],o=i.findIndex(p=>p.jid===e);if(o!==-1)i[o].lastMsgText=t.text,i[o].lastMsgTs=t.timestamp,i[o].lastMsgFromMe=t.fromMe;else{let p={jid:e,name:t.chatTitle||e,lastMsgText:t.text,lastMsgTs:t.timestamp,lastMsgFromMe:t.fromMe,unreadCount:t.fromMe?0:1};i.push(p)}let s=i.sort((p,P)=>(P.lastMsgTs||0)-(p.lastMsgTs||0));console.log(`\u{1F4CB} Lista de chats actualizada y reordenada (${s.length} chats)`),this.allItemsSubject.next(s);let d=[...this.chatsSubject.value],g=d.findIndex(p=>p.jid===e);g!==-1&&(d[g].lastMsgText=t.text,d[g].lastMsgTs=t.timestamp,d[g].lastMsgFromMe=t.fromMe,this.chatsSubject.next(d))}incrementUnreadCount(e){let t=[...this.allItemsSubject.value],i=t.findIndex(d=>d.jid===e);i!==-1&&(t[i].unreadCount=(t[i].unreadCount||0)+1,this.allItemsSubject.next(t));let o=[...this.chatsSubject.value],s=o.findIndex(d=>d.jid===e);s!==-1&&(o[s].unreadCount=(o[s].unreadCount||0)+1,this.chatsSubject.next(o)),console.log(`\u{1F4EC} Contador de no le\xEDdos incrementado para ${e}`)}updateChatUnreadCount(e,t){let i=[...this.allItemsSubject.value],o=i.findIndex(g=>g.jid===e);o!==-1&&(i[o].unreadCount=t,this.allItemsSubject.next(i));let s=[...this.chatsSubject.value],d=s.findIndex(g=>g.jid===e);d!==-1&&(s[d].unreadCount=t,this.chatsSubject.next(s)),t===0&&console.log(`\u2705 Chat marcado como le\xEDdo: ${e}`)}};r.\u0275fac=function(t){return new(t||r)(F(qe),F(tn))},r.\u0275prov=S({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var an=(()=>{let r=class r{constructor(){this.isDarkModeSubject=new E(!1),this.isDarkMode$=this.isDarkModeSubject.asObservable();let t=localStorage.getItem("theme")==="dark";this.setTheme(t)}toggleTheme(){let e=!this.isDarkModeSubject.value;this.setTheme(e)}setTheme(e){this.isDarkModeSubject.next(e),localStorage.setItem("theme",e?"dark":"light"),e?(document.body.classList.add("dark-theme"),document.body.classList.remove("light-theme")):(document.body.classList.add("light-theme"),document.body.classList.remove("dark-theme"))}isDarkMode(){return this.isDarkModeSubject.value}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=S({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var on=(()=>{let r=class r{constructor(e,t){this.http=e,this.router=t,this.API_BASE=L.apiUrl,this.TOKEN_KEY="callcenter_token",this.USER_KEY="callcenter_user",this.currentUserSubject=new E(this.getUserFromStorage()),this.currentUser$=this.currentUserSubject.asObservable()}login(e){return this.http.post(`${this.API_BASE}/auth/login`,e).pipe(Ke(t=>{this.storeAuthData(t)}))}register(e){return this.http.post(`${this.API_BASE}/auth/register`,e).pipe(Ke(t=>{this.storeAuthData(t)}))}logout(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY),this.currentUserSubject.next(null),this.router.navigate(["/login"])}getToken(){return localStorage.getItem(this.TOKEN_KEY)}isAuthenticated(){let e=this.getToken();return!!e&&!this.isTokenExpired(e)}getCurrentUser(){return this.currentUserSubject.value}storeAuthData(e){let t=e.accessToken||e.token||"";localStorage.setItem(this.TOKEN_KEY,t);let i=e.nombreCompleto?.split(" ")||["",""],o=i[0]||"",s=i.slice(1).join(" ")||"",d={id:e.idUsuario||0,username:e.nombreUsuario||e.username||"Usuario",email:e.email||"",firstName:o,lastName:s,role:e.roles?.[0]||e.role||"AGENT",sipExtension:e.extensionSip||"",active:!0};localStorage.setItem(this.USER_KEY,JSON.stringify(d)),this.currentUserSubject.next(d),console.log("\u2705 Usuario autenticado:",`${o} ${s}`.trim()||d.username)}getUserFromStorage(){let e=localStorage.getItem(this.USER_KEY);if(e)try{return JSON.parse(e)}catch{return null}return null}isTokenExpired(e){try{let i=JSON.parse(atob(e.split(".")[1])).exp;return Math.floor(new Date().getTime()/1e3)>=i}catch{return!0}}};r.\u0275fac=function(t){return new(t||r)(F(Se),F(wt))},r.\u0275prov=S({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();function Bn(a,r){if(a&1&&v(0,"img",28),a&2){let n=u().$implicit;f("src",n.profilePictureUrl,$)}}function zn(a,r){a&1&&(c(0,"mat-icon"),h(1,"account_circle"),l())}function Fn(a,r){if(a&1&&(c(0,"span",29),h(1),l()),a&2){let n=u().$implicit;m(),T(" ",n.unreadCount," ")}}function Nn(a,r){if(a&1){let n=k();c(0,"div",17),C("click",function(){let t=b(n).$implicit,i=u();return M(i.selectChat(t))}),c(1,"div",18),x(2,Bn,1,1,"img",19)(3,zn,2,0,"mat-icon",20),l(),c(4,"div",21)(5,"div",22)(6,"span",23),h(7),l(),c(8,"span",24),h(9),l()(),c(10,"div",25)(11,"span",26),h(12),l(),x(13,Fn,2,1,"span",27),l()()()}if(a&2){let n=r.$implicit,e=u();j("selected",e.selectedChatJid===n.jid),m(2),f("ngIf",n.profilePictureUrl),m(),f("ngIf",!n.profilePictureUrl),m(4),y(e.formatChatName(n)),m(2),y(e.formatTime(n.lastMsgTs)),m(3),y(e.truncateMessage(n.lastMsgText)),m(),f("ngIf",n.unreadCount&&n.unreadCount>0)}}var sn=(()=>{let r=class r{constructor(e,t,i){this.messageService=e,this.themeService=t,this.authService=i,this.chatSelected=new Y,this.allItems=[],this.allContacts=[],this.filteredChats=[],this.searchText="",this.selectedChatJid=null,this.isDarkMode=!1}ngOnInit(){this.messageService.allItems$.subscribe(e=>{console.log("\u{1F4F1} Chats activos:",e.length),this.allItems=e,this.filterChats()}),this.messageService.contacts$.subscribe(e=>{console.log("\u{1F4C7} Todos los contactos:",e.length),this.allContacts=e}),this.themeService.isDarkMode$.subscribe(e=>{this.isDarkMode=e})}toggleTheme(){this.themeService.toggleTheme()}logout(){this.authService.logout()}getCurrentUsername(){let e=this.authService.getCurrentUser();return e&&([e.firstName,e.lastName].filter(Boolean).join(" ").trim()||e.username)||"Usuario"}filterChats(){if(!this.searchText.trim())this.filteredChats=this.allItems;else{let e=this.searchText.toLowerCase().trim(),t=this.allItems.filter(s=>{let d=s.name?.toLowerCase()||"",g=s.jid?.toLowerCase()||"",p=s.lastMsgText?.toLowerCase()||"";return d.includes(e)||g.includes(e)||p.includes(e)}),i=new Set(this.allItems.map(s=>s.jid)),o=this.allContacts.filter(s=>{if(i.has(s.jid))return!1;let d=s.name?.toLowerCase()||"",g=s.jid?.toLowerCase()||"";return d.includes(e)||g.includes(e)}).map(s=>({jid:s.jid,name:s.name||s.pushName||s.jid,lastMsgText:"",lastMsgTs:0,unreadCount:0}));this.filteredChats=[...t,...o],console.log(`\u{1F50D} B\xFAsqueda: "${this.searchText}" - Chats: ${t.length}, Contactos: ${o.length}`)}}selectChat(e){this.selectedChatJid=e.jid,this.chatSelected.emit(e),this.messageService.selectChat(e)}formatTime(e){if(!e)return"";let t=new Date(e),o=new Date().getTime()-t.getTime();return o<864e5?t.toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"}):o<6048e5?t.toLocaleDateString("es-PE",{weekday:"short"}):t.toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit"})}truncateMessage(e){return e?e.length>50?e.substring(0,50)+"...":e:"Toca para iniciar conversaci\xF3n"}formatChatName(e){return!e.name||e.name.includes("@s.whatsapp.net")?this.formatPhoneNumber(e.jid):e.name}formatPhoneNumber(e){let t=e.split("@")[0];if(!/^\d+$/.test(t))return e;if(t.length>=11){let i=t.substring(0,2),o=t.substring(2),s=o.match(/.{1,3}/g)?.join(" ")||o;return`+${i} ${s}`}else if(t.length>=10){let i=t.substring(0,1),o=t.substring(1),s=o.match(/.{1,3}/g)?.join(" ")||o;return`+${i} ${s}`}else return`+${t}`}};r.\u0275fac=function(t){return new(t||r)(N(He),N(an),N(on))},r.\u0275cmp=I({type:r,selectors:[["app-chat-list"]],outputs:{chatSelected:"chatSelected"},decls:28,vars:4,consts:[["menu","matMenu"],[1,"chat-list-container"],[1,"sidebar-header"],[1,"header-left"],[1,"username-display"],[1,"header-right"],["mat-icon-button","",1,"header-icon",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"search-container"],[1,"search-wrapper"],[1,"search-icon"],["type","text","placeholder","Buscar o empezar un chat",1,"search-input",3,"ngModelChange","ngModel"],[1,"filter-tabs"],[1,"filter-tab","active"],[1,"filter-tab"],[1,"chat-list"],["class","chat-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"chat-item",3,"click"],[1,"chat-avatar"],["class","profile-pic","alt","Profile",3,"src",4,"ngIf"],[4,"ngIf"],[1,"chat-content"],[1,"chat-top"],[1,"chat-name"],[1,"chat-time"],[1,"chat-bottom"],[1,"chat-last-message"],["class","chat-unread",4,"ngIf"],["alt","Profile",1,"profile-pic",3,"src"],[1,"chat-unread"]],template:function(t,i){if(t&1){let o=k();c(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),h(4),l()(),c(5,"div",5)(6,"button",6)(7,"mat-icon"),h(8,"more_vert"),l()(),c(9,"mat-menu",null,0)(11,"button",7),C("click",function(){return b(o),M(i.logout())}),c(12,"mat-icon"),h(13,"logout"),l(),c(14,"span"),h(15,"Cerrar sesi\xF3n"),l()()()()(),c(16,"div",8)(17,"div",9)(18,"mat-icon",10),h(19,"search"),l(),c(20,"input",11),we("ngModelChange",function(d){return b(o),Pe(i.searchText,d)||(i.searchText=d),M(d)}),C("ngModelChange",function(){return b(o),M(i.filterChats())}),l()()(),c(21,"div",12)(22,"button",13),h(23,"Todos"),l(),c(24,"button",14),h(25,"No le\xEDdos"),l()(),c(26,"div",15),x(27,Nn,14,8,"div",16),l()()}if(t&2){let o=vt(10);m(4),y(i.getCurrentUsername()),m(2),f("matMenuTriggerFor",o),m(14),xe("ngModel",i.searchText),m(7),f("ngForOf",i.filteredChats)}},dependencies:[ke,ye,Oe,Ht,qt,Ne,Fe,Re,je,Ae,Ie,Te,Ee,Be,Zt,Z,ie,Gt],styles:['.chat-list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:#1e293b;overflow:hidden}.sidebar-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;height:59px;padding:10px 16px;background:#0a0e27;flex-shrink:0;border-bottom:1px solid #334155;box-shadow:0 2px 6px #0000004d;transition:box-shadow .3s ease}.sidebar-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .username-display[_ngcontent-%COMP%]{font-weight:600;color:#fff;font-size:16px}.sidebar-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .profile-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;color:#10b981;cursor:pointer;transition:all .3s ease}.sidebar-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .profile-icon[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.05)}.sidebar-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.sidebar-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{color:#94a3b8;width:40px;height:40px;border-radius:50%;transition:all .3s ease}.sidebar-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.sidebar-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]:hover{background:#10b9811a;color:#10b981;transform:scale(1.1)}.search-container[_ngcontent-%COMP%]{padding:10px 12px;background:#1e293b;flex-shrink:0}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;background:#0a0e27;border-radius:8px;padding:8px 12px;gap:10px;height:35px;border:1px solid #334155;transition:all .3s ease}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#10b981;box-shadow:0 0 0 2px #10b9811a}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#64748b;flex-shrink:0;transition:color .3s ease}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]:focus-within   .search-icon[_ngcontent-%COMP%]{color:#10b981}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{flex:1;background:transparent;border:none;outline:none;color:#fff;font-size:14.5px;font-family:inherit;line-height:20px}.search-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#64748b}.filter-tabs[_ngcontent-%COMP%]{display:flex;gap:24px;padding:10px 30px;background:#1e293b;border-bottom:1px solid #334155;flex-shrink:0;height:47px;align-items:center}.filter-tabs[_ngcontent-%COMP%]   .filter-tab[_ngcontent-%COMP%]{background:transparent;border:none;color:#64748b;font-size:14px;padding:0;cursor:pointer;border-bottom:3px solid transparent;transition:all .2s ease;font-family:inherit;font-weight:400;height:100%;display:flex;align-items:center;position:relative}.filter-tabs[_ngcontent-%COMP%]   .filter-tab[_ngcontent-%COMP%]:hover{color:#94a3b8}.filter-tabs[_ngcontent-%COMP%]   .filter-tab.active[_ngcontent-%COMP%]{color:#10b981}.filter-tabs[_ngcontent-%COMP%]   .filter-tab.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:3px;background:#10b981;border-radius:2px 2px 0 0}.chat-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;background:#1e293b}.chat-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.chat-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.chat-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#334155;border-radius:3px}.chat-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#475569}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]{display:flex;padding:0 16px;cursor:pointer;border-bottom:1px solid #334155;transition:all .3s ease;height:72px;align-items:center;position:relative}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;top:0;bottom:0;width:0;background:#10b981;transition:width .3s ease}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]:hover{background:#10b9810d;transform:translate(2px);box-shadow:0 2px 4px #0003}.chat-list[_ngcontent-%COMP%]   .chat-item.selected[_ngcontent-%COMP%]{background:#10b9811a}.chat-list[_ngcontent-%COMP%]   .chat-item.selected[_ngcontent-%COMP%]:after{width:4px}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-avatar[_ngcontent-%COMP%]{flex-shrink:0;margin-right:15px;transition:transform .3s ease}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:49px;width:49px;height:49px;color:#fff;background:linear-gradient(135deg,#10b981,#059669);border-radius:50%;padding:4px}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-avatar[_ngcontent-%COMP%]   .profile-pic[_ngcontent-%COMP%]{width:49px;height:49px;border-radius:50%;object-fit:cover;border:2px solid #334155}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]:hover   .chat-avatar[_ngcontent-%COMP%]{transform:scale(1.05)}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-content[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;justify-content:center;height:100%;padding:12px 0}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-content[_ngcontent-%COMP%]   .chat-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-content[_ngcontent-%COMP%]   .chat-top[_ngcontent-%COMP%]   .chat-name[_ngcontent-%COMP%]{font-size:17px;font-weight:500;color:#fff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:21px}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-content[_ngcontent-%COMP%]   .chat-top[_ngcontent-%COMP%]   .chat-time[_ngcontent-%COMP%]{font-size:12px;color:#64748b;margin-left:8px;white-space:nowrap;line-height:20px}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-content[_ngcontent-%COMP%]   .chat-bottom[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-content[_ngcontent-%COMP%]   .chat-bottom[_ngcontent-%COMP%]   .chat-last-message[_ngcontent-%COMP%]{flex:1;font-size:14px;color:#94a3b8;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:20px;font-weight:400}.chat-list[_ngcontent-%COMP%]   .chat-item[_ngcontent-%COMP%]   .chat-content[_ngcontent-%COMP%]   .chat-bottom[_ngcontent-%COMP%]   .chat-unread[_ngcontent-%COMP%]{flex-shrink:0;background:#10b981;color:#fff;font-size:12px;font-weight:600;min-width:20px;height:20px;border-radius:20px;display:flex;align-items:center;justify-content:center;padding:0 6px;margin-left:8px;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}']});let a=r;return a})();function Wn(a,r){if(a&1){let n=k();c(0,"div",1)(1,"button",2),C("click",function(){b(n);let t=u();return M(t.action())}),h(2),l()()}if(a&2){let n=u();m(2),T(" ",n.data.action," ")}}var Ln=["label"];function Vn(a,r){}var $n=Math.pow(2,31)-1,ae=class{_overlayRef;instance;containerInstance;_afterDismissed=new O;_afterOpened=new O;_onAction=new O;_durationTimeoutId;_dismissedByAction=!1;constructor(r,n){this._overlayRef=n,this.containerInstance=r,r._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(r){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(r,$n))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},rn=new z("MatSnackBarData"),J=class{politeness="polite";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},Un=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275dir=U({type:a,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return a})(),qn=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275dir=U({type:a,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return a})(),Hn=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275dir=U({type:a,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return a})(),cn=(()=>{class a{snackBarRef=_(ae);data=_(rn);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=I({type:a,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["matButton","","matSnackBarAction","",3,"click"]],template:function(e,t){e&1&&(c(0,"div",0),h(1),l(),fe(2,Wn,3,1,"div",1)),e&2&&(m(),T(" ",t.data.message,`
`),m(),be(t.hasAction?2:-1))},dependencies:[Nt,Un,qn,Hn],styles:[`.mat-mdc-simple-snack-bar{display:flex}
`],encapsulation:2,changeDetection:0})}return a})(),it="_mat-snack-bar-enter",at="_mat-snack-bar-exit",Yn=(()=>{class a extends Lt{_ngZone=_(_e);_elementRef=_(H);_changeDetectorRef=_(K);_platform=_(kt);_animationsDisabled=X();snackBarConfig=_(J);_document=_(ue);_trackedModals=new Set;_enterFallback;_exitFallback;_injector=_(R);_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new O;_onExit=new O;_onEnter=new O;_animationState="void";_live;_label;_role;_liveElementId=_(De).getId("mat-snack-bar-container-live-");constructor(){super();let n=this.snackBarConfig;n.politeness==="assertive"&&!n.announcementMessage?this._live="assertive":n.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(n){this._assertNotAttached();let e=this._portalOutlet.attachComponentPortal(n);return this._afterPortalAttached(),e}attachTemplatePortal(n){this._assertNotAttached();let e=this._portalOutlet.attachTemplatePortal(n);return this._afterPortalAttached(),e}attachDomPortal=n=>{this._assertNotAttached();let e=this._portalOutlet.attachDomPortal(n);return this._afterPortalAttached(),e};onAnimationEnd(n){n===at?this._completeExit():n===it&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?te(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(it)))},{injector:this._injector}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(it)},200)))}exit(){return this._destroyed?ee(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?te(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(at)))},{injector:this._injector}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(at),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let n=this._elementRef.nativeElement,e=this.snackBarConfig.panelClass;e&&(Array.isArray(e)?e.forEach(o=>n.classList.add(o)):n.classList.add(e)),this._exposeToModals();let t=this._label.nativeElement,i="mdc-snackbar__label";t.classList.toggle(i,!t.querySelector(`.${i}`))}_exposeToModals(){let n=this._liveElementId,e=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let t=0;t<e.length;t++){let i=e[t],o=i.getAttribute("aria-owns");this._trackedModals.add(i),o?o.indexOf(n)===-1&&i.setAttribute("aria-owns",o+" "+n):i.setAttribute("aria-owns",n)}}_clearFromModals(){this._trackedModals.forEach(n=>{let e=n.getAttribute("aria-owns");if(e){let t=e.replace(this._liveElementId,"").trim();t.length>0?n.setAttribute("aria-owns",t):n.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;let n=this._elementRef.nativeElement,e=n.querySelector("[aria-hidden]"),t=n.querySelector("[aria-live]");if(e&&t){let i=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(i=document.activeElement),e.removeAttribute("aria-hidden"),t.appendChild(e),i?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=I({type:a,selectors:[["mat-snack-bar-container"]],viewQuery:function(e,t){if(e&1&&(W(Je,7),W(Ln,7)),e&2){let i;A(i=D())&&(t._portalOutlet=i.first),A(i=D())&&(t._label=i.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(e,t){e&1&&C("animationend",function(o){return t.onAnimationEnd(o.animationName)})("animationcancel",function(o){return t.onAnimationEnd(o.animationName)}),e&2&&j("mat-snack-bar-container-enter",t._animationState==="visible")("mat-snack-bar-container-exit",t._animationState==="hidden")("mat-snack-bar-container-animations-enabled",!t._animationsDisabled)},features:[pe],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(e,t){e&1&&(c(0,"div",1)(1,"div",2,0)(3,"div",3),x(4,Vn,0,0,"ng-template",4),l(),v(5,"div"),l()()),e&2&&(m(5),q("aria-live",t._live)("role",t._role)("id",t._liveElementId))},dependencies:[Je],styles:[`@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mat-snack-bar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-snack-bar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-snack-bar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mat-snack-bar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mat-snack-bar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mat-snack-bar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mat-snack-bar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-button-text-state-layer-color: currentColor;--mat-button-text-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}
`],encapsulation:2})}return a})();function Kn(){return new J}var Qn=new z("mat-snack-bar-default-options",{providedIn:"root",factory:Kn}),ot=(()=>{class a{_live=_(Tt);_injector=_(R);_breakpointObserver=_(It);_parentSnackBar=_(a,{optional:!0,skipSelf:!0});_defaultConfig=_(Qn);_animationsDisabled=X();_snackBarRefAtThisLevel=null;simpleSnackBarComponent=cn;snackBarContainerComponent=Yn;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let n=this._parentSnackBar;return n?n._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(n){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=n:this._snackBarRefAtThisLevel=n}constructor(){}openFromComponent(n,e){return this._attach(n,e)}openFromTemplate(n,e){return this._attach(n,e)}open(n,e="",t){let i=w(w({},this._defaultConfig),t);return i.data={message:n,action:e},i.announcementMessage===n&&(i.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,i)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(n,e){let t=e&&e.viewContainerRef&&e.viewContainerRef.injector,i=R.create({parent:t||this._injector,providers:[{provide:J,useValue:e}]}),o=new Ze(this.snackBarContainerComponent,e.viewContainerRef,i),s=n.attach(o);return s.instance.snackBarConfig=e,s.instance}_attach(n,e){let t=w(w(w({},new J),this._defaultConfig),e),i=this._createOverlay(t),o=this._attachSnackBarContainer(i,t),s=new ae(o,i);if(n instanceof he){let d=new We(n,null,{$implicit:t.data,snackBarRef:s});s.instance=o.attachTemplatePortal(d)}else{let d=this._createInjector(t,s),g=new Ze(n,void 0,d),p=o.attachComponentPortal(g);s.instance=p.instance}return this._breakpointObserver.observe(jt.HandsetPortrait).pipe(le(i.detachments())).subscribe(d=>{i.overlayElement.classList.toggle(this.handsetCssClass,d.matches)}),t.announcementMessage&&o._onAnnounce.subscribe(()=>{this._live.announce(t.announcementMessage,t.politeness)}),this._animateSnackBar(s,t),this._openedSnackBarRef=s,this._openedSnackBarRef}_animateSnackBar(n,e){n.afterDismissed().subscribe(()=>{this._openedSnackBarRef==n&&(this._openedSnackBarRef=null),e.announcementMessage&&this._live.clear()}),e.duration&&e.duration>0&&n.afterOpened().subscribe(()=>n._dismissAfter(e.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{n.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):n.containerInstance.enter()}_createOverlay(n){let e=new Le;e.direction=n.direction;let t=Ut(this._injector),i=n.direction==="rtl",o=n.horizontalPosition==="left"||n.horizontalPosition==="start"&&!i||n.horizontalPosition==="end"&&i,s=!o&&n.horizontalPosition!=="center";return o?t.left("0"):s?t.right("0"):t.centerHorizontally(),n.verticalPosition==="top"?t.top("0"):t.bottom("0"),e.positionStrategy=t,e.disableAnimations=this._animationsDisabled,Ve(this._injector,e)}_createInjector(n,e){let t=n&&n.viewContainerRef&&n.viewContainerRef.injector;return R.create({parent:t||this._injector,providers:[{provide:ae,useValue:e},{provide:rn,useValue:n.data}]})}static \u0275fac=function(e){return new(e||a)};static \u0275prov=S({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var ln=(()=>{class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=ge({type:a});static \u0275inj=de({providers:[ot],imports:[$e,Vt,ze,Q,cn,Q]})}return a})();var Gn=["messagesContainer"],Zn=["fileInput"];function Jn(a,r){if(a&1&&v(0,"img",16),a&2){let n=u(2);f("src",n.currentChat.profilePictureUrl,$)}}function ei(a,r){a&1&&(c(0,"mat-icon",17),h(1,"account_circle"),l())}function ti(a,r){if(a&1&&(c(0,"div",8)(1,"div",9),x(2,Jn,1,1,"img",10)(3,ei,2,0,"mat-icon",11),c(4,"div",12)(5,"span",13),h(6),l()()(),c(7,"div",14)(8,"button",15)(9,"mat-icon"),h(10,"search"),l()(),c(11,"button",15)(12,"mat-icon"),h(13,"more_vert"),l()()()()),a&2){let n=u();m(2),f("ngIf",n.currentChat.profilePictureUrl),m(),f("ngIf",!n.currentChat.profilePictureUrl),m(3),y(n.getChatDisplayName())}}function ni(a,r){a&1&&(c(0,"div",18)(1,"div",19)(2,"div",20),me(),c(3,"svg",21),v(4,"path",22),l()(),dt(),c(5,"h1"),h(6,"Chat Contacto Total"),l(),c(7,"p"),h(8,"Selecciona un chat para comenzar a conversar"),l()()())}function ii(a,r){if(a&1&&(c(0,"div",34),v(1,"div",35),c(2,"div",36)(3,"div",37),h(4),l(),c(5,"div",38),h(6),l()()()),a&2){let n=u().$implicit;m(3),j("quoted-me",n.quotedFromMe),m(),T(" ",n.quotedFromMe?"T\xFA":n.quotedSender," "),m(2),y(n.quotedText||"Archivo adjunto")}}function ai(a,r){if(a&1&&v(0,"img",43),a&2){let n=u(2).$implicit,e=u(2);f("src",e.getMediaSrc(n.media),$)}}function oi(a,r){if(a&1&&v(0,"video",44),a&2){let n=u(2).$implicit,e=u(2);f("src",e.getMediaSrc(n.media),$)}}function si(a,r){if(a&1){let n=k();c(0,"div",45)(1,"button",46),C("click",function(t){b(n);let i=u(2).$implicit,o=u(2);return M(o.toggleAudio(t,i.msgId))}),c(2,"mat-icon"),h(3),l()(),c(4,"div",47)(5,"div",48)(6,"div",49),v(7,"div",50),l(),c(8,"input",51),C("input",function(t){b(n);let i=u(2).$implicit,o=u(2);return M(o.seekAudio(t,i.msgId))}),l()(),c(9,"div",52)(10,"span"),h(11),l(),c(12,"span",53),h(13),l()()(),c(14,"button",54),C("click",function(t){b(n);let i=u(2).$implicit,o=u(2);return M(o.changeSpeed(t,i.msgId))}),c(15,"span",55),h(16),l()(),c(17,"audio",56,1),C("timeupdate",function(){b(n);let t=u(2).$implicit,i=u(2);return M(i.onAudioTimeUpdate(t.msgId))})("loadedmetadata",function(){b(n);let t=u(2).$implicit,i=u(2);return M(i.onAudioLoaded(t.msgId))})("loadeddata",function(){b(n);let t=u(2).$implicit,i=u(2);return M(i.onAudioLoaded(t.msgId))})("canplay",function(){b(n);let t=u(2).$implicit,i=u(2);return M(i.onAudioLoaded(t.msgId))})("durationchange",function(){b(n);let t=u(2).$implicit,i=u(2);return M(i.onAudioLoaded(t.msgId))})("ended",function(){b(n);let t=u(2).$implicit,i=u(2);return M(i.onAudioEnded(t.msgId))}),l()()}if(a&2){let n=u(2).$implicit,e=u(2);m(3),y(e.isAudioPlaying(n.msgId)?"pause":"play_arrow"),m(4),xt("width",e.getAudioProgress(n.msgId),"%"),m(),f("value",e.getAudioProgress(n.msgId)),m(3),y(e.getAudioCurrentTime(n.msgId)),m(2),y(e.getAudioDuration(n.msgId)),m(3),T("",e.getAudioSpeed(n.msgId),"x"),m(),f("src",e.getMediaSrc(n.media),$)("id","audio-"+n.msgId)}}function ri(a,r){if(a&1&&(c(0,"div",39),x(1,ai,1,1,"img",40)(2,oi,1,1,"video",41)(3,si,19,9,"div",42),l()),a&2){let n=u().$implicit,e=u(2);m(),f("ngIf",e.isImageMedia(n.media.mime)),m(),f("ngIf",e.isVideoMedia(n.media.mime)),m(),f("ngIf",e.isAudioMedia(n.media.mime))}}function ci(a,r){if(a&1&&(c(0,"div",57),h(1),l()),a&2){let n=u().$implicit;m(),y(n.text)}}function li(a,r){if(a&1&&(c(0,"mat-icon",58),h(1),l()),a&2){let n=u().$implicit,e=u(2);ve(e.getMessageStatusClass(n.status)),m(),T(" ",e.getMessageStatusIcon(n.status)," ")}}function di(a,r){if(a&1){let n=k();c(0,"div",25)(1,"div",26)(2,"button",27),C("click",function(){let t=b(n).$implicit,i=u(2);return M(i.replyToMessage(t))}),c(3,"mat-icon"),h(4,"reply"),l()(),x(5,ii,7,4,"div",28)(6,ri,4,3,"div",29)(7,ci,2,1,"div",30),c(8,"div",31)(9,"span",32),h(10),l(),x(11,li,2,3,"mat-icon",33),l()()()}if(a&2){let n=r.$implicit,e=u(2);j("from-me",n.fromMe)("from-them",!n.fromMe),m(5),f("ngIf",n.quotedMessageId),m(),f("ngIf",n.hasMedia&&n.media),m(),f("ngIf",n.text),m(3),y(e.formatTime(n.timestamp)),m(),f("ngIf",n.fromMe)}}function mi(a,r){if(a&1&&(c(0,"div",23,0),x(2,di,12,9,"div",24),l()),a&2){let n=u();m(2),f("ngForOf",n.messages)}}function ui(a,r){if(a&1){let n=k();c(0,"div",72)(1,"div",73)(2,"div",74)(3,"mat-icon",75),h(4,"reply"),l(),c(5,"span",76),h(6),l()(),c(7,"div",77),h(8),l()(),c(9,"button",78),C("click",function(){b(n);let t=u(2);return M(t.cancelReply())}),c(10,"mat-icon"),h(11,"close"),l()()()}if(a&2){let n=u(2);m(6),T("Respondiendo a ",n.replyingTo.fromMe?"ti mismo":n.replyingTo.chatTitle||"Usuario"),m(2),y(n.replyingTo.text||"Archivo adjunto")}}function hi(a,r){a&1&&(c(0,"div",79),h(1," \u{1F4AC} El cliente debe iniciar esta conversaci\xF3n para poder enviar mensajes "),l())}function gi(a,r){if(a&1&&(c(0,"div",80),h(1),l()),a&2){let n=u(2);m(),T(" \u26A0\uFE0F Tienes ",n.getTimeRemaining()," para responder o el chat se bloquear\xE1 ")}}function pi(a,r){if(a&1&&(c(0,"div",81),h(1),l()),a&2){let n=u(2);m(),T(" \u{1F6AB} Chat bloqueado. Espera a que ",n.getChatDisplayName()," te escriba de nuevo. ")}}function _i(a,r){if(a&1){let n=k();c(0,"button",82),C("click",function(){b(n);let t=u(2);return M(t.sendMessage())}),c(1,"mat-icon"),h(2,"send"),l()()}if(a&2){let n=u(2);f("disabled",n.isChatBlocked||n.isNewChat)}}function fi(a,r){if(a&1&&(c(0,"button",69)(1,"mat-icon"),h(2,"mic"),l()()),a&2){let n=u(2);f("disabled",n.isChatBlocked||n.isNewChat)}}function bi(a,r){if(a&1){let n=k();c(0,"div",59),x(1,ui,12,2,"div",60)(2,hi,2,0,"div",61)(3,gi,2,1,"div",62)(4,pi,2,1,"div",63),c(5,"div",64)(6,"input",65,2),C("change",function(t){b(n);let i=u();return M(i.onFileSelected(t))}),l(),c(8,"button",66),C("click",function(){b(n);let t=u();return M(t.openFileSelector())}),c(9,"mat-icon"),h(10,"add"),l()(),c(11,"div",67)(12,"input",68),we("ngModelChange",function(t){b(n);let i=u();return Pe(i.messageText,t)||(i.messageText=t),M(t)}),C("keypress",function(t){b(n);let i=u();return M(i.onKeyPress(t))}),l()(),c(13,"button",69)(14,"mat-icon"),h(15,"sentiment_satisfied_alt"),l()(),x(16,_i,3,1,"button",70)(17,fi,3,1,"button",71),l()()}if(a&2){let n=u();m(),f("ngIf",n.replyingTo),m(),f("ngIf",n.isNewChat&&!n.isChatBlocked),m(),f("ngIf",(n.windowStatus==null?null:n.windowStatus.hasActiveWindow)&&!n.isChatBlocked&&!n.isNewChat),m(),f("ngIf",n.isChatBlocked&&!n.isNewChat),m(4),f("disabled",n.isChatBlocked||n.isNewChat),m(4),f("placeholder",n.getInputPlaceholder()),xe("ngModel",n.messageText),f("disabled",n.isChatBlocked||n.isNewChat),m(),f("disabled",n.isChatBlocked||n.isNewChat),m(3),f("ngIf",n.messageText.trim()),m(),f("ngIf",!n.messageText.trim())}}var dn=(()=>{let r=class r{constructor(e,t,i){this.messageService=e,this.apiService=t,this.snackBar=i,this.currentChat=null,this.messages=[],this.messageText="",this.shouldScroll=!1,this.replyingTo=null,this.audioStates=new Map,this.windowStatus=null,this.isChatBlocked=!1,this.isNewChat=!1,this.hoursRemaining=0,this.minutesRemaining=0,this.secondsRemaining=0}getChatDisplayName(){return this.currentChat?!this.currentChat.name||this.currentChat.name.includes("@s.whatsapp.net")?this.formatPhoneNumber(this.currentChat.jid):this.currentChat.name:""}formatPhoneNumber(e){let t=e.split("@")[0];if(!/^\d+$/.test(t))return e;if(t.length>=11){let i=t.substring(0,2),o=t.substring(2),s=o.match(/.{1,3}/g)?.join(" ")||o;return`+${i} ${s}`}else if(t.length>=10){let i=t.substring(0,1),o=t.substring(1),s=o.match(/.{1,3}/g)?.join(" ")||o;return`+${i} ${s}`}else return`+${t}`}ngOnInit(){this.messageService.currentChat$.subscribe(e=>{this.currentChat=e,e?(this.checkWindowStatus(),this.startWindowCheck()):this.stopWindowCheck()}),this.messageService.currentMessages$.subscribe(e=>{console.log("\u{1F4EC} Mensajes recibidos:",e);let t=this.messages.length;this.messages=e,this.checkIfNewChat(),this.shouldScroll=!0,e.length>t&&(e[e.length-1].fromMe||(console.log("\u{1F4AC} Mensaje nuevo del cliente - Verificando estado de ventana"),setTimeout(()=>{this.checkWindowStatus()},1e3)))}),this.messageService.windowStatusUpdate$.subscribe(e=>{if(!(!e||!this.currentChat)&&(e.chat===this.currentChat.jid||e.jid===this.currentChat.jid)){console.log("\u{1F514} Actualizaci\xF3n de ventana en tiempo real:",e),e.isBlocked!==void 0&&(this.isChatBlocked=e.isBlocked),e.hoursRemaining!==void 0&&(this.hoursRemaining=e.hoursRemaining),e.minutesRemaining!==void 0&&(this.minutesRemaining=e.minutesRemaining);let t=this.hoursRemaining*3600+this.minutesRemaining*60;this.secondsRemaining=t,t>0&&!this.isChatBlocked?this.startCountdown():this.stopCountdown()}})}ngAfterViewChecked(){this.shouldScroll&&(setTimeout(()=>{this.scrollToBottom()},100),this.shouldScroll=!1)}ngOnDestroy(){this.stopWindowCheck(),this.stopCountdown()}checkWindowStatus(){this.currentChat&&this.apiService.getWindowStatus(this.currentChat.jid).subscribe({next:e=>{this.windowStatus=e,this.isChatBlocked=e.isBlocked||!1,this.hoursRemaining=e.hoursRemaining||0,this.minutesRemaining=e.minutesRemaining||0;let t=this.hoursRemaining*3600+this.minutesRemaining*60;this.secondsRemaining=t,console.log("\u{1F50D} Window status:",{blocked:this.isChatBlocked,hours:this.hoursRemaining,minutes:this.minutesRemaining,seconds:this.secondsRemaining}),e.hasActiveWindow&&!this.isChatBlocked&&t>0?this.startCountdown():this.stopCountdown()},error:e=>{this.isChatBlocked=!1,this.windowStatus=null,this.hoursRemaining=0,this.minutesRemaining=0,this.secondsRemaining=0,this.stopCountdown()}})}checkIfNewChat(){if(!this.messages||this.messages.length===0){this.isNewChat=!0,console.log("\u{1F4AC} Chat nuevo detectado - Cliente debe iniciar conversaci\xF3n");return}this.messages.some(t=>!t.fromMe)?this.isNewChat=!1:(this.isNewChat=!0,console.log("\u{1F4AC} Chat sin mensajes del cliente - Cliente debe iniciar conversaci\xF3n"))}startWindowCheck(){this.stopWindowCheck(),this.windowCheckInterval=setInterval(()=>{this.checkWindowStatus()},3e4)}stopWindowCheck(){this.windowCheckInterval&&(clearInterval(this.windowCheckInterval),this.windowCheckInterval=null)}startCountdown(){this.stopCountdown(),this.countdownInterval=setInterval(()=>{this.secondsRemaining>0?(this.secondsRemaining--,this.hoursRemaining=Math.floor(this.secondsRemaining/3600),this.minutesRemaining=Math.floor(this.secondsRemaining%3600/60)):(console.log("\u23F0 Tiempo agotado - Bloqueando chat"),this.isChatBlocked=!0,this.windowStatus=oe(w({},this.windowStatus),{isBlocked:!0,hasActiveWindow:!1}),this.stopCountdown())},1e3)}stopCountdown(){this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}sendMessage(){!this.currentChat||!this.messageText.trim()||(this.replyingTo?(this.messageService.sendMessage(this.currentChat.jid,this.messageText.trim(),this.replyingTo.msgId),this.replyingTo=null):this.messageService.sendMessage(this.currentChat.jid,this.messageText.trim()),this.messageText="",setTimeout(()=>{this.checkWindowStatus()},1e3))}replyToMessage(e){this.replyingTo=e}cancelReply(){this.replyingTo=null}onKeyPress(e){e.key==="Enter"&&!e.shiftKey&&(e.preventDefault(),this.sendMessage())}onEscapePressed(e){e.key==="Escape"&&this.currentChat&&(e.preventDefault(),this.messageService.selectChat(null))}openFileSelector(){this.fileInput.nativeElement.click()}onFileSelected(e){let t=e.target,i=t.files?.[0];if(!i||!this.currentChat)return;let o=new FileReader;o.onload=()=>{let s=o.result.split(",")[1];this.messageService.sendMedia(this.currentChat.jid,s,i.type,this.messageText.trim()||void 0),this.messageText="",t.value=""},o.readAsDataURL(i)}formatTime(e){return new Date(e).toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"})}getMessageStatusIcon(e){switch(e){case"pending":return"schedule";case"sent":return"done";case"delivered":return"done_all";case"read":return"done_all";case"error":return"error_outline";default:return"done"}}getMessageStatusClass(e){return e==="read"?"status-read":"status-default"}isImageMedia(e){return e?.startsWith("image/")||!1}isVideoMedia(e){return e?.startsWith("video/")||!1}isAudioMedia(e){return e?.startsWith("audio/")||!1}getMediaSrc(e){return e.base64Data&&e.mime?`data:${e.mime};base64,${e.base64Data}`:e.url&&(e.url.startsWith("http://")||e.url.startsWith("https://"))?e.url:e.url&&e.mime?e.url.startsWith("data:")?e.url:`data:${e.mime};base64,${e.url}`:(console.log("\u274C No se pudo generar URL"),"")}scrollToBottom(){try{this.messagesContainer&&this.messagesContainer.nativeElement&&(this.messagesContainer.nativeElement.scrollTop=this.messagesContainer.nativeElement.scrollHeight)}catch{}}getAudioElement(e){return document.getElementById("audio-"+e)}initAudioState(e){this.audioStates.has(e)||this.audioStates.set(e,{isPlaying:!1,currentTime:0,duration:0,speed:1})}toggleAudio(e,t){e.stopPropagation(),this.initAudioState(t);let i=this.getAudioElement(t);if(!i)return;let o=this.audioStates.get(t);o.isPlaying?(i.pause(),o.isPlaying=!1):(this.audioStates.forEach((s,d)=>{if(d!==t&&s.isPlaying){let g=this.getAudioElement(d);g&&g.pause(),s.isPlaying=!1}}),i.play(),o.isPlaying=!0)}isAudioPlaying(e){return this.audioStates.get(e)?.isPlaying||!1}onAudioTimeUpdate(e){let t=this.getAudioElement(e);if(!t)return;this.initAudioState(e);let i=this.audioStates.get(e);i.currentTime=t.currentTime,this.audioStates=new Map(this.audioStates)}onAudioLoaded(e){let t=this.getAudioElement(e);if(!t){console.log("\u274C Audio element not found:",e);return}this.initAudioState(e);let i=this.audioStates.get(e);console.log("\u{1F3B5} Audio loaded:",e,"Duration:",t.duration,"readyState:",t.readyState),t.duration&&!isNaN(t.duration)&&isFinite(t.duration)?(i.duration=t.duration,console.log("\u2705 Duration set:",i.duration),this.audioStates=new Map(this.audioStates)):(console.log("\u23F3 Duration not ready, retrying..."),setTimeout(()=>{t.duration&&!isNaN(t.duration)&&isFinite(t.duration)?(i.duration=t.duration,console.log("\u2705 Duration set (retry):",i.duration),this.audioStates=new Map(this.audioStates)):console.log("\u274C Duration still not available:",t.duration)},200))}onAudioEnded(e){this.initAudioState(e);let t=this.audioStates.get(e);t.isPlaying=!1,t.currentTime=0}seekAudio(e,t){let i=e.target,o=this.getAudioElement(t);if(!o)return;let s=this.audioStates.get(t);if(!s)return;let d=parseFloat(i.value)/100*s.duration;o.currentTime=d}changeSpeed(e,t){e.stopPropagation();let i=this.getAudioElement(t);if(!i)return;this.initAudioState(t);let o=this.audioStates.get(t),s=[1,1.5,2],g=(s.indexOf(o.speed)+1)%s.length;o.speed=s[g],i.playbackRate=o.speed}getAudioProgress(e){let t=this.audioStates.get(e);return!t||t.duration===0?0:t.currentTime/t.duration*100}getAudioCurrentTime(e){let t=this.audioStates.get(e);return!t||!t.currentTime||isNaN(t.currentTime)?"0:00":this.formatAudioTime(t.currentTime)}getAudioDuration(e){let t=this.audioStates.get(e);return!t||!t.duration||t.duration===0||isNaN(t.duration)||!isFinite(t.duration)?"0:00":this.formatAudioTime(t.duration)}getAudioSpeed(e){return this.audioStates.get(e)?.speed||1}formatAudioTime(e){let t=Math.floor(e/60),i=Math.floor(e%60);return`${t}:${i.toString().padStart(2,"0")}`}canSendMessage(){return!this.isChatBlocked&&!this.isNewChat&&!!this.currentChat}getInputPlaceholder(){return this.isNewChat?"\u{1F4AC} El cliente debe iniciar esta conversaci\xF3n":this.isChatBlocked?"\u{1F6AB} Chat bloqueado - Espera a que el cliente te escriba":"Escribe un mensaje..."}getTimeRemaining(){if(this.hoursRemaining>0)return`${this.hoursRemaining}h ${this.minutesRemaining}min`;let e=this.secondsRemaining%60;return`${this.minutesRemaining}min ${e}seg`}};r.\u0275fac=function(t){return new(t||r)(N(He),N(qe),N(ot))},r.\u0275cmp=I({type:r,selectors:[["app-chat-window"]],viewQuery:function(t,i){if(t&1&&(W(Gn,5),W(Zn,5)),t&2){let o;A(o=D())&&(i.messagesContainer=o.first),A(o=D())&&(i.fileInput=o.first)}},hostBindings:function(t,i){t&1&&C("keydown",function(s){return i.onEscapePressed(s)},ht)},decls:5,vars:4,consts:[["messagesContainer",""],["audioElement",""],["fileInput",""],[1,"chat-window-container"],["class","chat-header",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","messages-container",4,"ngIf"],["class","input-container",4,"ngIf"],[1,"chat-header"],[1,"header-left"],["class","avatar-icon profile-pic","alt","Profile",3,"src",4,"ngIf"],["class","avatar-icon",4,"ngIf"],[1,"chat-info"],[1,"chat-name"],[1,"header-right"],["mat-icon-button","",1,"header-icon"],["alt","Profile",1,"avatar-icon","profile-pic",3,"src"],[1,"avatar-icon"],[1,"empty-state"],[1,"empty-content"],[1,"empty-icon"],["viewBox","0 0 303 172","width","360","height","210"],["fill","#525252","d","M151.5,0A75.5,75.5,0,1,1,76,75.5,75.5,75.5,0,0,1,151.5,0m0,140A64.5,64.5,0,1,0,87,75.5,64.5,64.5,0,0,0,151.5,140Z"],[1,"messages-container"],["class","message-wrapper",3,"from-me","from-them",4,"ngFor","ngForOf"],[1,"message-wrapper"],[1,"message-bubble"],["mat-icon-button","","title","Responder",1,"reply-button",3,"click"],["class","quoted-message",4,"ngIf"],["class","message-media",4,"ngIf"],["class","message-text",4,"ngIf"],[1,"message-footer"],[1,"message-time"],["class","message-status",3,"class",4,"ngIf"],[1,"quoted-message"],[1,"quoted-line"],[1,"quoted-content"],[1,"quoted-sender"],[1,"quoted-text"],[1,"message-media"],["alt","Imagen","class","media-image",3,"src",4,"ngIf"],["controls","","class","media-video",3,"src",4,"ngIf"],["class","media-audio",4,"ngIf"],["alt","Imagen",1,"media-image",3,"src"],["controls","",1,"media-video",3,"src"],[1,"media-audio"],["mat-icon-button","",1,"audio-play-button",3,"click"],[1,"audio-controls"],[1,"audio-waveform"],[1,"audio-progress-bg"],[1,"audio-progress-fill"],["type","range","min","0","max","100",1,"audio-slider",3,"input","value"],[1,"audio-time"],[1,"audio-duration"],["mat-icon-button","",1,"audio-speed-button",3,"click"],[1,"speed-text"],["preload","metadata",2,"display","none",3,"timeupdate","loadedmetadata","loadeddata","canplay","durationchange","ended","src","id"],[1,"message-text"],[1,"message-status"],[1,"input-container"],["class","reply-preview",4,"ngIf"],["class","new-chat-banner",4,"ngIf"],["class","window-warning-banner",4,"ngIf"],["class","chat-blocked-banner",4,"ngIf"],[1,"input-row"],["type","file","accept","image/*,video/*,audio/*",2,"display","none",3,"change"],["mat-icon-button","",1,"input-icon",3,"click","disabled"],[1,"message-input-wrapper"],["type","text","autocomplete","off",1,"message-input",3,"ngModelChange","keypress","placeholder","ngModel","disabled"],["mat-icon-button","",1,"input-icon",3,"disabled"],["mat-icon-button","","class","send-button",3,"disabled","click",4,"ngIf"],["mat-icon-button","","class","input-icon",3,"disabled",4,"ngIf"],[1,"reply-preview"],[1,"reply-preview-content"],[1,"reply-preview-header"],[1,"reply-icon"],[1,"reply-preview-title"],[1,"reply-preview-text"],["mat-icon-button","",1,"reply-close-button",3,"click"],[1,"new-chat-banner"],[1,"window-warning-banner"],[1,"chat-blocked-banner"],["mat-icon-button","",1,"send-button",3,"click","disabled"]],template:function(t,i){t&1&&(c(0,"div",3),x(1,ti,14,3,"div",4)(2,ni,9,0,"div",5)(3,mi,3,1,"div",6)(4,bi,18,11,"div",7),l()),t&2&&(m(),f("ngIf",i.currentChat),m(),f("ngIf",!i.currentChat),m(),f("ngIf",i.currentChat),m(),f("ngIf",i.currentChat))},dependencies:[ke,ye,Oe,Ae,Ie,Te,Ee,Rt,Re,je,ze,Be,Ne,Fe,Yt,ln],styles:[`.chat-window-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:#0a0e27;overflow:hidden}.chat-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;height:59px;padding:10px 16px;background:#1e293b;flex-shrink:0;box-shadow:0 2px 6px #0000004d;transition:box-shadow .3s ease}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;flex:1;min-width:0}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .avatar-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;color:#94a3b8;cursor:pointer;flex-shrink:0;transition:all .3s ease}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .avatar-icon[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.05)}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .avatar-icon.profile-pic[_ngcontent-%COMP%]{border-radius:50%;object-fit:cover;border:2px solid #334155}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]{flex:1;min-width:0}.chat-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .chat-info[_ngcontent-%COMP%]   .chat-name[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#94a3b8;line-height:21px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.chat-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.chat-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{color:#94a3b8;width:40px;height:40px;border-radius:50%;transition:all .3s ease}.chat-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.chat-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:#94a3b8;transform:scale(1.1)}.empty-state[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;background:#0a0e27;background-image:repeating-linear-gradient(transparent,transparent 80px,rgba(52,152,219,.02) 80px,rgba(52,152,219,.02) 160px),repeating-linear-gradient(90deg,transparent,transparent 80px,rgba(52,152,219,.02) 80px,rgba(52,152,219,.02) 160px);border-left:1px solid #334155}.empty-state[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]{text-align:center;max-width:460px;padding:40px;animation:_ngcontent-%COMP%_fadeIn .5s ease}.empty-state[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{margin-bottom:32px}.empty-state[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:block;margin:0 auto;opacity:.3}.empty-state[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:36px;font-weight:300;color:#fff;margin:0 0 24px;letter-spacing:-.5px}.empty-state[_ngcontent-%COMP%]   .empty-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#64748b;line-height:20px;margin:0;font-weight:400}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.messages-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden;padding:20px 60px;background-color:#0a0e27;background-size:412.5px 749.25px;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23000000' fill-opacity='0.03'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");transition:background-color .3s ease}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c5cdd4;border-radius:3px}.messages-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8b3bb}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]{display:flex;margin-bottom:12px;animation:_ngcontent-%COMP%_slideIn .3s ease}.messages-container[_ngcontent-%COMP%]   .message-wrapper.from-me[_ngcontent-%COMP%]{justify-content:flex-end}.messages-container[_ngcontent-%COMP%]   .message-wrapper.from-me[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:#10b981;color:#fff;border-radius:7.5px 7.5px 0;box-shadow:0 1px 2px #0000001a;transition:all .3s ease}.messages-container[_ngcontent-%COMP%]   .message-wrapper.from-me[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]:hover{box-shadow:0 2px 6px #00000026;transform:translateY(-1px)}.messages-container[_ngcontent-%COMP%]   .message-wrapper.from-them[_ngcontent-%COMP%]{justify-content:flex-start}.messages-container[_ngcontent-%COMP%]   .message-wrapper.from-them[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background:#1e293b;color:#fff;border-radius:7.5px 7.5px 7.5px 0;box-shadow:0 1px 2px #0000001a;transition:all .3s ease}.messages-container[_ngcontent-%COMP%]   .message-wrapper.from-them[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]:hover{box-shadow:0 2px 6px #00000026;transform:translateY(-1px)}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{max-width:65%;padding:6px 7px 8px 9px;position:relative}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .reply-button[_ngcontent-%COMP%]{position:absolute;top:0;right:-40px;opacity:0;transition:opacity .2s ease;color:#94a3b8;width:32px;height:32px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .reply-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .reply-button[_ngcontent-%COMP%]:hover{background:#10b9811a}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]:hover   .reply-button[_ngcontent-%COMP%]{opacity:1}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .quoted-message[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:6px;padding:6px 8px;background:#00000026;border-radius:5px;cursor:pointer;transition:background .2s ease}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .quoted-message[_ngcontent-%COMP%]:hover{background:#0003}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .quoted-message[_ngcontent-%COMP%]   .quoted-line[_ngcontent-%COMP%]{width:4px;border-radius:2px;background:#10b981;flex-shrink:0}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .quoted-message[_ngcontent-%COMP%]   .quoted-content[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:2px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .quoted-message[_ngcontent-%COMP%]   .quoted-content[_ngcontent-%COMP%]   .quoted-sender[_ngcontent-%COMP%]{font-size:12.8px;font-weight:500;color:#10b981;line-height:16px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .quoted-message[_ngcontent-%COMP%]   .quoted-content[_ngcontent-%COMP%]   .quoted-sender.quoted-me[_ngcontent-%COMP%]{color:#059669}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .quoted-message[_ngcontent-%COMP%]   .quoted-content[_ngcontent-%COMP%]   .quoted-text[_ngcontent-%COMP%]{font-size:13px;line-height:18px;color:#ffffffbf;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]{margin:-6px -7px 4px -9px;border-radius:7.5px 7.5px 0 0;overflow:hidden}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-image[_ngcontent-%COMP%], .messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-video[_ngcontent-%COMP%]{max-width:100%;max-height:400px;display:block;cursor:pointer;border-radius:7.5px 7.5px 0 0}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;min-width:280px;background:#ffffff14;border-radius:7.5px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-play-button[_ngcontent-%COMP%]{flex-shrink:0;width:36px;height:36px;background:#ffffff26;color:#fff}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-play-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-play-button[_ngcontent-%COMP%]:hover{background:#fff3}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:4px;min-width:0}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]{position:relative;height:4px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-progress-bg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:4px;background:#fff3;border-radius:2px;overflow:hidden}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-progress-bg[_ngcontent-%COMP%]   .audio-progress-fill[_ngcontent-%COMP%]{height:100%;background:#059669;border-radius:2px;transition:width .1s linear}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-slider[_ngcontent-%COMP%]{position:relative;width:100%;height:4px;-webkit-appearance:none;appearance:none;background:transparent;border-radius:2px;outline:none;cursor:pointer;z-index:1;margin:0}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:12px;height:12px;border-radius:50%;background:#0f172a;cursor:pointer;opacity:0;transition:opacity .2s}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-slider[_ngcontent-%COMP%]:hover::-webkit-slider-thumb{opacity:1}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-slider[_ngcontent-%COMP%]::-moz-range-thumb{width:12px;height:12px;border-radius:50%;background:#0f172a;cursor:pointer;border:none;opacity:0;transition:opacity .2s}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-slider[_ngcontent-%COMP%]:hover::-moz-range-thumb{opacity:1}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-slider[_ngcontent-%COMP%]::-webkit-slider-runnable-track{height:4px;background:transparent;border-radius:2px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-waveform[_ngcontent-%COMP%]   .audio-slider[_ngcontent-%COMP%]::-moz-range-track{height:4px;background:transparent;border-radius:2px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-time[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:11px;color:#fffc;line-height:1}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-controls[_ngcontent-%COMP%]   .audio-time[_ngcontent-%COMP%]   .audio-duration[_ngcontent-%COMP%]{color:#fff9}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-speed-button[_ngcontent-%COMP%]{flex-shrink:0;width:32px;height:32px;background:#ffffff26;border-radius:50%;display:flex;align-items:center;justify-content:center}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-speed-button[_ngcontent-%COMP%]   .speed-text[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:#fff;line-height:1}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-media[_ngcontent-%COMP%]   .media-audio[_ngcontent-%COMP%]   .audio-speed-button[_ngcontent-%COMP%]:hover{background:#fff3}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{word-wrap:break-word;white-space:pre-wrap;font-size:14.2px;line-height:19px;margin:0;padding-right:50px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:3px;margin-top:4px;float:right}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{font-size:11px;color:#ffffffb3;line-height:15px}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .message-status[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#ffffffb3}.messages-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .message-footer[_ngcontent-%COMP%]   .message-status.status-read[_ngcontent-%COMP%]{color:#1d57d4}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:#1e293b;flex-shrink:0;flex-grow:0}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;background:#1e293b;border-left:4px solid #10B981;gap:12px}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-preview-content[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:4px}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-preview-content[_ngcontent-%COMP%]   .reply-preview-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-preview-content[_ngcontent-%COMP%]   .reply-preview-header[_ngcontent-%COMP%]   .reply-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#10b981}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-preview-content[_ngcontent-%COMP%]   .reply-preview-header[_ngcontent-%COMP%]   .reply-preview-title[_ngcontent-%COMP%]{font-size:12.8px;font-weight:500;color:#10b981;line-height:16px}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-preview-content[_ngcontent-%COMP%]   .reply-preview-text[_ngcontent-%COMP%]{font-size:13px;line-height:18px;color:#94a3b8;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-close-button[_ngcontent-%COMP%]{flex-shrink:0;color:#94a3b8;width:32px;height:32px}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-close-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.input-container[_ngcontent-%COMP%]   .reply-preview[_ngcontent-%COMP%]   .reply-close-button[_ngcontent-%COMP%]:hover{background:#10b9811a}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:10px;padding:10px 16px;min-height:62px}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{color:#94a3b8;width:40px;height:40px;margin-bottom:5px;border-radius:50%;transition:all .3s ease}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:26px;width:26px;height:26px}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]:hover{background:#10b9811a;color:#10b981;transform:scale(1.1)}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .message-input-wrapper[_ngcontent-%COMP%]{flex:1;background:#0f172a;border-radius:8px;padding:10px 12px;min-height:42px;display:flex;align-items:center;border:1px solid #334155;transition:all .3s ease}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .message-input-wrapper[_ngcontent-%COMP%]:focus-within{border-color:#10b981;box-shadow:0 0 0 2px #3498db1a}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .message-input-wrapper[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]{width:100%;background:transparent;border:none;outline:none;color:#fff;font-size:15px;font-family:inherit;line-height:20px;resize:none}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .message-input-wrapper[_ngcontent-%COMP%]   .message-input[_ngcontent-%COMP%]::placeholder{color:#64748b}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]{color:#10b981;width:40px;height:40px;margin-bottom:5px;border-radius:50%;transition:all .3s ease}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.input-container[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]:hover{background:#10b9811a;color:#059669;transform:scale(1.1)}.window-warning-banner[_ngcontent-%COMP%]{background-color:#fff3cd;border:1px solid #ffc107;border-radius:4px;padding:12px 16px;margin:0 16px 12px;color:#856404;font-size:14px;text-align:center;animation:_ngcontent-%COMP%_pulse 2s infinite}.chat-blocked-banner[_ngcontent-%COMP%]{background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;padding:12px 16px;margin:0 16px 12px;color:#721c24;font-size:14px;text-align:center;font-weight:500}.new-chat-banner[_ngcontent-%COMP%]{background-color:#d1ecf1;border:1px solid #bee5eb;border-radius:4px;padding:12px 16px;margin:0 16px 12px;color:#0c5460;font-size:14px;text-align:center;font-weight:500}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.7}}.error-snackbar[_ngcontent-%COMP%]{background-color:#f44336!important;color:#fff!important}`]});let a=r;return a})();var Ja=(()=>{let r=class r{onChatSelected(e){console.log("Chat seleccionado:",e.name)}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=I({type:r,selectors:[["app-main"]],decls:5,vars:0,consts:[[1,"app-container"],[1,"sidebar"],[3,"chatSelected"],[1,"main-content"]],template:function(t,i){t&1&&(c(0,"div",0)(1,"div",1)(2,"app-chat-list",2),C("chatSelected",function(s){return i.onChatSelected(s)}),l()(),c(3,"div",3),v(4,"app-chat-window"),l()())},dependencies:[sn,dn],styles:[".app-container[_ngcontent-%COMP%]{display:flex;height:calc(100vh - 64px);width:100%;overflow:hidden;background:#0a0e27}.sidebar[_ngcontent-%COMP%]{width:350px;min-width:300px;max-width:400px;border-right:1px solid #334155;background:#1e293b;overflow-y:auto}.main-content[_ngcontent-%COMP%]{flex:1;background:#0a0e27;overflow:hidden;height:100%}"]});let a=r;return a})();export{Ja as MainComponent};
