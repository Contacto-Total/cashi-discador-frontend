import{a as S}from"./chunk-JCIXYVAL.js";import{Da as f,L as u,Ra as l,Sa as e,Ta as t,Ua as _,Vb as v,Wb as E,Xb as M,ac as O,bb as C,db as p,mc as P,pa as o,rb as n,sb as d,ta as m,tb as x,x as b,ya as h}from"./chunk-OVXRDAV3.js";function y(i,a){if(i&1&&(e(0,"div",6),n(1),t()),i&2){let r=p();o(),x("\u274C ",r.error)}}function I(i,a){i&1&&(e(0,"div",7),_(1,"div",8),e(2,"p"),n(3,"Cargando extensiones..."),t()())}function k(i,a){if(i&1&&(e(0,"tr")(1,"td",16),n(2),t(),e(3,"td"),n(4),t(),e(5,"td"),n(6),t(),e(7,"td"),n(8),t(),e(9,"td")(10,"span",17),n(11),t()(),e(12,"td",18),n(13),t(),e(14,"td",19),n(15),t()()),i&2){let r=a.$implicit,s=p(2);o(2),d(r.extension),o(2),d(r.fullName||r.displayName||"-"),o(2),d(r.ipAddress),o(2),d(r.port),o(2),l("ngClass",s.getStatusClass(r.status)),o(),x(" ",r.status," "),o(2),d(r.pingMs),o(2),d(r.userAgent||"-")}}function w(i,a){i&1&&(e(0,"tr")(1,"td",20),n(2," \u{1F4ED} No hay extensiones registradas en este momento "),t()())}function D(i,a){if(i&1&&(e(0,"div",9)(1,"div",10)(2,"h3"),n(3,"\u{1F4CB} Extensiones Registradas"),t(),e(4,"div",11),n(5),t()(),e(6,"div",12)(7,"table",13)(8,"thead")(9,"tr")(10,"th"),n(11,"Extensi\xF3n/Anexo"),t(),e(12,"th"),n(13,"Nombre"),t(),e(14,"th"),n(15,"IP"),t(),e(16,"th"),n(17,"Puerto"),t(),e(18,"th"),n(19,"Estado"),t(),e(20,"th"),n(21,"Respuesta"),t(),e(22,"th"),n(23,"User Agent"),t()()(),e(24,"tbody"),f(25,k,16,8,"tr",14)(26,w,3,0,"tr",15),t()()()()),i&2){let r=p();o(5),x(" Total: ",r.extensions.length," "),o(20),l("ngForOf",r.extensions),o(),l("ngIf",r.extensions.length===0)}}var G=(()=>{let a=class a{constructor(s,c){this.router=s,this.monitoringService=c,this.extensions=[],this.loading=!1,this.error=null}ngOnInit(){this.loadExtensions(),this.startPolling()}ngOnDestroy(){this.pollingSubscription&&this.pollingSubscription.unsubscribe()}loadExtensions(){this.loading=!0,this.error=null,this.monitoringService.getExtensionRegistrations().subscribe({next:s=>{this.extensions=s,this.loading=!1},error:s=>{console.error("Error loading extensions:",s),this.error="Error al cargar las extensiones registradas",this.loading=!1}})}startPolling(){this.pollingSubscription=b(5e3).pipe(u(()=>this.monitoringService.getExtensionRegistrations())).subscribe({next:s=>{this.extensions=s},error:s=>{console.error("Error polling extensions:",s)}})}goBack(){this.router.navigate(["/admin/campaigns"])}getStatusClass(s){return s==="REGISTRADO"?"status-registered":"status-unregistered"}};a.\u0275fac=function(c){return new(c||a)(m(P),m(S))},a.\u0275cmp=h({type:a,selectors:[["app-extensions-registry"]],decls:12,vars:3,consts:[[1,"extensions-container"],[1,"header"],[1,"btn-back",3,"click"],["class","error-message",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","extensions-section",4,"ngIf"],[1,"error-message"],[1,"loading-state"],[1,"spinner"],[1,"extensions-section"],[1,"table-header"],[1,"info-badge"],[1,"table-container"],[1,"extensions-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"extension-cell"],[1,"status-badge",3,"ngClass"],[1,"ping-cell"],[1,"user-agent-cell"],["colspan","7",1,"empty-row"]],template:function(c,g){c&1&&(e(0,"div",0)(1,"div",1)(2,"button",2),C("click",function(){return g.goBack()}),e(3,"span"),n(4,"\u2B05"),t(),e(5,"span"),n(6,"Volver a Campa\xF1as"),t()(),e(7,"h1"),n(8,"\u{1F4DE} Registro de Extensiones"),t()(),f(9,y,2,1,"div",3)(10,I,4,0,"div",4)(11,D,27,3,"div",5),t()),c&2&&(o(9),l("ngIf",g.error),o(),l("ngIf",g.loading&&g.extensions.length===0),o(),l("ngIf",!g.loading||g.extensions.length>0))},dependencies:[O,v,E,M],styles:[".extensions-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto;background:#0f172a;min-height:100vh;color:#e2e8f0}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:30px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#f1f5f9;font-size:28px;font-weight:600}.btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background:#1e293b;color:#e2e8f0;border:1px solid #334155;border-radius:8px;cursor:pointer;font-size:14px;transition:all .3s}.btn-back[_ngcontent-%COMP%]:hover{background:#334155;border-color:#475569}.error-message[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid #EF4444;color:#ef4444;padding:12px 16px;border-radius:8px;margin-bottom:20px;font-size:14px}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px;color:#94a3b8}.spinner[_ngcontent-%COMP%]{border:4px solid #334155;border-top:4px solid #3B82F6;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.extensions-section[_ngcontent-%COMP%]{background:#1e293b;border:1px solid #334155;border-radius:12px;padding:20px}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#f1f5f9;font-size:20px;font-weight:600}.info-badge[_ngcontent-%COMP%]{padding:6px 12px;background:#3b82f6;color:#fff;border-radius:6px;font-size:13px;font-weight:500}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.extensions-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.extensions-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#0f172a}.extensions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px;text-align:left;color:#94a3b8;font-size:13px;font-weight:600;border-bottom:2px solid #334155}.extensions-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #334155;transition:all .3s}.extensions-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#0f172a}.extensions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;color:#e2e8f0;font-size:14px}.extension-cell[_ngcontent-%COMP%]{font-weight:600;color:#3b82f6}.ping-cell[_ngcontent-%COMP%]{font-weight:500;color:#10b981}.user-agent-cell[_ngcontent-%COMP%]{color:#94a3b8;font-size:12px}.empty-row[_ngcontent-%COMP%]{text-align:center;color:#94a3b8;padding:40px!important;font-size:16px}.status-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:6px;font-size:12px;font-weight:500;display:inline-block}.status-registered[_ngcontent-%COMP%]{background:#10b98133;color:#10b981;border:1px solid #10B981}.status-unregistered[_ngcontent-%COMP%]{background:#ef444433;color:#ef4444;border:1px solid #EF4444}@media (max-width: 768px){.extensions-container[_ngcontent-%COMP%]{padding:15px}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.table-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}}"]});let i=a;return i})();export{G as ExtensionsRegistryComponent};
