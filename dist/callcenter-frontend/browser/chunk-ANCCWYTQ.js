import{a as Qe,b as ze,c as Ge,d as He,e as We,f as qe,g as K}from"./chunk-W25D4IGX.js";import"./chunk-5AU2PCOT.js";import"./chunk-V57U6UGI.js";import{c as $e,d as Je,e as je}from"./chunk-6BBDFUN7.js";import"./chunk-NLY5JN6O.js";import{a as De,b as Ee,c as Te,d as Re,e as Le,f as Ne,g as Ve,h as Ie,i as Be,j as Ue,k as Fe}from"./chunk-LSDV5TE3.js";import"./chunk-QSIQ6IWM.js";import"./chunk-SVPL2WML.js";import"./chunk-PXL5Y6WR.js";import"./chunk-NTJZNLVU.js";import{B as Se,C as j}from"./chunk-6HBETSWM.js";import"./chunk-HQPDVYNW.js";import{c as me}from"./chunk-T2ZQ5EGI.js";import"./chunk-NTU7HPDP.js";import{D as R,F as ke,b as he,c as fe,e as _e,f as xe,g as be,l as Ce,m as Me,o as Oe,r as Pe,s as ve,t as Ae,u as we,w as ye}from"./chunk-7GV7UZOL.js";import{a as ue}from"./chunk-YQKVMPSG.js";import{Cc as Q,Eb as ie,Gc as Y,K as H,Lb as u,Mb as o,N as X,Nb as i,O as ee,Ob as b,Sb as S,Tb as D,Vb as E,Xb as O,Y as W,Zb as f,a as V,ab as p,b as B,bc as oe,ca as te,cc as re,cd as ce,dc as ae,dd as z,ed as $,fd as pe,gb as ne,gd as de,ha as v,hc as F,ic as le,jc as q,lc as a,mc as P,md as J,na as C,nb as U,nc as N,oa as M,sb as A,ud as ge,v as Z,vc as se,xa as k}from"./chunk-SN4XSKG7.js";var G=(()=>{let d=class d{constructor(){this.http=v(ge),this.root=`${ue.webServiceUrl}/plantillas/sms`,this.dynamicQueryUrl=`${this.root}/dynamic-query`,this.exportUrl=`${this.root}/export`,this.precheckUrl=`${this.root}/precheck`,this.previewInitUrl=`${this.root}/preview/init`,this.previewChooseUrl=`${this.root}/preview/choose`,this.previewSkipUrl=`${this.root}/preview/skip`,this.previewDlUrl=`${this.root}/preview/download`}run(e){return this.http.post(this.dynamicQueryUrl,e)}precheck(e,t){return this.http.post(this.precheckUrl,{query:e,template:t})}export(e,t){let n=V({},e);return n.limit==null&&delete n.limit,n.selectAll=!1,n.template=t,this.http.post(this.exportUrl,n,{responseType:"blob"})}previewInit(e,t,n){let r={query:B(V({},e),{template:t}),candidatas:n};return this.http.post(this.previewInitUrl,r)}previewChoose(e,t){return this.http.post(this.previewChooseUrl,{sessionId:e,variableElegida:t})}previewSkip(e){return this.http.post(this.previewSkipUrl,{sessionId:e})}previewDownload(e){return this.http.post(this.previewDlUrl,{sessionId:e},{responseType:"blob"})}previewDownloadBase(e){return this.http.get(`${this.root}/preview/${e}/download-base`,{responseType:"blob"})}};d.\u0275fac=function(t){return new(t||d)},d.\u0275prov=te({token:d,factory:d.\u0275fac,providedIn:"root"});let l=d;return l})();var et=()=>[];function tt(l,d){if(l&1){let s=E();o(0,"button",19),O("click",function(){let t=C(s).$implicit,n=f(2);return M(n.choose(t.variable))}),o(1,"span",20),a(2),i(),o(3,"span",21),a(4),i()()}if(l&2){let s=d.$implicit,e=f(2);p(2),P(e.pretty(s.variable)),p(2),N("",s.filasQueResuelve," casos")}}function nt(l,d){if(l&1&&(S(0),o(1,"div",17),A(2,tt,5,2,"button",18),i(),D()),l&2){let s=f();p(2),u("ngForOf",s.state().candidatas)}}function it(l,d){l&1&&(o(0,"div",22),a(1,"No existen casos para resolver."),i())}function ot(l,d){if(l&1&&(o(0,"div",23)(1,"div",24)(2,"div",25),a(3),i(),o(4,"div",26),a(5),i(),o(6,"div",27)(7,"span"),a(8,"Usada: "),o(9,"b"),a(10),i()(),o(11,"span"),a(12,"Valor: "),o(13,"b"),a(14),i()()()(),o(15,"div",28),a(16),i()()),l&2){let s=d.$implicit,e=f();p(3),P(s.documento||"(sin doc.)"),p(2),P(s.nombre),p(5),P(e.pretty(s.variableUsada)||"\u2014"),p(4),P(s.valorUsado??"\u2014"),p(2),P(s.sms)}}var Ke=(()=>{let d=class d{pretty(e){let t=(e??"").toUpperCase();return t?this.prettyMap[t]?this.prettyMap[t]:t.replace(/_/g," ").toLowerCase().replace(new RegExp("\\b\\p{L}","gu"),n=>n.toUpperCase()):""}constructor(e){this.data=e,this.dialogRef=v($e),this.api=v(G),this.prettyMap={LTD:"LTD",LTDE:"LTDE",PKM:"PKM",SALDO_MORA:"Saldo Mora",BAJA30:"Baja 30",BAJA30_SALDOMORA:"Baja 30 + Mora",CAPITAL:"Capital",DEUDA_TOTAL:"Deuda Total",NOMBRECOMPLETO:"Nombre completo",NUMCUENTAPMCP:"N\xB0 de Cuenta",DIASMORA:"D\xEDas mora",LTD_LTDE:"LTD + LTDE"},this.state=k(this.data.init),this.loading=k(!1)}choose(e){this.loading.set(!0),this.api.previewChoose(this.data.sessionId,e).subscribe({next:t=>{this.state.set(t),this.loading.set(!1)},error:()=>this.loading.set(!1)})}skip(){this.loading.set(!0),this.api.previewDownloadBase(this.data.sessionId).subscribe({next:e=>{let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`sms_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(t),this.loading.set(!1),this.dialogRef.close(!0)},error:()=>this.loading.set(!1)})}download(){this.loading.set(!0),this.api.previewDownload(this.data.sessionId).subscribe({next:e=>{let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`sms_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(t),this.loading.set(!1),this.dialogRef.close(!0)},error:()=>this.loading.set(!1)})}close(){this.dialogRef.close(!1)}};d.\u0275fac=function(t){return new(t||d)(ne(Je))},d.\u0275cmp=U({type:d,selectors:[["app-round-wizard-dialog"]],decls:41,vars:9,consts:[["noCand",""],[1,"dlg"],[1,"dlg__head"],[1,"dlg__body"],[1,"group-card"],[1,"group-title"],[1,"stats"],[1,"stat"],[1,"ok"],[1,"warn"],[4,"ngIf","ngIfElse"],[1,"preview-list"],["class","pv-item",4,"ngFor","ngForOf"],[1,"dlg__foot"],["mat-button","","type","button",3,"click","disabled"],[1,"spacer"],["mat-raised-button","","type","button",2,"color","white","background","linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",3,"click","disabled"],[1,"chip-container"],["type","button","class","chip",3,"click",4,"ngFor","ngForOf"],["type","button",1,"chip",3,"click"],[1,"chip__var"],[1,"chip__count"],[1,"muted"],[1,"pv-item"],[1,"pv-left"],[1,"pv-doc"],[1,"pv-nom","muted"],[1,"pv-meta"],[1,"pv-sms","preview-box"]],template:function(t,n){if(t&1){let r=E();o(0,"div",1)(1,"header",2)(2,"h2"),a(3,"\xBFCompletar con otro importe?"),i()(),o(4,"section",3)(5,"div",4)(6,"div",5),a(7,"Progreso"),i(),o(8,"div",6)(9,"div",7)(10,"span"),a(11,"Total"),i(),o(12,"b"),a(13),i()(),o(14,"div",7)(15,"span"),a(16,"Resueltas"),i(),o(17,"b",8),a(18),i()(),o(19,"div",7)(20,"span"),a(21,"Pendientes"),i(),o(22,"b",9),a(23),i()()()(),o(24,"div",4)(25,"div",5),a(26,"Opciones"),i(),A(27,nt,3,1,"ng-container",10)(28,it,2,0,"ng-template",null,0,Q),i(),o(30,"div",4)(31,"div",5),a(32,"Previsualizaci\xF3n"),i(),o(33,"div",11),A(34,ot,17,5,"div",12),i()()(),o(35,"footer",13)(36,"button",14),O("click",function(){return C(r),M(n.skip())}),a(37,"Omitir"),i(),b(38,"span",15),o(39,"button",16),O("click",function(){return C(r),M(n.download())}),a(40," Generar "),i()()()}if(t&2){let r,c=F(29);p(13),P(n.state().total),p(5),P(n.state().resueltas),p(5),P(n.state().pendientes),p(4),u("ngIf",(r=n.state().candidatas)==null?null:r.length)("ngIfElse",c),p(7),u("ngForOf",n.state().muestraPreview||se(8,et)),p(2),u("disabled",n.loading()),p(3),u("disabled",n.loading())}},dependencies:[J,z,$,j,Se],styles:[".dlg[_ngcontent-%COMP%]{width:100%;max-width:100%;display:flex;flex-direction:column;max-height:80vh}.dlg__head[_ngcontent-%COMP%]{display:flex;align-items:center;gap:22px;padding:14px 18px;border-bottom:1px solid #e5e7eb;justify-content:center}.dlg__head[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:700}.icon-btn[_ngcontent-%COMP%]{border:none;background:transparent;font-size:18px;margin-left:auto;cursor:pointer}.dlg__body[_ngcontent-%COMP%]{flex:1 1 auto;overflow:auto}.dlg__foot[_ngcontent-%COMP%]{padding:12px 18px;border-top:1px solid #e5e7eb;background:#fff;box-shadow:0 -6px 12px -10px #0000001f;display:flex;align-items:center;gap:10px}.spacer[_ngcontent-%COMP%]{flex:1}.group-card[_ngcontent-%COMP%]{border:1px solid #e5e7eb;background:#fff;border-radius:12px;padding:12px;margin-top:20px;margin-left:15px;margin-right:15px}.group-title[_ngcontent-%COMP%]{margin:0 0 10px;font-size:14px;font-weight:600;color:#374151}.stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}.stat[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;background:#fafafa;display:flex;align-items:center;justify-content:space-between}.stat[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6b7280;font-size:.9rem}.stat[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-size:1rem}.stat[_ngcontent-%COMP%]   b.ok[_ngcontent-%COMP%]{color:#059669}.stat[_ngcontent-%COMP%]   b.warn[_ngcontent-%COMP%]{color:#b45309}.chip-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;align-items:center}.chip[_ngcontent-%COMP%]{appearance:none;border:1px solid #dfe3ee;background:#f8f9fc;color:#111827;border-radius:999px;padding:8px 14px;font-weight:600;line-height:1.1;cursor:pointer;transition:background .15s,border-color .15s,transform .04s;box-shadow:0 1px #00000005}.chip[_ngcontent-%COMP%]:hover{background:#f8fafc}.chip[_ngcontent-%COMP%]:active{transform:translateY(1px)}.chip[_ngcontent-%COMP%]:focus-visible{outline:2px solid #6366f1;outline-offset:2px}.chip__var[_ngcontent-%COMP%]{margin-right:8px}.chip__count[_ngcontent-%COMP%]{font-size:12px;color:#4b5563}.preview-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.pv-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:260px 1fr;gap:12px;border:1px solid #e5e7eb;border-radius:12px;padding:12px;background:#fff}.pv-left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.pv-doc[_ngcontent-%COMP%]{font-weight:600;font-size:13px}.pv-meta[_ngcontent-%COMP%]{display:flex;gap:12px;font-size:12px;color:#334155}.muted[_ngcontent-%COMP%]{color:#6b7280}.preview-box[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2c3e50,#34495e);color:#fff;padding:12px;border-radius:12px;min-height:85px;font-family:monospace;font-size:14px;line-height:1.5;white-space:pre-wrap}.dlg__body[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:16px}.adv[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:12px}.group-card[_ngcontent-%COMP%] + .group-card[_ngcontent-%COMP%]{margin-top:16px}.cand-list[_ngcontent-%COMP%], .preview-list[_ngcontent-%COMP%]{gap:12px}.pv-item[_ngcontent-%COMP%]{padding:12px}@media (max-width: 720px){.pv-item[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]});let l=d;return l})();var rt=["tplArea"];function at(l,d){if(l&1){let s=E();o(0,"button",55),O("click",function(){let t=C(s).$implicit,n=f(2);return M(n.toggleChip(t.key,t.affectsSelects!==!1))}),a(1),i()}if(l&2){let s=d.$implicit,e=f(2);q("active",e.isActive(s.key)),u("disabled",e.isChipDisabled(s.key)),ie("aria-pressed",e.isActive(s.key)),p(),N(" ",s.label," ")}}function lt(l,d){if(l&1&&(S(0),o(1,"div",51)(2,"h3",52),a(3),i(),o(4,"div",53),A(5,at,2,5,"button",54),i()(),D()),l&2){let s=d.$implicit;p(),u("ngClass","chip-group--"+s.key),p(2),P(s.title),p(2),u("ngForOf",s.items)}}function st(l,d){l&1&&(o(0,"div",8)(1,"label",9),a(2,"Sumar importe"),i(),b(3,"input",56),i())}function ct(l,d){if(l&1&&(o(0,"option",76),a(1),i()),l&2){let s=d.$implicit;u("value",s.key),p(),P(s.label)}}function pt(l,d){if(l&1){let s=E();o(0,"div",60)(1,"div",61)(2,"select",62),A(3,ct,2,2,"option",63),i(),o(4,"button",64),O("click",function(){C(s);let t=f().index,n=f();return M(n.removeRange(t))}),o(5,"span",15),a(6,"delete"),i(),a(7," Borrar "),i()(),o(8,"div",65),b(9,"input",66),o(10,"label",67),b(11,"input",68),o(12,"span",69),a(13),i()(),o(14,"div",70),a(15),i(),o(16,"label",67),b(17,"input",71),o(18,"span",69),a(19),i()(),b(20,"input",72),i(),o(21,"div",73)(22,"label",74)(23,"input",75),O("change",function(){let t;C(s);let n=f(),r=n.$implicit,c=n.index,g=f();return M(((t=r.get("mode"))==null?null:t.value)==="gt"?g.toggleUseMax(c,!1):g.toggleUseMin(c,!1))}),i(),o(24,"span"),a(25,"Desactivar intervalo"),i()()()()}if(l&2){let s,e,t,n=f().$implicit,r=f();p(3),u("ngForOf",r.rangeFields),p(10),P((s=n.get("inclusiveMin"))!=null&&s.value?"\u2264":"<"),p(2),N(" ",r.fieldLabel((e=n.get("field"))==null?null:e.value)||"Variable"," "),p(4),P((t=n.get("inclusiveMax"))!=null&&t.value?"\u2264":"<")}}function dt(l,d){if(l&1&&(o(0,"option",76),a(1),i()),l&2){let s=d.$implicit;u("value",s.key),p(),P(s.label)}}function gt(l,d){if(l&1&&(S(0),b(1,"input",88),o(2,"label",74),b(3,"input",68),o(4,"span"),a(5),i()(),D()),l&2){let s,e=f(2).$implicit;p(5),P((s=e.get("inclusiveMin"))!=null&&s.value?"\u2265":">")}}function mt(l,d){if(l&1&&(S(0),b(1,"input",89),o(2,"label",74),b(3,"input",71),o(4,"span"),a(5),i()(),D()),l&2){let s,e=f(2).$implicit;p(5),P((s=e.get("inclusiveMax"))!=null&&s.value?"\u2264":"<")}}function ut(l,d){if(l&1){let s=E();S(0),o(1,"input",38),O("change",function(t){C(s);let n=f(2).index,r=f();return M(r.toggleUseMax(n,t.target.checked))}),i(),o(2,"span"),a(3,"a\xF1adir l\xEDmite superior"),i(),D()}if(l&2){let s,e=f(2).$implicit;p(),u("checked",(s=e.get("useMax"))==null?null:s.value)}}function ht(l,d){if(l&1){let s=E();S(0),o(1,"input",38),O("change",function(t){C(s);let n=f(2).index,r=f();return M(r.toggleUseMin(n,t.target.checked))}),i(),o(2,"span"),a(3,"a\xF1adir l\xEDmite inferior"),i(),D()}if(l&2){let s,e=f(2).$implicit;p(),u("checked",(s=e.get("useMin"))==null?null:s.value)}}function ft(l,d){if(l&1){let s=E();o(0,"div",77)(1,"select",78),A(2,dt,2,2,"option",63),i(),o(3,"select",79),O("change",function(t){C(s);let n=f().index,r=f();return M(r.changeOperator(n,t.target.value))}),o(4,"option",80),a(5,">"),i(),o(6,"option",81),a(7,"<"),i()(),o(8,"div",82),S(9,83),A(10,gt,6,1,"ng-container",84)(11,mt,6,1,"ng-container",84),D(),i(),o(12,"button",85),O("click",function(){C(s);let t=f().index,n=f();return M(n.removeRange(t))}),o(13,"span",15),a(14,"delete"),i(),a(15," Borrar "),i()(),o(16,"div",86)(17,"label",74),A(18,ut,4,1,"ng-container",87)(19,ht,4,1,"ng-container",87),i()()}if(l&2){let s,e,t,n,r=f().$implicit,c=f();p(2),u("ngForOf",c.rangeFields),p(),u("value",(s=r.get("mode"))==null?null:s.value),p(6),u("ngSwitch",(e=r.get("mode"))==null?null:e.value),p(),u("ngSwitchCase","gt"),p(),u("ngSwitchCase","lt"),p(7),u("ngIf",((t=r.get("mode"))==null?null:t.value)==="gt"),p(),u("ngIf",((n=r.get("mode"))==null?null:n.value)==="lt")}}function _t(l,d){l&1&&(o(0,"div",90),a(1," \u26A0\uFE0F El valor m\xEDnimo no puede ser mayor que el m\xE1ximo. "),i())}function xt(l,d){if(l&1&&(o(0,"div",57),A(1,pt,26,4,"div",58)(2,ft,20,7,"ng-template",null,1,Q)(4,_t,2,0,"div",59),i()),l&2){let s,e=d.$implicit,t=F(3);u("formGroup",e),p(),u("ngIf",((s=e.get("useMin"))==null?null:s.value)&&((s=e.get("useMax"))==null?null:s.value))("ngIfElse",t),p(3),u("ngIf",e.errors==null?null:e.errors.rangeOrder)}}function bt(l,d){if(l&1&&(o(0,"th",100),a(1),i()),l&2){let s=f().$implicit;p(),P(s)}}function Ct(l,d){if(l&1&&(o(0,"td",101),a(1),i()),l&2){let s=d.$implicit,e=f().$implicit;p(),P(s[e])}}function Mt(l,d){if(l&1&&(S(0,97),A(1,bt,2,1,"th",98)(2,Ct,2,1,"td",99),D()),l&2){let s=d.$implicit;u("matColumnDef",s)}}function Ot(l,d){l&1&&b(0,"tr",102)}function Pt(l,d){l&1&&b(0,"tr",103)}function vt(l,d){if(l&1&&(o(0,"div",91)(1,"h2",14)(2,"span",15),a(3,"table_chart"),i(),a(4," Resultado "),i(),o(5,"div",92)(6,"table",93),A(7,Mt,3,1,"ng-container",94)(8,Ot,1,0,"tr",95)(9,Pt,1,0,"tr",96),i()()()),l&2){let s=f();p(6),u("dataSource",s.rows()),p(),u("ngForOf",s.cols()),p(),u("matHeaderRowDef",s.cols()),p(),u("matRowDefColumns",s.cols())}}var At=/\{([A-Z0-9_]+)\}/gi,I=/\{([A-Z0-9_]+)\}/g,gn=(()=>{let d=class d{constructor(){this.fbRef=v(R),this.api=v(G),this.comboApi=v(Qe),this.router=v(me),this.sampleRow=k(null),this.rangeFields=[{key:"DEUDA_TOTAL",label:"Deuda total"},{key:"CAPITAL",label:"Capital"},{key:"SALDO_MORA",label:"Saldo mora"},{key:"BAJA30",label:"Baja 30"},{key:"LTD",label:"LTD"},{key:"LTDE",label:"LTDE"},{key:"PKM",label:"PKM"},{key:"DIASMORA",label:"D\xEDas mora"}],this.selects=new Set,this.condiciones=new Set,this.chipGroups=[{key:"cliente",title:"Cliente",items:[{key:"NOMBRE",label:"Nombre",affectsSelects:!0},{key:"NOMBRECOMPLETO",label:"Nombre completo",affectsSelects:!0},{key:"EMAIL",label:"Correo",affectsSelects:!0},{key:"NUMCUENTAPMCP",label:"N\xB0 de Cuenta",affectsSelects:!0}]},{key:"financiero",title:"Financiero",items:[{key:"LTD",label:"LTD",affectsSelects:!0},{key:"LTDE",label:"LTDE",affectsSelects:!0},{key:"LTD_LTDE",label:"LTD y LTDE",affectsSelects:!0},{key:"BAJA30",label:"Baja 30",affectsSelects:!0},{key:"MORA",label:"Saldo Mora",affectsSelects:!0},{key:"BAJA30_SALDOMORA",label:"Baja 30 y Saldo Mora",affectsSelects:!0},{key:"PKM",label:"PKM",affectsSelects:!0},{key:"CAPITAL",label:"Capital",affectsSelects:!0},{key:"DEUDA_TOTAL",label:"Deuda Total",affectsSelects:!0}]},{key:"fechas",title:"Fechas",items:[{key:"DIASMORA",label:"D\xEDas mora",affectsSelects:!0},{key:"HOY",label:"Hoy",affectsSelects:!1},{key:"MANANA",label:"Ma\xF1ana",affectsSelects:!1}]}],this.chips=this.chipGroups.flatMap(e=>e.items),this.selectedChips=new Set,this.previewText=Y(()=>{let e=this.tplSig(),t=this.sampleRow();return this.renderTemplate(e,t)}),this.form=v(R).nonNullable.group({tramo:"3",noContenido:!1,excluirPromesasPeriodoActual:!0,excluirCompromisos:!0,excluirBlacklist:!0,limit:1e3,nombre:v(R).nonNullable.control(""),plantillaTexto:v(R).nonNullable.control(""),descripcion:v(R).nonNullable.control(""),importeExtra:v(R).nonNullable.control(0),rangos:v(R).array([])}),this.tplSig=ze(this.form.controls.plantillaTexto.valueChanges.pipe(W(this.form.controls.plantillaTexto.value??"")),{initialValue:this.form.controls.plantillaTexto.value??""}),this.rows=k([]),this.cols=k([]),this.matDialog=v(je),this.Math=Math,this.tokensInText=k(new Set),this.affectsMap=new Map(this.chipGroups.flatMap(e=>e.items.map(t=>[this.mapVar(t.key),t.affectsSelects!==!1]))),this.previewMode=k("manual"),this.loadingPreview=k(!1),this.lastHash=k(""),this.pendingPreview=Y(()=>this.previewMode()==="manual"&&this.hash(this.currentQueryForPreview())!==this.lastHash())}insertAtCursor(e){let t=this.form.controls.plantillaTexto,n=this.tplArea?.nativeElement;if(!n){let w=t.value??"",L=w&&!w.endsWith(" ")?" ":"";t.setValue(w+L+e),t.markAsDirty();return}let r=t.value??"",c=n.selectionStart??r.length,g=n.selectionEnd??c,m=r.slice(0,c),_=r.slice(g),h=(m.length&&!/\s$/.test(m)?" ":"")+e,y=m+h+_;t.setValue(y),t.markAsDirty();let T=(m+h).length;setTimeout(()=>{n.focus(),n.selectionStart=n.selectionEnd=T},0)}isSelected(e){return this.selectedChips.has(e)}aliasKeys(e){let t=e.toUpperCase();switch(t){case"MORA":case"SALDO_MORA":return["SALDO_MORA","MORA","SALDO MORA"];case"BAJA30":return["BAJA30","BAJA_30","BAJA 30"];case"BAJA30_SALDOMORA":return["BAJA30_SALDOMORA","BAJA30_SALDO_MORA","BAJA 30 SALDO MORA"];case"DEUDA_TOTAL":return["DEUDA_TOTAL","DEUDA TOTAL"];case"LTD_LTDE":return["LTD_LTDE","LTD+LTDE","LTD LTDE"];case"NOMBRECOMPLETO":return["NOMBRECOMPLETO","NOMBRE COMPLETO"];case"EMAIL":return["EMAIL"];case"NUMCUENTAPMCP":return["NUMCUENTAPMCP","NUMCUENTA_PMCP","NUM_CUENTA_PMCP","NUMCUENTA PMCP","N\xB0 CUENTA PMCP"];case"DIASMORA":return["DIASMORA","DIAS_MORA","DIAS MORA"];default:return[t,t.replace(/\s+/g,"_")]}}mapVar(e){let t=e.toUpperCase();return t==="MORA"?"SALDO_MORA":t}getVal(e,t){let n=this.aliasKeys(this.mapVar(t));for(let r of n)if(e.hasOwnProperty(r))return e[r]}hasMeaningfulValue(e,t){let n=this.getVal(e,t);return n==null?!1:typeof n=="string"?n.trim().length>0:typeof n=="number"?n>0:!0}requiredColumnsForPreview(){let e=Array.from(this.selects),n=((this.form.controls.plantillaTexto.value??"").match(I)||[]).map(g=>g.slice(1,-1)),r=Array.from(new Set([...e,...n])).map(g=>this.mapVar(g)),c=new Set(["LTD","LTDE","LTD_LTDE","BAJA30","SALDO_MORA","BAJA30_SALDOMORA","CAPITAL","DEUDA_TOTAL","PKM"]);return Array.from(new Set(e.map(g=>this.mapVar(g)))).filter(g=>c.has(g))}preferredColumnsForPreview(){let t=((this.form.controls.plantillaTexto.value??"").match(I)||[]).map(r=>this.mapVar(r.slice(1,-1))),n=new Set(this.requiredColumnsForPreview());return Array.from(new Set(t.filter(r=>!n.has(r))))}pickBestRow(e,t,n){let r=e,c=r.filter(x=>t.every(h=>this.hasMeaningfulValue(x,h)));if(c.length)return c.sort((x,h)=>{let y=n.reduce((w,L)=>w+(this.hasMeaningfulValue(x,L)?1:0),0);return n.reduce((w,L)=>w+(this.hasMeaningfulValue(h,L)?1:0),0)-y}),c[0];let g=null,m=-1,_=-1;for(let x of r){let h=t.reduce((T,w)=>T+(this.hasMeaningfulValue(x,w)?1:0),0),y=n.reduce((T,w)=>T+(this.hasMeaningfulValue(x,w)?1:0),0);(h>m||h===m&&y>_)&&(g=x,m=h,_=y)}return g??e[0]??null}toggleChip(e,t=!0){this.selectedChips.has(e)?(this.selectedChips.delete(e),t&&this.selects.delete(e),this.removePlaceholder(e)):((e==="BAJA30"||e==="MORA")&&this.selectedChips.has("BAJA30_SALDOMORA")&&(this.selectedChips.delete("BAJA30_SALDOMORA"),this.selects.delete("BAJA30_SALDOMORA"),this.removePlaceholder("BAJA30_SALDOMORA")),e==="BAJA30_SALDOMORA"&&(this.selectedChips.has("BAJA30")&&(this.selectedChips.delete("BAJA30"),this.selects.delete("BAJA30"),this.removePlaceholder("BAJA30")),this.selectedChips.has("MORA")&&(this.selectedChips.delete("MORA"),this.selects.delete("MORA"),this.removePlaceholder("MORA"))),(e==="LTD"||e==="LTDE")&&this.forceDeselect("LTD_LTDE"),e==="LTD_LTDE"&&(this.forceDeselect("LTD"),this.forceDeselect("LTDE")),this.selectedChips.add(e),t&&this.selects.add(e),this.insertPlaceholderOnce(e)),this.hasTopUpSelect()||this.form.controls.importeExtra.setValue(0),this.fetchSampleRow()}normalizeRow(e){let t={};return Object.keys(e||{}).forEach(n=>{let r=n.replace(/\s+/g,"_").toUpperCase();t[r]=e[n]}),t}fetchSampleRow(){this.previewMode()==="auto"&&this.triggerPreview()}renderTemplate(e,t){if(!e)return"";if(!t)return e;let n=this.normalizeRow(t),r=x=>String(x??"").trim().split(/\s+/)[0]||"",c=x=>{let h=Number(x);return Number.isFinite(h)?Math.trunc(h).toLocaleString("es-PE"):""},g=new Date,m=new Date(g.getTime()+1440*60*1e3),_=x=>x.toLocaleDateString("es-PE",{day:"2-digit",month:"2-digit"});return e.replace(I,(x,h)=>{switch(h){case"NOMBRE":return r(this.getVal(n,"NOMBRE"));case"HOY":return _(g);case"MANANA":return _(m);case"DIASMORA":case"LTD":case"LTDE":case"LTD_LTDE":case"BAJA30":case"SALDO_MORA":case"BAJA30_SALDOMORA":case"CAPITAL":case"DEUDA_TOTAL":case"PKM":return c(this.getVal(n,h));default:let y=this.getVal(n,h);return y===void 0?"":String(y)}})}expandWithAliases(e){let t=new Set;return e.forEach(n=>this.aliasKeys(n).forEach(r=>t.add(r))),Array.from(t)}ngOnInit(){this.form.valueChanges.pipe(W(this.form.getRawValue()),H(300),Z(t=>({tramo:t.tramo,importeExtra:t.importeExtra,plantillaTexto:t.plantillaTexto,selects:Array.from(this.selects),condiciones:Array.from(this.condiciones)})),X((t,n)=>JSON.stringify(t)===JSON.stringify(n))).subscribe(()=>{this.syncChipsWithTemplate(),this.previewMode()==="auto"&&this.triggerPreview()}),this.form.controls.plantillaTexto.valueChanges.pipe(H(200)).subscribe(()=>{this.syncChipsWithTemplate(),this.previewMode()==="auto"&&this.triggerPreview()}),this.syncChipsWithTemplate(),this.previewMode()==="auto"&&this.triggerPreview()}insertPlaceholderOnce(e){let n=this.form.controls.plantillaTexto.value??"";new RegExp(`\\{${e}\\}(?!\\w)`,"i").test(n)||this.insertAtCursor(`{${e}}`)}hasTopUpSelect(){return this.selectedChips.has("LTD")||this.selectedChips.has("LTDE")||this.selectedChips.has("LTD_LTDE")}get rangosFA(){return this.form.get("rangos")}validateMinLTMax(){return e=>{let t=e,n=t.get("min")?.value,r=t.get("max")?.value;return n!=null&&r!=null&&Number(n)>Number(r)?{rangeOrder:!0}:null}}makeRange(){return this.fbRef.nonNullable.group({field:this.fbRef.nonNullable.control("DEUDA_TOTAL",{validators:[_e.required]}),mode:this.fbRef.nonNullable.control("gt"),useMin:this.fbRef.nonNullable.control(!0),min:this.fbRef.control(null),inclusiveMin:this.fbRef.nonNullable.control(!1),useMax:this.fbRef.nonNullable.control(!1),max:this.fbRef.control(null),inclusiveMax:this.fbRef.nonNullable.control(!0)},{validators:[this.validateRange()]})}changeOperator(e,t){let n=this.rangosFA.at(e);n.get("mode")?.setValue(t),t==="gt"?(n.get("useMin")?.setValue(!0),n.get("useMax")?.setValue(!1),n.get("max")?.setValue(null)):(n.get("useMin")?.setValue(!1),n.get("useMax")?.setValue(!0),n.get("min")?.setValue(null))}toggleUseMin(e,t){let n=this.rangosFA.at(e);n.get("useMin")?.setValue(t),t||n.get("min")?.setValue(null)}toggleUseMax(e,t){let n=this.rangosFA.at(e);n.get("useMax")?.setValue(t),t||n.get("max")?.setValue(null)}validateRange(){return e=>{let t=e,n=!!t.get("useMin")?.value,r=!!t.get("useMax")?.value,c=t.get("min")?.value,g=t.get("max")?.value;return!n&&!r?{noBoundSelected:!0}:n&&(c==null||c==="")?{minRequired:!0}:r&&(g==null||g==="")?{maxRequired:!0}:n&&r&&Number(c)>Number(g)?{rangeOrder:!0}:null}}addRange(){this.rangosFA.push(this.makeRange())}removeRange(e){this.rangosFA.removeAt(e)}onSelectChange(e,t){let n=e.target;n.checked?(this.selects.add(n.value),this.insertPlaceholder(t)):(this.selects.delete(n.value),this.removePlaceholder(t))}toggleCond(e,t){e.target.checked?this.condiciones.add(t):this.condiciones.delete(t),this.fetchSampleRow()}buildBody(e){let t=this.form.getRawValue(),n=Array.from(this.selects).map(h=>h==="MORA"?"SALDO_MORA":h),r=new Set(["PROMESAS_HOY","PROMESAS_MANANA","PROMESAS_MANANA2","PROMESAS_ROTAS"]),c=Array.from(this.condiciones).filter(h=>r.has(h)),m=Array.from(this.extractTokens()).filter(h=>this.affectsMap.get(h));n=Array.from(new Set([...n,...m]));let _=this.hasTopUpSelect()&&Number(t.importeExtra)>0?Math.trunc(Number(t.importeExtra)):null,x=this.rangosFA.controls.map(h=>{let y=String(h.get("field")?.value||"").toUpperCase(),T=!!h.get("useMin")?.value,w=!!h.get("useMax")?.value,L=h.get("min")?.value,Ze=h.get("max")?.value;return{field:y,min:T?Number(L):void 0,max:w?Number(Ze):void 0,inclusiveMin:!!h.get("inclusiveMin")?.value,inclusiveMax:!!h.get("inclusiveMax")?.value}}).filter(h=>h.min!=null||h.max!=null);return{selects:n,tramo:t.tramo,condiciones:c,restricciones:{noContenido:!!t.noContenido,excluirPromesasPeriodoActual:!!t.excluirPromesasPeriodoActual,excluirCompromisos:!!t.excluirCompromisos,excluirBlacklist:!!t.excluirBlacklist},limit:e?Number(t.limit||1e3):void 0,importeExtra:_,rangos:x.length?x:void 0}}ejecutar(){let e=this.buildBody(!0);this.api.run(e).subscribe(t=>{this.rows.set(t),this.cols.set(t.length?Object.keys(t[0]):[])})}alert(e,t="Aviso"){this.matDialog.open(qe,{width:"420px",data:{title:t,message:e}})}compactQuery(e){let t=V({},e);return t.limit==null&&delete t.limit,t.importeExtra==null&&delete t.importeExtra,delete t.plantillaTexto,t}exportar(){let e=this.buildBody(!1),t=this.compactQuery(e),n=B(V({},t),{selectAll:!0}),r=(this.form.controls.plantillaTexto.value??"").trim();if(!r){this.alert("Ingresa un texto de SMS antes de exportar.","Falta texto");return}let c=this.matDialog.open(K,{disableClose:!0,data:{title:"Generando Excel\u2026",subtitle:"Preparando datos y creando archivo"},panelClass:"loading-dialog-panel",backdropClass:"blur-dialog-backdrop",width:"320px",autoFocus:!1});this.api.precheck(n,r).subscribe({next:g=>{if(!g.ok){c.close();let m=`${g.excedidos} ${g.excedidos===1?"fila":"filas"} superan ${g.limite} caracteres.`,_=(g.ejemplos??[]).map(x=>`\u2022 ${x.len} caracteres \u2014 DNI: ${x.documento||"(sin DNI)"}`).join(`
`);this.alert(`${m}

Primeros ${Math.min((g.ejemplos??[]).length,3)} casos:
${_}`,"Mensaje demasiado largo");return}this.api.export(n,r).pipe(ee(()=>c.close())).subscribe({next:m=>{let _=URL.createObjectURL(m),x=document.createElement("a");x.href=_,x.download=`sms report ${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(x),x.click(),x.remove(),URL.revokeObjectURL(_),this.showSuccess("Exportaci\xF3n exitosa","Tu archivo se gener\xF3 correctamente.").subscribe()},error:m=>{let _=m?.status===422?m?.error?.message||"No hay filas para exportar con los filtros seleccionados.":m?.error?.message||m?.message||"Ocurri\xF3 un error al exportar.";this.alert(_,m?.status===422?"Sin resultados":"Error")}})},error:g=>{c.close();let m=g?.error?.message||g?.message||"No se pudo validar el SMS.";this.alert(m,"Error en precheck")}})}insertPlaceholder(e){this.insertAtCursor(`{${e}}`)}mapRangosForPayload(){return this.rangosFA.controls.map(e=>{let t=String(e.get("field")?.value||"").toUpperCase(),n=!!e.get("useMin")?.value,r=!!e.get("useMax")?.value,c=e.get("min")?.value,g=e.get("max")?.value;return{field:t,min:n?Number(c):void 0,max:r?Number(g):void 0,inclusiveMin:!!e.get("inclusiveMin")?.value,inclusiveMax:!!e.get("inclusiveMax")?.value}}).filter(e=>e.min!=null||e.max!=null)}guardarCombo(){let e=this.form.getRawValue(),t=this.hasTopUpSelect()&&Number(e.importeExtra)>0?Math.trunc(Number(e.importeExtra)):null,n=this.mapRangosForPayload(),r={name:e.nombre,plantillaName:e.nombre,descripcion:e.descripcion,tramo:e.tramo,selects:Array.from(this.selects),condiciones:Array.from(this.condiciones),restricciones:{noContenido:!!e.noContenido,excluirPromesasPeriodoActual:!!e.excluirPromesasPeriodoActual,excluirCompromisos:!!e.excluirCompromisos,excluirBlacklist:!!e.excluirBlacklist},plantillaTexto:e.plantillaTexto,importeExtra:t,rangos:n.length?n:void 0};this.comboApi.createCombo(r).subscribe({next:c=>{this.form.reset({tramo:"3",excluirPromesasPeriodoActual:!0,excluirCompromisos:!0,excluirBlacklist:!0,limit:1e3,nombre:"",plantillaTexto:"",descripcion:""}),this.selects.clear(),this.condiciones.clear(),this.rows.set([]),this.cols.set([]),this.showSuccess("Guardado","El combo se guard\xF3 correctamente.").subscribe(()=>this.router.navigate(["/sms/combos"]))},error:c=>{let g=c?.error?.message||c?.message||"No se pudo guardar el combo.";this.alert(g,"Error")}})}Cancel(){this.router.navigate(["/sms/combos"])}removePlaceholder(e){let t=this.form.controls.plantillaTexto,n=t.value??"",r=new RegExp(`\\{${e}\\}`,"g"),c=n.replace(r,"");c=c.replace(/\s{2,}/g," ").replace(/\s+([.,;:!?])/g,"$1").trim(),c!==n&&(t.setValue(c),t.markAsDirty())}fieldLabel(e){let t=String(e||"").toUpperCase();return this.rangeFields.find(r=>r.key===t)?.label??t}showSuccess(e,t,n=1800){return this.matDialog.open(We,{data:{title:e,message:t,autoCloseMs:n},panelClass:"dialog-success",disableClose:!0}).afterClosed()}forceDeselect(e,t=!0){this.selectedChips.has(e)&&(this.selectedChips.delete(e),t&&this.selects.delete(e),this.removePlaceholder(e))}isChipDisabled(e){return this.isActive(e)?!1:e==="LTD_LTDE"?this.isActive("LTD")||this.isActive("LTDE"):e==="LTD"||e==="LTDE"?this.isActive("LTD_LTDE"):e==="BAJA30_SALDOMORA"?this.isActive("BAJA30")||this.isActive("MORA"):e==="BAJA30"||e==="MORA"?this.isActive("BAJA30_SALDOMORA"):!1}extractTokens(){let t=((this.form.controls.plantillaTexto.value??"").match(I)||[]).map(n=>this.mapVar(n.slice(1,-1)));return new Set(t)}syncChipsWithText(){let e=this.extractTokens();this.tokensInText.set(e);for(let t of Array.from(this.selectedChips)){let n=this.mapVar(t);(this.affectsMap.get(n)??!0)&&!e.has(n)&&(this.selectedChips.delete(t),this.selects.delete(t==="MORA"?"SALDO_MORA":t))}}isActive(e){return this.selectedChips.has(e)||this.tokensInText().has(this.mapVar(e))}chipMeta(e){for(let t of this.chipGroups){let n=t.items.find(r=>r.key===e);if(n)return n}}affectsSelects(e){return this.chipMeta(e)?.affectsSelects!==!1}syncChipsWithTemplate(){let e=this.form.controls.plantillaTexto.value??"",t=new Set;for(let m of e.matchAll(At))t.add(String(m[1]).toUpperCase());t.has("SALDO_MORA")&&t.add("MORA"),t.has("MORA")&&t.add("SALDO_MORA"),this.tokensInText.set(new Set(t));let n=m=>t.has(m.toUpperCase()),r=m=>{this.selectedChips.has(m)||(this.selectedChips.add(m),this.affectsSelects(m)&&this.selects.add(m==="MORA"?"SALDO_MORA":m))},c=m=>{this.selectedChips.has(m)&&(this.selectedChips.delete(m),this.affectsSelects(m)&&this.selects.delete(m==="MORA"?"SALDO_MORA":m))};n("BAJA30_SALDOMORA")?(r("BAJA30_SALDOMORA"),c("BAJA30"),c("MORA")):(c("BAJA30_SALDOMORA"),n("BAJA30")?r("BAJA30"):c("BAJA30"),n("MORA")?r("MORA"):c("MORA")),n("LTD_LTDE")?(r("LTD_LTDE"),c("LTD"),c("LTDE")):(c("LTD_LTDE"),n("LTD")?r("LTD"):c("LTD"),n("LTDE")?r("LTDE"):c("LTDE"));let g=new Set(["BAJA30","MORA","BAJA30_SALDOMORA","LTD","LTDE","LTD_LTDE"]);for(let m of this.chipGroups)for(let _ of m.items)g.has(_.key)||(n(_.key)?r(_.key):c(_.key));this.hasTopUpSelect()||this.form.controls.importeExtra.setValue(0)}generarGuiado(){let e=(this.form.controls.plantillaTexto.value??"").trim();if(!e){this.alert("Ingresa un texto de SMS antes de generar.","Falta texto");return}let t=this.buildBody(!1),n=this.compactQuery(t),c=Array.from(this.extractTokens()).filter(_=>this.affectsMap.get(_));n.selects=Array.from(new Set([...n.selects||[],...c]));let g=["BAJA30","SALDO_MORA","BAJA30_SALDOMORA","LTD","LTDE","LTD_LTDE","PKM","CAPITAL"],m=this.matDialog.open(K,{disableClose:!0,data:{title:"Preparando cohorte\u2026",subtitle:"Calculando variables candidatas"},panelClass:"loading-dialog-panel",width:"320px",autoFocus:!1});this.api.previewInit(n,e,g).subscribe({next:_=>{m.close(),this.matDialog.open(Ke,{width:"820px",data:{sessionId:_.sessionId,init:_,template:e},disableClose:!1})},error:_=>{m.close();let x=_?.error?.message||_?.message||"No se pudo iniciar el guiado.";this.alert(x,"Error")}})}triggerPreview(){let e=this.currentQueryForPreview(),t=this.hash(e);if(t===this.lastHash()&&this.sampleRow())return;this.lastHash.set(t),this.loadingPreview.set(!0);let n=this.requiredColumnsForPreview(),r=this.preferredColumnsForPreview();this.api.run(e).subscribe({next:c=>{let g=this.pickBestRow(c||[],n,r);this.sampleRow.set(g??null),this.loadingPreview.set(!1)},error:()=>{this.sampleRow.set(null),this.loadingPreview.set(!1)}})}refreshPreview(){this.triggerPreview()}setMode(e){this.previewMode.set(e),e==="auto"&&this.triggerPreview()}hash(e){let t={tramo:e.tramo,selects:[...e.selects||[]].sort(),condiciones:[...e.condiciones||[]].sort(),restricciones:e.restricciones,importeExtra:e.importeExtra??null};return JSON.stringify(t)}currentQueryForPreview(){let e=this.buildBody(!0),t=this.form.controls.plantillaTexto.value??"",n=Array.from(new Set((t.match(I)||[]).map(r=>this.mapVar(r.slice(1,-1)))));return e.selects=Array.from(new Set([...e.selects||[],...n])),e.selects=Array.from(new Set([...e.selects||[],...this.expandWithAliases(e.selects||[])])),e}};d.\u0275fac=function(t){return new(t||d)},d.\u0275cmp=U({type:d,selectors:[["app-dyn-query-page"]],viewQuery:function(t,n){if(t&1&&oe(rt,5),t&2){let r;re(r=ae())&&(n.tplArea=r.first)}},decls:136,vars:15,consts:[["tplArea",""],["singleMode",""],[1,"container"],[1,"header"],[1,"page-title"],[1,"layout"],[1,"main-card"],[1,"dynamic-form",3,"formGroup"],[1,"form-field"],[1,"form-label"],["formControlName","tramo",1,"form-select"],["value","3"],["value","5"],["value","CONTACTO_TOTAL"],[1,"section-title"],[1,"material-icons"],[1,"chip-groups"],[4,"ngFor","ngForOf"],["class","form-field",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],["class","range-item",3,"formGroup",4,"ngFor","ngForOf"],[1,"checkbox-group"],[1,"checkbox-item"],[1,"checkbox"],["type","checkbox",3,"change"],[1,"checkmark"],["type","checkbox","formControlName","noContenido"],["type","checkbox","formControlName","excluirPromesasPeriodoActual"],["type","checkbox","formControlName","excluirCompromisos"],["type","checkbox","formControlName","excluirBlacklist"],["type","text","formControlName","nombre","placeholder","Nombre del combo/plantilla",1,"form-input"],[1,"form-label","label-with-count"],["formControlName","plantillaTexto","placeholder","Escribe el mensaje y usa las variables",1,"form-textarea"],["class","results-card",4,"ngIf"],[1,"aside-card"],[1,"preview-controls"],[1,"mode-label"],["aria-label","Cambiar modo de previsualizaci\xF3n",1,"switch"],["type","checkbox",3,"change","checked"],[1,"slider"],[1,"preview-header"],[1,"preview-title"],["type","button",1,"btn","btn-small","btn-ghost",3,"click","disabled"],[1,"preview-box"],[1,"character-meter"],[1,"character-bar"],[1,"character-count"],[1,"hint"],[1,"button-group"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"chip-group",3,"ngClass"],[1,"chip-group-title"],[1,"chip-container"],["type","button","class","chip",3,"active","disabled","click",4,"ngFor","ngForOf"],["type","button",1,"chip",3,"click","disabled"],["type","number","min","0","step","1","formControlName","importeExtra","placeholder","0",1,"form-input"],[1,"range-item",3,"formGroup"],["class","interval-mode",4,"ngIf","ngIfElse"],["class","hint error-inline",4,"ngIf"],[1,"interval-mode"],[1,"interval-header"],["formControlName","field","title","Campo",1,"form-select","slim","interval-field"],[3,"value",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-danger","btn-small",3,"click"],[1,"interval-expression"],["type","number","formControlName","min","placeholder","m\xEDn",1,"form-input","slim","interval-input"],[1,"interval-check"],["type","checkbox","formControlName","inclusiveMin"],[1,"interval-symbol"],[1,"interval-variable"],["type","checkbox","formControlName","inclusiveMax"],["type","number","formControlName","max","placeholder","m\xE1x",1,"form-input","slim","interval-input"],[1,"interval-footer"],[1,"tiny-check"],["type","checkbox","checked","",3,"change"],[3,"value"],[1,"range-row"],["formControlName","field","title","Campo",1,"form-select","slim","col-field"],["title","Operador",1,"form-select","slim","col-op",3,"change","value"],["value","gt"],["value","lt"],[1,"value-box","col-value"],[3,"ngSwitch"],[4,"ngSwitchCase"],["type","button",1,"btn","btn-danger","btn-small","col-del",3,"click"],[1,"hint",2,"margin","8px 0 0 0"],[4,"ngIf"],["type","number","formControlName","min","placeholder","valor m\xEDnimo",1,"form-input","slim"],["type","number","formControlName","max","placeholder","valor m\xE1ximo",1,"form-input","slim"],[1,"hint","error-inline"],[1,"results-card"],[1,"table-container"],["mat-table","",1,"data-table",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(t,n){if(t&1){let r=E();o(0,"div",2)(1,"div",3)(2,"h1",4),a(3,"Consulta Din\xE1mica"),i()(),o(4,"div",5)(5,"div",6)(6,"form",7)(7,"div",8)(8,"label",9),a(9,"Tramo"),i(),o(10,"select",10)(11,"option",11),a(12,"Tramo 3"),i(),o(13,"option",12),a(14,"Tramo 5"),i(),o(15,"option",13),a(16,"Cartera Propia"),i()()(),o(17,"h2",14)(18,"span",15),a(19,"tune"),i(),a(20," Variables "),i(),o(21,"div",16),A(22,lt,6,3,"ng-container",17),i(),A(23,st,4,0,"div",18),o(24,"h2",14)(25,"span",15),a(26,"filter_alt"),i(),a(27," Rangos "),i(),o(28,"div",8)(29,"button",19),O("click",function(){return C(r),M(n.addRange())}),o(30,"span",15),a(31,"add"),i(),a(32," A\xF1adir rango "),i()(),A(33,xt,5,4,"div",20),o(34,"h2",14)(35,"span",15),a(36,"rule"),i(),a(37," Condiciones "),i(),o(38,"div",21)(39,"label",22)(40,"div",23)(41,"input",24),O("change",function(g){return C(r),M(n.toggleCond(g,"PROMESAS_HOY"))}),i(),b(42,"span",25),i(),a(43," PROMESAS HOY "),i(),o(44,"label",22)(45,"div",23)(46,"input",24),O("change",function(g){return C(r),M(n.toggleCond(g,"PROMESAS_MANANA"))}),i(),b(47,"span",25),i(),a(48," PROMESAS MA\xD1ANA "),i(),o(49,"label",22)(50,"div",23)(51,"input",24),O("change",function(g){return C(r),M(n.toggleCond(g,"PROMESAS_MANANA2"))}),i(),b(52,"span",25),i(),a(53," PROMESAS HOY Y MA\xD1ANA "),i(),o(54,"label",22)(55,"div",23)(56,"input",24),O("change",function(g){return C(r),M(n.toggleCond(g,"PROMESAS_ROTAS"))}),i(),b(57,"span",25),i(),a(58," PROMESAS ROTAS "),i()(),o(59,"h2",14)(60,"span",15),a(61,"block"),i(),a(62," Restricciones "),i(),o(63,"div",21)(64,"label",22)(65,"div",23),b(66,"input",26)(67,"span",25),i(),a(68," No Contenido "),i(),o(69,"label",22)(70,"div",23),b(71,"input",27)(72,"span",25),i(),a(73," Excluir Promesas periodo actual "),i(),o(74,"label",22)(75,"div",23),b(76,"input",28)(77,"span",25),i(),a(78," Excluir Compromisos "),i(),o(79,"label",22)(80,"div",23),b(81,"input",29)(82,"span",25),i(),a(83," Excluir Blacklist "),i()(),o(84,"h2",14)(85,"span",15),a(86,"description"),i(),a(87," Plantilla "),i(),o(88,"div",8)(89,"label",9),a(90,"Nombre"),i(),b(91,"input",30),i(),o(92,"div",8)(93,"label",31)(94,"span"),a(95,"Texto de SMS"),i()(),b(96,"textarea",32,0),i()(),A(98,vt,10,4,"div",33),i(),o(99,"aside",34)(100,"div",35)(101,"span",36),a(102,"Manual"),i(),o(103,"label",37)(104,"input",38),O("change",function(g){return C(r),M(n.setMode(g.target.checked?"auto":"manual"))}),i(),b(105,"span",39),i(),o(106,"span",36),a(107,"Auto"),i()(),o(108,"div",40)(109,"h3",41)(110,"span",15),a(111,"preview"),i(),a(112," Previsualizaci\xF3n "),i(),o(113,"button",42),O("click",function(){return C(r),M(n.refreshPreview())}),a(114," Actualizar "),i()(),o(115,"div",43),a(116),i(),o(117,"div",44),b(118,"div",45),i(),o(119,"div",46),a(120),i(),o(121,"p",47),a(122," \u{1F4A1} Consejo: mant\xE9n el mensaje bajo 160 caracteres o usa variables cortas. "),i(),o(123,"div",48)(124,"button",49),O("click",function(){return C(r),M(n.generarGuiado())}),o(125,"span",15),a(126,"send"),i(),a(127," Generar "),i(),o(128,"button",19),O("click",function(){return C(r),M(n.guardarCombo())}),o(129,"span",15),a(130,"save"),i(),a(131," Guardar "),i(),o(132,"button",50),O("click",function(){return C(r),M(n.Cancel())}),o(133,"span",15),a(134,"cancel"),i(),a(135," Cancelar "),i()()()()()}t&2&&(p(6),u("formGroup",n.form),p(16),u("ngForOf",n.chipGroups),p(),u("ngIf",n.selectedChips.has("LTD")||n.selectedChips.has("LTDE")||n.selectedChips.has("LTD_LTDE")),p(10),u("ngForOf",n.rangosFA.controls),p(65),u("ngIf",n.rows().length),p(6),u("checked",n.previewMode()==="auto"),p(9),u("disabled",n.previewMode()!=="manual"||n.loadingPreview()),p(3),N(" ",n.previewText()||"Tu SMS aparecer\xE1 aqu\xED\u2026"," "),p(2),le("width",n.Math.min(n.previewText().length/160*100,100),"%"),q("warning",n.previewText().length>120)("danger",n.previewText().length>160),p(2),N(" ",n.previewText().length," / 160 "))},dependencies:[J,ce,z,$,pe,de,ke,Ce,Ae,we,fe,Me,he,ve,xe,be,ye,Oe,Pe,j,Ge,He,Fe,De,Te,Ve,Re,Ee,Ie,Le,Ne,Be,Ue],styles:['.container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f5f7fa,#c3cfe2);min-height:100vh;color:#2c3e50;max-width:1800px;margin:0 auto;padding:20px}.header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;padding:24px;border-radius:12px;margin-bottom:24px;box-shadow:0 4px 20px #667eea4d;margin-top:0}.page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:600;margin:0}.layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 400px;gap:24px;align-items:start}.main-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;box-shadow:0 8px 32px #0000001a;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}.aside-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;box-shadow:0 8px 32px #0000001a;position:sticky;top:20px}.section-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#2c3e50;margin:44px 0 16px;display:flex;align-items:center;gap:8px}.section-title[_ngcontent-%COMP%]:first-child{margin-top:0}.section-title[_ngcontent-%COMP%]:before{content:"";width:4px;height:20px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:2px}.form-field[_ngcontent-%COMP%]{margin-bottom:20px}.form-label[_ngcontent-%COMP%]{display:block;font-weight:500;color:#374151;margin-top:25px;margin-bottom:8px;font-size:14px}.form-select[_ngcontent-%COMP%], .form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e5e7eb;border-radius:12px;font-size:14px;transition:all .3s ease;background:#fff}.form-select[_ngcontent-%COMP%]:focus, .form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #667eea1a}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:120px}.grid-2[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}.chip-container[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.chip[_ngcontent-%COMP%]{padding:8px 16px;background:#f3f4f6;border:2px solid #e5e7eb;border-radius:20px;font-size:13px;font-weight:500;cursor:pointer;transition:all .3s ease;color:#6b7280;margin-right:8px}.chip[_ngcontent-%COMP%]:hover{background:#e5e7eb;transform:translateY(-1px)}.chip.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);border-color:#3b82f6;color:#fff;box-shadow:0 4px 12px #667eea4d}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px}.checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-size:14px;color:#374151}.checkbox[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid #d1d5db;border-radius:4px;position:relative;cursor:pointer;transition:all .3s ease}.checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;position:absolute;width:100%;height:100%;cursor:pointer}.checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .checkmark[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);border-color:#3b82f6}.checkmark[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:4px;transition:all .3s ease}.checkmark[_ngcontent-%COMP%]:after{content:"";position:absolute;display:none;left:5px;top:2px;width:4px;height:8px;border:solid white;border-width:0 2px 2px 0;transform:rotate(45deg)}.checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .checkmark[_ngcontent-%COMP%]:after{display:block}.preview-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#2c3e50;margin-bottom:16px;display:flex;align-items:center;gap:8px;margin-top:10px}.preview-box[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2c3e50,#34495e);color:#fff;padding:16px;border-radius:12px;min-height:100px;margin-bottom:16px;font-family:monospace;font-size:14px;line-height:1.5}.character-meter[_ngcontent-%COMP%]{background:#f3f4f6;height:8px;border-radius:4px;overflow:hidden;margin-bottom:8px}.character-bar[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#10b981,#059669);transition:all .3s ease;border-radius:4px}.character-bar.warning[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f59e0b,#d97706)}.character-bar.danger[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ef4444,#dc2626)}.character-count[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;text-align:right}.hint[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-bottom:16px}.button-group[_ngcontent-%COMP%]{display:flex;gap:12px;flex-direction:column}.btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:12px;font-size:14px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:8px}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;box-shadow:0 4px 16px #3b82f64d}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #3b82f666}.btn-secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;box-shadow:0 4px 16px #8b5cf64d}.btn-secondary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #8b5cf666}.btn-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;box-shadow:0 4px 16px #ef44444d}.btn-danger[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #ef444466}.results-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;margin-top:24px;box-shadow:0 8px 32px #0000001a}.table-container[_ngcontent-%COMP%]{overflow-x:auto;border-radius:12px;border:1px solid #e5e7eb}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#e2e8f0);padding:12px 16px;text-align:left;font-weight:600;color:#374151;border-bottom:2px solid #e5e7eb}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #f3f4f6;color:#6b7280}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8fafc}.label-with-count[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.count-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;padding:2px 8px;border-radius:12px;font-size:11px;font-weight:500}@media (max-width: 1024px){.layout[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}.aside-card[_ngcontent-%COMP%]{position:static}}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:12px}.grid-2[_ngcontent-%COMP%]{grid-template-columns:1fr}.checkbox-group[_ngcontent-%COMP%]{flex-direction:column;gap:12px}}.chip-groups[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.chip-group[_ngcontent-%COMP%]{--group-accent: #374151;--group-bg: rgba(0,0,0,.03);--group-border: rgba(0,0,0,.08);--label-col: 90px;border:1px solid var(--group-border);border-radius:12px;padding:12px;display:grid;grid-template-columns:var(--label-col) 1fr;column-gap:12px;row-gap:6px;align-items:center}.chip-group-title[_ngcontent-%COMP%]{grid-column:1;font-weight:600;font-size:.95rem;color:var(--group-accent);opacity:.9;margin:0;padding:2px 0 0}.chip-container[_ngcontent-%COMP%]{grid-column:2;margin:0}.chip-group--cliente[_ngcontent-%COMP%]{--group-accent: #364278;--group-bg: rgba(102, 126, 234, .06);--group-border: rgba(102, 126, 234, .18)}.chip-group--financiero[_ngcontent-%COMP%]{--group-accent: #3a4785;--group-bg: rgba(102, 126, 234, .06);--group-border: rgba(102, 126, 234, .18)}.chip-group--fechas[_ngcontent-%COMP%]{--group-accent: #4563a1;--group-bg: rgba(102, 126, 234, .06);--group-border: rgba(102, 126, 234, .18)}.chip-group--cliente[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%], .chip-group--financiero[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%], .chip-group--fechas[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{background:#fff9;border-color:var(--group-border)}.chip-group--cliente[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .chip-group--financiero[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .chip-group--fechas[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover{background:#ffffffe6;box-shadow:0 2px 10px var(--group-border)}.chip-group--cliente[_ngcontent-%COMP%], .chip-group--financiero[_ngcontent-%COMP%], .chip-group--fechas[_ngcontent-%COMP%]{--group-accent: #3b82f6;--group-accent-2: #1d4ed8}.chip-group[_ngcontent-%COMP%]   .chip.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--group-accent, #2563eb) 0%,var(--group-accent-2, #2563eb) 100%);border-color:var(--group-accent, #3b82f6);color:#fff;box-shadow:0 4px 12px #0003}.chip[disabled][_ngcontent-%COMP%]{opacity:.45;cursor:not-allowed;pointer-events:none}.switch[_ngcontent-%COMP%]{font-size:1rem;position:relative;display:inline-block;width:4em;height:2em}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#eee;transition:.4s;border-radius:.5em;box-shadow:0 .2em #dfd9d9}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:1.5em;width:1.4em;border-radius:.3em;left:.3em;bottom:.7em;background-color:#5d6ebc;transition:.4s;box-shadow:0 .4em #b4b8bc}.slider[_ngcontent-%COMP%]:hover:before{box-shadow:0 .2em #b4b7bc;bottom:.5em}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(2em);background:#282e61}.preview-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px;flex-wrap:wrap}.btn-small[_ngcontent-%COMP%]{padding:8px 12px;font-size:12px;border-radius:10px;line-height:1}.btn-inline[_ngcontent-%COMP%]{margin-left:8px}.badge[_ngcontent-%COMP%]{background:#eef2ff;color:#374151;border:1px solid #dbeafe;padding:4px 8px;border-radius:999px;font-size:12px}.switch[_ngcontent-%COMP%]{vertical-align:middle}.preview-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:30px;margin-bottom:12px}.btn-ghost[_ngcontent-%COMP%]{background:#eef2ff;color:#374151;border:1px solid #dbeafe}.btn-ghost[_ngcontent-%COMP%]:hover{filter:brightness(.98);transform:translateY(-1px)}.preview-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:12px;margin-bottom:8px;flex-wrap:wrap}.preview-controls[_ngcontent-%COMP%]   .mode-label[_ngcontent-%COMP%]{font-size:13px;color:#374151}.btn[_ngcontent-%COMP%]:disabled, .btn[disabled][_ngcontent-%COMP%], .btn-ghost[_ngcontent-%COMP%]:disabled, .btn-ghost[disabled][_ngcontent-%COMP%], .btn.is-disabled[_ngcontent-%COMP%], .btn-ghost.is-disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed;pointer-events:none;box-shadow:none;transform:none;filter:grayscale(.2) saturate(.6)}.range-item[_ngcontent-%COMP%]{background:#fafafa;border:1px solid #e5e7eb;border-radius:12px;padding:12px;margin-bottom:12px;box-shadow:0 1px #00000005 inset}.interval-mode[_ngcontent-%COMP%]{background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;padding:16px}.interval-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;gap:12px}.interval-header[_ngcontent-%COMP%]   .interval-field[_ngcontent-%COMP%]{flex:1;max-width:300px}.interval-expression[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:16px;padding:20px 16px;background:#fff;border-radius:10px;border:2px solid #e2e8f0;flex-wrap:wrap}.interval-input[_ngcontent-%COMP%]{width:130px!important;height:42px!important;text-align:center;font-weight:600;font-size:16px;border:2px solid #cbd5e1!important}.interval-input[_ngcontent-%COMP%]:focus{border-color:#3b82f6!important}.interval-check[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:6px;cursor:pointer}.interval-check[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer}.interval-symbol[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#475569;line-height:1;-webkit-user-select:none;user-select:none}.interval-variable[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;padding:12px 24px;border-radius:24px;font-weight:700;font-size:16px;min-width:140px;text-align:center;box-shadow:0 4px 14px #667eea59;white-space:nowrap}.interval-footer[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid #e2e8f0;text-align:center}.interval-footer[_ngcontent-%COMP%]   .tiny-check[_ngcontent-%COMP%]{font-size:13px;color:#64748b}.range-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:240px 80px 1fr max-content;gap:12px;align-items:center}.col-field[_ngcontent-%COMP%]{grid-column:1}.col-op[_ngcontent-%COMP%]{grid-column:2}.col-value[_ngcontent-%COMP%]{grid-column:3}.col-del[_ngcontent-%COMP%]{grid-column:4;justify-self:end}.range-row[_ngcontent-%COMP%]   .value-box[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px}.range-row[_ngcontent-%COMP%]   .form-input.slim[_ngcontent-%COMP%]{width:180px}.form-select.slim[_ngcontent-%COMP%], .form-input.slim[_ngcontent-%COMP%]{height:36px;padding:6px 10px;border:2px solid #e5e7eb;border-radius:10px;background:#fff;font-size:14px;transition:all .2s ease}.tiny-check[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;font-size:12px;color:#6b7280;cursor:pointer}.tiny-check[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{transform:translateY(1px)}.error-inline[_ngcontent-%COMP%]{color:#ef4444;font-weight:500;margin-top:8px}@media (max-width: 900px){.interval-expression[_ngcontent-%COMP%]{gap:12px;padding:16px 12px}.interval-input[_ngcontent-%COMP%]{width:110px!important}.interval-variable[_ngcontent-%COMP%]{min-width:120px;font-size:15px;padding:10px 20px}.interval-symbol[_ngcontent-%COMP%]{font-size:24px}}@media (max-width: 700px){.interval-expression[_ngcontent-%COMP%]{flex-direction:column;gap:10px;padding:16px}.interval-input[_ngcontent-%COMP%]{width:100%!important;max-width:200px}.interval-variable[_ngcontent-%COMP%]{width:100%;max-width:200px}.range-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.range-row[_ngcontent-%COMP%]   .btn-small[_ngcontent-%COMP%]{justify-self:stretch}}.dark[_nghost-%COMP%]   .container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f172a,#1e293b);color:#f8fafc}.dark[_nghost-%COMP%]   .header[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b4a9c,#4f2f7a);box-shadow:0 4px 20px #3b499c66}.dark[_nghost-%COMP%]   .main-card[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .main-card[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .aside-card[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .aside-card[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .results-card[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .results-card[_ngcontent-%COMP%]{background:#1e293b;box-shadow:0 8px 32px #0000004d}.dark[_nghost-%COMP%]   .section-title[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .section-title[_ngcontent-%COMP%]{color:#f8fafc}.dark[_nghost-%COMP%]   .form-label[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .form-label[_ngcontent-%COMP%]{color:#cbd5e1}.dark[_nghost-%COMP%]   .form-select[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .form-select[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .form-input[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .form-input[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .form-textarea[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .form-textarea[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155;color:#f8fafc}.dark[_nghost-%COMP%]   .form-select[_ngcontent-%COMP%]:focus, .dark   [_nghost-%COMP%]   .form-select[_ngcontent-%COMP%]:focus, .dark[_nghost-%COMP%]   .form-input[_ngcontent-%COMP%]:focus, .dark   [_nghost-%COMP%]   .form-input[_ngcontent-%COMP%]:focus, .dark[_nghost-%COMP%]   .form-textarea[_ngcontent-%COMP%]:focus, .dark   [_nghost-%COMP%]   .form-textarea[_ngcontent-%COMP%]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px #667eea33}.dark[_nghost-%COMP%]   .chip[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .chip[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155;color:#94a3b8}.dark[_nghost-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .chip[_ngcontent-%COMP%]:hover{background:#1e293b}.dark[_nghost-%COMP%]   .checkbox-item[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .checkbox-item[_ngcontent-%COMP%]{color:#cbd5e1}.dark[_nghost-%COMP%]   .checkbox[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .checkbox[_ngcontent-%COMP%]{border-color:#475569}.dark[_nghost-%COMP%]   .preview-title[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .preview-title[_ngcontent-%COMP%]{color:#f8fafc}.dark[_nghost-%COMP%]   .character-meter[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .character-meter[_ngcontent-%COMP%]{background:#334155}.dark[_nghost-%COMP%]   .character-count[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .character-count[_ngcontent-%COMP%]{color:#94a3b8}.dark[_nghost-%COMP%]   .hint[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .hint[_ngcontent-%COMP%]{color:#94a3b8}.dark[_nghost-%COMP%]   .table-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .table-container[_ngcontent-%COMP%]{border-color:#334155}.dark[_nghost-%COMP%]   .data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e293b,#334155);color:#f8fafc;border-bottom-color:#475569}.dark[_nghost-%COMP%]   .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-color:#334155;color:#94a3b8}.dark[_nghost-%COMP%]   .data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#0f172a}.dark[_nghost-%COMP%]   .chip-group[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .chip-group[_ngcontent-%COMP%]{--group-bg: rgba(255, 255, 255, .03);--group-border: rgba(255, 255, 255, .08);border-color:#334155}.dark[_nghost-%COMP%]   .chip-group-title[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .chip-group-title[_ngcontent-%COMP%]{color:#cbd5e1}.dark[_nghost-%COMP%]   .chip-group--cliente[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .chip-group--cliente[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .chip-group--financiero[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .chip-group--financiero[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .chip-group--fechas[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .chip-group--fechas[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{background:#0f172acc;border-color:#334155}.dark[_nghost-%COMP%]   .chip-group--cliente[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .chip-group--cliente[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .dark[_nghost-%COMP%]   .chip-group--financiero[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .chip-group--financiero[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .dark[_nghost-%COMP%]   .chip-group--fechas[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .chip-group--fechas[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover{background:#1e293be6;box-shadow:0 2px 10px #0000004d}.dark[_nghost-%COMP%]   .slider[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .slider[_ngcontent-%COMP%]{background-color:#334155;box-shadow:0 .2em #1e293b}.dark[_nghost-%COMP%]   .slider[_ngcontent-%COMP%]:before, .dark   [_nghost-%COMP%]   .slider[_ngcontent-%COMP%]:before{background-color:#3b82f6;box-shadow:0 .4em #475569}.dark[_nghost-%COMP%]   .preview-controls[_ngcontent-%COMP%]   .mode-label[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .preview-controls[_ngcontent-%COMP%]   .mode-label[_ngcontent-%COMP%]{color:#cbd5e1}.dark[_nghost-%COMP%]   .badge[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .badge[_ngcontent-%COMP%]{background:#1e293b;color:#cbd5e1;border-color:#334155}.dark[_nghost-%COMP%]   .btn-ghost[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .btn-ghost[_ngcontent-%COMP%]{background:#1e293b;color:#cbd5e1;border-color:#334155}.dark[_nghost-%COMP%]   .btn-ghost[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .btn-ghost[_ngcontent-%COMP%]:hover{background:#334155}.dark[_nghost-%COMP%]   .range-item[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .range-item[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155}.dark[_nghost-%COMP%]   .interval-mode[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .interval-mode[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155}.dark[_nghost-%COMP%]   .interval-expression[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .interval-expression[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155}.dark[_nghost-%COMP%]   .interval-input[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .interval-input[_ngcontent-%COMP%]{background:#1e293b!important;border-color:#475569!important;color:#f8fafc}.dark[_nghost-%COMP%]   .interval-input[_ngcontent-%COMP%]:focus, .dark   [_nghost-%COMP%]   .interval-input[_ngcontent-%COMP%]:focus{border-color:#3b82f6!important}.dark[_nghost-%COMP%]   .interval-symbol[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .interval-symbol[_ngcontent-%COMP%]{color:#94a3b8}.dark[_nghost-%COMP%]   .interval-footer[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .interval-footer[_ngcontent-%COMP%]{border-top-color:#334155}.dark[_nghost-%COMP%]   .tiny-check[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .tiny-check[_ngcontent-%COMP%]{color:#94a3b8}.dark[_nghost-%COMP%]   .form-select.slim[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .form-select.slim[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .form-input.slim[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .form-input.slim[_ngcontent-%COMP%]{background:#0f172a;border-color:#334155;color:#f8fafc}']});let l=d;return l})();export{gn as DynQueryPageComponent};
