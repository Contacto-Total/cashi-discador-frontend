import{a as jt}from"./chunk-5B2TAFDX.js";import{b as V,f as Gt,h as Ft,i as zt}from"./chunk-223PPICN.js";import{a as At,b as wt,c as Dt,d as Rt,e as Lt,f as Ut,g as kt,h as Nt,i as Ht,j as Vt,k as Yt}from"./chunk-2CNE6ZBL.js";import"./chunk-SXQZ4L4A.js";import{d as Ot,g as St,i as Et}from"./chunk-GJAKKEFP.js";import{a as Xt}from"./chunk-BBGRSXKY.js";import{a as Mt,b as Tt}from"./chunk-4SL4CQAR.js";import{a as ut,b as ft,c as gt,d as vt,e as Ct}from"./chunk-PGKA3K2M.js";import{a as It}from"./chunk-B35D4W4K.js";import{A as k,C as N,K as H,R as yt,T as bt,U as xt,V as Pt,e as lt,f as ct,g as U,i as dt,t as mt,v as pt,x as ht,y as _t}from"./chunk-ZJ5FHI2N.js";import{a as rt}from"./chunk-LLRGNGWH.js";import{f as at}from"./chunk-WXG3VTZD.js";import{$c as st,Ec as it,Fb as p,Gb as a,Hb as s,Ib as E,Mb as f,Nb as g,Pb as I,Rb as v,Tb as M,Uc as nt,Wa as d,Wc as ot,X as _,Xb as K,Yb as J,Zb as tt,a as y,aa as B,ab as b,ca as w,cb as W,dc as R,ea as m,ec as et,fc as r,gc as u,hb as S,hc as L,ib as Z,ja as T,jb as Q,ka as x,l as A,mb as h,na as P,oa as $,qb as q,rb as D,za as O}from"./chunk-7WTPKN2D.js";var te=["tooltip"],Y=20;var G=new w("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let n=m(P);return()=>V(n,{scrollThrottle:Y})}});function Zt(n){let l=m(P);return()=>V(l,{scrollThrottle:Y})}var F={provide:G,deps:[],useFactory:Zt};function Qt(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var qt=new w("mat-tooltip-default-options",{providedIn:"root",factory:Qt});var Bt="tooltip-panel",$t=ct({passive:!0}),ee=8,ie=8,ne=24,oe=200,z=(()=>{class n{_elementRef=m(O);_ngZone=m(q);_platform=m(lt);_ariaDescriber=m(ht);_focusMonitor=m(dt);_dir=m(_t);_injector=m(P);_viewContainerRef=m(W);_animationsDisabled=H();_defaultOptions=m(qt,{optional:!0});_overlayRef;_tooltipInstance;_overlayPanelClass;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=Kt;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=N(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){let e=N(t);this._disabled!==e&&(this._disabled=e,e?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=U(t)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=U(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(t){let e=this._message;this._message=t!=null?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(e)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_touchstartTimeout=null;_destroyed=new A;_isDestroyed=!1;constructor(){let t=this._defaultOptions;t&&(this._showDelay=t.showDelay,this._hideDelay=t.hideDelay,t.position&&(this.position=t.position),t.positionAtOrigin&&(this.positionAtOrigin=t.positionAtOrigin),t.touchGestures&&(this.touchGestures=t.touchGestures),t.tooltipClass&&(this.tooltipClass=t.tooltipClass)),this._viewportMargin=ee}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(_(this._destroyed)).subscribe(t=>{t?t==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let t=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([e,i])=>{t.removeEventListener(e,i,$t)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0,this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,e){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let i=this._createOverlay(e);this._detach(),this._portal=this._portal||new Et(this._tooltipComponent,this._viewContainerRef);let o=this._tooltipInstance=i.attach(this._portal).instance;o._triggerElement=this._elementRef.nativeElement,o._mouseLeaveHideDelay=this._hideDelay,o.afterHidden().pipe(_(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),o.show(t)}hide(t=this.hideDelay){let e=this._tooltipInstance;e&&(e.isVisible()?e.hide(t):(e._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){let c=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&c._origin instanceof O)return this._overlayRef;this._detach()}let e=this._injector.get(Ot).getAncestorScrollContainers(this._elementRef),i=`${this._cssClassPrefix}-${Bt}`,o=Gt(this._injector,this.positionAtOrigin?t||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(e);return o.positionChanges.pipe(_(this._destroyed)).subscribe(c=>{this._updateCurrentPositionClass(c.connectionPair),this._tooltipInstance&&c.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=Ft(this._injector,{direction:this._dir,positionStrategy:o,panelClass:this._overlayPanelClass?[...this._overlayPanelClass,i]:i,scrollStrategy:this._injector.get(G)(),disableAnimations:this._animationsDisabled}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(_(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(_(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(_(this._destroyed)).subscribe(c=>{this._isTooltipVisible()&&c.keyCode===27&&!pt(c)&&(c.preventDefault(),c.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(_(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){let e=t.getConfig().positionStrategy,i=this._getOrigin(),o=this._getOverlayPosition();e.withPositions([this._addOffset(y(y({},i.main),o.main)),this._addOffset(y(y({},i.fallback),o.fallback))])}_addOffset(t){let e=ie,i=!this._dir||this._dir.value=="ltr";return t.originY==="top"?t.offsetY=-e:t.originY==="bottom"?t.offsetY=e:t.originX==="start"?t.offsetX=i?-e:e:t.originX==="end"&&(t.offsetX=i?e:-e),t}_getOrigin(){let t=!this._dir||this._dir.value=="ltr",e=this.position,i;e=="above"||e=="below"?i={originX:"center",originY:e=="above"?"top":"bottom"}:e=="before"||e=="left"&&t||e=="right"&&!t?i={originX:"start",originY:"center"}:(e=="after"||e=="right"&&t||e=="left"&&!t)&&(i={originX:"end",originY:"center"});let{x:o,y:c}=this._invertPosition(i.originX,i.originY);return{main:i,fallback:{originX:o,originY:c}}}_getOverlayPosition(){let t=!this._dir||this._dir.value=="ltr",e=this.position,i;e=="above"?i={overlayX:"center",overlayY:"bottom"}:e=="below"?i={overlayX:"center",overlayY:"top"}:e=="before"||e=="left"&&t||e=="right"&&!t?i={overlayX:"end",overlayY:"center"}:(e=="after"||e=="right"&&t||e=="left"&&!t)&&(i={overlayX:"start",overlayY:"center"});let{x:o,y:c}=this._invertPosition(i.overlayX,i.overlayY);return{main:i,fallback:{overlayX:o,overlayY:c}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),D(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,e){return this.position==="above"||this.position==="below"?e==="top"?e="bottom":e==="bottom"&&(e="top"):t==="end"?t="start":t==="start"&&(t="end"),{x:t,y:e}}_updateCurrentPositionClass(t){let{overlayY:e,originX:i,originY:o}=t,c;if(e==="center"?this._dir&&this._dir.value==="rtl"?c=i==="end"?"left":"right":c=i==="start"?"left":"right":c=e==="bottom"&&o==="top"?"above":"below",c!==this._currentPosition){let C=this._overlayRef;if(C){let X=`${this._cssClassPrefix}-${Bt}-`;C.removePanelClass(X+this._currentPosition),C.addPanelClass(X+c)}this._currentPosition=c}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{this._setupPointerExitEventsIfNeeded();let e;t.x!==void 0&&t.y!==void 0&&(e=t),this.show(void 0,e)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{let e=t.targetTouches?.[0],i=e?{x:e.clientX,y:e.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let o=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,i)},this._defaultOptions?.touchLongPressShowDelay??o)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",e=>{let i=e.relatedTarget;(!i||!this._overlayRef?.overlayElement.contains(i))&&this.hide()}],["wheel",e=>this._wheelListener(e)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let e=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};t.push(["touchend",e],["touchcancel",e])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([e,i])=>{this._elementRef.nativeElement.addEventListener(e,i,$t)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){let e=this._injector.get($).elementFromPoint(t.clientX,t.clientY),i=this._elementRef.nativeElement;e!==i&&!i.contains(e)&&this.hide()}}_disableNativeGesturesIfNecessary(){let t=this.touchGestures;if(t!=="off"){let e=this._elementRef.nativeElement,i=e.style;(t==="on"||e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA")&&(i.userSelect=i.msUserSelect=i.webkitUserSelect=i.MozUserSelect="none"),(t==="on"||!e.draggable)&&(i.webkitUserDrag="none"),i.touchAction="none",i.webkitTapHighlightColor="transparent"}}_syncAriaDescription(t){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,t,"tooltip"),this._isDestroyed||D({write:()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")}},{injector:this._injector}))}static \u0275fac=function(e){return new(e||n)};static \u0275dir=Q({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(e,i){e&2&&R("mat-mdc-tooltip-disabled",i.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return n})(),Kt=(()=>{class n{_changeDetectorRef=m(it);_elementRef=m(O);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled=H();_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new A;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){}show(t){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>ne&&t.width>=oe}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){let e=this._tooltip.nativeElement,i=this._showAnimation,o=this._hideAnimation;if(e.classList.remove(t?o:i),e.classList.add(t?i:o),this._isVisible!==t&&(this._isVisible=t,this._changeDetectorRef.markForCheck()),t&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let c=getComputedStyle(e);(c.getPropertyValue("animation-duration")==="0s"||c.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(e.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=S({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(e,i){if(e&1&&K(te,7),e&2){let o;J(o=tt())&&(i._tooltip=o.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(e,i){e&1&&v("mouseleave",function(c){return i._handleMouseLeave(c)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(e,i){if(e&1){let o=I();a(0,"div",1,0),v("animationend",function(C){return T(o),x(i._handleAnimationEnd(C))}),a(2,"div",2),r(3),s()()}e&2&&(R("mdc-tooltip--multiline",i._isMultiline),p("ngClass",i.tooltipClass),d(3),u(i.message))},dependencies:[nt],styles:[`.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mat-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mat-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mat-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mat-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mat-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mat-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mat-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mat-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}
`],encapsulation:2,changeDetection:0})}return n})();var j=(()=>{class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=Z({type:n});static \u0275inj=B({providers:[F],imports:[mt,zt,k,k,St]})}return n})();function ae(n,l){n&1&&(a(0,"div",7),E(1,"mat-spinner"),a(2,"p"),r(3,"Cargando llamadas activas..."),s()())}function re(n,l){n&1&&(a(0,"div",8)(1,"mat-icon"),r(2,"phone_disabled"),s(),a(3,"p"),r(4,"No hay llamadas activas en este momento"),s()())}function le(n,l){n&1&&(a(0,"th",21),r(1,"Agente"),s())}function ce(n,l){if(n&1&&(a(0,"td",22)(1,"div",23)(2,"mat-icon"),r(3,"person"),s(),a(4,"div")(5,"div",24),r(6),s(),a(7,"div",25),r(8),s()()()()),n&2){let t=l.$implicit;d(6),u(t.agentName),d(2),L("Ext: ",t.agentExtension)}}function de(n,l){n&1&&(a(0,"th",21),r(1,"Cliente"),s())}function me(n,l){if(n&1&&(a(0,"td",22)(1,"div",26)(2,"mat-icon"),r(3,"phone"),s(),a(4,"span"),r(5),s()()()),n&2){let t=l.$implicit;d(5),u(t.clientNumber)}}function pe(n,l){n&1&&(a(0,"th",21),r(1,"Duraci\xF3n"),s())}function he(n,l){if(n&1&&(a(0,"td",22)(1,"div",27)(2,"mat-icon"),r(3,"timer"),s(),a(4,"span"),r(5),s()()()),n&2){let t=l.$implicit,e=M(2);d(5),u(e.formatDuration(t.duration))}}function _e(n,l){n&1&&(a(0,"th",21),r(1,"Estado"),s())}function ue(n,l){if(n&1&&(a(0,"td",22)(1,"div",28)(2,"mat-icon",29),r(3),s(),a(4,"span"),r(5),s()()()),n&2){let t=l.$implicit,e=M(2);d(),et("state-"+t.callState.toLowerCase()),d(),p("color",e.getStateColor(t.callState)),d(),L(" ",e.getStateIcon(t.callState)," "),d(2),u(t.callState)}}function fe(n,l){n&1&&(a(0,"th",21),r(1,"Campa\xF1a"),s())}function ge(n,l){if(n&1&&(a(0,"td",22)(1,"span",30),r(2),s()()),n&2){let t=l.$implicit;d(2),u(t.campaignName||"-")}}function ve(n,l){n&1&&(a(0,"th",21),r(1,"Acciones"),s())}function Ce(n,l){if(n&1){let t=I();a(0,"td",22)(1,"button",31),v("click",function(){let i=T(t).$implicit,o=M(2);return x(o.superviseCall(i))}),a(2,"mat-icon"),r(3,"supervisor_account"),s(),r(4," Supervisar "),s()()}}function ye(n,l){n&1&&E(0,"tr",32)}function be(n,l){n&1&&E(0,"tr",33)}function Me(n,l){if(n&1&&(a(0,"div",9)(1,"table",10),f(2,11),h(3,le,2,0,"th",12)(4,ce,9,2,"td",13),g(),f(5,14),h(6,de,2,0,"th",12)(7,me,6,1,"td",13),g(),f(8,15),h(9,pe,2,0,"th",12)(10,he,6,1,"td",13),g(),f(11,16),h(12,_e,2,0,"th",12)(13,ue,6,5,"td",13),g(),f(14,17),h(15,fe,2,0,"th",12)(16,ge,3,1,"td",13),g(),f(17,18),h(18,ve,2,0,"th",12)(19,Ce,5,0,"td",13),g(),h(20,ye,1,0,"tr",19)(21,be,1,0,"tr",20),s()()),n&2){let t=M();d(),p("dataSource",t.activeCalls),d(19),p("matHeaderRowDef",t.displayedColumns),d(),p("matRowDefColumns",t.displayedColumns)}}function Te(n,l){n&1&&(a(0,"div",34)(1,"h4"),r(2,"Modos de Monitoreo:"),s(),a(3,"div",35)(4,"div",36)(5,"mat-icon",37),r(6,"visibility"),s(),a(7,"span")(8,"strong"),r(9,"VIG\xCDA:"),s(),r(10," Escuchas la llamada, pero nadie te escucha"),s()(),a(11,"div",36)(12,"mat-icon",38),r(13,"hearing"),s(),a(14,"span")(15,"strong"),r(16,"SUSURRO:"),s(),r(17," Solo el agente puede escucharte, el cliente no"),s()(),a(18,"div",36)(19,"mat-icon",39),r(20,"group_add"),s(),a(21,"span")(22,"strong"),r(23,"TRIPARTITA:"),s(),r(24," Todos te escuchan (agente y cliente)"),s()()()())}var yi=(()=>{let l=class l{constructor(e,i,o,c){this.adminMonitoringService=e,this.websocketService=i,this.authService=o,this.router=c,this.activeCalls=[],this.loading=!0,this.currentUser=null,this.currentMonitoringCall=null,this.currentAdminCallUuid=null,this.displayedColumns=["agent","client","duration","state","campaign","actions"],this.subscriptions=[]}ngOnInit(){this.currentUser=this.authService.getCurrentUser(),this.loadActiveCalls(),this.subscribeToWebSocket(),this.refreshInterval=setInterval(()=>{this.loadActiveCalls()},5e3)}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe()),this.refreshInterval&&clearInterval(this.refreshInterval)}loadActiveCalls(){this.adminMonitoringService.getActiveCalls().subscribe({next:e=>{this.activeCalls=e,this.loading=!1},error:e=>{console.error("Error loading active calls:",e),this.loading=!1}})}subscribeToWebSocket(){let e=this.websocketService.subscribe("/topic/admin/calls").subscribe({next:o=>{console.log("Admin call event received:",o),this.handleCallEvent(o)},error:o=>{console.error("WebSocket error:",o)}}),i=this.websocketService.subscribe("/topic/admin/monitoring").subscribe({next:o=>{console.log("Monitoring event received:",o),this.handleMonitoringEvent(o)},error:o=>{console.error("WebSocket monitoring error:",o)}});this.subscriptions.push(e,i)}handleCallEvent(e){let i=e.data||e;if(i.callState==="ENDED")this.activeCalls=this.activeCalls.filter(o=>o.callUuid!==i.callUuid);else{let o=this.activeCalls.findIndex(c=>c.callUuid===i.callUuid);o>=0?this.activeCalls[o]=i:this.activeCalls.push(i)}}handleMonitoringEvent(e){console.log("Monitoring event:",e)}startSpyMode(e){!this.currentUser||this.currentMonitoringCall||(console.log("Starting SPY mode for call:",e.callUuid),this.adminMonitoringService.startSpyMode({callUuid:e.callUuid,adminExtension:"1003",adminUsername:this.currentUser.username}).subscribe({next:i=>{console.log("SPY mode started:",i),this.currentMonitoringCall=e.callUuid,this.currentAdminCallUuid=i.adminCallUuid,alert("Modo VIG\xCDA activado. Escucha la llamada sin ser o\xEDdo.")},error:i=>{console.error("Error starting SPY mode:",i),alert("Error al activar modo VIG\xCDA")}}))}startWhisperMode(e){!this.currentUser||this.currentMonitoringCall||(console.log("Starting WHISPER mode for call:",e.callUuid),this.adminMonitoringService.startWhisperMode({callUuid:e.callUuid,adminExtension:"1003",adminUsername:this.currentUser.username}).subscribe({next:i=>{console.log("WHISPER mode started:",i),this.currentMonitoringCall=e.callUuid,this.currentAdminCallUuid=i.adminCallUuid,alert("Modo SUSURRO activado. Solo el agente puede escucharte.")},error:i=>{console.error("Error starting WHISPER mode:",i),alert("Error al activar modo SUSURRO")}}))}startBargeMode(e){!this.currentUser||this.currentMonitoringCall||(console.log("Starting BARGE mode for call:",e.callUuid),this.adminMonitoringService.startBargeMode({callUuid:e.callUuid,adminExtension:"1003",adminUsername:this.currentUser.username}).subscribe({next:i=>{console.log("BARGE mode started:",i),this.currentMonitoringCall=e.callUuid,this.currentAdminCallUuid=i.adminCallUuid,alert("Modo TRIPARTITA activado. Todos pueden escucharte.")},error:i=>{console.error("Error starting BARGE mode:",i),alert("Error al activar modo TRIPARTITA")}}))}stopMonitoring(e){!this.currentMonitoringCall||!this.currentAdminCallUuid||(console.log("Stopping monitoring for call:",e.callUuid),this.adminMonitoringService.stopMonitoring(e.callUuid,this.currentAdminCallUuid,this.currentUser.username).subscribe({next:i=>{console.log("Monitoring stopped:",i),this.currentMonitoringCall=null,this.currentAdminCallUuid=null,alert("Monitoreo detenido")},error:i=>{console.error("Error stopping monitoring:",i),alert("Error al detener monitoreo")}}))}isMonitoring(e){return this.currentMonitoringCall===e.callUuid}formatDuration(e){let i=Math.floor(e/60),o=e%60;return`${i.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}getStateIcon(e){switch(e){case"RINGING":return"phone_in_talk";case"ANSWERED":return"call";case"ACTIVE":return"call";default:return"phone"}}getStateColor(e){switch(e){case"RINGING":return"accent";case"ANSWERED":return"primary";case"ACTIVE":return"primary";default:return""}}superviseCall(e){this.router.navigate(["/admin/supervision",e.callUuid])}};l.\u0275fac=function(i){return new(i||l)(b(Xt),b(It),b(rt),b(at))},l.\u0275cmp=S({type:l,selectors:[["app-admin-monitoring"]],decls:17,vars:4,consts:[[1,"monitoring-container"],[1,"header-actions"],["mat-raised-button","","color","primary",3,"click"],["class","loading-container",4,"ngIf"],["class","no-calls",4,"ngIf"],["class","table-container",4,"ngIf"],["class","legend",4,"ngIf"],[1,"loading-container"],[1,"no-calls"],[1,"table-container"],["mat-table","",1,"calls-table",3,"dataSource"],["matColumnDef","agent"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","client"],["matColumnDef","duration"],["matColumnDef","state"],["matColumnDef","campaign"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"agent-info"],[1,"agent-name"],[1,"agent-ext"],[1,"client-info"],[1,"duration"],[1,"call-state"],[3,"color"],[1,"campaign-name"],["mat-raised-button","","color","primary","matTooltip","Abrir pantalla de supervisi\xF3n",3,"click"],["mat-header-row",""],["mat-row",""],[1,"legend"],[1,"legend-items"],[1,"legend-item"],["color","primary"],["color","accent"],["color","warn"]],template:function(i,o){i&1&&(a(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),r(5,"supervisor_account"),s(),r(6," Panel de Supervisi\xF3n - Llamadas Activas "),s(),a(7,"div",1)(8,"button",2),v("click",function(){return o.loadActiveCalls()}),a(9,"mat-icon"),r(10,"refresh"),s(),r(11," Actualizar "),s()()(),a(12,"mat-card-content"),h(13,ae,4,0,"div",3)(14,re,5,0,"div",4)(15,Me,22,3,"div",5)(16,Te,25,0,"div",6),s()()()),i&2&&(d(13),p("ngIf",o.loading),d(),p("ngIf",!o.loading&&o.activeCalls.length===0),d(),p("ngIf",!o.loading&&o.activeCalls.length>0),d(),p("ngIf",!o.loading&&o.activeCalls.length>0))},dependencies:[st,ot,Ct,ut,gt,vt,ft,Pt,xt,bt,yt,Yt,At,Dt,kt,Rt,wt,Nt,Lt,Ut,Ht,Vt,Tt,Mt,j,z,jt],styles:[".monitoring-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto}mat-card[_ngcontent-%COMP%]{margin-bottom:20px}mat-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:24px;font-weight:500}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px;color:#666}.no-calls[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#999}.no-calls[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:20px}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.calls-table[_ngcontent-%COMP%]{width:100%}.calls-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:600}.calls-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .calls-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px 16px}.agent-info[_ngcontent-%COMP%], .client-info[_ngcontent-%COMP%], .duration[_ngcontent-%COMP%], .call-state[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.agent-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .client-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .duration[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#666}.agent-name[_ngcontent-%COMP%]{font-weight:500}.agent-ext[_ngcontent-%COMP%]{font-size:12px;color:#999}.call-state[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px;font-weight:500}.call-state.state-ringing[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.call-state.state-answered[_ngcontent-%COMP%], .call-state.state-active[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.campaign-name[_ngcontent-%COMP%]{font-size:13px;color:#555}.action-buttons[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.spy-btn[_ngcontent-%COMP%]:hover{background-color:#3f51b51a}.whisper-btn[_ngcontent-%COMP%]:hover{background-color:#ff40811a}.barge-btn[_ngcontent-%COMP%]:hover{background-color:#f443361a}.stop-btn[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.7}}.monitoring-indicator[_ngcontent-%COMP%]{color:#f44336;animation:_ngcontent-%COMP%_blink 1s infinite}@keyframes _ngcontent-%COMP%_blink{0%,50%,to{opacity:1}25%,75%{opacity:.3}}.legend[_ngcontent-%COMP%]{margin-top:30px;padding:20px;background-color:#f9f9f9;border-radius:8px}.legend[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#333;font-weight:500}.legend-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.legend-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#555}.legend-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}@media (max-width: 768px){.monitoring-container[_ngcontent-%COMP%]{padding:10px}mat-card-title[_ngcontent-%COMP%]{font-size:18px}.action-buttons[_ngcontent-%COMP%], .legend-items[_ngcontent-%COMP%]{flex-direction:column}}"]});let n=l;return n})();export{yi as AdminMonitoringComponent};
