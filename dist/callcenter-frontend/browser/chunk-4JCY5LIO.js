import"./chunk-VN3CQEPZ.js";import{b as q}from"./chunk-5JIAMO6J.js";import{a as W}from"./chunk-JBERCPHR.js";import{a as A}from"./chunk-6MCPGPXT.js";import"./chunk-5E4NLGLG.js";import{e as $}from"./chunk-IGD5VCKG.js";import{C as O}from"./chunk-JRQDYGIX.js";import"./chunk-3HY3XBSW.js";import{d as U}from"./chunk-NTU7HPDP.js";import{A as R,E as B,c as Y,f as L,k as N}from"./chunk-7GV7UZOL.js";import{Zb as P,_b as j}from"./chunk-NUMEWRMA.js";import{a as T}from"./chunk-YQKVMPSG.js";import{Lb as d,Mb as r,Nb as n,Ob as p,Vb as w,Xb as h,Ya as _,Zb as f,ab as o,ca as k,ed as M,ga as C,gb as x,lc as c,mc as v,md as F,na as b,nb as I,oa as g,oc as z,qc as D,rc as S,sb as m,sc as E,ud as V}from"./chunk-SN4XSKG7.js";var H=(()=>{let i=class i{constructor(e){this.http=e,this.apiUrl=`${T.webServiceUrl}/cartas-cesion`}searchByDni(e){return this.http.get(`${this.apiUrl}/search`,{params:{dni:e}})}getViewUrl(e){return`${this.apiUrl}/view/${e}`}getDownloadUrl(e){return`${this.apiUrl}/download/${e}`}downloadPdf(e){return this.http.get(`${this.apiUrl}/download/${e}`,{responseType:"blob"})}};i.\u0275fac=function(s){return new(s||i)(C(V))},i.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();function K(t,i){if(t&1){let l=w();r(0,"button",23),h("click",function(){b(l);let s=f();return g(s.clearSearch())}),p(1,"lucide-angular",24),r(2,"span"),c(3,"Limpiar"),n()()}t&2&&(o(),d("size",18))}function Q(t,i){if(t&1&&(r(0,"div",25),p(1,"lucide-angular",26),r(2,"span"),c(3),n()()),t&2){let l=f();o(),d("size",18),o(2),v(l.errorMessage)}}function X(t,i){t&1&&(r(0,"div",27),p(1,"lucide-angular",28),r(2,"span"),c(3,"Ingrese el DNI del cliente (8 d\xEDgitos) para buscar su carta de cesi\xF3n"),n()()),t&2&&(o(),d("size",18))}function Z(t,i){t&1&&(r(0,"div",39),p(1,"div",40),r(2,"p"),c(3,"Cargando PDF..."),n()())}function ee(t,i){if(t&1&&(r(0,"div",41),p(1,"iframe",42),n()),t&2){let l=f(2);o(),d("src",l.pdfUrl,_)}}function te(t,i){if(t&1){let l=w();r(0,"div",29)(1,"div",8)(2,"div",30)(3,"div",31)(4,"div",32),p(5,"lucide-angular",33),n(),r(6,"div",34)(7,"h3"),c(8,"Carta Encontrada"),n(),r(9,"p"),c(10),n()()(),r(11,"button",35),h("click",function(){b(l);let s=f();return g(s.downloadPdf())}),p(12,"lucide-angular",36),r(13,"span"),c(14,"Descargar PDF"),n()()(),m(15,Z,4,0,"div",37)(16,ee,2,1,"div",38),n()()}if(t&2){let l=f();o(5),d("size",20),o(5),z("DNI: ",l.cartaData==null?null:l.cartaData.dni," - ",l.cartaData==null?null:l.cartaData.filename),o(2),d("size",18),o(3),d("ngIf",l.loading),o(),d("ngIf",!l.loading&&l.pdfUrl)}}function re(t,i){t&1&&(r(0,"div",43)(1,"div",8)(2,"div",44),p(3,"lucide-angular",45),r(4,"h3"),c(5,"Vista Previa del PDF"),n(),r(6,"p"),c(7,"Busque una carta de cesi\xF3n para visualizarla aqu\xED"),n()()()()),t&2&&(o(3),d("size",64))}var ge=(()=>{let i=class i{constructor(e,s){this.cartaCesionService=e,this.sanitizer=s,this.dni="",this.loading=!1,this.searching=!1,this.cartaFound=!1,this.errorMessage="",this.cartaData=null,this.pdfUrl=null}ngOnInit(){}searchCarta(){if(!this.dni||this.dni.trim().length!==8){this.errorMessage="Por favor ingrese un DNI v\xE1lido de 8 d\xEDgitos";return}if(!/^\d{8}$/.test(this.dni)){this.errorMessage="El DNI debe contener solo n\xFAmeros";return}this.searching=!0,this.loading=!0,this.errorMessage="",this.cartaFound=!1,this.pdfUrl=null,this.cartaCesionService.searchByDni(this.dni).subscribe({next:e=>{console.log("Carta encontrada:",e),this.cartaData=e,this.cartaFound=!0,this.searching=!1,this.loadPdf(e.filename)},error:e=>{console.error("Error buscando carta:",e),this.searching=!1,this.loading=!1,e.status===404?this.errorMessage=`No se encontr\xF3 carta de cesi\xF3n para el DNI: ${this.dni}`:e.status===400?this.errorMessage="DNI inv\xE1lido. Debe tener exactamente 8 d\xEDgitos":this.errorMessage="Error al buscar la carta de cesi\xF3n. Por favor intente nuevamente"}})}loadPdf(e){this.cartaCesionService.downloadPdf(e).subscribe({next:s=>{let a=window.URL.createObjectURL(s);this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(a),this.loading=!1},error:s=>{console.error("Error cargando PDF:",s),this.loading=!1,this.errorMessage="Error al cargar el PDF para visualizaci\xF3n"}})}downloadPdf(){this.cartaData&&this.cartaCesionService.downloadPdf(this.cartaData.filename).subscribe({next:e=>{let s=window.URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download=this.cartaData.filename,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(s),console.log("PDF descargado:",this.cartaData.filename)},error:e=>{console.error("Error descargando PDF:",e),this.errorMessage="Error al descargar el PDF. Por favor intente nuevamente"}})}clearSearch(){this.dni="",this.cartaFound=!1,this.cartaData=null,this.pdfUrl=null,this.errorMessage="",this.searching=!1,this.loading=!1}onEnter(){this.searchCarta()}};i.\u0275fac=function(s){return new(s||i)(x(H),x(U))},i.\u0275cmp=I({type:i,selectors:[["app-carta-cesion-viewer"]],decls:30,vars:12,consts:[[1,"carta-cesion-container"],[1,"header-section"],[1,"header-icon"],["name","file-text",1,"text-white",3,"size"],[1,"header-text"],[1,"two-column-layout"],[1,"left-column"],[1,"search-card"],[1,"card-content"],[1,"search-section"],[1,"input-group"],[1,"input-label"],[1,"input-wrapper"],["name","hash",1,"input-icon",3,"size"],["type","text","placeholder","Ej: 12345678","maxlength","8",1,"dni-input",3,"ngModelChange","keyup.enter","ngModel","disabled"],[1,"search-button",3,"click","disabled"],["name","search",3,"size"],["class","clear-button",3,"click",4,"ngIf"],["class","error-message",4,"ngIf"],["class","info-message",4,"ngIf"],[1,"right-column"],["class","pdf-viewer-card",4,"ngIf"],["class","pdf-placeholder-card",4,"ngIf"],[1,"clear-button",3,"click"],["name","x",3,"size"],[1,"error-message"],["name","alert-circle",3,"size"],[1,"info-message"],["name","info",3,"size"],[1,"pdf-viewer-card"],[1,"pdf-info-header"],[1,"pdf-info"],[1,"success-icon"],["name","file-check",3,"size"],[1,"pdf-info-text"],[1,"download-button",3,"click"],["name","download",3,"size"],["class","loading-container",4,"ngIf"],["class","pdf-container",4,"ngIf"],[1,"loading-container"],[1,"spinner"],[1,"pdf-container"],["frameborder","0",1,"pdf-iframe",3,"src"],[1,"pdf-placeholder-card"],[1,"placeholder-content"],["name","file-search",3,"size"]],template:function(s,a){s&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),p(3,"lucide-angular",3),n(),r(4,"div",4)(5,"h1"),c(6,"Cartas de Cesi\xF3n"),n(),r(7,"p"),c(8,"Buscar y visualizar cartas de cesi\xF3n por DNI"),n()()(),r(9,"div",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),c(16,"DNI del Cliente"),n(),r(17,"div",12),p(18,"lucide-angular",13),r(19,"input",14),E("ngModelChange",function(u){return S(a.dni,u)||(a.dni=u),u}),h("keyup.enter",function(){return a.onEnter()}),n()()(),r(20,"button",15),h("click",function(){return a.searchCarta()}),p(21,"lucide-angular",16),r(22,"span"),c(23),n()(),m(24,K,4,1,"button",17),n(),m(25,Q,4,2,"div",18)(26,X,4,1,"div",19),n()()(),r(27,"div",20),m(28,te,17,6,"div",21)(29,re,8,1,"div",22),n()()()),s&2&&(o(3),d("size",18),o(15),d("size",18),o(),D("ngModel",a.dni),d("disabled",a.searching),o(),d("disabled",a.searching||!a.dni||a.dni.length!==8),o(),d("size",18),o(2),v(a.searching?"Buscando...":"Buscar"),o(),d("ngIf",a.cartaFound),o(),d("ngIf",a.errorMessage),o(),d("ngIf",!a.cartaFound&&!a.searching&&!a.errorMessage),o(2),d("ngIf",a.cartaFound),o(),d("ngIf",!a.cartaFound))},dependencies:[F,M,B,Y,L,R,N,$,O,W,A,q,j,P],styles:[`.carta-cesion-container{padding:20px;max-width:1400px;margin:0 auto;background-color:#f8fafc;min-height:100vh;transition:background-color .3s ease}:root.dark .carta-cesion-container,body.dark-theme .carta-cesion-container{background-color:#0f172a}.header-section{display:flex;align-items:center;gap:12px;margin-bottom:20px;animation:fadeInDown .5s ease}@keyframes fadeInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.header-icon{width:40px;height:40px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 4px 12px #3b82f64d;transition:all .3s ease}.header-icon:hover{transform:translateY(-2px);box-shadow:0 6px 16px #3b82f666}.header-text h1{font-size:24px;font-weight:700;color:#0f172a;margin:0;line-height:1.2;transition:color .3s ease}:root.dark .header-text h1,body.dark-theme .header-text h1{color:#f8fafc}.header-text p{font-size:14px;color:#64748b;margin:0;line-height:1.2;transition:color .3s ease}:root.dark .header-text p,body.dark-theme .header-text p{color:#94a3b8}.two-column-layout{display:grid;grid-template-columns:400px 1fr;gap:20px;align-items:start}.left-column{animation:slideInLeft .5s ease}.right-column{animation:slideInRight .5s ease}@keyframes slideInLeft{0%{opacity:0;transform:translate(-30px)}to{opacity:1;transform:translate(0)}}@keyframes slideInRight{0%{opacity:0;transform:translate(30px)}to{opacity:1;transform:translate(0)}}.search-card,.pdf-viewer-card,.pdf-placeholder-card{background-color:#fff;border:1px solid #e2e8f0;border-radius:16px;box-shadow:0 2px 8px #0000000f;transition:all .3s ease}.search-card:hover,.pdf-viewer-card:hover,.pdf-placeholder-card:hover{box-shadow:0 4px 16px #0000001a;transform:translateY(-2px)}:root.dark .search-card,:root.dark .pdf-viewer-card,:root.dark .pdf-placeholder-card,body.dark-theme .search-card,body.dark-theme .pdf-viewer-card,body.dark-theme .pdf-placeholder-card{background-color:#1e293b;border:1px solid #334155;box-shadow:0 2px 8px #0000004d}.card-content{padding:24px}.search-section{display:flex;flex-direction:column;gap:16px}.input-group{display:flex;flex-direction:column;gap:8px}.input-label{font-size:13px;font-weight:600;color:#475569;text-transform:uppercase;letter-spacing:.5px;transition:color .3s ease}:root.dark .input-label,body.dark-theme .input-label{color:#cbd5e1}.input-wrapper{position:relative;display:flex;align-items:center;background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:0 16px;height:52px;transition:all .3s cubic-bezier(.4,0,.2,1)}.input-wrapper:hover{border-color:#cbd5e1;box-shadow:0 4px 12px #0000000d;transform:translateY(-1px)}.input-wrapper:focus-within{border-color:#10b981;box-shadow:0 0 0 4px #10b9811a;transform:translateY(-1px)}:root.dark .input-wrapper,body.dark-theme .input-wrapper{background:#0f172a;border-color:#334155}:root.dark .input-wrapper:hover,body.dark-theme .input-wrapper:hover{border-color:#475569;box-shadow:0 4px 12px #0000004d}:root.dark .input-wrapper:focus-within,body.dark-theme .input-wrapper:focus-within{border-color:#10b981;box-shadow:0 0 0 4px #10b98126}.input-icon{color:#94a3b8;margin-right:12px;transition:all .3s ease;flex-shrink:0}.input-wrapper:focus-within .input-icon{color:#10b981;transform:scale(1.1)}:root.dark .input-icon,body.dark-theme .input-icon{color:#64748b}.dni-input{flex:1;background:transparent;border:none;outline:none;color:#0f172a;font-size:15px;font-weight:500;padding:0;transition:color .3s ease}.dni-input::placeholder{color:#94a3b8;opacity:.6}.dni-input:disabled{cursor:not-allowed;opacity:.6}:root.dark .dni-input,body.dark-theme .dni-input{color:#f8fafc}:root.dark .dni-input::placeholder,body.dark-theme .dni-input::placeholder{color:#64748b}.search-button,.clear-button,.download-button{height:52px;width:100%;display:flex;align-items:center;justify-content:center;gap:10px;font-weight:600;font-size:15px;border-radius:12px;border:none;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.search-button:before,.download-button:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:#ffffff4d;transform:translate(-50%,-50%);transition:width .6s,height .6s}.search-button:active:before,.download-button:active:before{width:300px;height:300px}.search-button{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;box-shadow:0 4px 12px #3b82f64d}.search-button:hover:not(:disabled){background:linear-gradient(135deg,#2563eb,#1d4ed8);box-shadow:0 6px 16px #3b82f666;transform:translateY(-2px)}.search-button:active:not(:disabled){transform:translateY(0);box-shadow:0 2px 8px #3b82f64d}.search-button:disabled{opacity:.5;cursor:not-allowed;transform:none}.clear-button{background:#fff;border:2px solid #e2e8f0;color:#64748b}.clear-button:hover{background:#f8fafc;border-color:#cbd5e1;color:#475569;transform:translateY(-2px)}:root.dark .clear-button,body.dark-theme .clear-button{background:#0f172a;border-color:#334155;color:#94a3b8}:root.dark .clear-button:hover,body.dark-theme .clear-button:hover{background:#1e293b;border-color:#475569;color:#cbd5e1}.download-button{width:auto;padding:0 24px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;box-shadow:0 4px 12px #10b9814d}.download-button:hover{background:linear-gradient(135deg,#059669,#047857);box-shadow:0 6px 16px #10b98166;transform:translateY(-2px)}.download-button:active{transform:translateY(0);box-shadow:0 2px 8px #10b9814d}.error-message,.info-message{display:flex;align-items:center;gap:12px;padding:14px 16px;border-radius:12px;font-size:14px;font-weight:500;animation:slideIn .3s ease;transition:all .3s ease}@keyframes slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.error-message{background:#fef2f2;border:2px solid #fecaca;color:#991b1b}.error-message lucide-angular{color:#dc2626}:root.dark .error-message,body.dark-theme .error-message{background:#ef44441a;border-color:#ef44444d;color:#fca5a5}.info-message{background:#eff6ff;border:2px solid #bfdbfe;color:#1e40af}.info-message lucide-angular{color:#3b82f6}:root.dark .info-message,body.dark-theme .info-message{background:#3b82f61a;border-color:#3b82f64d;color:#93c5fd}.pdf-info-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid #e2e8f0;animation:fadeIn .5s ease;transition:border-color .3s ease}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}:root.dark .pdf-info-header,body.dark-theme .pdf-info-header{border-color:#334155}.pdf-info{display:flex;align-items:center;gap:14px}.success-icon{width:44px;height:44px;background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 4px 12px #10b9814d;animation:scaleIn .5s cubic-bezier(.34,1.56,.64,1)}@keyframes scaleIn{0%{opacity:0;transform:scale(0)}to{opacity:1;transform:scale(1)}}.pdf-info-text h3{font-size:18px;font-weight:700;color:#0f172a;margin:0 0 4px;line-height:1.2;transition:color .3s ease}:root.dark .pdf-info-text h3,body.dark-theme .pdf-info-text h3{color:#f8fafc}.pdf-info-text p{font-size:13px;color:#64748b;margin:0;line-height:1.2;transition:color .3s ease}:root.dark .pdf-info-text p,body.dark-theme .pdf-info-text p{color:#94a3b8}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:16px}.spinner{width:48px;height:48px;border:4px solid #e2e8f0;border-top-color:#3b82f6;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}:root.dark .spinner,body.dark-theme .spinner{border-color:#334155;border-top-color:#3b82f6}.loading-container p{color:#64748b;font-size:15px;font-weight:500;transition:color .3s ease}:root.dark .loading-container p,body.dark-theme .loading-container p{color:#94a3b8}.pdf-container{width:100%;height:calc(100vh - 280px);min-height:600px;background:#f3f4f6;border-radius:12px;overflow:hidden;border:2px solid #e2e8f0;animation:fadeIn .5s ease;transition:all .3s ease}.pdf-container:hover{border-color:#cbd5e1}:root.dark .pdf-container,body.dark-theme .pdf-container{background:#0f172a;border-color:#334155}:root.dark .pdf-container:hover,body.dark-theme .pdf-container:hover{border-color:#475569}.pdf-iframe{width:100%;height:100%;border:none}.placeholder-content{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:100px 20px;text-align:center;color:#94a3b8;animation:fadeIn .5s ease}.placeholder-content lucide-angular{color:#cbd5e1;margin-bottom:24px;opacity:.5;animation:float 3s ease-in-out infinite}@keyframes float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}:root.dark .placeholder-content lucide-angular,body.dark-theme .placeholder-content lucide-angular{color:#334155}.placeholder-content h3{font-size:20px;font-weight:600;color:#64748b;margin:0 0 8px;transition:color .3s ease}:root.dark .placeholder-content h3,body.dark-theme .placeholder-content h3{color:#94a3b8}.placeholder-content p{font-size:15px;color:#94a3b8;margin:0;transition:color .3s ease}:root.dark .placeholder-content p,body.dark-theme .placeholder-content p{color:#64748b}@media (max-width: 1024px){.two-column-layout{grid-template-columns:1fr}.pdf-container{height:500px;min-height:500px}}@media (max-width: 768px){.carta-cesion-container{padding:12px}.header-text h1{font-size:20px}.header-text p{font-size:13px}.card-content{padding:20px}.pdf-info-header{flex-direction:column;align-items:flex-start;gap:12px}.download-button{width:100%}.pdf-container{height:450px;min-height:450px}.placeholder-content{padding:60px 20px}}@media (prefers-reduced-motion: reduce){*,*:before,*:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}
`],encapsulation:2});let t=i;return t})();export{ge as CartaCesionViewerComponent};
