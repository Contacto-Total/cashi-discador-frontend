import{a as he,b as ve,c as Y}from"./chunk-4F4PQCC5.js";import{a as _e}from"./chunk-MH2R325L.js";import{a as ge}from"./chunk-A45DFSUZ.js";import{a as xe}from"./chunk-6LMWXMMV.js";import{E as fe,f as de,k as ce,s as me,t as pe,u as ue}from"./chunk-E2JO3TS2.js";import{pc as le,qc as se}from"./chunk-3IYT5ASU.js";import"./chunk-YQKVMPSG.js";import"./chunk-72Z2NTOL.js";import{Db as oe,Eb as I,Fb as N,Gb as q,Ib as L,Jb as P,Kb as g,Lb as n,Mb as o,Nb as C,Ub as K,Wb as B,Yb as S,ab as l,g as G,gb as J,ic as ne,kc as d,lc as X,ld as re,ma as O,mc as j,na as U,nb as ae,nc as Z,pc as Q,qc as ee,rc as te,wa as T}from"./chunk-BDAG5FYU.js";var W=(t,c)=>c.id;function Se(t,c){t&1&&(n(0,"div",0),C(1,"div",20),n(2,"div",21)(3,"div",22)(4,"div",23),C(5,"div",24)(6,"div",25),o(),n(7,"div",26)(8,"h3",27),d(9,"Importando datos..."),o(),n(10,"p",28),d(11,"Por favor espere, este proceso puede tardar varios minutos dependiendo de la cantidad de registros."),o()(),n(12,"div",29),C(13,"div",30),o(),n(14,"p",31),d(15,"No cierre esta ventana"),o()()()())}function Ee(t,c){if(t&1&&(n(0,"option",14),d(1),o()),t&2){let i=c.$implicit;g("value",i.id),l(),Z("",i.tenantCode," - ",i.tenantName)}}function De(t,c){if(t&1&&(n(0,"option",14),d(1),o()),t&2){let i=c.$implicit;g("value",i.id),l(),Z("",i.portfolioCode," - ",i.portfolioName)}}function we(t,c){if(t&1&&(n(0,"option",14),d(1),o()),t&2){let i=c.$implicit;g("value",i.id),l(),Z("",i.subPortfolioCode," - ",i.subPortfolioName)}}function Ie(t,c){if(t&1&&(n(0,"div",47)(1,"div",44)(2,"span",31),d(3,"Total:"),o(),n(4,"span",56),d(5),o()(),n(6,"div",44),C(7,"lucide-angular",57),n(8,"span",58),d(9),o()(),n(10,"div",44),C(11,"lucide-angular",59),n(12,"span",60),d(13),o()()()),t&2){let i=S(2);l(5),X(i.importedData().length),l(2),g("size",12),l(2),X(i.validData().length),l(2),g("size",12),l(2),X(i.invalidData().length)}}function Ne(t,c){if(t&1&&(n(0,"span",31),d(1),o()),t&2){let i=S(2);l(),j("",i.previewHeaders().length," columnas")}}function Te(t,c){t&1&&(n(0,"th",52),d(1,"Estado"),o())}function Le(t,c){if(t&1&&C(0,"lucide-angular",62),t&2){let i=S().$implicit;g("size",12)("title","Campo transformado desde: "+i.sourceField)}}function Pe(t,c){if(t&1&&(n(0,"th",53)(1,"div",61),I(2,Le,1,2,"lucide-angular",62),n(3,"div",63)(4,"span",64),d(5),o(),n(6,"span",65),d(7),o()()()()),t&2){let i=c.$implicit;g("title",i.dataType+(i.format?" ("+i.format+")":"")),l(2),N(i.sourceField&&i.regexPattern?2:-1),l(3),X(i.headerName),l(2),Z("",i.dataType,"",i.format?" ("+i.format+")":"")}}function Fe(t,c){if(t&1&&(n(0,"tr",54)(1,"td",66)(2,"div",67),C(3,"lucide-angular",68),n(4,"span",69),d(5,"No hay datos. Importa un archivo Excel para ver los datos aqu\xED."),o()()()()),t&2){let i=S(2);l(),oe("colspan",i.previewHeaders().length+1),l(2),g("size",24)}}function Me(t,c){if(t&1&&(n(0,"td",77),d(1),o()),t&2){let i=c.$implicit,e=S().$implicit;ne("text-gray-500",!e[i.headerName]),l(),j(" ",e[i.headerName]||"NULL"," ")}}function ke(t,c){if(t&1&&(n(0,"tr",70)(1,"td",72),d(2),o(),n(3,"td",73)(4,"span",74),C(5,"lucide-angular",75),d(6," V\xE1lido "),o()(),L(7,Me,2,3,"td",76,W),o()),t&2){let i=c.$index,e=S(3);l(2),X(i+1),l(3),g("size",10),l(2),P(e.previewHeaders())}}function $e(t,c){if(t&1&&(n(0,"td",77),d(1),o()),t&2){let i=c.$implicit,e=S().$implicit;ne("text-gray-500",!e.data[i.headerName]),l(),j(" ",e.data[i.headerName]||"NULL"," ")}}function ze(t,c){if(t&1&&(n(0,"tr",71)(1,"td",72),d(2),o(),n(3,"td",73)(4,"span",78),C(5,"lucide-angular",79),d(6," Error "),o()(),L(7,$e,2,3,"td",76,W),o()),t&2){let i=c.$implicit,e=c.$index,a=S(3);l(2),X(a.validData().length+e+1),l(2),g("title",i.error),l(),g("size",10),l(2),P(a.previewHeaders())}}function He(t,c){if(t&1&&(L(0,ke,9,2,"tr",70,q),L(2,ze,9,3,"tr",71,q)),t&2){let i=S(2);P(i.validData()),l(2),P(i.invalidData())}}function Ae(t,c){if(t&1&&(n(0,"div",94),d(1),o()),t&2){let i=c.$implicit;l(),j(" ",i," ")}}function Ve(t,c){if(t&1&&(n(0,"div",80)(1,"div",88),C(2,"lucide-angular",89),n(3,"div",90)(4,"h3",91),d(5,"Errores al Importar Datos"),o(),n(6,"p",92),d(7," La importaci\xF3n fall\xF3 debido a los siguientes errores. No se insert\xF3 ning\xFAn dato. "),o(),n(8,"div",93),L(9,Ae,2,1,"div",94,q),o()()()()),t&2){let i=S(3);l(2),g("size",24),l(7),P(i.backendErrors())}}function Be(t,c){if(t&1&&(n(0,"p",83)(1,"span",84),d(2),o(),d(3),o()),t&2){let i=c.$implicit,e=c.$index,a=S(4);l(2),j("Fila ",a.validData().length+e+1,":"),l(),j(" ",i.error," ")}}function je(t,c){if(t&1&&(n(0,"div",81)(1,"div",88),C(2,"lucide-angular",95),n(3,"div",90)(4,"h3",96),d(5,"Registros con Errores"),o(),n(6,"div",97),L(7,Be,4,2,"p",83,q),o()()()()),t&2){let i=S(3);l(2),g("size",20),l(5),P(i.invalidData())}}function Re(t,c){t&1&&(n(0,"span",84),d(1,"La importaci\xF3n fall\xF3. Corrija los errores e intente nuevamente."),o())}function Xe(t,c){if(t&1&&(n(0,"span",98),d(1),o(),d(2," listo(s) para importar ")),t&2){let i=S(3);l(),j("",i.validData().length," registro(s)")}}function We(t,c){t&1&&(n(0,"span",84),d(1,"No hay registros v\xE1lidos para importar"),o())}function Oe(t,c){if(t&1){let i=K();n(0,"button",99),B("click",function(){O(i);let a=S(3);return U(a.confirmImport())}),d(1," Confirmar Importaci\xF3n "),o()}}function Ue(t,c){if(t&1){let i=K();n(0,"div",55),I(1,Ve,11,1,"div",80),I(2,je,9,1,"div",81),n(3,"div",82)(4,"div",83),I(5,Re,2,0,"span",84)(6,Xe,3,1)(7,We,2,0,"span",84),o(),n(8,"div",85)(9,"button",86),B("click",function(){O(i);let a=S(2);return U(a.clearImportedData())}),d(10," Cancelar "),o(),I(11,Oe,2,0,"button",87),o()()()}if(t&2){let i=S(2);l(),N(i.backendErrors().length>0?1:-1),l(),N(i.invalidData().length>0?2:-1),l(3),N(i.backendErrors().length>0?5:i.validData().length>0?6:7),l(6),N(i.validData().length>0&&i.backendErrors().length===0?11:-1)}}function qe(t,c){if(t&1){let i=K();n(0,"div",18)(1,"div",32)(2,"div")(3,"h2",33),d(4,"Importaci\xF3n de Datos"),o(),n(5,"p",34),d(6," Sube un archivo Excel con los datos para esta subcartera "),o()(),n(7,"div",35)(8,"button",36),B("click",function(){O(i);let a=S();return U(a.downloadDataTemplate())}),C(9,"lucide-angular",37),n(10,"span"),d(11,"Descargar Plantilla"),o()(),n(12,"label",38),C(13,"lucide-angular",39),n(14,"span"),d(15,"Importar Datos"),o(),n(16,"input",40),B("change",function(a){O(i);let s=S();return U(s.onDataFileSelected(a))}),o()()()(),n(17,"div",41)(18,"div",42)(19,"div",43)(20,"div",44),C(21,"lucide-angular",45),n(22,"span",46),d(23," Tabla de Datos "),o()(),I(24,Ie,14,5,"div",47)(25,Ne,2,1,"span",31),o()(),n(26,"div",48)(27,"table",49)(28,"thead",50)(29,"tr")(30,"th",51),d(31,"#"),o(),I(32,Te,2,0,"th",52),L(33,Pe,8,5,"th",53,W),o()(),n(35,"tbody"),I(36,Fe,6,2,"tr",54)(37,He,4,0),o()()()(),I(38,Ue,12,4,"div",55),o()}if(t&2){let i=S();l(9),g("size",16),l(4),g("size",16),l(8),g("size",16),l(3),N(i.importedData().length>0?24:25),l(8),N(i.importedData().length>0?32:-1),l(),P(i.previewHeaders()),l(3),N(i.importedData().length===0?36:37),l(2),N(i.importedData().length>0?38:-1)}}function Ze(t,c){t&1&&(n(0,"div",19)(1,"div",88),C(2,"lucide-angular",100),n(3,"div")(4,"h3",101),d(5,"No hay cabeceras configuradas"),o(),n(6,"p",28),d(7," Primero debes configurar las cabeceras para esta subcartera en el m\xF3dulo de Mantenimiento. "),o()()()()),t&2&&(l(2),g("size",20))}var lt=(()=>{let c=class c{constructor(e,a,s){this.tenantService=e,this.portfolioService=a,this.headerConfigService=s,this.tenants=T([]),this.portfolios=T([]),this.subPortfolios=T([]),this.selectedTenantId=0,this.selectedPortfolioId=0,this.selectedSubPortfolioId=0,this.previewHeaders=T([]),this.headersAreSaved=T(!1),this.importedData=T([]),this.validData=T([]),this.invalidData=T([]),this.backendErrors=T([]),this.isLoading=T(!1)}ngOnInit(){this.loadTenants()}loadTenants(){this.tenantService.getAllTenants().subscribe({next:e=>{this.tenants.set(e)},error:e=>{console.error("Error cargando proveedores:",e),alert("Error al cargar los proveedores")}})}onTenantChange(e){this.selectedTenantId=e,this.selectedPortfolioId=0,this.selectedSubPortfolioId=0,this.portfolios.set([]),this.subPortfolios.set([]),this.previewHeaders.set([]),this.headersAreSaved.set(!1),e>0&&this.loadPortfoliosByTenant(e)}loadPortfoliosByTenant(e){this.portfolioService.getPortfoliosByTenant(e).subscribe({next:a=>{this.portfolios.set(a)},error:a=>{console.error("Error cargando carteras:",a),alert("Error al cargar las carteras")}})}onPortfolioChange(e){this.selectedPortfolioId=e,this.selectedSubPortfolioId=0,this.subPortfolios.set([]),this.previewHeaders.set([]),this.headersAreSaved.set(!1),e>0&&this.loadSubPortfoliosByPortfolio(e)}loadSubPortfoliosByPortfolio(e){this.portfolioService.getSubPortfoliosByPortfolio(e).subscribe({next:a=>{this.subPortfolios.set(a)},error:a=>{console.error("Error cargando subcarteras:",a),alert("Error al cargar las subcarteras")}})}onSubPortfolioChange(e){e>0?this.loadHeadersForSubPortfolio(e):(this.previewHeaders.set([]),this.headersAreSaved.set(!1))}loadHeadersForSubPortfolio(e){this.headerConfigService.getBySubPortfolioAndLoadType(e,"ACTUALIZACION").subscribe({next:a=>{this.previewHeaders.set(a),this.headersAreSaved.set(a.length>0)},error:a=>{console.error("Error cargando cabeceras:",a),this.previewHeaders.set([]),this.headersAreSaved.set(!1)}})}downloadDataTemplate(){return G(this,null,function*(){if(this.previewHeaders().length===0){alert("No hay cabeceras configuradas para generar la plantilla de datos");return}let e=this.previewHeaders().map(m=>m.headerName),a=Y.book_new(),s=Y.aoa_to_sheet([e]);s["!cols"]=e.map(m=>({wch:Math.max(m.length+2,15)})),Y.book_append_sheet(a,s,"Datos");let r=`plantilla-datos-${this.subPortfolios().find(m=>m.id===this.selectedSubPortfolioId)?.subPortfolioCode||"subcartera"}.xlsx`;ve(a,r),alert("Plantilla de datos descargada exitosamente.")})}onDataFileSelected(e){return G(this,null,function*(){let a=e.target.files[0];if(!a)return;if(a.name.toLowerCase().endsWith(".csv")){this.parseCSVFile(a),e.target.value="";return}let r=new FileReader;r.onload=m=>G(this,null,function*(){try{let b=new Uint8Array(m.target.result),D=he(b,{type:"array"}),x=D.Sheets[D.SheetNames[0]],F=Y.sheet_to_json(x,{header:1});if(F.length===0){alert("El archivo Excel est\xE1 vac\xEDo");return}let z=F[0].map(u=>String(u).toLowerCase()),M=this.previewHeaders(),H={},k=[];if(M.forEach((u,V)=>{let h=z.findIndex(p=>p===u.headerName.toLowerCase());h!==-1?H[h]=V:u.sourceField&&u.regexPattern||k.push(u)}),k.length>0){let u=k.map(h=>h.headerName).join(", ");if(!confirm(`\u26A0\uFE0F ADVERTENCIA: Faltan las siguientes columnas en el archivo Excel:

${u}

Estas columnas se guardar\xE1n como NULL.

\xBFDesea continuar con la importaci\xF3n?`))return}let y=F.slice(1);if(y.length===0){alert("El archivo Excel no contiene datos (solo cabeceras)");return}let A=[],w=[];y.forEach((u,V)=>{let h={},p="";M.forEach((f,v)=>{let $=Object.keys(H).find(E=>H[parseInt(E)]===v);if($!==void 0){let E=u[parseInt($)];if(E!=null&&String(E).trim()!=="")try{if(f.dataType==="FECHA"&&typeof E=="number"){let be=new Date(1899,11,30).getTime()+E*24*60*60*1e3,ye=new Date(be),Ce=f.format||"dd/MM/yyyy";h[f.headerName]=this.formatDateByPattern(ye,Ce)}else if(f.dataType==="FECHA"&&E instanceof Date){let ie=f.format||"dd/MM/yyyy";h[f.headerName]=this.formatDateByPattern(E,ie)}else h[f.headerName]=String(E).trim()}catch{p=`Error procesando columna ${f.headerName}`,h[f.headerName]=String(E)}else h[f.headerName]=null}else h[f.headerName]=null}),M.forEach(f=>{if(f.sourceField&&f.regexPattern)try{let v=h[f.sourceField];if(v){let $=new RegExp(f.regexPattern),E=String(v).match($);E?h[f.headerName]=E[1]||E[0]:h[f.headerName]=null}else h[f.headerName]=null}catch(v){console.error(`Error aplicando regex en ${f.headerName}:`,v),h[f.headerName]=null}}),Object.values(h).some(f=>f!==null&&f!=="")?p?w.push({error:p,data:h}):A.push(h):w.push({error:"Fila vac\xEDa - no contiene datos",data:h})}),this.importedData.set([...A,...w.map(u=>u.data)]),this.validData.set(A),this.invalidData.set(w),console.log("Previsualizaci\xF3n de datos:",{total:y.length,v\u00E1lidos:A.length,inv\u00E1lidos:w.length})}catch(b){console.error("Error procesando el archivo:",b),alert("Error al procesar el archivo Excel")}}),r.readAsArrayBuffer(a),e.target.value=""})}parseCSVFile(e){let a=new FileReader;a.onload=s=>{try{let r=s.target.result.split(`
`).map(y=>y.trim()).filter(y=>y.length>0);if(r.length===0){alert("El archivo CSV est\xE1 vac\xEDo");return}let m=r[0],b=";";m.includes(";")?b=";":m.includes(",")?b=",":m.includes("|")?b="|":m.includes("	")&&(b="	");let D=r[0].split(b).map(y=>y.trim().toLowerCase()),x=this.previewHeaders(),F={},z=[];if(x.forEach((y,A)=>{let w=D.findIndex(u=>u===y.headerName.toLowerCase());w!==-1?F[w]=A:y.sourceField&&y.regexPattern||z.push(y)}),z.length>0){let y=z.map(w=>w.headerName).join(", ");if(!confirm(`\u26A0\uFE0F ADVERTENCIA: Faltan las siguientes columnas en el archivo CSV:

${y}

Estas columnas se guardar\xE1n como NULL.

\xBFDesea continuar con la importaci\xF3n?`))return}let M=r.slice(1);if(M.length===0){alert("El archivo CSV no contiene datos (solo cabeceras)");return}let H=[],k=[];M.forEach((y,A)=>{let w=y.split(b).map(p=>p.trim()),u={},V="";x.forEach((p,R)=>{let f=Object.keys(F).find(v=>F[parseInt(v)]===R);if(f!==void 0){let v=w[parseInt(f)];if(v!=null&&v!=="")try{if(p.dataType==="FECHA"){let $=this.parseCSVDate(v,p.format||"dd/MM/yyyy");$?u[p.headerName]=$:(V=`Valor no es fecha v\xE1lida para campo ${p.headerName}: ${v} (formato esperado: ${p.format||"dd/MM/yyyy"})`,u[p.headerName]=v)}else u[p.headerName]=v}catch($){V=`Error procesando columna ${p.headerName}: ${$}`,u[p.headerName]=v}else u[p.headerName]=null}else u[p.headerName]=null}),x.forEach(p=>{if(p.sourceField&&p.regexPattern)try{let R=u[p.sourceField];if(R){let f=new RegExp(p.regexPattern),v=String(R).match(f);v?u[p.headerName]=v[1]||v[0]:u[p.headerName]=null}else u[p.headerName]=null}catch(R){console.error(`Error aplicando regex en ${p.headerName}:`,R),u[p.headerName]=null}}),Object.values(u).some(p=>p!==null&&p!=="")?V?k.push({error:V,data:u}):H.push(u):k.push({error:"Fila vac\xEDa - no contiene datos",data:u})}),this.importedData.set([...H,...k.map(y=>y.data)]),this.validData.set(H),this.invalidData.set(k),console.log("Previsualizaci\xF3n de datos CSV:",{total:M.length,v\u00E1lidos:H.length,inv\u00E1lidos:k.length})}catch(_){console.error("Error procesando el archivo CSV:",_),alert("Error al procesar el archivo CSV")}},a.readAsText(e)}parseCSVDate(e,a){try{let s=a.replace(/dd/g,"\\d{2}").replace(/MM/g,"\\d{2}").replace(/yyyy/g,"\\d{4}").replace(/yy/g,"\\d{2}").replace(/HH/g,"\\d{2}").replace(/mm/g,"\\d{2}").replace(/ss/g,"\\d{2}");if(new RegExp("^"+s+"$").test(e.trim()))return e.trim();let r=e.split(/[-\/\s:]/);if(r.length<3)return null;let m,b,D,x=0,F=0,z=0;if(a.startsWith("dd")?(m=parseInt(r[0]),b=parseInt(r[1]),D=parseInt(r[2])):a.startsWith("MM")?(b=parseInt(r[0]),m=parseInt(r[1]),D=parseInt(r[2])):(D=parseInt(r[0]),b=parseInt(r[1]),m=parseInt(r[2])),r.length>3&&(x=parseInt(r[3])||0,F=parseInt(r[4])||0,z=parseInt(r[5])||0),isNaN(m)||isNaN(b)||isNaN(D)||m<1||m>31||b<1||b>12||D<1900)return null;let M=new Date(D,b-1,m,x,F,z);return isNaN(M.getTime())?null:this.formatDateByPattern(M,a)}catch(s){return console.error("Error parseando fecha:",s),null}}formatDateByPattern(e,a){let s=e.getFullYear(),_=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),m=String(e.getHours()).padStart(2,"0"),b=String(e.getMinutes()).padStart(2,"0"),D=String(e.getSeconds()).padStart(2,"0"),x=a;return x=x.replace(/yyyy/g,String(s)),x=x.replace(/yy/g,String(s).slice(-2)),x=x.replace(/MM/g,_),x=x.replace(/dd/g,r),x=x.replace(/HH/g,m),x=x.replace(/mm/g,b),x=x.replace(/ss/g,D),x}simplifyBackendError(e){let a=e.match(/Fila (\d+):/),s=a?a[1]:"?";if(e.includes("doesn't have a default value")){let r=e.match(/Field '([^']+)'/),m=r?r[1]:"desconocido";return`Fila ${s}: El campo '${m}' est\xE1 vac\xEDo pero es obligatorio. Por favor, proporcione un valor.`}if(e.includes("cannot be null")||e.includes("Column")&&e.includes("cannot be null")){let r=e.match(/Column '([^']+)'/)||e.match(/Field '([^']+)'/),m=r?r[1]:"desconocido";return`Fila ${s}: El campo '${m}' no puede estar vac\xEDo. Es un campo obligatorio.`}if(e.includes("Data too long")||e.includes("too long for column")){let r=e.match(/column '([^']+)'/)||e.match(/Field '([^']+)'/),m=r?r[1]:"desconocido";return`Fila ${s}: El valor del campo '${m}' es demasiado largo. Reduzca el tama\xF1o del texto.`}if(e.includes("Incorrect date")||e.includes("Incorrect datetime")){let r=e.match(/column '([^']+)'/)||e.match(/Field '([^']+)'/),m=r?r[1]:"desconocido";return`Fila ${s}: El campo '${m}' tiene un formato de fecha incorrecto. Verifique el formato.`}if(e.includes("Duplicate entry")){let r=e.match(/Duplicate entry '([^']+)'/),m=r?r[1]:"desconocido";return`Fila ${s}: El valor '${m}' ya existe en la base de datos. No se permiten duplicados.`}if(e.includes("Incorrect integer")||e.includes("Incorrect decimal")){let r=e.match(/column '([^']+)'/)||e.match(/Field '([^']+)'/),m=r?r[1]:"desconocido";return`Fila ${s}: El campo '${m}' debe contener un n\xFAmero v\xE1lido.`}if(e.includes("foreign key constraint fails")||e.includes("Cannot add or update a child row"))return`Fila ${s}: Hay una referencia a un dato que no existe en el sistema. Verifique los datos relacionados.`;let _=e.match(/Fila \d+: Error al insertar datos: (.+?)(?:\s*;|$)/);return _?`Fila ${s}: ${_[1]}`:e.length>200?e.substring(0,200)+"...":e}clearImportedData(){this.importedData.set([]),this.validData.set([]),this.invalidData.set([]),this.backendErrors.set([])}confirmImport(){let e=this.validData();if(e.length===0){alert("No hay datos v\xE1lidos para importar");return}console.log("Datos transformados listos para importar:",e),console.log("Subcartera ID:",this.selectedSubPortfolioId),this.isLoading.set(!0),this.backendErrors.set([]),this.headerConfigService.importData(this.selectedSubPortfolioId,"ACTUALIZACION",e).subscribe({next:a=>{if(this.isLoading.set(!1),console.log("Respuesta del servidor:",a),a.errors&&a.errors.length>0){let s=a.errors.map(_=>this.simplifyBackendError(_));this.backendErrors.set(s),console.error("Errores del backend:",a.errors)}else alert(`\u2705 Se importaron ${a.insertedRows||e.length} filas de datos exitosamente a la tabla din\xE1mica.`),this.clearImportedData()},error:a=>{if(this.isLoading.set(!1),console.error("Error HTTP al importar datos:",a),a.error?.errors&&Array.isArray(a.error.errors)){let s=a.error.errors.map(_=>this.simplifyBackendError(_));this.backendErrors.set(s)}else this.backendErrors.set([`Error de conexi\xF3n: ${a.error?.message||a.message}`])}})}};c.\u0275fac=function(a){return new(a||c)(J(ge),J(xe),J(_e))},c.\u0275cmp=ae({type:c,selectors:[["app-daily-load"]],decls:43,vars:14,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center"],[1,"min-h-screen","bg-gradient-to-br","from-slate-900","via-slate-800","to-slate-900","p-6"],[1,"max-w-7xl","mx-auto"],[1,"mb-8"],[1,"flex","items-center","gap-2","mb-2"],[1,"w-8","h-8","bg-orange-600","rounded-lg","flex","items-center","justify-center"],["name","calendar",1,"text-white",3,"size"],[1,"text-lg","font-bold","text-white"],[1,"text-xs","text-gray-400"],[1,"bg-slate-900","rounded-lg","p-3","shadow-sm","border","border-slate-800","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-3"],[1,"block","text-xs","font-semibold","text-gray-300","mb-1.5"],["name","building-2",1,"inline","mr-1",3,"size"],[1,"w-full","px-3","py-2","bg-slate-800","border","border-slate-700","rounded-lg","text-white","text-sm","focus:outline-none","focus:ring-2","focus:ring-green-500",3,"ngModelChange","ngModel"],[3,"value"],["name","folder",1,"inline","mr-1",3,"size"],[1,"w-full","px-3","py-2","bg-slate-800","border","border-slate-700","rounded-lg","text-white","text-sm","focus:outline-none","focus:ring-2","focus:ring-green-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],["name","folder-tree",1,"inline","mr-1",3,"size"],[1,"bg-slate-800","border","border-slate-700","rounded-xl","p-6"],[1,"bg-yellow-900/20","border","border-yellow-700/50","rounded-xl","p-6"],[1,"absolute","inset-0","bg-black/60","backdrop-blur-sm"],[1,"relative","bg-slate-800","rounded-2xl","p-8","shadow-2xl","border","border-slate-700","max-w-md","w-full","mx-4"],[1,"flex","flex-col","items-center","gap-6"],[1,"relative"],[1,"w-16","h-16","border-4","border-slate-600","rounded-full"],[1,"absolute","top-0","left-0","w-16","h-16","border-4","border-green-500","rounded-full","border-t-transparent","animate-spin"],[1,"text-center"],[1,"text-xl","font-bold","text-white","mb-2"],[1,"text-gray-400","text-sm"],[1,"w-full","bg-slate-700","rounded-full","h-2","overflow-hidden"],[1,"bg-gradient-to-r","from-green-500","to-emerald-400","h-full","rounded-full","animate-pulse",2,"width","100%"],[1,"text-xs","text-gray-500"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-4","mb-4"],[1,"text-xl","font-bold","text-white"],[1,"text-gray-400","text-sm","mt-1"],[1,"flex","flex-col","sm:flex-row","gap-2"],[1,"flex","items-center","gap-2","px-4","py-2","bg-purple-600","text-white","rounded-lg","hover:bg-purple-700","transition-all","font-medium","text-sm","cursor-pointer",3,"click"],["name","file-text",3,"size"],[1,"flex","items-center","gap-2","px-4","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-all","font-medium","cursor-pointer","text-sm"],["name","folder-open",3,"size"],["type","file","accept",".xlsx,.xls,.csv",1,"hidden",3,"change"],[1,"bg-slate-900","border","border-slate-700","rounded-lg","overflow-hidden"],[1,"px-4","py-2","bg-slate-800","border-b","border-slate-700"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-2"],["name","table",1,"text-green-400",3,"size"],[1,"text-sm","font-semibold","text-gray-300"],[1,"flex","items-center","gap-4"],[1,"overflow-auto",2,"max-height","500px"],[1,"w-full","text-xs","border-collapse"],[1,"bg-slate-800","sticky","top-0","z-10"],[1,"px-3","py-2","text-left","font-semibold","text-gray-300","border-r","border-slate-700","bg-slate-800",2,"min-width","50px"],[1,"px-3","py-2","text-left","font-semibold","text-gray-300","border-r","border-slate-700","bg-slate-800",2,"min-width","80px"],[1,"px-3","py-2","text-left","font-semibold","text-gray-300","border-r","border-slate-700","bg-slate-800",2,"min-width","150px",3,"title"],[1,"border-b","border-slate-700"],[1,"space-y-4","mt-4"],[1,"text-xs","font-bold","text-white"],["name","check-circle",1,"text-green-400",3,"size"],[1,"text-xs","font-bold","text-green-400"],["name","x-circle",1,"text-red-400",3,"size"],[1,"text-xs","font-bold","text-red-400"],[1,"flex","items-center","gap-1.5"],["name","sparkles",1,"text-amber-400","flex-shrink-0",3,"size","title"],[1,"flex","flex-col","gap-0.5"],[1,"font-semibold"],[1,"text-[10px]","text-green-400","font-normal"],[1,"px-3","py-8","text-center","text-gray-500","bg-slate-800/30"],[1,"flex","flex-col","items-center","gap-2"],["name","inbox",1,"text-gray-600",3,"size"],[1,"text-sm"],[1,"border-b","border-slate-700","hover:bg-slate-800/50"],[1,"border-b","border-slate-700","hover:bg-slate-800/50","bg-red-900/10"],[1,"px-3","py-2","text-gray-400","border-r","border-slate-700","bg-slate-800/30"],[1,"px-3","py-2","border-r","border-slate-700"],[1,"inline-flex","items-center","gap-1","px-2","py-0.5","bg-green-900/30","text-green-400","rounded","text-[10px]"],["name","check",3,"size"],[1,"px-3","py-2","text-gray-300","border-r","border-slate-700",3,"text-gray-500"],[1,"px-3","py-2","text-gray-300","border-r","border-slate-700"],[1,"inline-flex","items-center","gap-1","px-2","py-0.5","bg-red-900/30","text-red-400","rounded","text-[10px]",3,"title"],["name","x",3,"size"],[1,"bg-red-900/30","border-2","border-red-700","rounded-xl","p-4"],[1,"bg-red-900/20","border","border-red-700/50","rounded-lg","p-4"],[1,"flex","justify-between","items-center"],[1,"text-sm","text-gray-400"],[1,"text-red-400"],[1,"flex","gap-3"],[1,"px-4","py-2","bg-slate-700","text-white","rounded-lg","hover:bg-slate-600","transition-all","font-medium","text-sm",3,"click"],[1,"px-4","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-all","font-medium","text-sm"],[1,"flex","items-start","gap-3"],["name","x-circle",1,"text-red-500","flex-shrink-0","mt-1",3,"size"],[1,"flex-1"],[1,"text-red-500","font-bold","text-lg","mb-2"],[1,"text-red-300","text-sm","mb-3"],[1,"bg-red-950/50","rounded-lg","p-3","max-h-60","overflow-y-auto"],[1,"text-red-200","text-xs","font-mono","mb-2","pb-2","border-b","border-red-800/50","last:border-0"],["name","alert-circle",1,"text-red-400","mt-0.5",3,"size"],[1,"text-red-400","font-semibold","mb-2"],[1,"space-y-1"],[1,"text-green-400"],[1,"px-4","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-all","font-medium","text-sm",3,"click"],["name","alert-circle",1,"text-yellow-500","mt-0.5",3,"size"],[1,"text-yellow-500","font-semibold","mb-1"]],template:function(a,s){a&1&&(I(0,Se,16,0,"div",0),n(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),C(6,"lucide-angular",6),o(),n(7,"div")(8,"h1",7),d(9,"Carga Diaria"),o(),n(10,"p",8),d(11,"Importaci\xF3n diaria de actualizaciones"),o()()()(),n(12,"div",9)(13,"div",10)(14,"div")(15,"label",11),C(16,"lucide-angular",12),d(17," Proveedor "),o(),n(18,"select",13),te("ngModelChange",function(r){return ee(s.selectedTenantId,r)||(s.selectedTenantId=r),r}),B("ngModelChange",function(r){return s.onTenantChange(r)}),n(19,"option",14),d(20,"Seleccione un proveedor..."),o(),L(21,Ee,2,3,"option",14,W),o()(),n(23,"div")(24,"label",11),C(25,"lucide-angular",15),d(26," Cartera "),o(),n(27,"select",16),te("ngModelChange",function(r){return ee(s.selectedPortfolioId,r)||(s.selectedPortfolioId=r),r}),B("ngModelChange",function(r){return s.onPortfolioChange(r)}),n(28,"option",14),d(29,"Seleccione una cartera..."),o(),L(30,De,2,3,"option",14,W),o()(),n(32,"div")(33,"label",11),C(34,"lucide-angular",17),d(35," Subcartera "),o(),n(36,"select",16),te("ngModelChange",function(r){return ee(s.selectedSubPortfolioId,r)||(s.selectedSubPortfolioId=r),r}),B("ngModelChange",function(r){return s.onSubPortfolioChange(r)}),n(37,"option",14),d(38,"Seleccione una subcartera..."),o(),L(39,we,2,3,"option",14,W),o()()()(),I(41,qe,39,7,"div",18)(42,Ze,8,1,"div",19),o()()),a&2&&(N(s.isLoading()?0:-1),l(6),g("size",16),l(10),g("size",16),l(2),Q("ngModel",s.selectedTenantId),l(),g("value",0),l(2),P(s.tenants()),l(4),g("size",16),l(2),Q("ngModel",s.selectedPortfolioId),g("disabled",s.selectedTenantId===0),l(),g("value",0),l(2),P(s.portfolios()),l(4),g("size",16),l(2),Q("ngModel",s.selectedSubPortfolioId),g("disabled",s.selectedPortfolioId===0),l(),g("value",0),l(2),P(s.subPortfolios()),l(2),N(s.selectedSubPortfolioId>0&&s.headersAreSaved()?41:s.selectedSubPortfolioId>0&&!s.headersAreSaved()?42:-1))},dependencies:[re,fe,pe,ue,me,de,ce,se,le],styles:["[_nghost-%COMP%]{display:block}"]});let t=c;return t})();export{lt as DailyLoadComponent};
