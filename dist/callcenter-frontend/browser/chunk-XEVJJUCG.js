import{a as K}from"./chunk-KN46AQQT.js";import{a as W}from"./chunk-5QM4BWZK.js";import{a as q}from"./chunk-EGJT6C6E.js";import{c as R}from"./chunk-T2ZQ5EGI.js";import"./chunk-NTU7HPDP.js";import{E as G,f as V,k as $,s as j,t as H,u as Y}from"./chunk-7GV7UZOL.js";import{$b as U,_b as B}from"./chunk-W3UIH3CO.js";import"./chunk-YQKVMPSG.js";import{Bc as O,E as C,Lb as s,Mb as e,Nb as a,Ob as d,Vb as I,Xb as g,Zb as f,ab as i,dd as P,ed as N,gb as E,ic as y,jc as w,kd as F,lc as n,mc as m,md as L,na as v,nb as k,nc as x,oa as S,oc as _,qc as z,rc as T,sb as h,sc as D,zc as M}from"./chunk-SN4XSKG7.js";function Q(c,p){if(c&1&&(e(0,"option",36),n(1),a()),c&2){let l=p.$implicit;s("value",l.id),i(),_(" ",l.name," (",l.status,") ")}}function X(c,p){if(c&1&&(e(0,"div",37)(1,"h3"),d(2,"lucide-angular",38),n(3," M\xE9tricas del Auto-Dialer en Tiempo Real"),a(),e(4,"div",39)(5,"div",40)(6,"span",41),d(7,"lucide-angular",38),a(),e(8,"div",42)(9,"span",43),n(10),a(),e(11,"span",44),n(12,"Total llamadas"),a()()(),e(13,"div",40)(14,"span",41),d(15,"lucide-angular",45),a(),e(16,"div",42)(17,"span",43),n(18),a(),e(19,"span",44),n(20,"Llamadas en cola"),a()()(),e(21,"div",40)(22,"span",41),d(23,"lucide-angular",46),a(),e(24,"div",42)(25,"span",43),n(26),a(),e(27,"span",44),n(28,"Llamadas conectadas"),a()()(),e(29,"div",40)(30,"span",41),d(31,"lucide-angular",47),a(),e(32,"div",42)(33,"span",43),n(34),a(),e(35,"span",44),n(36,"Llamadas por realizar"),a()()(),e(37,"div",40)(38,"span",41),d(39,"lucide-angular",20),a(),e(40,"div",42)(41,"span",43),n(42),a(),e(43,"span",44),n(44,"Llamadas siendo marcadas"),a()()(),e(45,"div",40)(46,"span",41),d(47,"lucide-angular",48),a(),e(48,"div",42)(49,"span",43),n(50),a(),e(51,"span",44),n(52,"Llamadas siendo procesadas"),a()()(),e(53,"div",40)(54,"span",41),d(55,"lucide-angular",49),a(),e(56,"div",42)(57,"span",43),n(58),a(),e(59,"span",44),n(60,"Llamadas fallidas"),a()()(),e(61,"div",40)(62,"span",41),d(63,"lucide-angular",50),a(),e(64,"div",42)(65,"span",43),n(66),a(),e(67,"span",44),n(68,"Llamadas no contestadas"),a()()(),e(69,"div",40)(70,"span",41),d(71,"lucide-angular",51),a(),e(72,"div",42)(73,"span",43),n(74),a(),e(75,"span",44),n(76,"Llamadas abandonadas"),a()()(),e(77,"div",40)(78,"span",41),d(79,"lucide-angular",45),a(),e(80,"div",42)(81,"span",43),n(82),a(),e(83,"span",44),n(84,"Duraci\xF3n promedio de llamada"),a()()(),e(85,"div",40)(86,"span",41),d(87,"lucide-angular",52),a(),e(88,"div",42)(89,"span",43),n(90),a(),e(91,"span",44),n(92,"Duraci\xF3n m\xE1xima de llamada"),a()()()()()),c&2){let l=f();i(2),s("size",20),i(5),s("size",24),i(3),m(l.autoDialerStats.totalLlamadas),i(5),s("size",24),i(3),m(l.autoDialerStats.llamadasEnCola),i(5),s("size",24),i(3),m(l.autoDialerStats.llamadasConectadas),i(5),s("size",24),i(3),m(l.autoDialerStats.contactosPendientes),i(5),s("size",24),i(3),m(l.autoDialerStats.llamadasMarcando),i(5),s("size",24),i(3),m(l.autoDialerStats.llamadasActivas),i(5),s("size",24),i(3),m(l.autoDialerStats.contactosFallidos),i(5),s("size",24),i(3),m(l.autoDialerStats.llamadasNoContestadas),i(5),s("size",24),i(3),m(l.autoDialerStats.llamadasAbandonadas),i(5),s("size",24),i(3),m(l.autoDialerStats.duracionPromedioFormato),i(5),s("size",24),i(3),m(l.autoDialerStats.duracionMaximaFormato)}}function Z(c,p){if(c&1&&(e(0,"tr",53)(1,"td",54),n(2),M(3,"date"),a(),e(4,"td",55),n(5),a(),e(6,"td",56),n(7),a(),e(8,"td",57)(9,"span",58),n(10),a()(),e(11,"td",59),n(12),a()()),c&2){let l=p.$implicit,t=f();i(2),m(O(3,5,l.fechaInicio,"HH:mm:ss")),i(3),m(l.anexoDestino),i(2),m(l.nombreAgente),i(3),m(l.estadoLlamada),i(2),m(t.formatTiempo(l.duracionSegundos))}}function ee(c,p){c&1&&(e(0,"tr",60)(1,"td",61),n(2," No hay llamadas en curso "),a()())}function te(c,p){if(c&1&&(e(0,"tr",62)(1,"td",63)(2,"div",64),n(3),a(),e(4,"div",65),n(5),a()(),e(6,"td",66)(7,"span",67),d(8,"lucide-angular",10),n(9),a()(),e(10,"td",68),n(11),a(),e(12,"td",69),n(13),a(),e(14,"td",70),d(15,"app-status-alarm-clock",71),a()()),c&2){let l=p.$implicit,t=f();w("alert-row",l.excedeTiempoMaximo),i(3),x("SIP/",l.sipExtension),i(2),m(l.nombreCompleto),i(2),y("background-color",t.getEstadoColor(l.estadoActual)),i(),s("name",t.getEstadoIcon(l.estadoActual))("size",14),i(),x(" ",t.getEstadoTexto(l.estadoActual)," "),i(2),x(" ",l.telefonoDestino||"-"," "),i(2),x(" ",t.formatTiempo(l.segundosEnEstado)," "),i(2),s("color",l.colorIndicador)("excedido",l.excedeTiempoMaximo)("size",20)("tooltip",l.mensajeAlerta||"")}}function ae(c,p){c&1&&(e(0,"tr",60)(1,"td",61),n(2," No hay agentes registrados "),a()())}function ie(c,p){if(c&1){let l=I();e(0,"div",72),g("click",function(o){v(l);let r=f();return S(r.onOverlayClick(o))}),e(1,"div",73)(2,"button",74),g("click",function(){v(l);let o=f();return S(o.dismissAlert())}),d(3,"lucide-angular",75),a(),e(4,"div",76)(5,"div",77),d(6,"lucide-angular",78),a(),e(7,"h3"),n(8,"Alerta de Agente"),a()(),e(9,"div",79)(10,"div",80)(11,"div",81),d(12,"lucide-angular",82),a(),e(13,"div",83)(14,"span",84),n(15),a(),e(16,"span",85),n(17),a()()(),e(18,"div",86)(19,"span",87),n(20,"Estado:"),a(),e(21,"span",88),n(22),a()(),e(23,"div",89),d(24,"lucide-angular",45),e(25,"span"),n(26,"Tiempo en estado: "),e(27,"strong"),n(28),a()()(),e(29,"div",90),d(30,"lucide-angular",91),e(31,"span"),n(32),a()()(),e(33,"div",92)(34,"button",93),g("click",function(){v(l);let o=f();return S(o.dismissAlert())}),n(35," Entendido "),a()()()()}if(c&2){let l=f();i(3),s("size",20),i(3),s("size",32),i(6),s("size",24),i(3),m(l.alertaActiva.agente.nombreCompleto),i(2),x("SIP/",l.alertaActiva.agente.sipExtension),i(4),y("background-color",l.getEstadoColor(l.alertaActiva.agente.estadoActual)),i(),x(" ",l.getEstadoTexto(l.alertaActiva.agente.estadoActual)," "),i(2),s("size",18),i(4),m(l.formatTiempo(l.alertaActiva.agente.segundosEnEstado)),i(2),s("size",18),i(2),m(l.alertaActiva.agente.mensajeAlerta)}}var xe=(()=>{let p=class p{constructor(t,o,r){this.campaignService=t,this.autoDialerService=o,this.router=r,this.campaigns=[],this.selectedCampaignId=null,this.loadingCampaigns=!1,this.autoDialerStats=null,this.agentesMonitoreo=[],this.llamadasEnTiempoReal=[],this.alertaActiva=null,this.alertasDismissed=new Set,this.soundEnabled=!1,this.SOUND_STORAGE_KEY="supervisor_sound_enabled",this.audioContext=null,this.oscillator=null,this.gainNode=null,this.isAlarmPlaying=!1,this.previousAgentStates=new Map}ngOnInit(){this.loadSoundPreference(),this.initAlarmAudio(),this.loadCampaigns(),this.startAutoDialerPolling(),this.startAgentesPolling(),this.startLlamadasPolling(),this.startLocalTimer()}startLocalTimer(){this.localTimerSubscription=C(1e3).subscribe(()=>{this.agentesMonitoreo.forEach(t=>{t.segundosEnEstado!==void 0&&t.segundosEnEstado++})})}loadSoundPreference(){let t=localStorage.getItem(this.SOUND_STORAGE_KEY);this.soundEnabled=t==="true"}saveSoundPreference(){localStorage.setItem(this.SOUND_STORAGE_KEY,String(this.soundEnabled))}ngOnDestroy(){this.localTimerSubscription&&this.localTimerSubscription.unsubscribe(),this.autoDialerSubscription&&this.autoDialerSubscription.unsubscribe(),this.agentesSubscription&&this.agentesSubscription.unsubscribe(),this.llamadasSubscription&&this.llamadasSubscription.unsubscribe(),this.stopAlarm(),this.audioContext&&this.audioContext.close()}initAlarmAudio(){this.audioContext=new(window.AudioContext||window.webkitAudioContext)}loadCampaigns(){this.loadingCampaigns=!0,this.campaignService.getAllCampaigns().subscribe({next:t=>{if(this.campaigns=t,this.loadingCampaigns=!1,t.length>0&&!this.selectedCampaignId){let o=t.find(r=>r.status==="ACTIVE");this.selectedCampaignId=o?.id||t[0].id||null}},error:t=>{console.error("Error loading campaigns:",t),this.loadingCampaigns=!1}})}onCampaignChange(){console.log("Selected campaign changed to:",this.selectedCampaignId),this.autoDialerSubscription&&this.autoDialerSubscription.unsubscribe(),this.startAutoDialerPolling(),this.llamadasSubscription&&this.llamadasSubscription.unsubscribe(),this.startLlamadasPolling()}startAutoDialerPolling(){let t=this.selectedCampaignId||void 0;this.autoDialerSubscription=this.autoDialerService.startStatsPolling(t).subscribe({next:o=>{this.autoDialerStats=o},error:o=>{console.error("Error polling auto-dialer stats:",o)}})}startAgentesPolling(){this.agentesSubscription=this.autoDialerService.startAgentesPolling().subscribe({next:t=>{this.agentesMonitoreo=t;let o=t.filter(r=>r.excedeTiempoMaximo);o.length>0&&console.log("[Monitor] Agentes con tiempo excedido:",o.map(r=>({nombre:r.nombreCompleto,estado:r.estadoActual,excede:r.excedeTiempoMaximo,mensaje:r.mensajeAlerta,sonido:r.sonidoAlerta}))),this.checkAgentAlerts(t)},error:t=>{console.error("Error polling agentes:",t)}})}checkAgentAlerts(t){for(let o of t){let r=this.previousAgentStates.get(o.idUsuario);r&&r!==o.estadoActual&&(console.log(`[Monitor] Agente ${o.nombreCompleto} cambi\xF3 de ${r} a ${o.estadoActual}, limpiando alertas`),this.clearDismissedForAgent(o.idUsuario)),this.previousAgentStates.set(o.idUsuario,o.estadoActual)}if(this.alertaActiva){console.log("[Monitor] Ya hay una alerta activa, no se mostrar\xE1n nuevas");return}for(let o of t)if(o.excedeTiempoMaximo&&o.mensajeAlerta){let r=`${o.idUsuario}-${o.estadoActual}`;if(this.alertasDismissed.has(r)){console.log(`[Monitor] Alerta ${r} ya fue cerrada, ignorando`);continue}console.log(`[Monitor] Mostrando alerta para agente ${o.nombreCompleto}`),this.showAlert(o);break}}showAlert(t){this.alertaActiva={agente:t,timestamp:new Date},t.sonidoAlerta&&this.soundEnabled&&(this.speakAlert(t),this.playAlarm())}speakAlert(t){if(!("speechSynthesis"in window)){console.warn("Text-to-Speech no soportado");return}let o=this.getEstadoHablado(t.estadoActual),r=`Atenci\xF3n. El agente ${t.nombreCompleto} lleva demasiado tiempo en estado ${o}. Requiere supervisi\xF3n.`;speechSynthesis.cancel();let u=new SpeechSynthesisUtterance(r);u.lang="es-ES",u.rate=.9,u.pitch=.8,u.volume=1;let A=speechSynthesis.getVoices().find(J=>J.lang.startsWith("es"));A&&(u.voice=A),speechSynthesis.speak(u)}getEstadoHablado(t){return{DISPONIBLE:"disponible",EN_LLAMADA:"en llamada",TIPIFICANDO:"tipificando",EN_REUNION:"en reuni\xF3n",REFRIGERIO:"refrigerio",SSHH:"ba\xF1o",EN_MANUAL:"modo manual",PAUSADO:"pausado"}[t]||t}dismissAlert(){if(this.alertaActiva){let t=`${this.alertaActiva.agente.idUsuario}-${this.alertaActiva.agente.estadoActual}`;this.alertasDismissed.add(t),this.alertaActiva=null,this.stopAlarm(),"speechSynthesis"in window&&speechSynthesis.cancel()}}onOverlayClick(t){t.target.classList.contains("alert-overlay")&&this.dismissAlert()}toggleSound(){this.soundEnabled=!this.soundEnabled,this.saveSoundPreference(),this.soundEnabled&&this.audioContext&&(this.audioContext.state==="suspended"&&this.audioContext.resume(),this.playTestBeep())}playTestBeep(){if(!this.audioContext)return;let t=this.audioContext.createOscillator(),o=this.audioContext.createGain();t.connect(o),o.connect(this.audioContext.destination),t.type="sine",t.frequency.setValueAtTime(440,this.audioContext.currentTime),o.gain.setValueAtTime(.3,this.audioContext.currentTime),t.start(),t.stop(this.audioContext.currentTime+.1)}playAlarm(){if(!(!this.audioContext||this.isAlarmPlaying||!this.soundEnabled))try{this.audioContext.state==="suspended"&&this.audioContext.resume(),this.isAlarmPlaying=!0,this.startBeepSequence()}catch(t){console.warn("No se pudo reproducir la alarma:",t)}}startBeepSequence(){if(!this.audioContext||!this.isAlarmPlaying)return;let t=this.audioContext.createOscillator(),o=this.audioContext.createGain();t.connect(o),o.connect(this.audioContext.destination),t.type="sine",t.frequency.setValueAtTime(880,this.audioContext.currentTime),o.gain.setValueAtTime(.5,this.audioContext.currentTime),t.start(),t.stop(this.audioContext.currentTime+.2),t.onended=()=>{this.isAlarmPlaying&&setTimeout(()=>this.startBeepSequence(),200)}}stopAlarm(){this.isAlarmPlaying=!1}clearDismissedForAgent(t){let o=[];this.alertasDismissed.forEach(r=>{r.startsWith(`${t}-`)&&o.push(r)}),o.forEach(r=>this.alertasDismissed.delete(r))}startLlamadasPolling(){let t=this.selectedCampaignId||void 0;this.llamadasSubscription=this.autoDialerService.startLlamadasPolling(t).subscribe({next:o=>{this.llamadasEnTiempoReal=o},error:o=>{console.error("Error polling llamadas en tiempo real:",o)}})}getCurrentTime(){return new Date().toLocaleTimeString("es-PE",{hour12:!1})}getEstadoColor(t){switch(t){case"DISPONIBLE":return"#10B981";case"EN_LLAMADA":return"#3B82F6";case"DESCONECTADO":return"#EF4444";case"PAUSADO":return"#F59E0B";case"EN_REUNION":return"#8B5CF6";case"REFRIGERIO":return"#F59E0B";case"SSHH":return"#F59E0B";case"TIPIFICANDO":return"#06B6D4";default:return"#6B7280"}}getEstadoIcon(t){switch(t){case"DISPONIBLE":return"circle";case"EN_LLAMADA":return"phone-call";case"DESCONECTADO":return"circle";case"PAUSADO":return"pause";case"EN_REUNION":return"users";case"REFRIGERIO":return"coffee";case"SSHH":return"user";case"TIPIFICANDO":return"edit";default:return"circle"}}getEstadoTexto(t){switch(t){case"DISPONIBLE":return"Libre";case"EN_LLAMADA":return"En Llamada";case"DESCONECTADO":return"Desconectado";case"PAUSADO":return"Pausado";case"EN_REUNION":return"En Reuni\xF3n";case"REFRIGERIO":return"Refrigerio";case"SSHH":return"SSHH";case"TIPIFICANDO":return"Tipificando";default:return t}}formatTiempo(t){if(!t||t<0)return"-";let o=Math.floor(t/3600),r=Math.floor(t%3600/60),u=t%60;return o>0?`${o.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`:`${r.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}goBack(){this.router.navigate(["/admin/campaigns"])}navigateToExtensions(){this.router.navigate(["/admin/extensions"])}};p.\u0275fac=function(o){return new(o||p)(E(q),E(K),E(R))},p.\u0275cmp=k({type:p,selectors:[["app-campaign-monitoring"]],decls:76,vars:20,consts:[[1,"monitoring-container"],[1,"flex","items-center","gap-2","mb-2"],[1,"w-8","h-8","bg-gradient-to-br","from-blue-600","to-blue-700","rounded-lg","flex","items-center","justify-center"],["name","bar-chart-2",1,"text-white",3,"size"],[1,"text-lg","font-bold","text-white"],[1,"text-xs","text-gray-400"],[1,"header"],[1,"btn-back",3,"click"],["name","arrow-left",3,"size"],[1,"btn-sound",3,"click","title"],[3,"name","size"],[1,"campaign-selector"],["for","campaignSelect"],["id","campaignSelect",1,"campaign-select",3,"ngModelChange","change","ngModel"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","metrics-panel",4,"ngIf"],[1,"two-column-layout"],[1,"left-column"],[1,"discado-panel"],["name","phone-call",3,"size"],[1,"discado-table-container"],[1,"discado-table"],["class","llamada-row",4,"ngFor","ngForOf"],["class","empty-row",4,"ngIf"],[1,"right-column"],[1,"agentes-panel"],[1,"agentes-header"],["name","users",3,"size"],[1,"btn-view-all",3,"click"],["name","phone",3,"size"],[1,"agentes-table-container"],[1,"agentes-table"],[2,"width","50px","text-align","center"],["class","agente-row",3,"alert-row",4,"ngFor","ngForOf"],["class","alert-overlay",3,"click",4,"ngIf"],[3,"value"],[1,"metrics-panel"],["name","bar-chart-2",3,"size"],[1,"metrics-grid"],[1,"metric-item"],[1,"metric-icon"],[1,"metric-info"],[1,"metric-value"],[1,"metric-label"],["name","clock",3,"size"],["name","check-circle",3,"size"],["name","clipboard-list",3,"size"],["name","activity",3,"size"],["name","x-circle",3,"size"],["name","phone-missed",3,"size"],["name","phone-off",3,"size"],["name","timer",3,"size"],[1,"llamada-row"],[1,"llamada-hora"],[1,"llamada-telefono"],[1,"llamada-agente"],[1,"llamada-estado"],[1,"estado-badge-mini"],[1,"llamada-duracion"],[1,"empty-row"],["colspan","5",2,"text-align","center","color","#94a3b8"],[1,"agente-row"],[1,"agente-info"],[1,"agente-extension"],[1,"agente-nombre"],[1,"agente-estado"],[1,"estado-badge"],[1,"agente-telefono"],[1,"agente-tiempo"],[1,"agente-alerta",2,"text-align","center"],[3,"color","excedido","size","tooltip"],[1,"alert-overlay",3,"click"],[1,"alert-modal"],[1,"alert-close",3,"click"],["name","x",3,"size"],[1,"alert-header"],[1,"alert-icon-container"],["name","alert-triangle",1,"alert-icon",3,"size"],[1,"alert-body"],[1,"alert-agent-info"],[1,"agent-avatar"],["name","user",3,"size"],[1,"agent-details"],[1,"agent-name"],[1,"agent-extension"],[1,"alert-status"],[1,"status-label"],[1,"status-badge"],[1,"alert-time"],[1,"alert-message"],["name","alert-circle",3,"size"],[1,"alert-footer"],[1,"btn-dismiss",3,"click"]],template:function(o,r){o&1&&(e(0,"div",0)(1,"div",1)(2,"div",2),d(3,"lucide-angular",3),a(),e(4,"div")(5,"h1",4),n(6,"Monitoreo por Campa\xF1a"),a(),e(7,"p",5),n(8,"M\xE9tricas del auto-dialer en tiempo real"),a()()(),e(9,"div",6)(10,"button",7),g("click",function(){return r.goBack()}),d(11,"lucide-angular",8),e(12,"span"),n(13,"Volver a Campa\xF1as"),a()(),e(14,"button",9),g("click",function(){return r.toggleSound()}),d(15,"lucide-angular",10),e(16,"span"),n(17),a()()(),e(18,"div",11)(19,"label",12),n(20,"Seleccionar Campa\xF1a:"),a(),e(21,"select",13),D("ngModelChange",function(b){return T(r.selectedCampaignId,b)||(r.selectedCampaignId=b),b}),g("change",function(){return r.onCampaignChange()}),e(22,"option",14),n(23,"-- Seleccione una campa\xF1a --"),a(),h(24,Q,2,3,"option",15),a()(),h(25,X,93,23,"div",16),e(26,"div",17)(27,"div",18)(28,"div",19)(29,"h3"),d(30,"lucide-angular",20),n(31," Discado en Tiempo Real"),a(),e(32,"div",21)(33,"table",22)(34,"thead")(35,"tr")(36,"th"),n(37,"Hora"),a(),e(38,"th"),n(39,"Tel\xE9fono"),a(),e(40,"th"),n(41,"Agente"),a(),e(42,"th"),n(43,"Estado"),a(),e(44,"th"),n(45,"Duraci\xF3n"),a()()(),e(46,"tbody"),h(47,Z,13,8,"tr",23)(48,ee,3,0,"tr",24),a()()()()(),e(49,"div",25)(50,"div",26)(51,"div",27)(52,"h3"),d(53,"lucide-angular",28),n(54," Agentes en Tiempo Real"),a(),e(55,"button",29),g("click",function(){return r.navigateToExtensions()}),d(56,"lucide-angular",30),n(57," Ver Extensiones "),a()(),e(58,"div",31)(59,"table",32)(60,"thead")(61,"tr")(62,"th"),n(63,"Agente"),a(),e(64,"th"),n(65,"Estado"),a(),e(66,"th"),n(67,"Tel\xE9fono"),a(),e(68,"th"),n(69,"Tiempo"),a(),e(70,"th",33),n(71,"Alerta"),a()()(),e(72,"tbody"),h(73,te,16,15,"tr",34)(74,ae,3,0,"tr",24),a()()()()()()(),h(75,ie,36,12,"div",35)),o&2&&(i(3),s("size",16),i(8),s("size",18),i(3),w("active",r.soundEnabled),s("title",r.soundEnabled?"Desactivar sonido de alertas":"Activar sonido de alertas (requerido para escuchar alarmas)"),i(),s("name",r.soundEnabled?"volume-2":"volume-x")("size",18),i(2),m(r.soundEnabled?"Sonido ON":"Sonido OFF"),i(4),z("ngModel",r.selectedCampaignId),i(),s("value",null),i(2),s("ngForOf",r.campaigns),i(),s("ngIf",r.autoDialerStats),i(5),s("size",20),i(17),s("ngForOf",r.llamadasEnTiempoReal),i(),s("ngIf",r.llamadasEnTiempoReal.length===0),i(5),s("size",20),i(3),s("size",16),i(17),s("ngForOf",r.agentesMonitoreo),i(),s("ngIf",r.agentesMonitoreo.length===0),i(),s("ngIf",r.alertaActiva))},dependencies:[L,P,N,G,H,Y,j,V,$,U,B,W,F],styles:[`.monitoring-container{min-height:100vh;background:linear-gradient(to bottom right,#0f172a,#1e293b,#0f172a);padding:1.5rem!important;max-width:1600px;margin:0 auto}.header{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid #334155}.header h1{margin:0;font-size:1.5rem;color:#fff;font-weight:600}.btn-back{display:flex;align-items:center;gap:.5rem;background:#ffffff1a;border:1px solid #334155;color:#fff;padding:.6rem 1rem;border-radius:8px;cursor:pointer;font-size:.9rem;transition:all .3s}.btn-back:hover{background:#ffffff26;transform:translate(-3px)}.btn-sound{display:flex;align-items:center;gap:.5rem;background:#ef444433;border:1px solid #ef4444;color:#fca5a5;padding:.6rem 1rem;border-radius:8px;cursor:pointer;font-size:.9rem;transition:all .3s;margin-left:auto}.btn-sound:hover{background:#ef44444d}.btn-sound.active{background:#22c55e33;border-color:#22c55e;color:#86efac}.btn-sound.active:hover{background:#22c55e4d}.campaign-selector{background:#1e293b;border:1px solid #334155;border-radius:8px;padding:1rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:1rem}.campaign-selector label{color:#fff;font-weight:600;font-size:.95rem;white-space:nowrap}.campaign-select{flex:1;max-width:500px;background:#0a0e27;border:1px solid #334155;border-radius:6px;padding:.7rem;color:#fff;font-size:.95rem;transition:border .3s;cursor:pointer}.campaign-select:focus{outline:none;border-color:#10b981}.campaign-select option{background:#0a0e27;color:#fff}.metrics-panel{background:#1e293b;border:1px solid #334155;border-radius:8px;padding:1rem;margin-bottom:1.5rem}.metrics-panel h3{margin:0 0 1rem;font-size:.95rem;color:#fff;font-weight:600}.metrics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:.8rem}.metric-item{background:#0a0e27;border:1px solid #334155;border-radius:6px;padding:.7rem;display:flex;align-items:center;gap:.7rem;transition:transform .2s,box-shadow .2s}.metric-item:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000004d}.metric-icon{font-size:1.5rem;flex-shrink:0}.metric-info{display:flex;flex-direction:column;min-width:0}.metric-value{font-size:1.3rem;font-weight:700;color:#10b981;line-height:1.2}.metric-label{font-size:.7rem;color:#94a3b8;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.two-column-layout{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;height:calc(100vh - 400px);min-height:500px}.left-column{display:flex;flex-direction:column;background:#1e293b;border:1px solid #334155;border-radius:8px;overflow:hidden}.discado-panel{flex:1;display:flex;flex-direction:column;overflow:hidden}.discado-panel h3{margin:0;padding:1rem;font-size:.95rem;color:#fff;font-weight:600;background:#0a0e27;border-bottom:1px solid #334155}.discado-table-container{flex:1;overflow-y:auto;overflow-x:auto}.discado-table-container::-webkit-scrollbar{width:8px;height:8px}.discado-table-container::-webkit-scrollbar-track{background:#0a0e27}.discado-table-container::-webkit-scrollbar-thumb{background:#334155;border-radius:4px}.discado-table-container::-webkit-scrollbar-thumb:hover{background:#475569}.discado-table{width:100%;border-collapse:collapse;font-size:.8rem}.discado-table thead{position:sticky;top:0;background:#0a0e27;z-index:10}.discado-table th{padding:.7rem .8rem;text-align:left;font-weight:600;color:#94a3b8;font-size:.75rem;text-transform:uppercase;border-bottom:1px solid #334155}.discado-table tbody tr{transition:background-color .2s;animation:fadeIn .3s ease-in}@keyframes fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.llamada-row:hover{background:#3b82f60d}.discado-table td{padding:.7rem .8rem;border-bottom:1px solid #334155;color:#e2e8f0}.llamada-hora{font-family:monospace;font-size:.75rem;color:#94a3b8}.llamada-telefono{font-family:monospace;font-size:.8rem;color:#10b981;font-weight:600}.llamada-agente{font-size:.75rem;color:#e2e8f0}.llamada-estado{text-align:center}.estado-badge-mini{display:inline-block;padding:.2rem .5rem;border-radius:50px;background:#3b82f6;color:#fff;font-size:.7rem;font-weight:600;white-space:nowrap}.llamada-duracion{font-family:monospace;font-size:.75rem;font-weight:600;color:#10b981;text-align:center}.right-column{display:flex;flex-direction:column}.agentes-panel{flex:1;background:#1e293b;border:1px solid #334155;border-radius:8px;overflow:hidden;display:flex;flex-direction:column}.agentes-header{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:#0a0e27;border-bottom:1px solid #334155}.agentes-panel h3{margin:0;font-size:.95rem;color:#fff;font-weight:600}.btn-view-all{padding:6px 12px;background:#3b82f6;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:13px;font-weight:500;transition:all .3s}.btn-view-all:hover{background:#2563eb;transform:translateY(-2px)}.agentes-table-container{flex:1;overflow-y:auto;overflow-x:auto}.agentes-table-container::-webkit-scrollbar{width:8px;height:8px}.agentes-table-container::-webkit-scrollbar-track{background:#0a0e27}.agentes-table-container::-webkit-scrollbar-thumb{background:#334155;border-radius:4px}.agentes-table-container::-webkit-scrollbar-thumb:hover{background:#475569}.agentes-table{width:100%;border-collapse:collapse;font-size:.8rem}.agentes-table thead{position:sticky;top:0;background:#0a0e27;z-index:10}.agentes-table th{padding:.7rem .8rem;text-align:left;font-weight:600;color:#94a3b8;font-size:.75rem;text-transform:uppercase;border-bottom:1px solid #334155}.agentes-table tbody tr{transition:background-color .2s}.agente-row:hover{background:#10b9810d}.agentes-table td{padding:.7rem .8rem;border-bottom:1px solid #334155;color:#e2e8f0}.agente-info{display:flex;flex-direction:column;gap:.2rem}.agente-extension{font-size:.75rem;color:#10b981;font-weight:600;font-family:monospace}.agente-nombre{font-size:.7rem;color:#94a3b8;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:180px}.agente-estado{text-align:center}.estado-badge{display:inline-flex;align-items:center;gap:.3rem;padding:.3rem .6rem;border-radius:50px;color:#fff;font-size:.7rem;font-weight:600;white-space:nowrap}.agente-telefono{font-family:monospace;font-size:.75rem;color:#e2e8f0}.agente-tiempo{font-family:monospace;font-size:.75rem;font-weight:600;color:#10b981;text-align:center}.empty-row td{padding:2rem 1rem}@media (max-width: 1200px){.two-column-layout{grid-template-columns:1fr;height:auto}.left-column,.right-column{min-height:400px;max-height:500px}.metrics-grid{grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}}@media (max-width: 768px){.monitoring-container{padding:1rem}.header{flex-direction:column;align-items:flex-start;gap:.5rem}.campaign-selector{flex-direction:column;align-items:flex-start}.campaign-select{max-width:100%}.two-column-layout{gap:1rem}.metrics-grid{grid-template-columns:repeat(2,1fr)}}.agente-row.alert-row{background:#ef44441a!important;animation:alertRowPulse 2s ease-in-out infinite}@keyframes alertRowPulse{0%,to{background:#ef44441a}50%{background:#ef444433}}.alert-overlay{position:fixed;inset:0;background:#000000b3;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:9999;animation:fadeIn .3s ease}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}.alert-modal{background:linear-gradient(135deg,#1e293b,#0f172a);border:1px solid #EF4444;border-radius:16px;padding:0;width:90%;max-width:420px;box-shadow:0 20px 60px #ef44444d,0 0 40px #ef44441a;animation:modalSlideIn .3s ease,modalPulse 2s ease-in-out infinite;position:relative;overflow:hidden}@keyframes modalSlideIn{0%{transform:scale(.9) translateY(-20px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}@keyframes modalPulse{0%,to{box-shadow:0 20px 60px #ef44444d,0 0 40px #ef44441a}50%{box-shadow:0 20px 80px #ef444480,0 0 60px #ef444433}}.alert-close{position:absolute;top:12px;right:12px;background:#ffffff1a;border:none;color:#94a3b8;width:32px;height:32px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;z-index:1}.alert-close:hover{background:#ef444433;color:#ef4444}.alert-header{background:linear-gradient(135deg,#ef4444,#dc2626);padding:1.5rem;text-align:center}.alert-icon-container{width:64px;height:64px;background:#fff3;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto .75rem;animation:iconShake .5s ease-in-out infinite}@keyframes iconShake{0%,to{transform:rotate(0)}25%{transform:rotate(-5deg)}75%{transform:rotate(5deg)}}.alert-icon{color:#fff}.alert-header h3{margin:0;color:#fff;font-size:1.25rem;font-weight:600}.alert-body{padding:1.5rem;display:flex;flex-direction:column;gap:1rem}.alert-agent-info{display:flex;align-items:center;gap:1rem;background:#ffffff0d;padding:1rem;border-radius:12px;border:1px solid #334155}.agent-avatar{width:48px;height:48px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff}.agent-details{display:flex;flex-direction:column;gap:.25rem}.agent-name{color:#fff;font-weight:600;font-size:1rem}.agent-extension{color:#94a3b8;font-size:.85rem}.alert-status{display:flex;align-items:center;gap:.75rem}.status-label{color:#94a3b8;font-size:.9rem}.alert-status .status-badge{padding:.35rem .75rem;border-radius:20px;color:#fff;font-size:.85rem;font-weight:500}.alert-time,.alert-message{display:flex;align-items:center;gap:.75rem;color:#cbd5e1;font-size:.95rem}.alert-time lucide-angular,.alert-message lucide-angular{color:#94a3b8}.alert-message{background:#ef44441a;padding:.75rem 1rem;border-radius:8px;border-left:3px solid #EF4444}.alert-message lucide-angular{color:#ef4444}.alert-footer{padding:1rem 1.5rem 1.5rem;display:flex;justify-content:center}.btn-dismiss{background:linear-gradient(135deg,#3b82f6,#2563eb);border:none;color:#fff;padding:.75rem 2rem;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:all .2s;min-width:150px}.btn-dismiss:hover{transform:translateY(-2px);box-shadow:0 4px 12px #3b82f666}
`],encapsulation:2});let c=p;return c})();export{xe as CampaignMonitoringComponent};
