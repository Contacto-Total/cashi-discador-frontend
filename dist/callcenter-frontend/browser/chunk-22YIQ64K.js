import{E as J,c as V,f as G,k as $,m as q}from"./chunk-VB7IBPYH.js";import{pc as F,qc as H}from"./chunk-Y57AC67X.js";import{a as U}from"./chunk-YQKVMPSG.js";import{b as I,c as O}from"./chunk-VXC2434B.js";import{Ac as b,Bc as P,Eb as y,Fb as h,Ib as z,Jb as B,Kb as g,Lb as e,Mb as t,Nb as c,Wb as k,Yb as v,ab as n,ba as M,fa as D,gb as R,hc as A,jc as _,kc as i,kd as W,lc as x,ld as j,mc as u,md as L,nb as T,nd as N,pc as S,qc as C,rc as E,wa as w,yc as s}from"./chunk-R6PGQ7OV.js";var K=(()=>{let m=class m{constructor(l){this.http=l,this.baseUrl=`${U.gatewayUrl}/reportes/continuidad`}getReporte(l,p,r,f){let a=new I;return l&&(a=a.set("fechaDesde",l)),p&&(a=a.set("fechaHasta",p)),r&&(a=a.set("idCartera",r.toString())),f&&(a=a.set("idSubcartera",f.toString())),this.http.get(this.baseUrl,{params:a})}exportarExcel(l,p,r,f){let a=new I;return l&&(a=a.set("fechaDesde",l)),p&&(a=a.set("fechaHasta",p)),r&&(a=a.set("idCartera",r.toString())),f&&(a=a.set("idSubcartera",f.toString())),this.http.get(`${this.baseUrl}/excel`,{params:a,responseType:"blob"})}};m.\u0275fac=function(p){return new(p||m)(D(O))},m.\u0275prov=M({token:m,factory:m.\u0275fac,providedIn:"root"});let d=m;return d})();var Y=(d,m)=>m.idGestionContinuidad;function Z(d,m){d&1&&c(0,"lucide-angular",13),d&2&&g("size",18)}function ee(d,m){d&1&&c(0,"lucide-angular",14),d&2&&g("size",18)}function te(d,m){if(d&1&&(e(0,"div",26)(1,"div",27)(2,"div",28)(3,"div",29),c(4,"lucide-angular",30),t(),e(5,"div")(6,"p",31),i(7),t(),e(8,"p",32),i(9,"Total Continuidades"),t()()()(),e(10,"div",27)(11,"div",28)(12,"div",33),c(13,"lucide-angular",34),t(),e(14,"div")(15,"p",35),i(16),t(),e(17,"p",32),i(18,"Pendientes"),t()()()(),e(19,"div",27)(20,"div",28)(21,"div",36),c(22,"lucide-angular",37),t(),e(23,"div")(24,"p",38),i(25),t(),e(26,"p",32),i(27,"Pagadas"),t()()()(),e(28,"div",27)(29,"div",28)(30,"div",39),c(31,"lucide-angular",40),t(),e(32,"div")(33,"p",41),i(34),t(),e(35,"p",32),i(36,"Vencidas"),t()()()(),e(37,"div",27)(38,"div",28)(39,"div",42),c(40,"lucide-angular",43),t(),e(41,"div")(42,"p",44),i(43),s(44,"number"),t(),e(45,"p",32),i(46,"% Recuperaci\xF3n Prom."),t()()()()(),e(47,"div",45)(48,"div",46)(49,"p",47),i(50,"Monto Total Original"),t(),e(51,"p",48),i(52),s(53,"number"),t()(),e(54,"div",49)(55,"p",50),i(56,"Pagado Previo"),t(),e(57,"p",48),i(58),s(59,"number"),t()(),e(60,"div",51)(61,"p",52),i(62,"Pagado en Continuidad"),t(),e(63,"p",48),i(64),s(65,"number"),t()(),e(66,"div",53)(67,"p",54),i(68,"Monto Pendiente"),t(),e(69,"p",48),i(70),s(71,"number"),t()()()),d&2){let o=v();n(4),g("size",24),n(3),x(o.metricas().totalContinuidades),n(6),g("size",24),n(3),x(o.metricas().continuidadesPendientes),n(6),g("size",24),n(3),x(o.metricas().continuidadesPagadas),n(6),g("size",24),n(3),x(o.metricas().continuidadesVencidas),n(6),g("size",24),n(3),u(" ",b(44,14,o.metricas().porcentajeRecuperacionPromedio,"1.1-1"),"% "),n(9),u("S/ ",b(53,17,o.metricas().montoTotalOriginal,"1.2-2")),n(6),u("S/ ",b(59,20,o.metricas().montoTotalPagadoPrevio,"1.2-2")),n(6),u("S/ ",b(65,23,o.metricas().montoTotalPagadoContinuidad,"1.2-2")),n(6),u("S/ ",b(71,26,o.metricas().montoTotalPendiente,"1.2-2"))}}function ie(d,m){d&1&&(e(0,"tr")(1,"td",55),c(2,"lucide-angular",56),e(3,"p"),i(4,"Cargando datos..."),t()()()),d&2&&(n(2),g("size",32))}function ne(d,m){d&1&&(e(0,"tr")(1,"td",55),c(2,"lucide-angular",57),e(3,"p"),i(4,"No hay datos de continuidad para mostrar"),t(),e(5,"p",58),i(6,'Aplica los filtros y presiona "Buscar"'),t()()()),d&2&&(n(2),g("size",48))}function ae(d,m){if(d&1&&(e(0,"tr",59)(1,"td",60),i(2),t(),e(3,"td",61),i(4),t(),e(5,"td",62),i(6),t(),e(7,"td",63),i(8),s(9,"slice"),t(),e(10,"td",64),i(11),t(),e(12,"td",65),i(13),s(14,"number"),t(),e(15,"td",66),i(16),s(17,"number"),t(),e(18,"td",67),i(19),s(20,"date"),t(),e(21,"td",64),i(22),s(23,"slice"),t(),e(24,"td",68),i(25),s(26,"number"),t(),e(27,"td",69)(28,"span"),i(29),t()(),e(30,"td",70),i(31),s(32,"number"),t(),e(33,"td",71),i(34),s(35,"number"),t(),e(36,"td",69)(37,"div",72)(38,"div",73),c(39,"div",74),t(),e(40,"span",75),i(41),s(42,"number"),t()()()()),d&2){let o=m.$implicit,l=v(2);n(2),x(o.idGestionContinuidad),n(2),x(o.idGestionOriginal||"-"),n(2),x(o.documentoCliente),n(2),x(P(9,20,o.nombreCliente,0,25)),n(3),x(o.nombreCartera),n(2),u("S/ ",b(14,24,o.montoOriginalPromesa,"1.2-2")),n(3),u("S/ ",b(17,27,o.montoPagadoPrevio,"1.2-2")),n(3),x(b(20,30,o.fechaContinuidad,"dd/MM/yy")),n(3),x(P(23,33,o.asesorContinuidad,0,15)),n(3),u("S/ ",b(26,37,o.montoContinuidad,"1.2-2")),n(3),_(l.getEstadoClass(o.estadoContinuidad)),n(),u(" ",o.estadoContinuidad," "),n(2),u("S/ ",b(32,40,o.pagadoEnContinuidad,"1.2-2")),n(3),u("S/ ",b(35,43,o.pendienteContinuidad,"1.2-2")),n(5),_(l.getProgressClass(o.porcentajeAvance)),A("width",o.porcentajeAvance||0,"%"),n(2),u(" ",b(42,46,o.porcentajeAvance,"1.0-0"),"% ")}}function re(d,m){if(d&1&&z(0,ae,43,49,"tr",59,Y),d&2){let o=v();B(o.data())}}function de(d,m){if(d&1&&(e(0,"div",25)(1,"p",76),i(2," Mostrando "),e(3,"span",77),i(4),t(),i(5," registros de continuidad "),t()()),d&2){let o=v();n(4),x(o.data().length)}}var ve=(()=>{let m=class m{constructor(l){this.reporteService=l,this.loading=w(!1),this.data=w([]),this.metricas=w(null),this.filtros={fechaDesde:"",fechaHasta:"",idCartera:null,idSubcartera:null}}ngOnInit(){this.buscar()}buscar(){this.loading.set(!0),this.reporteService.getReporte(this.filtros.fechaDesde||void 0,this.filtros.fechaHasta||void 0,this.filtros.idCartera||void 0,this.filtros.idSubcartera||void 0).subscribe({next:l=>{this.data.set(l.data),this.metricas.set(l.metricas),this.loading.set(!1)},error:l=>{console.error("Error cargando reporte:",l),this.loading.set(!1),alert("Error al cargar el reporte de continuidad")}})}exportarExcel(){this.loading.set(!0),this.reporteService.exportarExcel(this.filtros.fechaDesde||void 0,this.filtros.fechaHasta||void 0,this.filtros.idCartera||void 0,this.filtros.idSubcartera||void 0).subscribe({next:l=>{let p=window.URL.createObjectURL(l),r=document.createElement("a");r.href=p,r.download=`Reporte_Continuidad_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(p),this.loading.set(!1)},error:l=>{console.error("Error exportando Excel:",l),this.loading.set(!1),alert("Error al exportar el reporte a Excel")}})}getEstadoClass(l){let p="px-2 py-1 rounded-full text-xs font-semibold";switch(l){case"PAGADA":return`${p} bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400`;case"PENDIENTE":case"PARCIAL":return`${p} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400`;case"VENCIDA":return`${p} bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400`;default:return`${p} bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-400`}}getProgressClass(l){return l>=100?"bg-green-500":l>=50?"bg-amber-500":"bg-red-500"}};m.\u0275fac=function(p){return new(p||m)(R(K))},m.\u0275cmp=T({type:m,selectors:[["app-continuidad-report"]],decls:72,vars:12,consts:[[1,"min-h-screen","bg-gray-100","dark:bg-gray-900","p-4","md:p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-gray-800","dark:text-white","flex","items-center","gap-3"],["name","refresh-cw",1,"text-amber-500",3,"size"],[1,"text-gray-500","dark:text-gray-400","mt-1"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-md","p-4","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4"],[1,"block","text-sm","font-medium","text-gray-700","dark:text-gray-300","mb-1"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","ngModel"],["type","number","placeholder","ID Cartera",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","ngModel"],["type","number","placeholder","ID Subcartera",1,"w-full","px-3","py-2","border","border-gray-300","dark:border-gray-600","rounded-lg","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","ngModel"],[1,"flex","items-end","gap-2"],[1,"flex-1","px-4","py-2","bg-amber-500","hover:bg-amber-600","text-white","font-semibold","rounded-lg","transition-colors","flex","items-center","justify-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","loader-2",1,"animate-spin",3,"size"],["name","search",3,"size"],[1,"px-4","py-2","bg-green-600","hover:bg-green-700","text-white","font-semibold","rounded-lg","transition-colors","flex","items-center","gap-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","download",3,"size"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-md","overflow-hidden"],[1,"overflow-x-auto"],[1,"w-full","text-sm"],[1,"bg-gray-50","dark:bg-gray-700"],[1,"px-3","py-3","text-left","text-xs","font-semibold","text-gray-600","dark:text-gray-300","uppercase"],[1,"px-3","py-3","text-right","text-xs","font-semibold","text-gray-600","dark:text-gray-300","uppercase"],[1,"px-3","py-3","text-center","text-xs","font-semibold","text-gray-600","dark:text-gray-300","uppercase"],[1,"divide-y","divide-gray-200","dark:divide-gray-700"],[1,"px-4","py-3","bg-gray-50","dark:bg-gray-700","border-t","border-gray-200","dark:border-gray-600"],[1,"grid","grid-cols-2","md:grid-cols-5","gap-4","mb-6"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-md","p-4"],[1,"flex","items-center","gap-3"],[1,"p-2","bg-amber-100","dark:bg-amber-900/30","rounded-lg"],["name","refresh-cw",1,"text-amber-600","dark:text-amber-400",3,"size"],[1,"text-2xl","font-bold","text-gray-800","dark:text-white"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"p-2","bg-yellow-100","dark:bg-yellow-900/30","rounded-lg"],["name","clock",1,"text-yellow-600","dark:text-yellow-400",3,"size"],[1,"text-2xl","font-bold","text-yellow-600","dark:text-yellow-400"],[1,"p-2","bg-green-100","dark:bg-green-900/30","rounded-lg"],["name","check-circle",1,"text-green-600","dark:text-green-400",3,"size"],[1,"text-2xl","font-bold","text-green-600","dark:text-green-400"],[1,"p-2","bg-red-100","dark:bg-red-900/30","rounded-lg"],["name","x-circle",1,"text-red-600","dark:text-red-400",3,"size"],[1,"text-2xl","font-bold","text-red-600","dark:text-red-400"],[1,"p-2","bg-blue-100","dark:bg-blue-900/30","rounded-lg"],["name","trending-up",1,"text-blue-600","dark:text-blue-400",3,"size"],[1,"text-2xl","font-bold","text-blue-600","dark:text-blue-400"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","mb-6"],[1,"bg-gradient-to-r","from-gray-700","to-gray-800","rounded-xl","shadow-md","p-4","text-white"],[1,"text-xs","text-gray-300","uppercase"],[1,"text-xl","font-bold"],[1,"bg-gradient-to-r","from-amber-500","to-amber-600","rounded-xl","shadow-md","p-4","text-white"],[1,"text-xs","text-amber-100","uppercase"],[1,"bg-gradient-to-r","from-green-500","to-green-600","rounded-xl","shadow-md","p-4","text-white"],[1,"text-xs","text-green-100","uppercase"],[1,"bg-gradient-to-r","from-red-500","to-red-600","rounded-xl","shadow-md","p-4","text-white"],[1,"text-xs","text-red-100","uppercase"],["colspan","14",1,"px-4","py-8","text-center","text-gray-500","dark:text-gray-400"],["name","loader-2",1,"animate-spin","mx-auto","mb-2",3,"size"],["name","inbox",1,"mx-auto","mb-2","text-gray-400",3,"size"],[1,"text-xs","mt-1"],[1,"hover:bg-gray-50","dark:hover:bg-gray-700/50","transition-colors"],[1,"px-3","py-2","text-gray-900","dark:text-white","font-medium"],[1,"px-3","py-2","text-gray-600","dark:text-gray-400"],[1,"px-3","py-2","text-gray-900","dark:text-white","font-mono","text-xs"],[1,"px-3","py-2","text-gray-900","dark:text-white"],[1,"px-3","py-2","text-gray-600","dark:text-gray-400","text-xs"],[1,"px-3","py-2","text-right","text-gray-900","dark:text-white"],[1,"px-3","py-2","text-right","text-amber-600","dark:text-amber-400"],[1,"px-3","py-2","text-center","text-gray-600","dark:text-gray-400","text-xs"],[1,"px-3","py-2","text-right","text-gray-900","dark:text-white","font-semibold"],[1,"px-3","py-2","text-center"],[1,"px-3","py-2","text-right","text-green-600","dark:text-green-400"],[1,"px-3","py-2","text-right","text-red-600","dark:text-red-400"],[1,"flex","items-center","justify-center","gap-1"],[1,"w-16","bg-gray-200","dark:bg-gray-600","rounded-full","h-2"],[1,"h-2","rounded-full","transition-all"],[1,"text-xs","text-gray-600","dark:text-gray-400","w-10"],[1,"text-sm","text-gray-600","dark:text-gray-400"],[1,"font-semibold"]],template:function(p,r){p&1&&(e(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"lucide-angular",3),i(4," Reporte de Continuidad de Promesas "),t(),e(5,"p",4),i(6," Seguimiento de promesas de continuidad y su estado de recuperaci\xF3n "),t()(),e(7,"div",5)(8,"div",6)(9,"div")(10,"label",7),i(11," Fecha Desde "),t(),e(12,"input",8),E("ngModelChange",function(a){return C(r.filtros.fechaDesde,a)||(r.filtros.fechaDesde=a),a}),t()(),e(13,"div")(14,"label",7),i(15," Fecha Hasta "),t(),e(16,"input",8),E("ngModelChange",function(a){return C(r.filtros.fechaHasta,a)||(r.filtros.fechaHasta=a),a}),t()(),e(17,"div")(18,"label",7),i(19," Cartera "),t(),e(20,"input",9),E("ngModelChange",function(a){return C(r.filtros.idCartera,a)||(r.filtros.idCartera=a),a}),t()(),e(21,"div")(22,"label",7),i(23," Subcartera "),t(),e(24,"input",10),E("ngModelChange",function(a){return C(r.filtros.idSubcartera,a)||(r.filtros.idSubcartera=a),a}),t()(),e(25,"div",11)(26,"button",12),k("click",function(){return r.buscar()}),y(27,Z,1,1,"lucide-angular",13)(28,ee,1,1,"lucide-angular",14),i(29," Buscar "),t(),e(30,"button",15),k("click",function(){return r.exportarExcel()}),c(31,"lucide-angular",16),i(32," Excel "),t()()()(),y(33,te,72,29),e(34,"div",17)(35,"div",18)(36,"table",19)(37,"thead",20)(38,"tr")(39,"th",21),i(40,"ID Cont."),t(),e(41,"th",21),i(42,"ID Orig."),t(),e(43,"th",21),i(44,"Documento"),t(),e(45,"th",21),i(46,"Cliente"),t(),e(47,"th",21),i(48,"Cartera"),t(),e(49,"th",22),i(50,"Monto Orig."),t(),e(51,"th",22),i(52,"Pagado Prev."),t(),e(53,"th",23),i(54,"Fecha Cont."),t(),e(55,"th",21),i(56,"Asesor"),t(),e(57,"th",22),i(58,"Monto Cont."),t(),e(59,"th",23),i(60,"Estado"),t(),e(61,"th",22),i(62,"Pagado"),t(),e(63,"th",22),i(64,"Pendiente"),t(),e(65,"th",23),i(66,"% Avance"),t()()(),e(67,"tbody",24),y(68,ie,5,1,"tr")(69,ne,7,1,"tr")(70,re,2,0),t()()(),y(71,de,6,1,"div",25),t()()),p&2&&(n(3),g("size",28),n(9),S("ngModel",r.filtros.fechaDesde),n(4),S("ngModel",r.filtros.fechaHasta),n(4),S("ngModel",r.filtros.idCartera),n(4),S("ngModel",r.filtros.idSubcartera),n(2),g("disabled",r.loading()),n(),h(r.loading()?27:28),n(3),g("disabled",r.loading()||r.data().length===0),n(),g("size",18),n(2),h(r.metricas()?33:-1),n(35),h(r.loading()?68:r.data().length===0?69:70),n(3),h(r.data().length>0?71:-1))},dependencies:[N,J,V,q,G,$,H,F,L,j,W],encapsulation:2});let d=m;return d})();export{ve as ContinuidadReportComponent};
