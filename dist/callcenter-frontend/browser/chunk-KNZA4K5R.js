import{a as _e}from"./chunk-RJ3LZGQL.js";import{a as xe,b as Ce}from"./chunk-4SH3ABNN.js";import{a as he}from"./chunk-TATL7MOR.js";import{a as ge}from"./chunk-VVSSGT66.js";import{E as fe,b as le,c as de,f as se,k as ce,s as me,t as ue,u as pe}from"./chunk-2YC26MZ7.js";import{pc as ae,qc as oe}from"./chunk-YLTLMO6P.js";import{a as re}from"./chunk-YQKVMPSG.js";import{c as ne}from"./chunk-LYMJIISJ.js";import{Ea as Q,Fb as h,Gb as b,Gc as j,Hb as Y,Jb as F,Kb as V,Lb as m,Mb as n,Nb as a,Ob as g,Vb as H,Xb as S,Zb as u,bb as l,bc as J,ca as q,cc as K,dc as ee,g as P,ga as U,ha as G,hb as O,ic as te,kc as B,lc as d,mc as M,md as ie,na as x,nc as N,oa as C,ob as Z,oc as $,qc as E,rc as T,sc as D,tc as X,v as R,xa as w}from"./chunk-BMTIWWAP.js";var be=(()=>{let s=class s{constructor(t){this.http=t,this.baseUrl=`${re.tipificacionUrl}/system-config/field-definitions`}getAllActive(){return this.http.get(this.baseUrl)}getByCategory(t){return this.http.get(`${this.baseUrl}/category/${t}`)}getByDataType(t){return this.http.get(`${this.baseUrl}/data-type/${t}`)}getById(t){return this.http.get(`${this.baseUrl}/${t}`)}getByFieldCode(t){return this.http.get(`${this.baseUrl}/code/${t}`)}countActiveFields(){return this.http.get(`${this.baseUrl}/count`)}};s.\u0275fac=function(e){return new(e||s)(U(ne))},s.\u0275prov=q({token:s,factory:s.\u0275fac,providedIn:"root"});let o=s;return o})();var we=["downloadButton"],W=(o,s)=>s.id,Ee=(o,s)=>s.headerName;function Te(o,s){if(o&1&&(n(0,"option",15),d(1),a()),o&2){let r=s.$implicit;m("value",r.id),l(),M(r.tenantName)}}function De(o,s){if(o&1&&(n(0,"option",15),d(1),a()),o&2){let r=s.$implicit;m("value",r.id),l(),M(r.portfolioName)}}function Me(o,s){if(o&1&&(n(0,"option",15),d(1),a()),o&2){let r=s.$implicit;m("value",r.id),l(),M(r.subPortfolioName)}}function He(o,s){if(o&1&&(n(0,"div",42),g(1,"lucide-angular",46),n(2,"span",47),d(3),a(),n(4,"span",48),d(5,"cabecera(s)"),a()()),o&2){let r=u(2);l(),m("size",14),l(2),M(r.previewHeaders().length)}}function Ie(o,s){if(o&1){let r=H();n(0,"div",49),S("click",function(){x(r);let e=u(2);return C(e.downloadMenuOpen.set(!1))}),a(),n(1,"div",50)(2,"button",51),S("click",function(){x(r);let e=u(2);return C(e.downloadCSVTemplate())}),g(3,"lucide-angular",52),n(4,"span",53),d(5,"Descargar CSV"),a()(),n(6,"button",51),S("click",function(){x(r);let e=u(2);return C(e.downloadExcelTemplate())}),g(7,"lucide-angular",54),n(8,"span",53),d(9,"Descargar Excel (.xlsx)"),a()()()}if(o&2){let r=u(2);l(),te("top",r.dropdownPosition().top,"px")("left",r.dropdownPosition().left,"px"),l(2),m("size",16),l(4),m("size",16)}}function Ae(o,s){o&1&&(g(0,"lucide-angular",58),n(1,"span"),d(2,"Guardando..."),a()),o&2&&m("size",16)}function Ne(o,s){o&1&&(g(0,"lucide-angular",59),n(1,"span"),d(2,"Guardar"),a()),o&2&&m("size",16)}function Pe(o,s){if(o&1){let r=H();n(0,"div",43)(1,"button",55),S("click",function(){x(r);let e=u(2);return C(e.clearAll())}),g(2,"lucide-angular",56),n(3,"span"),d(4,"Limpiar"),a()(),n(5,"button",57),S("click",function(){x(r);let e=u(2);return C(e.confirmConfiguration())}),h(6,Ae,3,1)(7,Ne,3,1),a()()}if(o&2){let r=u(2);l(2),m("size",14),l(3),m("disabled",r.isSaving()),l(),b(r.isSaving()?6:7)}}function Fe(o,s){o&1&&(n(0,"div",44)(1,"div",60),g(2,"lucide-angular",61),a(),n(3,"p",62),d(4,"No hay cabeceras configuradas"),a()()),o&2&&(l(2),m("size",24))}function Ve(o,s){o&1&&g(0,"lucide-angular",71),o&2&&m("size",12)}function ze(o,s){o&1&&(n(0,"span",72),d(1,"NUEVO"),a())}function Le(o,s){if(o&1&&g(0,"lucide-angular",74),o&2){let r=u().$implicit;m("title",X("Campo transformado mediante expresi\xF3n regular desde: ",r.sourceField))("size",12)}}function ke(o,s){o&1&&(n(0,"span",77),d(1,"Sin asociar"),a())}function Oe(o,s){if(o&1&&(n(0,"span",78),d(1),a()),o&2){let r=u().$implicit,t=u(3);l(),M(t.getFieldCodeById(r.fieldDefinitionId))}}function We(o,s){o&1&&g(0,"lucide-angular",80),o&2&&m("size",14)}function Re(o,s){o&1&&g(0,"lucide-angular",81),o&2&&m("size",14)}function Be(o,s){if(o&1&&(n(0,"span",88),d(1),a()),o&2){let r=u(2).$index,t=u(3);l(),N(" ",t.getAliasCount(r)," ")}}function $e(o,s){if(o&1){let r=H();n(0,"button",86),S("click",function(){x(r);let e=u().$index,i=u(3);return C(i.openAliasDialog(e))}),g(1,"lucide-angular",87),h(2,Be,2,1,"span",88),a()}if(o&2){let r=u().$index,t=u(3);l(),m("size",14),l(),b(t.getAliasCount(r)>0?2:-1)}}function Xe(o,s){if(o&1){let r=H();n(0,"tr",68)(1,"td",69)(2,"div",70),h(3,Ve,1,1,"lucide-angular",71)(4,ze,2,0,"span",72),n(5,"span",73),d(6),a(),h(7,Le,1,3,"lucide-angular",74),a()(),n(8,"td",69)(9,"span",75),d(10),a()(),n(11,"td",69)(12,"span",76),d(13),a()(),n(14,"td",69),h(15,ke,2,0,"span",77)(16,Oe,2,1,"span",78),a(),n(17,"td",69)(18,"span",9),d(19),a()(),n(20,"td",79),h(21,We,1,1,"lucide-angular",80)(22,Re,1,1,"lucide-angular",81),a(),n(23,"td",69)(24,"div",70)(25,"button",82),S("click",function(){let e=x(r).$index,i=u(3);return C(i.editPreviewHeader(e))}),g(26,"lucide-angular",83),a(),h(27,$e,3,2,"button",84),n(28,"button",85),S("click",function(){let e=x(r).$index,i=u(3);return C(i.removePreviewHeader(e))}),g(29,"lucide-angular",56),a()()()()}if(o&2){let r=s.$implicit,t=s.$index,e=u(3);l(3),b(r.id?3:4),l(3),M(r.headerName),l(),b(r.sourceField&&r.regexPattern?7:-1),l(2),B(e.getDataTypeBadgeClass(r.dataType)),l(),N(" ",r.dataType," "),l(3),M(r.displayLabel),l(2),b(r.fieldDefinitionId===0?15:16),l(4),M(r.format||"-"),l(2),b(r.required?21:22),l(5),m("size",14),l(),b(e.canManageAlias(t)?27:-1),l(2),m("size",14)}}function je(o,s){if(o&1&&(n(0,"div",45)(1,"table",63)(2,"thead",64)(3,"tr")(4,"th",65),d(5,"Nombre"),a(),n(6,"th",65),d(7,"Tipo"),a(),n(8,"th",65),d(9,"Etiqueta"),a(),n(10,"th",65),d(11,"Campo Cat\xE1logo"),a(),n(12,"th",65),d(13,"Formato"),a(),n(14,"th",66),d(15,"Req."),a(),n(16,"th",65),d(17,"Acciones"),a()()(),n(18,"tbody",67),F(19,Xe,30,13,"tr",68,Y),a()()()),o&2){let r=u(2);l(19),V(r.previewHeaders())}}function qe(o,s){if(o&1){let r=H();n(0,"div",4)(1,"div",23)(2,"div",24)(3,"div",25)(4,"div",26)(5,"button",27,0),S("click",function(){x(r);let e=u();return C(e.toggleDownloadMenu())}),g(7,"lucide-angular",28),n(8,"span",29),d(9,"Descargar Plantilla"),a(),n(10,"span",30),d(11,"Plantilla"),a(),g(12,"lucide-angular",31),a()(),n(13,"select",32),D("ngModelChange",function(e){x(r);let i=u();return T(i.csvSeparator,e)||(i.csvSeparator=e),C(e)}),n(14,"option",33),d(15,"Separador: Punto y coma (;)"),a(),n(16,"option",34),d(17,"Separador: Coma (,)"),a(),n(18,"option",35),d(19,"Separador: Pipe (|)"),a(),n(20,"option",36),d(21,"Separador: Tabulaci\xF3n (Tab)"),a()(),n(22,"label",37),g(23,"lucide-angular",38),n(24,"span",29),d(25,"Importar CSV/Excel"),a(),n(26,"span",30),d(27,"Importar"),a(),n(28,"input",39),S("change",function(e){x(r);let i=u();return C(i.onFileSelected(e))}),a()(),n(29,"button",40),S("click",function(){x(r);let e=u();return C(e.openManualDialog())}),g(30,"lucide-angular",41),n(31,"span",29),d(32,"Agregar Cabecera"),a(),n(33,"span",30),d(34,"Agregar"),a()(),h(35,He,6,2,"div",42),a(),h(36,Ie,10,6),h(37,Pe,8,3,"div",43),a()()(),n(38,"div")(39,"div",23),h(40,Fe,5,1,"div",44)(41,je,21,0,"div",45),a()()}if(o&2){let r=u();l(7),m("size",16),l(5),m("name",r.downloadMenuOpen()?"chevron-up":"chevron-down")("size",14),l(),E("ngModel",r.csvSeparator),l(10),m("size",16),l(7),m("size",16),l(5),b(r.previewHeaders().length>0?35:-1),l(),b(r.downloadMenuOpen()?36:-1),l(),b(r.previewHeaders().length>0?37:-1),l(3),b(r.previewHeaders().length===0?40:41)}}function Ue(o,s){o&1&&g(0,"lucide-angular",103),o&2&&m("size",12)}function Ge(o,s){if(o&1&&(n(0,"option",15),d(1),a()),o&2){let r=s.$implicit;m("value",r.id),l(),$(" ",r.fieldName," (",r.fieldCode,") ")}}function Qe(o,s){o&1&&d(0," La asociaci\xF3n al cat\xE1logo no puede cambiarse en cabeceras existentes. ")}function Ze(o,s){o&1&&d(0,' Seleccione un campo del cat\xE1logo o deje "Sin asociar" para crear un campo personalizado. ')}function Ye(o,s){if(o&1&&(n(0,"div",9)(1,"span",124),d(2,"Descripci\xF3n:"),a(),d(3),a()),o&2){let r=u();l(3),N(" ",r.description," ")}}function Je(o,s){if(o&1&&(n(0,"div",9)(1,"span",124),d(2,"Formato del Sistema:"),a(),n(3,"code",125),d(4),a()()),o&2){let r=u();l(4),M(r.format)}}function Ke(o,s){if(o&1&&(n(0,"div",106)(1,"p",122),d(2,"\u{1F4CB} Informaci\xF3n del Cat\xE1logo"),a(),n(3,"div",5)(4,"span",9),d(5,"Tipo de Dato:"),a(),n(6,"span",123),d(7),a()(),h(8,Ye,4,1,"div",9),h(9,Je,5,1,"div",9),a()),o&2){let r=s,t=u(2);l(6),B(t.getDataTypeBadgeClass(r.dataType)),l(),N(" ",r.dataType," "),l(),b(r.description?8:-1),l(),b(r.format?9:-1)}}function et(o,s){o&1&&(n(0,"div",107)(1,"div",126),g(2,"lucide-angular",127),n(3,"div")(4,"p",128),d(5,"Cabecera existente en base de datos"),a(),n(6,"p",129),d(7," El nombre del campo y tipo de dato no pueden modificarse porque la columna ya existe en la tabla. Solo puede editar: etiqueta visual, formato y obligatoriedad. "),a()()()()),o&2&&(l(2),m("size",16))}function tt(o,s){o&1&&g(0,"lucide-angular",103),o&2&&m("size",12)}function it(o,s){o&1&&d(0," El tipo de dato no puede cambiarse en cabeceras existentes. ")}function nt(o,s){o&1&&d(0," Seleccione el tipo de dato para este campo personalizado. ")}function at(o,s){if(o&1){let r=H();n(0,"div")(1,"label",101),g(2,"lucide-angular",130),d(3," Tipo de Dato * "),h(4,tt,1,1,"lucide-angular",103),a(),n(5,"select",104),D("ngModelChange",function(e){x(r);let i=u(2);return T(i.formData.dataType,e)||(i.formData.dataType=e),C(e)}),n(6,"option",131),d(7,"TEXTO"),a(),n(8,"option",132),d(9,"NUMERICO"),a(),n(10,"option",133),d(11,"FECHA"),a()(),n(12,"p",105),h(13,it,1,0)(14,nt,1,0),a()()}if(o&2){let r=u(2);l(2),m("size",16),l(2),b(r.formData.id?4:-1),l(),E("ngModel",r.formData.dataType),m("disabled",!!r.formData.id),l(8),b(r.formData.id?13:14)}}function ot(o,s){o&1&&g(0,"lucide-angular",103),o&2&&m("size",12)}function rt(o,s){o&1&&d(0," El nombre del campo no puede cambiarse en cabeceras existentes. ")}function lt(o,s){o&1&&d(0," Nombre de la cabecera tal como viene del proveedor. ")}function dt(o,s){if(o&1&&(n(0,"option",15),d(1),a()),o&2){let r=s.$implicit;m("value",r.headerName),l(),$(" ",r.headerName," - ",r.displayLabel," ")}}function st(o,s){o&1&&(n(0,"span",140),d(1,"*"),a())}function ct(o,s){if(o&1){let r=H();n(0,"p",134),d(1," Si este campo se deriva de otro campo mediante regex, config\xFAralo aqu\xED."),g(2,"br"),d(3," Ejemplo: extraer documento desde IDENTITY_CODE. "),a(),n(4,"div",135)(5,"div")(6,"label",101),g(7,"lucide-angular",136),d(8," Campo Origen "),a(),n(9,"select",137),D("ngModelChange",function(e){x(r);let i=u(2);return T(i.formData.sourceField,e)||(i.formData.sourceField=e),C(e)}),n(10,"option",138),d(11,"Seleccione un campo origen..."),a(),F(12,dt,2,3,"option",15,Ee),a(),n(14,"p",105),d(15," Campo desde donde se extraer\xE1 el valor mediante regex. "),a()(),n(16,"div")(17,"label",101),g(18,"lucide-angular",139),d(19," Patr\xF3n Regex "),h(20,st,2,0,"span",140),a(),n(21,"input",141),D("ngModelChange",function(e){x(r);let i=u(2);return T(i.formData.regexPattern,e)||(i.formData.regexPattern=e),C(e)}),a(),n(22,"p",105),d(23," Ejemplos: "),n(24,"code",142),d(25),a(),d(26," \xFAltimos 8 \u2022 "),n(27,"code",142),d(28),a(),d(29," 8 d\xEDgitos "),a()()()}if(o&2){let r=u(2);l(7),m("size",16),l(2),E("ngModel",r.formData.sourceField),l(3),V(r.availableSourceHeaders()),l(6),m("size",16),l(2),b(r.formData.sourceField&&r.formData.sourceField.trim()!==""?20:-1),l(),m("placeholder",X("Ej: .",8,"$ (\xFAltimos 8 caracteres)")),E("ngModel",r.formData.regexPattern),l(4),N(".",8,"$"),l(3),N("\\d",8)}}function mt(o,s){if(o&1){let r=H();n(0,"div",22)(1,"div",89)(2,"div",90)(3,"div",91)(4,"div",92)(5,"div",93),g(6,"lucide-angular",94),a(),n(7,"div")(8,"h2",95),d(9),a(),n(10,"p",96),d(11,"Complete la informaci\xF3n de la cabecera"),a()()(),n(12,"button",97),S("click",function(){x(r);let e=u();return C(e.closeManualDialog())}),g(13,"lucide-angular",98),a()()(),n(14,"div",99)(15,"div",100)(16,"div")(17,"label",101),g(18,"lucide-angular",102),d(19," Campo Base de Datos (Opcional) "),h(20,Ue,1,1,"lucide-angular",103),a(),n(21,"select",104),D("ngModelChange",function(e){x(r);let i=u();return T(i.formData.fieldDefinitionId,e)||(i.formData.fieldDefinitionId=e),C(e)}),S("ngModelChange",function(){x(r);let e=u();return C(e.onFieldDefinitionSelect())}),n(22,"option",15),d(23,"Sin asociar - Campo personalizado"),a(),F(24,Ge,2,3,"option",15,W),a(),n(26,"p",105),h(27,Qe,1,0)(28,Ze,1,0),a()(),h(29,Ke,10,5,"div",106),h(30,et,8,1,"div",107),h(31,at,15,5,"div"),n(32,"div")(33,"label",101),g(34,"lucide-angular",108),d(35," Campo Sistema * "),h(36,ot,1,1,"lucide-angular",103),a(),n(37,"input",109),D("ngModelChange",function(e){x(r);let i=u();return T(i.formData.headerName,e)||(i.formData.headerName=e),C(e)}),a(),n(38,"p",105),h(39,rt,1,0)(40,lt,1,0),a()(),n(41,"div")(42,"label",101),g(43,"lucide-angular",110),d(44," Etiqueta Visual * "),a(),n(45,"input",111),D("ngModelChange",function(e){x(r);let i=u();return T(i.formData.displayLabel,e)||(i.formData.displayLabel=e),C(e)}),a(),n(46,"p",105),d(47," Texto que se mostrar\xE1 en la interfaz de usuario. "),a()(),n(48,"div")(49,"label",101),g(50,"lucide-angular",112),d(51," Formato "),a(),n(52,"input",113),D("ngModelChange",function(e){x(r);let i=u();return T(i.formData.format,e)||(i.formData.format=e),C(e)}),a(),n(53,"p",105),d(54," Formato espec\xEDfico para esta subcartera (opcional, puede diferir del formato del sistema). "),a()(),n(55,"div",92)(56,"input",114),D("ngModelChange",function(e){x(r);let i=u();return T(i.formData.required,e)||(i.formData.required=e),C(e)}),a(),n(57,"label",115),d(58," Campo obligatorio "),a()(),n(59,"div",116)(60,"button",117),S("click",function(){x(r);let e=u();return C(e.showTransformSection.set(!e.showTransformSection()))}),n(61,"div",5),g(62,"lucide-angular",118),d(63," Transformaci\xF3n de Campo (Opcional) "),a(),g(64,"lucide-angular",31),a(),h(65,ct,30,9),a()()(),n(66,"div",119)(67,"button",120),S("click",function(){x(r);let e=u();return C(e.closeManualDialog())}),d(68," Cancelar "),a(),n(69,"button",121),S("click",function(){x(r);let e=u();return C(e.saveManualHeader())}),d(70),a()()()()}if(o&2){let r,t=u();l(6),m("size",20),l(3),N("",t.editingIndex()!==null?"Editar":"Agregar"," Cabecera"),l(4),m("size",20),l(5),m("size",16),l(2),b(t.formData.id?20:-1),l(),E("ngModel",t.formData.fieldDefinitionId),m("disabled",!!t.formData.id),l(),m("value",0),l(2),V(t.availableFieldDefinitions()),l(3),b(t.formData.id?27:28),l(2),b((r=t.getSelectedFieldDefinition())?29:-1,r),l(),b(t.formData.id?30:-1),l(),b(t.formData.fieldDefinitionId===0?31:-1),l(3),m("size",16),l(2),b(t.formData.id?36:-1),l(),E("ngModel",t.formData.headerName),m("disabled",!!t.formData.id),l(2),b(t.formData.id?39:40),l(4),m("size",16),l(2),E("ngModel",t.formData.displayLabel),l(5),m("size",16),l(2),E("ngModel",t.formData.format),l(4),E("ngModel",t.formData.required),l(6),m("size",16),l(2),m("name",t.showTransformSection()?"chevron-up":"chevron-down")("size",16),l(),b(t.showTransformSection()?65:-1),l(4),m("disabled",!t.canSaveManualHeader()),l(),N(" ",t.editingIndex()!==null?"Actualizar":"Agregar"," ")}}function ut(o,s){o&1&&(n(0,"div",157),g(1,"lucide-angular",162),n(2,"p",150),d(3,"Cargando alias..."),a()()),o&2&&(l(),m("size",24))}function pt(o,s){o&1&&(n(0,"div",158),g(1,"lucide-angular",163),n(2,"p",150),d(3,"No hay alias configurados"),a()()),o&2&&(l(),m("size",24))}function ft(o,s){o&1&&(n(0,"span",167),d(1,"Principal"),a())}function gt(o,s){if(o&1){let r=H();n(0,"button",169),S("click",function(){x(r);let e=u().$implicit,i=u(3);return C(i.removeAlias(e))}),g(1,"lucide-angular",56),a()}o&2&&(l(),m("size",14))}function _t(o,s){if(o&1&&(n(0,"div",164)(1,"div",5),g(2,"lucide-angular",165),n(3,"span",166),d(4),a(),h(5,ft,2,0,"span",167),a(),h(6,gt,2,1,"button",168),a()),o&2){let r=s.$implicit;l(2),m("size",14),l(2),M(r.alias),l(),b(r.isPrincipal?5:-1),l(),b(r.isPrincipal?-1:6)}}function xt(o,s){if(o&1&&(n(0,"div",159),F(1,_t,7,4,"div",164,W),a()),o&2){let r=u(2);l(),V(r.aliases())}}function Ct(o,s){if(o&1){let r=H();n(0,"div",22)(1,"div",143)(2,"div",144)(3,"div",91)(4,"div",92)(5,"div",93),g(6,"lucide-angular",87),a(),n(7,"div")(8,"h2",95),d(9,"Gestionar Alias"),a(),n(10,"p",145),d(11),a()()(),n(12,"button",97),S("click",function(){x(r);let e=u();return C(e.closeAliasDialog())}),g(13,"lucide-angular",98),a()()(),n(14,"div",146)(15,"div",147)(16,"p",148),d(17,"Nombre principal de la cabecera"),a(),n(18,"p",149),d(19),a(),n(20,"p",150),d(21,"Los alias permiten que el sistema reconozca columnas del Excel aunque tengan nombres diferentes."),a()(),n(22,"div",151)(23,"label",101),g(24,"lucide-angular",152),d(25," Agregar nuevo alias "),a(),n(26,"div",153)(27,"input",154),S("ngModelChange",function(e){x(r);let i=u();return C(i.newAliasName.set(e))})("keyup.enter",function(){x(r);let e=u();return C(e.addAlias())}),a(),n(28,"button",155),S("click",function(){x(r);let e=u();return C(e.addAlias())}),d(29," Agregar "),a()()(),n(30,"div")(31,"label",101),g(32,"lucide-angular",156),d(33," Alias configurados "),a(),h(34,ut,4,1,"div",157)(35,pt,4,1,"div",158)(36,xt,3,0,"div",159),a()(),n(37,"div",160)(38,"button",161),S("click",function(){x(r);let e=u();return C(e.closeAliasDialog())}),d(39," Cerrar "),a()()()()}if(o&2){let r,t,e=u();l(6),m("size",20),l(5),M((r=e.selectedHeaderForAlias())==null?null:r.headerName),l(2),m("size",20),l(6),M((t=e.selectedHeaderForAlias())==null?null:t.headerName),l(5),m("size",14),l(3),m("ngModel",e.newAliasName()),l(),m("disabled",!e.newAliasName().trim()),l(4),m("size",14),l(2),b(e.loadingAliases()?34:e.aliases().length===0?35:36)}}var Vt=(()=>{let s=class s{constructor(t,e,i,p){this.headerConfigService=t,this.fieldDefinitionService=e,this.typificationService=i,this.portfolioService=p,this.notificationService=G(xe),this.tenants=w([]),this.portfolios=w([]),this.subPortfolios=w([]),this.fieldDefinitions=w([]),this.previewHeaders=w([]),this.showManualDialog=w(!1),this.editingIndex=w(null),this.downloadMenuOpen=w(!1),this.showTransformSection=w(!1),this.dropdownPosition=w({top:120,left:100}),this.headersAreSaved=w(!1),this.isLoading=w(!1),this.isSaving=w(!1),this.showAliasDialog=w(!1),this.selectedHeaderForAlias=w(null),this.aliases=w([]),this.newAliasName=w(""),this.loadingAliases=w(!1),this.savedHeaders=w([]),this.availableFieldDefinitions=j(()=>{let f=this.previewHeaders().map(y=>y.fieldDefinitionId),c=this.formData.fieldDefinitionId,_=this.editingIndex();return this.fieldDefinitions().filter(y=>_!==null&&y.id===c?!0:!f.includes(y.id))}),this.availableSourceHeaders=j(()=>{let f=this.formData.headerName;return this.previewHeaders().filter(c=>!(c.sourceField&&c.regexPattern||c.headerName===f))}),this.selectedTenantId=0,this.selectedPortfolioId=0,this.selectedSubPortfolioId=0,this.selectedLoadType="ACTUALIZACION",this.csvSeparator=";",this.formData={id:void 0,fieldDefinitionId:0,headerName:"",dataType:"TEXTO",displayLabel:"",format:"",required:!1,sourceField:"",regexPattern:"",hasData:!1}}ngOnInit(){this.loadTenants(),this.loadFieldDefinitions()}loadFieldDefinitions(){this.fieldDefinitionService.getAllActive().subscribe({next:t=>{this.fieldDefinitions.set(t)},error:t=>{console.error("Error al cargar definiciones de campos:",t)}})}loadTenants(){this.typificationService.getAllTenants().subscribe({next:t=>{this.tenants.set(t)},error:t=>{console.error("Error loading tenants:",t)}})}onTenantChange(){this.selectedPortfolioId=0,this.selectedSubPortfolioId=0,this.portfolios.set([]),this.subPortfolios.set([]),this.previewHeaders.set([]),this.selectedTenantId>0&&this.loadPortfolios()}onPortfolioChange(){this.selectedSubPortfolioId=0,this.subPortfolios.set([]),this.previewHeaders.set([]),this.selectedPortfolioId>0&&this.loadSubPortfolios()}onSubPortfolioChange(){this.previewHeaders.set([]),this.headersAreSaved.set(!1),this.selectedSubPortfolioId>0&&this.loadExistingHeaders()}onLoadTypeChange(){this.previewHeaders.set([]),this.headersAreSaved.set(!1),this.selectedSubPortfolioId>0&&this.loadExistingHeaders()}loadPortfolios(){this.portfolioService.getPortfoliosByTenant(this.selectedTenantId).subscribe({next:t=>{this.portfolios.set(t)},error:t=>{console.error("Error loading portfolios:",t)}})}loadSubPortfolios(){this.portfolioService.getSubPortfoliosByPortfolio(this.selectedPortfolioId).subscribe({next:t=>{this.subPortfolios.set(t)},error:t=>{console.error("Error loading subportfolios:",t)}})}loadExistingHeaders(){this.headerConfigService.getBySubPortfolioAndLoadType(this.selectedSubPortfolioId,this.selectedLoadType).subscribe({next:t=>{this.savedHeaders.set(t);let e=t.map(i=>({id:i.id,fieldDefinitionId:i.fieldDefinitionId,headerName:i.headerName,dataType:i.dataType,displayLabel:i.displayLabel,format:i.format,required:i.required,sourceField:i.sourceField,regexPattern:i.regexPattern,hasData:!0}));this.previewHeaders.set(e),this.headersAreSaved.set(t.length>0)},error:t=>{console.error("Error loading headers:",t),this.headersAreSaved.set(!1),this.savedHeaders.set([])}})}openManualDialog(){this.editingIndex.set(null),this.formData={id:void 0,fieldDefinitionId:0,headerName:"",dataType:"TEXTO",displayLabel:"",format:"",required:!1,sourceField:"",regexPattern:"",hasData:!1},this.showTransformSection.set(!1),this.showManualDialog.set(!0)}onFieldDefinitionSelect(){let t=this.formData.fieldDefinitionId;if(t===0){this.formData.dataType="TEXTO";return}let e=this.fieldDefinitions().find(i=>i.id===t);e&&(this.formData.dataType=e.dataType)}getSelectedFieldDefinition(){let t=this.formData.fieldDefinitionId;return t===0?null:this.fieldDefinitions().find(e=>e.id===t)}closeManualDialog(){this.showManualDialog.set(!1),this.editingIndex.set(null)}canSaveManualHeader(){return!this.formData.headerName.trim()||!this.formData.displayLabel.trim()||this.formData.sourceField&&this.formData.sourceField.trim()!==""&&(!this.formData.regexPattern||this.formData.regexPattern.trim()==="")?!1:this.formData.fieldDefinitionId===0?!!this.formData.dataType&&["TEXTO","NUMERICO","FECHA"].includes(this.formData.dataType):!0}saveManualHeader(){if(!this.canSaveManualHeader())return;let t=this.editingIndex(),e={id:this.formData.id,fieldDefinitionId:this.formData.fieldDefinitionId,headerName:this.formData.headerName.trim(),dataType:this.formData.dataType,displayLabel:this.formData.displayLabel.trim(),format:this.formData.format?.trim()||void 0,required:this.formData.required,sourceField:this.formData.sourceField?.trim()||void 0,regexPattern:this.formData.regexPattern?.trim()||void 0,hasData:this.formData.hasData};if(t!==null){let i=[...this.previewHeaders()];i[t]=e,this.previewHeaders.set(i)}else{let i=[...this.previewHeaders()];i.push(e),this.previewHeaders.set(i)}this.closeManualDialog()}editPreviewHeader(t){let e=this.previewHeaders()[t];this.editingIndex.set(t),this.formData={id:e.id,fieldDefinitionId:e.fieldDefinitionId,headerName:e.headerName,dataType:e.dataType,displayLabel:e.displayLabel,format:e.format||"",required:e.required||!1,sourceField:e.sourceField||"",regexPattern:e.regexPattern||"",hasData:e.hasData||!1},this.showTransformSection.set(!!(e.sourceField||e.regexPattern)),this.showManualDialog.set(!0)}removePreviewHeader(t){return P(this,null,function*(){let e=this.previewHeaders()[t];if(e.id&&!(yield this.notificationService.confirm({title:"Eliminar cabecera",message:`La cabecera "${e.headerName}" ya existe en la base de datos.

Si la tabla tiene datos, la eliminaci\xF3n ser\xE1 rechazada por el servidor.`,confirmText:"Eliminar",cancelText:"Cancelar",type:"warning"})))return;let i=[...this.previewHeaders()];i.splice(t,1),this.previewHeaders.set(i),this.notificationService.info("Cabecera removida","Recuerde guardar los cambios")})}clearAll(){return P(this,null,function*(){let t=this.headersAreSaved();(yield this.notificationService.confirm({title:t?"Eliminar todas las cabeceras":"Limpiar vista",message:t?"Esto eliminar\xE1 las cabeceras guardadas en la base de datos. Esta acci\xF3n no se puede deshacer.":"\xBFEst\xE1 seguro de limpiar todas las cabeceras de la vista?",confirmText:t?"Eliminar todo":"Limpiar",cancelText:"Cancelar",type:t?"danger":"warning"}))&&(t?(this.isLoading.set(!0),this.headerConfigService.deleteAllBySubPortfolioAndLoadType(this.selectedSubPortfolioId,this.selectedLoadType).subscribe({next:()=>{this.previewHeaders.set([]),this.savedHeaders.set([]),this.headersAreSaved.set(!1),this.isLoading.set(!1),this.notificationService.success("Cabeceras eliminadas","Todas las cabeceras han sido eliminadas exitosamente")},error:i=>{console.error("Error al eliminar cabeceras:",i),this.isLoading.set(!1),this.notificationService.error("Error al eliminar",i.error?.message||i.message)}})):(this.previewHeaders.set([]),this.notificationService.info("Vista limpiada","Se han removido todas las cabeceras de la vista")))})}confirmConfiguration(){return P(this,null,function*(){if(this.previewHeaders().length===0){this.notificationService.warning("Sin cabeceras","No hay cabeceras para guardar");return}let t=this.previewHeaders(),e=t.filter(y=>!y.id),i=t.filter(y=>y.id),p=new Set(t.filter(y=>y.id).map(y=>y.id)),f=this.savedHeaders().filter(y=>!p.has(y.id));if(e.length===0&&i.length===0&&f.length===0){this.notificationService.info("Sin cambios","No hay cambios pendientes para guardar");return}let c=[];e.length>0&&c.push(`${e.length} cabecera(s) nueva(s)`),i.length>0&&c.push(`${i.length} cabecera(s) actualizada(s)`),f.length>0&&(c.push(`${f.length} cabecera(s) a eliminar:`),f.forEach(y=>c.push(`  \u2022 ${y.headerName}`))),(yield this.notificationService.confirm({title:"Guardar configuraci\xF3n",message:f.length>0?`Se guardar\xE1n los cambios en la configuraci\xF3n de cabeceras.

Si alguna cabecera a eliminar tiene datos, la eliminaci\xF3n fallar\xE1.`:"Se guardar\xE1n los cambios en la configuraci\xF3n de cabeceras.",confirmText:"Guardar",cancelText:"Cancelar",type:f.length>0?"warning":"info",details:c}))&&this.saveConfigurationWithSmartLogic(e,i,f)})}saveConfigurationWithSmartLogic(t,e,i){return P(this,null,function*(){this.isSaving.set(!0);let p=[],f=[];try{for(let c of i)try{yield R(this.headerConfigService.delete(c.id))}catch(_){let y=_?.error?.message||_?.message||"Error desconocido";f.push(`${c.headerName}: ${y}`)}for(let c of e)if(c.id)try{yield R(this.headerConfigService.update(c.id,{displayLabel:c.displayLabel,format:c.format,required:c.required}))}catch(_){p.push(`${c.headerName}: ${_?.error?.message||_?.message}`)}if(t.length>0)try{let c={subPortfolioId:this.selectedSubPortfolioId,loadType:this.selectedLoadType,headers:t.map(_=>({fieldDefinitionId:_.fieldDefinitionId,headerName:_.headerName,dataType:_.dataType,displayLabel:_.displayLabel,format:_.format,required:_.required,sourceField:_.sourceField,regexPattern:_.regexPattern}))};yield R(this.headerConfigService.createBulk(c))}catch(c){p.push(`Creaci\xF3n en lote: ${c?.error?.message||c?.message}`)}if(f.length>0){let c=f.join(`
\u2022 `);this.notificationService.warning("Algunas cabeceras no se eliminaron",`Las siguientes cabeceras no pudieron eliminarse (probablemente tienen datos):
\u2022 ${c}`)}if(p.length>0){let c=p.join(`
\u2022 `);this.notificationService.error("Errores durante el guardado",`\u2022 ${c}`)}f.length===0&&p.length===0?this.notificationService.success("Configuraci\xF3n guardada","Todos los cambios se aplicaron exitosamente"):p.length===0&&f.length>0&&this.notificationService.info("Guardado parcial","El resto de la configuraci\xF3n se guard\xF3 correctamente")}finally{this.isSaving.set(!1),this.loadExistingHeaders()}})}onFileSelected(t){let e=t.target.files[0];if(!e)return;let i=e.name.toLowerCase();if(i.endsWith(".xlsx")||i.endsWith(".xls"))this.parseExcel(e);else{let f=new FileReader;f.onload=c=>{let _=c.target.result;this.parseCSV(_)},f.readAsText(e)}t.target.value=""}parseExcel(t){let e=new FileReader;e.onload=i=>P(this,null,function*(){try{window.XLSX||(this.notificationService.info("Cargando soporte Excel","Por favor espere..."),yield this.loadXLSXLibrary());let p=window.XLSX,f=new Uint8Array(i.target.result),c=p.read(f,{type:"array"}),_=c.SheetNames[0],y=c.Sheets[_],L=p.utils.sheet_to_csv(y,{FS:this.csvSeparator});this.parseCSV(L)}catch(p){console.error("Error al procesar Excel:",p),this.notificationService.error("Error al procesar Excel","Verifique que el formato del archivo sea correcto")}}),e.readAsArrayBuffer(t)}loadXLSXLibrary(){return new Promise((t,e)=>{if(window.XLSX){t();return}let i=document.createElement("script");i.src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js",i.onload=()=>t(),i.onerror=()=>e(new Error("No se pudo cargar la librer\xEDa XLSX")),document.head.appendChild(i)})}parseCsvLine(t,e){let i=[],p="",f=!1;for(let c=0;c<t.length;c++){let _=t[c];_==='"'?f=!f:_===e&&!f?(i.push(p.trim()),p=""):p+=_}return i.push(p.trim()),i.map(c=>c.startsWith('"')&&c.endsWith('"')?c.slice(1,-1):c)}detectDataType(t){let e=t.filter(c=>c&&c.trim()!=="");if(e.length===0)return{dataType:"TEXTO"};let i=[{regex:/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/,format:"yyyy-MM-dd HH:mm:ss"},{regex:/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/,format:"yyyy-MM-ddTHH:mm:ss"},{regex:/^\d{4}-\d{2}-\d{2}$/,format:"yyyy-MM-dd"},{regex:/^\d{2}\/\d{2}\/\d{4}$/,format:"dd/MM/yyyy"},{regex:/^\d{2}-\d{2}-\d{4}$/,format:"dd-MM-yyyy"},{regex:/^\d{4}\/\d{2}\/\d{2}$/,format:"yyyy/MM/dd"}];for(let c of i)if(e.filter(y=>c.regex.test(y.trim())).length>=e.length*.8)return{dataType:"FECHA",format:c.format};let p=/^-?\d+([.,]\d+)?$/;return e.filter(c=>{let _=c.trim().replace(/,/g,".");return p.test(_)}).length>=e.length*.8?{dataType:"NUMERICO",format:e.some(_=>_.includes(".")||_.includes(","))?"decimal(18,2)":void 0}:{dataType:"TEXTO"}}generateDisplayLabel(t){return t.toLowerCase().split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}parseCSV(t){let e=t.split(`
`).filter(v=>v.trim());if(e.length<2){this.notificationService.error("Archivo vac\xEDo","El archivo CSV est\xE1 vac\xEDo o no tiene datos");return}let i=this.parseCsvLine(e[0],this.csvSeparator);if(i.length===0){this.notificationService.error("Sin columnas","No se encontraron columnas en el archivo");return}let p=Math.min(5,e.length-1),f=i.map(()=>[]);for(let v=1;v<=p;v++)this.parseCsvLine(e[v],this.csvSeparator).forEach((z,I)=>{I<i.length&&f[I].push(z)});let c=[];for(let v=0;v<i.length;v++){let A=i[v].trim();if(!A)continue;let{dataType:z,format:I}=this.detectDataType(f[v]),k=this.generateDisplayLabel(A);c.push({fieldDefinitionId:0,headerName:A,dataType:z,displayLabel:k,format:I,required:!1})}if(c.length===0){this.notificationService.error("Sin cabeceras v\xE1lidas","No se encontraron cabeceras v\xE1lidas en el archivo");return}this.previewHeaders.set(c);let _=c.filter(v=>v.dataType==="FECHA").length,y=c.filter(v=>v.dataType==="NUMERICO").length,L=c.filter(v=>v.dataType==="TEXTO").length;this.notificationService.success(`${c.length} columnas detectadas`,`Tipos: ${_} fecha, ${y} num\xE9rico, ${L} texto
Revise y ajuste antes de guardar`)}toggleDownloadMenu(){if(this.downloadMenuOpen.update(t=>!t),this.downloadMenuOpen()&&this.downloadButton){let t=this.downloadButton.nativeElement.getBoundingClientRect();this.dropdownPosition.set({top:t.bottom+8,left:t.left})}}escapeCsvValue(t,e){return t?t.includes(e)||t.includes('"')||t.includes(`
`)||t.includes("\r")?`"${t.replace(/"/g,'""')}"`:t:""}createCsvRow(t,e){return t.map(i=>this.escapeCsvValue(i,e)).join(e)}downloadCSVTemplate(){this.downloadMenuOpen.set(!1);let t=this.csvSeparator,e;this.previewHeaders().length>0?(e=[["codigoCampo","nombreCabecera","etiquetaVisual","formato","tipoDato","obligatorio","campoAsociado","regEx"]],this.previewHeaders().forEach(v=>{let A=this.fieldDefinitions().find(I=>I.id===v.fieldDefinitionId),z=A?A.fieldCode:"";e.push([z,v.headerName,v.displayLabel,v.format||"",v.dataType||"",v.required?"1":"0",v.sourceField||"",v.regexPattern||""])})):e=[["codigoCampo","nombreCabecera","etiquetaVisual","formato","tipoDato","obligatorio","campoAsociado","regEx"],["documento","DNI","N\xFAmero de Documento","","TEXTO","1","",""],["nombre_completo","NOMBRE","Nombre del Cliente","","TEXTO","1","",""],["telefono_principal","TELEFONO","Tel\xE9fono Principal","","TEXTO","0","",""],["email","CORREO","Correo Electr\xF3nico","","TEXTO","0","",""],["monto_capital","MONTO_CAPITAL","Monto Capital (S/.)","decimal(18,2)","NUMERICO","1","",""],["fecha_vencimiento","FEC_VENC","Fecha de Vencimiento","dd/MM/yyyy","FECHA","1","",""],["","DOCUMENTO_EXTRAIDO","Documento Extra\xEDdo","","TEXTO","0","DNI",'"^D.*?(\\d{7})$|^C.*?(\\d{8})$"']];let p=e.map((v,A)=>{if(A===0)return this.createCsvRow(v,t);let z=v.slice(0,7),I=v[7]||"",k=this.createCsvRow(z,t);if(I&&I.trim()!==""){let ve=I.replace(/"/g,'""');k+=t+`"${ve}"`}else k+=t;return k}).join(`
`),f=new Blob([p],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a"),_=URL.createObjectURL(f),y=this.csvSeparator===","?"coma":this.csvSeparator===";"?"punto-coma":this.csvSeparator==="|"?"pipe":"tab",L=this.previewHeaders().length>0?`header-configuration-actual-${y}.csv`:`header-configuration-template-${y}.csv`;c.setAttribute("href",_),c.setAttribute("download",L),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),this.notificationService.success("Archivo descargado",this.previewHeaders().length>0?"Configuraci\xF3n actual exportada":"Plantilla CSV descargada")}downloadExcelTemplate(){return P(this,null,function*(){if(this.downloadMenuOpen.set(!1),!window.XLSX)try{this.notificationService.info("Cargando","Preparando soporte para Excel..."),yield this.loadXLSXLibrary()}catch{this.notificationService.error("Error","No se pudo cargar el soporte para Excel");return}let t=window.XLSX,e=[["codigoCampo","nombreCabecera","etiquetaVisual","formato","tipoDato"],["documento","DNI","N\xFAmero de Documento","",""],["nombre_completo","NOMBRE","Nombre del Cliente","",""],["telefono_principal","TELEFONO","Tel\xE9fono Principal","",""],["email","CORREO","Correo Electr\xF3nico","",""],["direccion","DIRECCION","Direcci\xF3n Completa","",""],["distrito","DISTRITO","Distrito","",""],["provincia","PROVINCIA","Provincia","",""],["numero_contrato","NRO_CONTRATO","N\xFAmero de Contrato","",""],["tipo_producto","PRODUCTO","Tipo de Producto","",""],["estado_cuenta","ESTADO","Estado de Cuenta","",""],["monto_capital","MONTO_CAPITAL","Monto Capital (S/.)","decimal(18,2)",""],["monto_interes","INTERES","Inter\xE9s (S/.)","decimal(18,2)",""],["saldo_pendiente","SALDO","Saldo Pendiente (S/.)","decimal(18,2)",""],["monto_mora","MORA","Monto Mora (S/.)","decimal(18,2)",""],["dias_mora","DIAS_MORA","D\xEDas de Mora","",""],["monto_minimo_pagar","PAGO_MINIMO","Monto M\xEDnimo a Pagar (S/.)","decimal(18,2)",""],["fecha_vencimiento","FEC_VENC","Fecha de Vencimiento","dd/MM/yyyy",""],["fecha_desembolso","FEC_DESEMB","Fecha de Desembolso","dd/MM/yyyy",""],["fecha_proximo_vencimiento","FEC_PROX_VENC","Fecha Pr\xF3ximo Vencimiento","dd/MM/yyyy",""],["fecha_corte","FEC_CORTE","Fecha de Corte","dd/MM/yyyy",""],["","CAMPO_PERSONALIZADO","Ejemplo Campo Extra","","TEXTO"]],i=t.utils.book_new(),p=t.utils.aoa_to_sheet(e);p["!cols"]=[{wch:25},{wch:20},{wch:30},{wch:20},{wch:15}],t.utils.book_append_sheet(i,p,"Configuraci\xF3n Cabeceras"),t.writeFile(i,"header-configuration-template.xlsx"),this.notificationService.success("Archivo descargado","Plantilla Excel descargada exitosamente")})}getDataTypeBadgeClass(t){switch(t){case"TEXTO":return"bg-blue-900/30 text-blue-400";case"NUMERICO":return"bg-emerald-900/30 text-emerald-400";case"FECHA":return"bg-amber-900/30 text-amber-400";default:return"bg-gray-900/30 text-gray-400"}}getFieldCodeById(t){let e=this.fieldDefinitions().find(i=>i.id===t);return e?e.fieldCode:"-"}openAliasDialog(t){let e=this.previewHeaders()[t];if(!e||!e.id){this.notificationService.warning("Cabecera no guardada","Debe guardar las cabeceras primero para poder gestionar alias");return}let i=this.savedHeaders().find(p=>p.id===e.id);if(!i){this.notificationService.warning("Cabecera no encontrada","No se encontr\xF3 la cabecera en la base de datos");return}this.selectedHeaderForAlias.set(i),this.newAliasName.set(""),this.showAliasDialog.set(!0),this.loadAliases(i.id)}closeAliasDialog(){this.showAliasDialog.set(!1),this.selectedHeaderForAlias.set(null),this.aliases.set([]),this.newAliasName.set("")}loadAliases(t){this.loadingAliases.set(!0),this.headerConfigService.getAliases(t).subscribe({next:e=>{this.aliases.set(e),this.loadingAliases.set(!1)},error:e=>{console.error("Error al cargar alias:",e),this.loadingAliases.set(!1),this.aliases.set([])}})}addAlias(){let t=this.selectedHeaderForAlias(),e=this.newAliasName().trim();!t||!t.id||!e||this.headerConfigService.addAlias(t.id,{alias:e,username:"admin"}).subscribe({next:i=>{this.aliases.update(p=>[...p,i]),this.newAliasName.set(""),this.notificationService.success("Alias agregado",`Se agreg\xF3 "${e}" como alias`)},error:i=>{console.error("Error al agregar alias:",i),this.notificationService.error("Error al agregar alias",i.error?.message||i.message)}})}removeAlias(t){return P(this,null,function*(){(yield this.notificationService.confirm({title:"Eliminar alias",message:`\xBFEst\xE1 seguro de eliminar el alias "${t.alias}"?`,confirmText:"Eliminar",cancelText:"Cancelar",type:"warning"}))&&this.headerConfigService.removeAlias(t.id,"admin").subscribe({next:()=>{this.aliases.update(i=>i.filter(p=>p.id!==t.id)),this.notificationService.success("Alias eliminado",`Se elimin\xF3 el alias "${t.alias}"`)},error:i=>{console.error("Error al eliminar alias:",i),this.notificationService.error("Error al eliminar alias",i.error?.message||i.message)}})})}canManageAlias(t){let e=this.previewHeaders()[t];return!!e&&!!e.id}getAliasCount(t){let e=this.previewHeaders()[t];return!e||!e.id?0:this.savedHeaders().find(p=>p.id===e.id)?.aliases?.length||0}};s.\u0275fac=function(e){return new(e||s)(O(he),O(be),O(_e),O(ge))},s.\u0275cmp=Z({type:s,selectors:[["app-header-configuration"]],viewQuery:function(e,i){if(e&1&&J(we,5,Q),e&2){let p;K(p=ee())&&(i.downloadButton=p.first)}},decls:55,vars:18,consts:[["downloadButton",""],[1,"h-[calc(100dvh-56px)]","bg-slate-950","overflow-hidden","flex","flex-col"],[1,"flex-1","overflow-y-auto"],[1,"p-3","max-w-7xl","mx-auto"],[1,"mb-2"],[1,"flex","items-center","gap-2"],[1,"w-8","h-8","bg-gradient-to-br","from-indigo-600","to-indigo-700","rounded-lg","flex","items-center","justify-center"],["name","table-2",1,"text-white",3,"size"],[1,"text-lg","font-bold","text-white"],[1,"text-xs","text-gray-400"],[1,"bg-slate-900","rounded-lg","p-2","shadow-sm","border","border-slate-800"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-2"],[1,"block","text-xs","font-semibold","text-gray-300","mb-1"],["name","building-2",1,"inline","mr-1",3,"size"],[1,"w-full","px-3","py-1.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","text-sm","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"ngModelChange","ngModel"],[3,"value"],["name","folder",1,"inline","mr-1",3,"size"],[1,"w-full","px-3","py-1.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","text-sm","focus:outline-none","focus:ring-2","focus:ring-indigo-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],["name","folder-tree",1,"inline","mr-1",3,"size"],["name","database",1,"inline","mr-1",3,"size"],["value","ACTUALIZACION"],["value","INICIAL"],[1,"fixed","inset-0","bg-black/80","backdrop-blur-sm","flex","items-center","justify-center","z-50","p-4"],[1,"bg-slate-900","rounded-lg","shadow-sm","border","border-slate-800","overflow-hidden"],[1,"p-3"],[1,"flex","flex-wrap","items-center","gap-2","mb-2"],[1,"relative"],[1,"flex","items-center","gap-1.5","px-3","py-1.5","bg-blue-600","text-white","rounded-lg","text-sm","font-medium","hover:bg-blue-700","transition-all","cursor-pointer",3,"click"],["name","file-text",3,"size"],[1,"hidden","sm:inline"],[1,"sm:hidden"],[3,"name","size"],[1,"px-3","py-1.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","text-sm","focus:outline-none","focus:ring-2","focus:ring-emerald-500","cursor-pointer",3,"ngModelChange","ngModel"],["value",";"],["value",","],["value","|"],["value","	"],[1,"flex","items-center","gap-1.5","px-3","py-1.5","bg-emerald-600","text-white","rounded-lg","text-sm","font-medium","hover:bg-emerald-700","transition-all","cursor-pointer"],["name","folder-open",3,"size"],["type","file","accept",".csv,.xlsx,.xls",1,"hidden",3,"change"],[1,"flex","items-center","gap-1.5","px-3","py-1.5","bg-indigo-600","text-white","rounded-lg","text-sm","font-medium","hover:bg-indigo-700","transition-all","cursor-pointer",3,"click"],["name","plus",3,"size"],[1,"ml-auto","flex","items-center","gap-2","px-3","py-1.5"],[1,"flex","flex-wrap","items-center","justify-end","gap-2","pt-2","border-t","border-slate-700"],[1,"p-6","text-center"],[1,"overflow-x-auto","max-h-[calc(100dvh-340px)]","overflow-y-auto"],["name","table-2",1,"text-indigo-400",3,"size"],[1,"text-sm","font-semibold","text-indigo-400"],[1,"text-xs","text-indigo-400"],[1,"fixed","inset-0","z-[9998]",3,"click"],[1,"fixed","w-56","bg-slate-800","rounded-lg","shadow-xl","border","border-slate-700","py-1","z-[9999]"],[1,"w-full","flex","items-center","gap-2","px-3","py-2","hover:bg-slate-700","transition-colors","text-left","text-gray-300","cursor-pointer",3,"click"],["name","file-text",1,"text-gray-400",3,"size"],[1,"text-sm","font-medium"],["name","table-2",1,"text-green-400",3,"size"],[1,"flex","items-center","gap-1","px-3","py-1.5","bg-slate-800","text-gray-300","rounded-lg","text-sm","hover:bg-slate-700","hover:text-white","transition-all","cursor-pointer",3,"click"],["name","trash-2",3,"size"],[1,"flex","items-center","gap-1.5","px-3","py-1.5","bg-green-600","text-white","rounded-lg","text-sm","font-medium","hover:bg-green-700","transition-all","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","loader-2",1,"animate-spin",3,"size"],["name","save",3,"size"],[1,"w-12","h-12","bg-slate-800","rounded-full","flex","items-center","justify-center","mx-auto","mb-2"],["name","table-2",1,"text-gray-600",3,"size"],[1,"text-sm","text-gray-400"],[1,"w-full"],[1,"bg-slate-800","border-b","border-slate-700","sticky","top-0"],[1,"px-2","py-1.5","text-left","text-xs","font-semibold","text-gray-400"],[1,"px-2","py-1.5","text-center","text-xs","font-semibold","text-gray-400"],[1,"divide-y","divide-slate-800"],[1,"hover:bg-slate-800","transition-colors"],[1,"px-2","py-1.5"],[1,"flex","items-center","gap-1"],["name","database","title","Cabecera guardada en BD",1,"text-green-400","flex-shrink-0",3,"size"],[1,"px-1","py-0.5","bg-blue-900/50","text-blue-300","text-[9px]","rounded","font-medium"],[1,"font-mono","text-xs","font-semibold","text-indigo-400"],["name","sparkles",1,"text-amber-400","flex-shrink-0",3,"size","title"],[1,"inline-flex","px-1.5","py-0.5","rounded","text-xs","font-medium"],[1,"text-xs","text-white"],[1,"text-xs","text-amber-400","italic"],[1,"font-mono","text-xs","text-gray-400"],[1,"px-2","py-1.5","text-center"],["name","check-circle",1,"text-green-400","inline",3,"size"],["name","circle",1,"text-gray-600","inline",3,"size"],["title","Editar",1,"p-1","text-blue-400","hover:bg-slate-800","rounded","transition-colors",3,"click"],["name","edit",3,"size"],["title","Gestionar alias",1,"p-1","text-amber-400","hover:bg-slate-800","rounded","transition-colors","relative"],["title","Eliminar",1,"p-1","text-red-400","hover:bg-slate-800","rounded","transition-colors",3,"click"],["title","Gestionar alias",1,"p-1","text-amber-400","hover:bg-slate-800","rounded","transition-colors","relative",3,"click"],["name","tags",3,"size"],[1,"absolute","-top-1","-right-1","w-4","h-4","bg-amber-500","text-white","text-[10px]","rounded-full","flex","items-center","justify-center"],[1,"bg-slate-900","rounded-xl","shadow-2xl","max-w-2xl","w-full","max-h-[90vh]","overflow-hidden","border","border-slate-800"],[1,"bg-gradient-to-r","from-indigo-600","to-indigo-700","p-5","text-white"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","bg-white/20","rounded-lg","flex","items-center","justify-center"],["name","plus-circle",3,"size"],[1,"text-xl","font-bold"],[1,"text-indigo-100","text-sm"],[1,"text-white/80","hover:text-white",3,"click"],["name","x",3,"size"],[1,"p-6","overflow-y-auto","max-h-[calc(90vh-200px)]"],[1,"space-y-4"],[1,"block","text-sm","font-semibold","text-gray-300","mb-2"],["name","book-open",1,"inline","mr-1",3,"size"],["name","lock","title","No editable",1,"inline","ml-1","text-amber-400",3,"size"],[1,"w-full","px-4","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-indigo-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],[1,"text-xs","text-gray-400","mt-1"],[1,"bg-slate-800/50","rounded-lg","p-4","space-y-2","border","border-slate-700/50"],[1,"bg-amber-900/30","border","border-amber-700/50","rounded-lg","p-3","mb-2"],["name","settings",1,"inline","mr-1",3,"size"],["type","text","placeholder","Ej: DNI, Saldo Vencido, Tel\xE9fono Principal",1,"w-full","px-4","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-indigo-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","ngModel","disabled"],["name","eye",1,"inline","mr-1",3,"size"],["type","text","placeholder","Ej: N\xFAmero de Documento, Saldo Pendiente",1,"w-full","px-4","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"ngModelChange","ngModel"],["name","file-text",1,"inline","mr-1",3,"size"],["type","text","placeholder","Ej: dd/MM/yyyy, decimal(18,2)",1,"w-full","px-4","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-indigo-500",3,"ngModelChange","ngModel"],["type","checkbox","id","required",1,"w-4","h-4","text-indigo-600","bg-slate-800","border-slate-700","rounded","focus:ring-indigo-500",3,"ngModelChange","ngModel"],["for","required",1,"text-sm","text-gray-300"],[1,"col-span-2","border-t","border-slate-700","pt-4","mt-2"],["type","button",1,"w-full","flex","items-center","justify-between","text-sm","font-bold","text-emerald-400","mb-3","hover:text-emerald-300","transition-colors",3,"click"],["name","git-branch",3,"size"],[1,"border-t","border-slate-800","p-4","flex","justify-end","gap-3","bg-slate-950"],[1,"px-5","py-2","text-gray-400","hover:bg-slate-800","hover:text-white","rounded-lg","font-medium","transition-colors",3,"click"],[1,"px-5","py-2","bg-gradient-to-r","from-indigo-600","to-indigo-700","text-white","rounded-lg","font-semibold","hover:shadow-lg","transition-all","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-xs","font-semibold","text-gray-400","mb-2"],[1,"inline-flex","px-2","py-0.5","rounded","text-xs","font-medium"],[1,"font-semibold"],[1,"text-cyan-400"],[1,"flex","items-start","gap-2"],["name","alert-triangle",1,"text-amber-400","mt-0.5","flex-shrink-0",3,"size"],[1,"text-sm","text-amber-300","font-medium"],[1,"text-xs","text-amber-400/80","mt-1"],["name","type",1,"inline","mr-1",3,"size"],["value","TEXTO"],["value","NUMERICO"],["value","FECHA"],[1,"text-xs","text-gray-400","mb-4"],[1,"grid","grid-cols-1","gap-4"],["name","arrow-right",1,"inline","mr-1",3,"size"],[1,"w-full","px-4","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-emerald-500",3,"ngModelChange","ngModel"],["value",""],["name","code",1,"inline","mr-1",3,"size"],[1,"text-red-400","ml-1"],["type","text",1,"w-full","px-4","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-emerald-500","font-mono","text-sm",3,"ngModelChange","ngModel","placeholder"],[1,"text-emerald-400"],[1,"bg-slate-900","rounded-xl","shadow-2xl","max-w-lg","w-full","max-h-[90vh]","overflow-hidden","border","border-slate-800"],[1,"bg-gradient-to-r","from-amber-600","to-amber-700","p-5","text-white"],[1,"text-amber-100","text-sm"],[1,"p-6"],[1,"bg-slate-800/50","rounded-lg","p-3","mb-4","border","border-slate-700/50"],[1,"text-xs","text-gray-400","mb-1"],[1,"text-white","font-mono","font-semibold"],[1,"text-xs","text-gray-400","mt-2"],[1,"mb-4"],["name","plus",1,"inline","mr-1",3,"size"],[1,"flex","gap-2"],["type","text","placeholder","Nombre alternativo de la columna",1,"flex-1","px-3","py-2","bg-slate-800","border","border-slate-700","rounded-lg","text-white","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-amber-500","text-sm",3,"ngModelChange","keyup.enter","ngModel"],[1,"px-4","py-2","bg-amber-600","text-white","rounded-lg","font-medium","hover:bg-amber-700","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["name","list",1,"inline","mr-1",3,"size"],[1,"text-center","py-4"],[1,"text-center","py-4","bg-slate-800/30","rounded-lg","border","border-slate-700/50"],[1,"space-y-2","max-h-48","overflow-y-auto"],[1,"border-t","border-slate-800","p-4","flex","justify-end","bg-slate-950"],[1,"px-5","py-2","bg-slate-700","text-white","rounded-lg","font-medium","hover:bg-slate-600","transition-colors",3,"click"],["name","loader-2",1,"text-amber-400","animate-spin","mx-auto",3,"size"],["name","tags",1,"text-gray-600","mx-auto",3,"size"],[1,"flex","items-center","justify-between","bg-slate-800/50","rounded-lg","px-3","py-2","border","border-slate-700/50"],["name","tag",1,"text-amber-400",3,"size"],[1,"text-white","font-mono","text-sm"],[1,"px-1.5","py-0.5","bg-green-900/50","text-green-400","rounded","text-[10px]","font-medium"],["title","Eliminar alias",1,"p-1","text-red-400","hover:bg-slate-700","rounded","transition-colors"],["title","Eliminar alias",1,"p-1","text-red-400","hover:bg-slate-700","rounded","transition-colors",3,"click"]],template:function(e,i){e&1&&(g(0,"app-notifications"),n(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),g(7,"lucide-angular",7),a(),n(8,"div")(9,"h1",8),d(10,"Configuraci\xF3n de Cabeceras"),a(),n(11,"p",9),d(12,"Define las cabeceras personalizadas por subcartera"),a()()()(),n(13,"div",4)(14,"div",10)(15,"div",11)(16,"div")(17,"label",12),g(18,"lucide-angular",13),d(19," Proveedor "),a(),n(20,"select",14),D("ngModelChange",function(f){return T(i.selectedTenantId,f)||(i.selectedTenantId=f),f}),S("ngModelChange",function(){return i.onTenantChange()}),n(21,"option",15),d(22,"Seleccione un proveedor..."),a(),F(23,Te,2,2,"option",15,W),a()(),n(25,"div")(26,"label",12),g(27,"lucide-angular",16),d(28," Cartera "),a(),n(29,"select",17),D("ngModelChange",function(f){return T(i.selectedPortfolioId,f)||(i.selectedPortfolioId=f),f}),S("ngModelChange",function(){return i.onPortfolioChange()}),n(30,"option",15),d(31,"Seleccione una cartera..."),a(),F(32,De,2,2,"option",15,W),a()(),n(34,"div")(35,"label",12),g(36,"lucide-angular",18),d(37," Subcartera "),a(),n(38,"select",17),D("ngModelChange",function(f){return T(i.selectedSubPortfolioId,f)||(i.selectedSubPortfolioId=f),f}),S("ngModelChange",function(){return i.onSubPortfolioChange()}),n(39,"option",15),d(40,"Seleccione una subcartera..."),a(),F(41,Me,2,2,"option",15,W),a()(),n(43,"div")(44,"label",12),g(45,"lucide-angular",19),d(46," Tipo de Carga "),a(),n(47,"select",17),D("ngModelChange",function(f){return T(i.selectedLoadType,f)||(i.selectedLoadType=f),f}),S("ngModelChange",function(){return i.onLoadTypeChange()}),n(48,"option",20),d(49,"Carga Diaria"),a(),n(50,"option",21),d(51,"Carga Inicial del Mes"),a()()()()()(),h(52,qe,42,10),h(53,mt,71,28,"div",22),h(54,Ct,40,9,"div",22),a()()()),e&2&&(l(7),m("size",16),l(11),m("size",16),l(2),E("ngModel",i.selectedTenantId),l(),m("value",0),l(2),V(i.tenants()),l(4),m("size",16),l(2),E("ngModel",i.selectedPortfolioId),m("disabled",i.selectedTenantId===0),l(),m("value",0),l(2),V(i.portfolios()),l(4),m("size",16),l(2),E("ngModel",i.selectedSubPortfolioId),m("disabled",i.selectedPortfolioId===0),l(),m("value",0),l(2),V(i.subPortfolios()),l(4),m("size",16),l(2),E("ngModel",i.selectedLoadType),m("disabled",i.selectedSubPortfolioId===0),l(5),b(i.selectedSubPortfolioId>0?52:-1),l(),b(i.showManualDialog()?53:-1),l(),b(i.showAliasDialog()?54:-1))},dependencies:[ie,fe,ue,pe,de,le,me,se,ce,oe,ae,Ce],styles:["[_nghost-%COMP%]{display:block}"]});let o=s;return o})();export{Vt as HeaderConfigurationComponent};
