{
  "version": 3,
  "sources": ["src/app/core/services/admin-monitoring.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { environment } from '../../../environments/environment';\n\nexport interface ActiveCall {\n  callUuid: string;\n  agentExtension: string;\n  agentName: string;\n  clientNumber: string;\n  callDirection: string;\n  callState: string;\n  startTime: string;\n  duration: number;\n  campaignId?: number;\n  campaignName?: string;\n  isBeingMonitored: boolean;\n  monitoringMode?: string;\n  monitoredBy?: string;\n}\n\nexport interface MonitoringRequest {\n  callUuid: string;\n  adminExtension: string;\n  adminUsername: string;\n}\n\nexport interface ExtensionRegistration {\n  extension: string;\n  username: string;\n  displayName: string;\n  ipAddress: string;\n  port: string;\n  status: string;\n  pingMs: string;\n  userAgent: string;\n  userId?: number;\n  fullName?: string;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AdminMonitoringService {\n  private apiUrl = `${environment.gatewayUrl}/admin/monitoring`;\n\n  constructor(private http: HttpClient) {}\n\n  /**\n   * Get all active calls\n   */\n  getActiveCalls(): Observable<ActiveCall[]> {\n    return this.http.get<ActiveCall[]>(`${this.apiUrl}/active-calls`);\n  }\n\n  /**\n   * Get specific call details\n   */\n  getCall(callUuid: string): Observable<ActiveCall> {\n    return this.http.get<ActiveCall>(`${this.apiUrl}/active-calls/${callUuid}`);\n  }\n\n  /**\n   * Start SPY mode (Vig√≠a) - Listen only\n   */\n  startSpyMode(request: MonitoringRequest): Observable<any> {\n    return this.http.post(`${this.apiUrl}/spy`, request);\n  }\n\n  /**\n   * Start WHISPER mode (Susurro) - Speak to agent only\n   */\n  startWhisperMode(request: MonitoringRequest): Observable<any> {\n    return this.http.post(`${this.apiUrl}/whisper`, request);\n  }\n\n  /**\n   * Start BARGE mode (Tripartita) - Join as full participant\n   */\n  startBargeMode(request: MonitoringRequest): Observable<any> {\n    return this.http.post(`${this.apiUrl}/barge`, request);\n  }\n\n  /**\n   * Stop monitoring a call\n   */\n  stopMonitoring(callUuid: string, adminCallUuid: string, adminUsername: string): Observable<any> {\n    return this.http.post(`${this.apiUrl}/stop`, {\n      callUuid,\n      adminCallUuid,\n      adminUsername\n    });\n  }\n\n  /**\n   * Get active call count\n   */\n  getActiveCallCount(): Observable<{activeCallCount: number}> {\n    return this.http.get<{activeCallCount: number}>(`${this.apiUrl}/stats/active-count`);\n  }\n\n  /**\n   * Get FreeSWITCH status (for debugging)\n   */\n  getFreeSwitchStatus(): Observable<any> {\n    return this.http.get(`${this.apiUrl}/freeswitch/status`);\n  }\n\n  /**\n   * Get specific active call (alias for getCall)\n   */\n  getActiveCall(callUuid: string): Observable<ActiveCall> {\n    return this.getCall(callUuid);\n  }\n\n  /**\n   * SPY mode - simplified (admin extension 1000)\n   */\n  spyCall(callUuid: string): Observable<any> {\n    return this.http.post(`${this.apiUrl}/spy`, {\n      callUuid,\n      adminExtension: '1000',\n      adminUsername: 'admin'\n    });\n  }\n\n  /**\n   * WHISPER mode - simplified (admin extension 1000)\n   */\n  whisperCall(callUuid: string): Observable<any> {\n    return this.http.post(`${this.apiUrl}/whisper`, {\n      callUuid,\n      adminExtension: '1000',\n      adminUsername: 'admin'\n    });\n  }\n\n  /**\n   * BARGE mode - simplified (admin extension 1000)\n   */\n  bargeCall(callUuid: string): Observable<any> {\n    return this.http.post(`${this.apiUrl}/barge`, {\n      callUuid,\n      adminExtension: '1000',\n      adminUsername: 'admin'\n    });\n  }\n\n  /**\n   * Get SIP extension registrations\n   */\n  getExtensionRegistrations(): Observable<ExtensionRegistration[]> {\n    return this.http.get<ExtensionRegistration[]>(`${this.apiUrl}/extensions/registrations`);\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;AA2CM,IAAO,0BAAP,MAAO,wBAAsB;EAGjC,YAAoB,MAAgB;AAAhB,SAAA,OAAA;AAFZ,SAAA,SAAS,GAAG,YAAY,UAAU;EAEH;;;;EAKvC,iBAAc;AACZ,WAAO,KAAK,KAAK,IAAkB,GAAG,KAAK,MAAM,eAAe;EAClE;;;;EAKA,QAAQ,UAAgB;AACtB,WAAO,KAAK,KAAK,IAAgB,GAAG,KAAK,MAAM,iBAAiB,QAAQ,EAAE;EAC5E;;;;EAKA,aAAa,SAA0B;AACrC,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,MAAM,QAAQ,OAAO;EACrD;;;;EAKA,iBAAiB,SAA0B;AACzC,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,MAAM,YAAY,OAAO;EACzD;;;;EAKA,eAAe,SAA0B;AACvC,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,MAAM,UAAU,OAAO;EACvD;;;;EAKA,eAAe,UAAkB,eAAuB,eAAqB;AAC3E,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,MAAM,SAAS;MAC3C;MACA;MACA;KACD;EACH;;;;EAKA,qBAAkB;AAChB,WAAO,KAAK,KAAK,IAA+B,GAAG,KAAK,MAAM,qBAAqB;EACrF;;;;EAKA,sBAAmB;AACjB,WAAO,KAAK,KAAK,IAAI,GAAG,KAAK,MAAM,oBAAoB;EACzD;;;;EAKA,cAAc,UAAgB;AAC5B,WAAO,KAAK,QAAQ,QAAQ;EAC9B;;;;EAKA,QAAQ,UAAgB;AACtB,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,MAAM,QAAQ;MAC1C;MACA,gBAAgB;MAChB,eAAe;KAChB;EACH;;;;EAKA,YAAY,UAAgB;AAC1B,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,MAAM,YAAY;MAC9C;MACA,gBAAgB;MAChB,eAAe;KAChB;EACH;;;;EAKA,UAAU,UAAgB;AACxB,WAAO,KAAK,KAAK,KAAK,GAAG,KAAK,MAAM,UAAU;MAC5C;MACA,gBAAgB;MAChB,eAAe;KAChB;EACH;;;;EAKA,4BAAyB;AACvB,WAAO,KAAK,KAAK,IAA6B,GAAG,KAAK,MAAM,2BAA2B;EACzF;;;mCA9GW,yBAAsB,mBAAA,UAAA,CAAA;AAAA;2FAAtB,yBAAsB,SAAtB,wBAAsB,WAAA,YAFrB,OAAM,CAAA;AAEd,IAAO,yBAAP;;sEAAO,wBAAsB,CAAA;UAHlC;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
