import{a as se,b as ce}from"./chunk-4SH3ABNN.js";import{a as le,c as de}from"./chunk-4F4PQCC5.js";import{a as me}from"./chunk-TATL7MOR.js";import{a as re}from"./chunk-QEFW7LKZ.js";import{a as ae}from"./chunk-VVSSGT66.js";import{d as q}from"./chunk-JKE5BK6V.js";import"./chunk-WPZY277X.js";import{E as oe,f as Q,k as ee,s as te,t as ie,u as ne}from"./chunk-2YC26MZ7.js";import{pc as Z,qc as G}from"./chunk-YLTLMO6P.js";import{a as J}from"./chunk-YQKVMPSG.js";import{c as X}from"./chunk-LYMJIISJ.js";import{Fb as h,Gb as x,Jb as P,Kb as N,Lb as u,Mb as o,Nb as r,Ob as C,Vb as E,Xb as b,Zb as p,a as O,b as D,bb as l,ca as K,g as A,ga as U,ha as j,hb as F,jc as S,lc as d,mc as L,md as W,na as T,nc as w,oa as I,ob as B,oc as V,qc as R,rc as k,sc as Y,v as M,xa as v}from"./chunk-BMTIWWAP.js";var z={DAILY:/Cartera_CONTACTO_TOTAL_\d{4}-\d{2}-\d{2}/i,INITIAL_MAIN:/CONTACTO_TOTAL_ASIGNACION_\d{6}/i,COMPLEMENTARY_FACILITIES:/Facilidades_Pago_CONTACTO_TOTAL_\d{6}/i,COMPLEMENTARY_PKM:/CONTACTO_TOTAL_PKM_/i};function ue(n){return z.DAILY.test(n)?"DAILY":z.INITIAL_MAIN.test(n)?"INITIAL_MAIN":z.COMPLEMENTARY_FACILITIES.test(n)?"COMPLEMENTARY_FACILITIES":z.COMPLEMENTARY_PKM.test(n)?"COMPLEMENTARY_PKM":"UNKNOWN"}function H(n){switch(n){case"DAILY":return"Carga Diaria";case"INITIAL_MAIN":return"Asignaci\xF3n Inicial";case"COMPLEMENTARY_FACILITIES":return"Facilidades de Pago";case"COMPLEMENTARY_PKM":return"PKM";case"UNKNOWN":return"Desconocido"}}var pe=(()=>{let c=class c{constructor(e){this.http=e,this.baseUrl=`${J.tipificacionUrl}/system-config/complementary-files`}importComplementaryData(e){return this.http.post(`${this.baseUrl}/import`,e)}detectFileType(e){return this.http.post(`${this.baseUrl}/detect-type`,e)}getTypesBySubPortfolio(e){return this.http.get(`${this.baseUrl}/types/subportfolio/${e}`)}getTypeById(e){return this.http.get(`${this.baseUrl}/types/${e}`)}createType(e){return this.http.post(`${this.baseUrl}/types`,e)}updateType(e,i){return this.http.put(`${this.baseUrl}/types/${e}`,i)}deleteType(e){return this.http.delete(`${this.baseUrl}/types/${e}`)}validateColumns(e,i){return this.http.post(`${this.baseUrl}/validate-columns?subPortfolioId=${e}`,i)}};c.\u0275fac=function(i){return new(i||c)(U(X))},c.\u0275prov=K({token:c,factory:c.\u0275fac,providedIn:"root"});let n=c;return n})();var $=(n,c)=>c.id,fe=(n,c)=>c.name,he=(n,c)=>c.file.name;function xe(n,c){if(n&1&&(o(0,"div",51)(1,"span",53),d(2,"Ejemplos:"),r(),o(3,"code",54),d(4),r()()),n&2){let t=p().$implicit;l(4),L(t.sampleValues.slice(0,3).join(" | "))}}function be(n,c){if(n&1){let t=E();o(0,"div",52)(1,"div")(2,"label",55),d(3,"Etiqueta visual"),r(),o(4,"input",56),b("input",function(i){T(t);let a=p().$index,s=p(2);return I(s.updateHeaderForm(a,"displayLabel",i))}),r()(),o(5,"div")(6,"label",55),d(7,"Tipo de dato"),r(),o(8,"select",57),b("change",function(i){T(t);let a=p().$index,s=p(2);return I(s.updateHeaderForm(a,"dataType",i))}),o(9,"option",58),d(10,"TEXTO"),r(),o(11,"option",59),d(12,"NUMERICO"),r(),o(13,"option",60),d(14,"FECHA"),r()()(),o(15,"div")(16,"label",55),d(17,"Formato (opcional)"),r(),o(18,"input",61),b("input",function(i){T(t);let a=p().$index,s=p(2);return I(s.updateHeaderForm(a,"format",i))}),r()()()}if(n&2){let t=p().$index,e=p(2);l(4),u("value",e.newHeaderForms()[t].displayLabel),l(4),u("value",e.newHeaderForms()[t].dataType),l(10),u("value",e.newHeaderForms()[t].format)("placeholder",e.newHeaderForms()[t].dataType==="FECHA"?"dd/MM/yyyy":"")}}function ve(n,c){if(n&1){let t=E();o(0,"div",42)(1,"div",43)(2,"div",44)(3,"label",45)(4,"input",46),b("change",function(){let i=T(t).$index,a=p(2);return I(a.toggleColumnSelection(i))}),r()(),o(5,"div",47)(6,"div",48)(7,"span",49),d(8),r(),o(9,"span",50),d(10),r()(),h(11,xe,5,1,"div",51),h(12,be,19,4,"div",52),r()()()()}if(n&2){let t=c.$implicit,e=c.$index,i=p(2);S("border-emerald-500",t.selected)("border-slate-600",!t.selected),l(4),u("checked",t.selected),l(4),L(t.name),l(),S("bg-purple-900/50",t.detectedType==="FECHA")("text-purple-400",t.detectedType==="FECHA")("bg-blue-900/50",t.detectedType==="NUMERICO")("text-blue-400",t.detectedType==="NUMERICO")("bg-slate-600",t.detectedType==="TEXTO")("text-gray-300",t.detectedType==="TEXTO"),l(),w(" ",t.detectedType," "),l(),x(t.sampleValues.length>0?11:-1),l(),x(t.selected&&i.newHeaderForms()[e]?12:-1)}}function ye(n,c){if(n&1&&(o(0,"span",34),d(1),r()),n&2){let t=p(2);l(),w(" (",t.unregisteredColumns().length-t.getSelectedColumnsCount()," ser\xE1n ignoradas) ")}}function Te(n,c){n&1&&(C(0,"div",63),d(1," Creando... "))}function Ie(n,c){if(n&1&&(C(0,"lucide-angular",64),d(1)),n&2){let t=p(3);u("size",16),l(),w(" Crear ",t.getSelectedColumnsCount()," cabecera(s) y continuar ")}}function Le(n,c){if(n&1){let t=E();o(0,"button",62),b("click",function(){T(t);let i=p(2);return I(i.createSelectedHeadersAndContinue())}),h(1,Te,2,0)(2,Ie,2,2),r()}if(n&2){let t=p(2);u("disabled",t.isCreatingHeaders()),l(),x(t.isCreatingHeaders()?1:2)}}function Se(n,c){if(n&1){let t=E();o(0,"div",0),C(1,"div",20),o(2,"div",21)(3,"div",22)(4,"div",5)(5,"div",23),C(6,"lucide-angular",24),r(),o(7,"div")(8,"h2",8),d(9,"Columnas no registradas detectadas"),r(),o(10,"p",25),d(11),o(12,"span",26),d(13),r()()()()(),o(14,"div",27)(15,"p",28),d(16," Seleccione las columnas que desea registrar como cabeceras. Las columnas no seleccionadas ser\xE1n ignoradas durante la importaci\xF3n. "),r(),o(17,"div",29),P(18,ve,13,21,"div",30,fe),r(),o(20,"div",31)(21,"div",32)(22,"span",9)(23,"span",33),d(24),r(),d(25," columna(s) seleccionada(s) para crear "),r(),h(26,ye,2,1,"span",34),r(),o(27,"button",35),b("click",function(){T(t);let i=p();return I(i.selectAllColumns())}),d(28),r()()(),o(29,"div",36)(30,"button",37),b("click",function(){T(t);let i=p();return I(i.cancelUnregisteredDialog())}),d(31," Cancelar importaci\xF3n "),r(),o(32,"div",38)(33,"button",39),b("click",function(){T(t);let i=p();return I(i.proceedIgnoringUnregisteredColumns())}),C(34,"lucide-angular",40),d(35," Ignorar todas y continuar "),r(),h(36,Le,3,2,"button",41),r()()()()}if(n&2){let t,e=p();l(6),u("size",24),l(5),w(" ",e.unregisteredColumns().length," columna(s) en "),l(2),L((t=e.pendingFileForValidation())==null||t.file==null?null:t.file.name),l(5),N(e.unregisteredColumns()),l(6),L(e.getSelectedColumnsCount()),l(2),x(e.getSelectedColumnsCount()<e.unregisteredColumns().length?26:-1),l(2),w(" ",e.getSelectedColumnsCount()===e.unregisteredColumns().length?"Deseleccionar todo":"Seleccionar todo"," "),l(6),u("size",16),l(2),x(e.getSelectedColumnsCount()>0?36:-1)}}function Ee(n,c){if(n&1&&(o(0,"div",1),C(1,"div",65),o(2,"div",66)(3,"div",67)(4,"div",68),C(5,"div",69)(6,"div",70),r(),o(7,"div",71)(8,"h3",72),d(9),r(),o(10,"p",73),d(11,"Por favor espere..."),r()(),o(12,"div",74),C(13,"div",75),r()()()()),n&2){let t=p();l(9),L(t.loadingMessage())}}function Me(n,c){if(n&1&&(o(0,"option",15),d(1),r()),n&2){let t=c.$implicit;u("value",t.id),l(),V("",t.tenantCode," - ",t.tenantName)}}function we(n,c){if(n&1&&(o(0,"option",15),d(1),r()),n&2){let t=c.$implicit;u("value",t.id),l(),V("",t.portfolioCode," - ",t.portfolioName)}}function Ae(n,c){if(n&1&&(o(0,"option",15),d(1),r()),n&2){let t=c.$implicit;u("value",t.id),l(),V("",t.subPortfolioCode," - ",t.subPortfolioName)}}function Pe(n,c){if(n&1){let t=E();o(0,"button",105),b("click",function(){T(t);let i=p(3);return I(i.clearFiles())}),C(1,"lucide-angular",106),d(2," Limpiar "),r()}n&2&&(l(),u("size",14))}function Ne(n,c){if(n&1&&(o(0,"div",104)(1,"div",107),C(2,"lucide-angular",108),r(),o(3,"h3",109),d(4,'Arrastra archivos aqu\xED o haz clic en "Agregar Archivo"'),r(),o(5,"p",73),d(6),r()()),n&2){let t=p(3);l(2),u("size",32),l(4),L(t.getExpectedFilesDescription())}}function Fe(n,c){n&1&&C(0,"lucide-angular",115),n&2&&u("size",20)}function Oe(n,c){n&1&&C(0,"lucide-angular",116),n&2&&u("size",20)}function De(n,c){n&1&&C(0,"lucide-angular",117),n&2&&u("size",20)}function Ve(n,c){if(n&1&&(o(0,"span",84),d(1),r()),n&2){let t=p().$implicit;l(),w("",t.rowCount," registros")}}function Re(n,c){if(n&1&&(o(0,"span",122),d(1),r()),n&2){let t=p().$implicit;l(),L(t.error)}}function ke(n,c){if(n&1){let t=E();o(0,"div",113)(1,"div",95)(2,"div",5)(3,"div",114),h(4,Fe,1,1,"lucide-angular",115)(5,Oe,1,1,"lucide-angular",116)(6,De,1,1,"lucide-angular",117),r(),o(7,"div")(8,"p",118),d(9),r(),o(10,"div",119)(11,"span",120),d(12),r(),h(13,Ve,2,1,"span",84),r()()(),o(14,"div",121),h(15,Re,2,1,"span",122),o(16,"button",123),b("click",function(){let i=T(t).$implicit,a=p(4);return I(a.removeFile(i))}),C(17,"lucide-angular",124),r()()()()}if(n&2){let t=c.$implicit,e=p(4);S("border-emerald-500/50",t.validated&&!t.error)("border-red-500/50",t.error)("border-slate-700",!t.validated&&!t.error),l(3),S("bg-emerald-600/20",t.validated&&!t.error)("bg-red-600/20",t.error)("bg-slate-700",!t.validated&&!t.error),l(),x(t.validated&&!t.error?4:t.error?5:6),l(5),L(t.file.name),l(2),S("bg-blue-900/50",t.type==="DAILY")("text-blue-400",t.type==="DAILY")("bg-emerald-900/50",t.type==="INITIAL_MAIN")("text-emerald-400",t.type==="INITIAL_MAIN")("bg-purple-900/50",t.type==="COMPLEMENTARY_FACILITIES")("text-purple-400",t.type==="COMPLEMENTARY_FACILITIES")("bg-amber-900/50",t.type==="COMPLEMENTARY_PKM")("text-amber-400",t.type==="COMPLEMENTARY_PKM")("bg-gray-700",t.type==="UNKNOWN")("text-gray-400",t.type==="UNKNOWN"),l(),w(" ",e.getFileTypeLabel(t.type)," "),l(),x(t.rowCount?13:-1),l(2),x(t.error?15:-1),l(2),u("size",16)}}function Ye(n,c){if(n&1){let t=E();o(0,"div",112)(1,"div",95)(2,"div",9)(3,"span",125),d(4),r(),d(5," registros en "),o(6,"span",125),d(7),r(),d(8," archivo(s) "),r(),o(9,"button",126),b("click",function(){T(t);let i=p(4);return I(i.processFiles())}),C(10,"lucide-angular",127),d(11," Procesar Carga "),r()()()}if(n&2){let t=p(4);l(4),L(t.getTotalRows()),l(3),L(t.filesToProcess().length),l(3),u("size",18)}}function ze(n,c){if(n&1&&(o(0,"div",110),P(1,ke,18,38,"div",111,he),r(),h(3,Ye,12,3,"div",112)),n&2){let t=p(3);l(),N(t.filesToProcess()),l(2),x(t.canProcess()?3:-1)}}function He(n,c){if(n&1){let t=E();o(0,"div",92)(1,"div",94)(2,"div",95)(3,"div")(4,"h2",96),d(5),r(),o(6,"p",97),d(7),r()(),o(8,"div",98),h(9,Pe,3,1,"button",99),o(10,"label",100),C(11,"lucide-angular",101),d(12," Agregar Archivo "),o(13,"input",102),b("change",function(i){T(t);let a=p(2);return I(a.onFileSelected(i))}),r()()()()(),o(14,"div",103),h(15,Ne,7,2,"div",104)(16,ze,4,1),r()()}if(n&2){let t=p(2);l(5),L(t.getLoadModeTitle()),l(2),L(t.getLoadModeDescription()),l(2),x(t.filesToProcess().length>0?9:-1),l(2),u("size",16),l(2),u("multiple",t.selectedLoadMode()==="INITIAL_MONTH"),l(2),x(t.filesToProcess().length===0?15:16)}}function $e(n,c){n&1&&(o(0,"div",87),C(1,"lucide-angular",115),r(),o(2,"h3",135),d(3,"Carga completada exitosamente"),r()),n&2&&(l(),u("size",24))}function Ke(n,c){n&1&&(o(0,"div",136),C(1,"lucide-angular",137),r(),o(2,"h3",138),d(3,"Carga completada con errores"),r()),n&2&&(l(),u("size",24))}function Ue(n,c){if(n&1&&(o(0,"div",128)(1,"div",129),h(2,$e,4,1)(3,Ke,4,1),r(),o(4,"div",130)(5,"div",131)(6,"p",132),d(7,"Procesados"),r(),o(8,"p",133),d(9),r()(),o(10,"div",131)(11,"p",132),d(12,"Errores"),r(),o(13,"p",134),d(14),r()()()()),n&2){let t,e,i,a,s,m,_,g=p(2);S("border-emerald-500/50",(t=g.lastResult())==null?null:t.success)("border-red-500/50",!((e=g.lastResult())!=null&&e.success)),l(2),x((i=g.lastResult())!=null&&i.success?2:3),l(7),L((a=g.lastResult())==null?null:a.totalProcessed),l(4),S("text-red-400",(s=g.lastResult())==null?null:s.totalErrors)("text-gray-400",!((m=g.lastResult())!=null&&m.totalErrors)),l(),L((_=g.lastResult())==null?null:_.totalErrors)}}function je(n,c){if(n&1){let t=E();o(0,"div",10)(1,"h3",76),C(2,"lucide-angular",77),d(3," Tipo de Carga "),r(),o(4,"div",78)(5,"button",79),b("click",function(){T(t);let i=p();return I(i.selectLoadMode("DAILY"))}),o(6,"div",80)(7,"div",81),C(8,"lucide-angular",82),r(),o(9,"div")(10,"h4",83),d(11,"Carga Diaria"),r(),o(12,"p",84),d(13,"Actualizaci\xF3n diaria"),r()()(),o(14,"p",85),d(15,"Cartera_CONTACTO_TOTAL_YYYY-MM-DD.xlsx"),r()(),o(16,"button",86),b("click",function(){T(t);let i=p();return I(i.selectLoadMode("INITIAL_MONTH"))}),o(17,"div",80)(18,"div",87),C(19,"lucide-angular",88),r(),o(20,"div")(21,"h4",83),d(22,"Carga Inicial de Mes"),r(),o(23,"p",84),d(24,"Asignaci\xF3n + Complementarios"),r()()(),o(25,"p",85),d(26,"CONTACTO_TOTAL_ASIGNACION_YYYYMM.xlsx + opcionales"),r()(),o(27,"button",89),b("click",function(){T(t);let i=p();return I(i.selectLoadMode("PKM"))}),o(28,"div",80)(29,"div",90),C(30,"lucide-angular",91),r(),o(31,"div")(32,"h4",83),d(33,"Carga PKM"),r(),o(34,"p",84),d(35,"Variable (sin fecha fija)"),r()()(),o(36,"p",85),d(37,"CONTACTO_TOTAL_PKM_MESYY.xlsx"),r()()()(),h(38,He,17,6,"div",92),h(39,Ue,15,11,"div",93)}if(n&2){let t=p();l(2),u("size",14),l(3),S("ring-2",t.selectedLoadMode()==="DAILY")("ring-blue-500",t.selectedLoadMode()==="DAILY")("bg-blue-900/30",t.selectedLoadMode()==="DAILY"),l(3),u("size",20),l(8),S("ring-2",t.selectedLoadMode()==="INITIAL_MONTH")("ring-emerald-500",t.selectedLoadMode()==="INITIAL_MONTH")("bg-emerald-900/30",t.selectedLoadMode()==="INITIAL_MONTH"),l(3),u("size",20),l(8),S("ring-2",t.selectedLoadMode()==="PKM")("ring-amber-500",t.selectedLoadMode()==="PKM")("bg-amber-900/30",t.selectedLoadMode()==="PKM"),l(3),u("size",20),l(8),x(t.selectedLoadMode()?38:-1),l(),x(t.lastResult()?39:-1)}}function Be(n,c){n&1&&(o(0,"div",19),C(1,"lucide-angular",139),o(2,"h3",140),d(3,"Configuraci\xF3n de cabeceras pendiente"),r(),o(4,"p",141),d(5,"Debe configurar las cabeceras para esta subcartera antes de importar datos."),r(),o(6,"a",142),C(7,"lucide-angular",143),d(8," Ir a Configuraci\xF3n de Cabeceras "),r()()),n&2&&(l(),u("size",48),l(6),u("size",16))}var ut=(()=>{let c=class c{constructor(e,i,a,s){this.tenantService=e,this.portfolioService=i,this.headerConfigService=a,this.complementaryFileService=s,this.notificationService=j(se),this.tenants=v([]),this.portfolios=v([]),this.subPortfolios=v([]),this.headersInicial=v([]),this.headersActualizacion=v([]),this.complementaryTypes=v([]),this.selectedTenantId=0,this.selectedPortfolioId=0,this.selectedSubPortfolioId=0,this.selectedLoadMode=v(null),this.filesToProcess=v([]),this.isLoading=v(!1),this.loadingMessage=v("Procesando..."),this.lastResult=v(null),this.showUnregisteredColumnsDialog=v(!1),this.unregisteredColumns=v([]),this.pendingFileForValidation=v(null),this.newHeaderForms=v([]),this.isCreatingHeaders=v(!1)}ngOnInit(){this.loadTenants()}loadTenants(){this.tenantService.getAllTenants().subscribe({next:e=>this.tenants.set(e),error:e=>console.error("Error loading tenants:",e)})}onTenantChange(e){this.selectedTenantId=e,this.selectedPortfolioId=0,this.selectedSubPortfolioId=0,this.portfolios.set([]),this.subPortfolios.set([]),this.resetLoadState(),e>0&&this.portfolioService.getPortfoliosByTenant(e).subscribe({next:i=>this.portfolios.set(i),error:i=>console.error("Error loading portfolios:",i)})}onPortfolioChange(e){this.selectedPortfolioId=e,this.selectedSubPortfolioId=0,this.subPortfolios.set([]),this.resetLoadState(),e>0&&this.portfolioService.getSubPortfoliosByPortfolio(e).subscribe({next:i=>this.subPortfolios.set(i),error:i=>console.error("Error loading subportfolios:",i)})}onSubPortfolioChange(e){this.selectedSubPortfolioId=e,this.resetLoadState(),e>0&&(this.loadHeaderConfigurations(),this.loadComplementaryTypes())}loadHeaderConfigurations(){this.headerConfigService.getBySubPortfolioAndLoadType(this.selectedSubPortfolioId,"INICIAL").subscribe({next:e=>this.headersInicial.set(e),error:e=>console.error("Error loading INICIAL headers:",e)}),this.headerConfigService.getBySubPortfolioAndLoadType(this.selectedSubPortfolioId,"ACTUALIZACION").subscribe({next:e=>this.headersActualizacion.set(e),error:e=>console.error("Error loading ACTUALIZACION headers:",e)})}loadComplementaryTypes(){this.complementaryFileService.getTypesBySubPortfolio(this.selectedSubPortfolioId).subscribe({next:e=>this.complementaryTypes.set(e),error:e=>console.error("Error loading complementary types:",e)})}selectLoadMode(e){this.selectedLoadMode.set(e),this.filesToProcess.set([]),this.lastResult.set(null)}resetLoadState(){this.selectedLoadMode.set(null),this.filesToProcess.set([]),this.lastResult.set(null)}onFileSelected(e){let i=e.target.files;if(!(!i||i.length===0)){for(let a=0;a<i.length;a++){let s=i[a],m=ue(s.name);if(!this.isFileTypeValidForMode(m)){this.notificationService.error("Archivo no v\xE1lido",`El archivo "${s.name}" no es v\xE1lido para el tipo de carga seleccionado.`);continue}if(this.isDuplicateFileType(m)){this.notificationService.warning("Archivo duplicado",`Ya existe un archivo de tipo "${H(m)}".`);continue}let _={file:s,type:m,validated:!1};this.filesToProcess.update(g=>[...g,_]),this.parseAndValidateFile(_)}e.target.value=""}}isFileTypeValidForMode(e){switch(this.selectedLoadMode()){case"DAILY":return e==="DAILY";case"INITIAL_MONTH":return["INITIAL_MAIN","COMPLEMENTARY_FACILITIES","COMPLEMENTARY_PKM"].includes(e);case"PKM":return e==="COMPLEMENTARY_PKM";default:return!1}}isDuplicateFileType(e){return this.filesToProcess().some(i=>i.type===e)}removeFile(e){this.filesToProcess.update(i=>i.filter(a=>a!==e))}clearFiles(){this.filesToProcess.set([]),this.lastResult.set(null)}parseAndValidateFile(e){return A(this,null,function*(){try{let i=yield this.readExcelFile(e.file);if(i.length===0){this.updateFileError(e,"El archivo est\xE1 vac\xEDo");return}let a=Object.keys(i[0]);if(e.data=i,e.headers=a,e.rowCount=i.length,e.type==="DAILY"||e.type==="INITIAL_MAIN"){let s=this.detectUnregisteredColumns(e);if(s.length>0){this.unregisteredColumns.set(s),this.pendingFileForValidation.set(e),this.showUnregisteredColumnsDialog.set(!0);return}}this.completeFileValidation(e)}catch(i){this.updateFileError(e,i.message||"Error al leer el archivo")}})}detectUnregisteredColumns(e){if(!e.headers||!e.data)return[];let i=e.type==="DAILY"?this.headersActualizacion():this.headersInicial(),a=new Set;i.forEach(m=>{a.add(m.headerName.toLowerCase()),m.aliases&&m.aliases.forEach(_=>{a.add(_.alias.toLowerCase())})});let s=[];return e.headers.forEach(m=>{if(!a.has(m.toLowerCase())){let _=[];for(let g=0;g<Math.min(5,e.data.length);g++){let y=e.data[g][m];y!=null&&String(y).trim()!==""&&_.push(String(y).trim())}s.push({name:m,sampleValues:_,detectedType:this.detectColumnType(_)})}}),s}detectColumnType(e){if(e.length===0)return"TEXTO";let i=[/^\d{4}-\d{2}-\d{2}$/,/^\d{2}\/\d{2}\/\d{4}$/,/^\d{2}-\d{2}-\d{4}$/,/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/];if(e.every(_=>i.some(g=>g.test(_))))return"FECHA";let s=/^-?\d+([.,]\d+)?$/;return e.every(_=>s.test(_.replace(/,/g,".")))?"NUMERICO":"TEXTO"}completeFileValidation(e){e.validated=!0,e.error=void 0,this.filesToProcess.update(i=>[...i])}updateFileError(e,i){e.error=i,e.validated=!1,this.filesToProcess.update(a=>[...a])}readExcelFile(e){return new Promise((i,a)=>{let s=new FileReader;s.onload=m=>{try{let _=new Uint8Array(m.target.result),g=le(_,{type:"array"}),y=g.Sheets[g.SheetNames[0]],f=de.sheet_to_json(y,{defval:""});i(f)}catch(_){a(_)}},s.onerror=()=>a(new Error("Error al leer el archivo")),s.readAsArrayBuffer(e)})}canProcess(){let e=this.filesToProcess();if(e.length===0)return!1;let i=this.selectedLoadMode();return e.every(s=>s.validated&&!s.error)?i==="INITIAL_MONTH"?e.some(s=>s.type==="INITIAL_MAIN"):!0:!1}getTotalRows(){return this.filesToProcess().reduce((e,i)=>e+(i.rowCount||0),0)}processFiles(){return A(this,null,function*(){let e=this.selectedLoadMode();if(e){this.isLoading.set(!0),this.lastResult.set(null);try{switch(e){case"DAILY":yield this.processDailyLoad();break;case"INITIAL_MONTH":yield this.processInitialMonthLoad();break;case"PKM":yield this.processPkmLoad();break}}catch(i){console.error("Error processing files:",i),this.lastResult.set({success:!1,totalProcessed:0,totalErrors:1,error:i.message})}finally{this.isLoading.set(!1)}}})}processDailyLoad(){return A(this,null,function*(){this.loadingMessage.set("Procesando carga diaria...");let e=this.filesToProcess().find(a=>a.type==="DAILY");if(!e||!e.data)throw new Error("No hay archivo de carga diaria");let i=yield M(this.headerConfigService.importData(this.selectedSubPortfolioId,"ACTUALIZACION",e.data));this.lastResult.set({success:!i.errors||i.errors.length===0,totalProcessed:i.insertedRows||0,totalErrors:i.failedRows||0,mode:"DAILY",mainFileResult:i}),this.filesToProcess.set([])})}processInitialMonthLoad(){return A(this,null,function*(){let e=this.filesToProcess(),i=e.find(f=>f.type==="INITIAL_MAIN");if(!i||!i.data)throw new Error("No hay archivo de asignaci\xF3n inicial");let a=0,s=0,m=[];this.loadingMessage.set("Procesando asignaci\xF3n inicial...");let _=yield M(this.headerConfigService.importData(this.selectedSubPortfolioId,"INICIAL",i.data));a+=_.insertedRows||0,s+=_.failedRows||0;let g=e.find(f=>f.type==="COMPLEMENTARY_FACILITIES");if(g&&g.data){this.loadingMessage.set("Procesando facilidades de pago...");try{let f=yield M(this.complementaryFileService.importComplementaryData({subPortfolioId:this.selectedSubPortfolioId,typeName:"FACILIDADES",data:g.data}));m.push(f),a+=f?.updatedRows||0,s+=f?.errorRows||0}catch(f){console.error("Error processing facilities:",f),s++}}let y=e.find(f=>f.type==="COMPLEMENTARY_PKM");if(y&&y.data){this.loadingMessage.set("Procesando PKM...");try{let f=yield M(this.complementaryFileService.importComplementaryData({subPortfolioId:this.selectedSubPortfolioId,typeName:"PKM",data:y.data}));m.push(f),a+=f?.updatedRows||0,s+=f?.errorRows||0}catch(f){console.error("Error processing PKM:",f),s++}}this.lastResult.set({success:s===0,totalProcessed:a,totalErrors:s,mode:"INITIAL_MONTH",mainFileResult:_,complementaryResults:m}),this.filesToProcess.set([])})}processPkmLoad(){return A(this,null,function*(){this.loadingMessage.set("Procesando carga PKM...");let e=this.filesToProcess().find(a=>a.type==="COMPLEMENTARY_PKM");if(!e||!e.data)throw new Error("No hay archivo PKM");let i=yield M(this.complementaryFileService.importComplementaryData({subPortfolioId:this.selectedSubPortfolioId,typeName:"PKM",data:e.data}));this.lastResult.set({success:(i?.errorRows??0)===0,totalProcessed:i?.updatedRows||0,totalErrors:i?.errorRows||0,mode:"PKM",mainFileResult:i}),this.filesToProcess.set([])})}hasHeadersConfigured(){return this.headersInicial().length>0||this.headersActualizacion().length>0}getLoadModeTitle(){switch(this.selectedLoadMode()){case"DAILY":return"Carga Diaria";case"INITIAL_MONTH":return"Carga Inicial de Mes";case"PKM":return"Carga PKM";default:return""}}getLoadModeDescription(){switch(this.selectedLoadMode()){case"DAILY":return"Suba el archivo de actualizaci\xF3n diaria (Cartera_CONTACTO_TOTAL_YYYY-MM-DD.xlsx)";case"INITIAL_MONTH":return"Suba el archivo de asignaci\xF3n (obligatorio) y opcionalmente los archivos de facilidades y PKM";case"PKM":return"Suba el archivo PKM para actualizar la columna PKM de los registros existentes";default:return""}}getExpectedFilesDescription(){switch(this.selectedLoadMode()){case"DAILY":return"Archivo esperado: Cartera_CONTACTO_TOTAL_YYYY-MM-DD.xlsx";case"INITIAL_MONTH":return"Principal: CONTACTO_TOTAL_ASIGNACION_YYYYMM.xlsx | Opcionales: Facilidades_Pago_*.xlsx, CONTACTO_TOTAL_PKM_*.xlsx";case"PKM":return"Archivo esperado: CONTACTO_TOTAL_PKM_MESYY.xlsx";default:return""}}getFileTypeLabel(e){return H(e)}cancelUnregisteredDialog(){let e=this.pendingFileForValidation();e&&this.filesToProcess.update(i=>i.filter(a=>a!==e)),this.showUnregisteredColumnsDialog.set(!1),this.unregisteredColumns.set([]),this.pendingFileForValidation.set(null),this.newHeaderForms.set([]),this.notificationService.info("Importaci\xF3n cancelada","El archivo no fue procesado")}toggleColumnSelection(e){this.unregisteredColumns.update(a=>{let s=[...a];return s[e]=D(O({},s[e]),{selected:!s[e].selected}),s});let i=this.unregisteredColumns()[e];this.newHeaderForms.update(a=>{let s=[...a];return i.selected&&(s[e]={headerName:i.name,dataType:i.detectedType,displayLabel:this.generateDisplayLabel(i.name),format:i.detectedType==="FECHA"?"dd/MM/yyyy":"",required:!1,sampleValues:i.sampleValues}),s})}generateDisplayLabel(e){return e.replace(/_/g," ").toLowerCase().replace(/\b\w/g,i=>i.toUpperCase())}updateHeaderForm(e,i,a){let s=a.target.value;this.newHeaderForms.update(m=>{let _=[...m];return _[e]&&(_[e]=D(O({},_[e]),{[i]:s})),_})}getSelectedColumnsCount(){return this.unregisteredColumns().filter(e=>e.selected).length}selectAllColumns(){let e=this.getSelectedColumnsCount()===this.unregisteredColumns().length;this.unregisteredColumns.update(i=>i.map(a=>D(O({},a),{selected:!e}))),e||this.newHeaderForms.set(this.unregisteredColumns().map(i=>({headerName:i.name,dataType:i.detectedType,displayLabel:this.generateDisplayLabel(i.name),format:i.detectedType==="FECHA"?"dd/MM/yyyy":"",required:!1,sampleValues:i.sampleValues})))}createSelectedHeadersAndContinue(){return A(this,null,function*(){let e=this.unregisteredColumns().filter(g=>g.selected),i=this.newHeaderForms();if(e.length===0){this.notificationService.warning("Sin selecci\xF3n","No hay columnas seleccionadas para crear");return}let a=this.pendingFileForValidation();if(!a){this.notificationService.error("Error","No hay archivo pendiente");return}let s=a.type==="DAILY"?"ACTUALIZACION":"INICIAL",m=e.map(g=>{let y=this.unregisteredColumns().findIndex(ge=>ge.name===g.name),f=i[y];return{fieldDefinitionId:0,headerName:f?.headerName||g.name,dataType:f?.dataType||g.detectedType,displayLabel:f?.displayLabel||this.generateDisplayLabel(g.name),format:f?.format||(g.detectedType==="FECHA"?"dd/MM/yyyy":void 0),required:f?.required||!1,sourceField:void 0,regexPattern:void 0}}),_={subPortfolioId:this.selectedSubPortfolioId,loadType:s,headers:m};this.isCreatingHeaders.set(!0);try{let g=yield M(this.headerConfigService.createBulk(_));if(this.notificationService.success("Cabeceras creadas",`Se crearon ${m.length} cabecera(s) exitosamente`),s==="ACTUALIZACION"){let y=yield M(this.headerConfigService.getBySubPortfolioAndLoadType(this.selectedSubPortfolioId,"ACTUALIZACION"));this.headersActualizacion.set(y)}else{let y=yield M(this.headerConfigService.getBySubPortfolioAndLoadType(this.selectedSubPortfolioId,"INICIAL"));this.headersInicial.set(y)}this.showUnregisteredColumnsDialog.set(!1),this.unregisteredColumns.set([]),this.newHeaderForms.set([]),this.pendingFileForValidation.set(null),yield this.parseAndValidateFile(a)}catch(g){console.error("Error creando cabeceras:",g),this.notificationService.error("Error al crear cabeceras",g.error?.message||g.message||"No se pudieron crear las cabeceras")}finally{this.isCreatingHeaders.set(!1)}})}proceedIgnoringUnregisteredColumns(){let e=this.pendingFileForValidation();if(!e){this.notificationService.error("Error","No hay archivo pendiente para procesar");return}let i=this.unregisteredColumns().filter(a=>!a.selected);if(i.length>0){let a=i.map(s=>s.name).join(", ");this.notificationService.warning("Columnas ignoradas",`Las siguientes columnas no ser\xE1n importadas: ${a}`,8e3)}this.showUnregisteredColumnsDialog.set(!1),this.unregisteredColumns.set([]),this.newHeaderForms.set([]),this.pendingFileForValidation.set(null),this.completeFileValidation(e)}};c.\u0275fac=function(i){return new(i||c)(F(re),F(ae),F(me),F(pe))},c.\u0275cmp=B({type:c,selectors:[["app-consolidated-load"]],decls:45,vars:16,consts:[[1,"fixed","inset-0","z-[60]","flex","items-center","justify-center"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center"],[1,"min-h-screen","bg-gradient-to-br","from-slate-900","via-slate-800","to-slate-900","p-6"],[1,"max-w-7xl","mx-auto"],[1,"mb-6"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","bg-gradient-to-br","from-emerald-500","to-teal-600","rounded-xl","flex","items-center","justify-center","shadow-lg"],["name","upload-cloud",1,"text-white",3,"size"],[1,"text-xl","font-bold","text-white"],[1,"text-sm","text-gray-400"],[1,"bg-slate-900/80","backdrop-blur","rounded-xl","p-4","shadow-lg","border","border-slate-800","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-xs","font-semibold","text-gray-300","mb-1.5"],["name","building-2",1,"inline","mr-1",3,"size"],[1,"w-full","px-3","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","text-sm","focus:outline-none","focus:ring-2","focus:ring-emerald-500","transition-all",3,"ngModelChange","ngModel"],[3,"value"],["name","folder",1,"inline","mr-1",3,"size"],[1,"w-full","px-3","py-2.5","bg-slate-800","border","border-slate-700","rounded-lg","text-white","text-sm","focus:outline-none","focus:ring-2","focus:ring-emerald-500","disabled:opacity-50","disabled:cursor-not-allowed","transition-all",3,"ngModelChange","ngModel","disabled"],["name","folder-tree",1,"inline","mr-1",3,"size"],[1,"bg-amber-900/20","border","border-amber-500/30","rounded-xl","p-6","text-center"],[1,"absolute","inset-0","bg-black/70","backdrop-blur-sm"],[1,"relative","bg-slate-800","rounded-2xl","shadow-2xl","border","border-slate-700","max-w-4xl","w-full","mx-4","max-h-[90vh]","overflow-hidden"],[1,"bg-gradient-to-r","from-amber-600","to-orange-600","p-5"],[1,"w-12","h-12","bg-white/20","rounded-xl","flex","items-center","justify-center"],["name","alert-triangle",1,"text-white",3,"size"],[1,"text-amber-100","text-sm"],[1,"font-semibold"],[1,"p-5","overflow-y-auto","max-h-[60vh]"],[1,"text-gray-300","text-sm","mb-4"],[1,"space-y-3","mb-4"],[1,"bg-slate-700/50","rounded-lg","border","transition-all",3,"border-emerald-500","border-slate-600"],[1,"bg-slate-900/50","rounded-lg","p-3","flex","items-center","justify-between"],[1,"flex","items-center","gap-4"],[1,"text-emerald-400","font-semibold"],[1,"text-sm","text-gray-500"],[1,"text-xs","text-emerald-400","hover:text-emerald-300","cursor-pointer",3,"click"],[1,"border-t","border-slate-700","p-4","bg-slate-900","flex","flex-col","sm:flex-row","gap-3","justify-between"],[1,"px-4","py-2.5","bg-slate-700","text-gray-300","rounded-lg","hover:bg-slate-600","transition-colors","font-medium","cursor-pointer",3,"click"],[1,"flex","gap-3"],[1,"px-4","py-2.5","bg-slate-600","text-white","rounded-lg","hover:bg-slate-500","transition-colors","font-medium","flex","items-center","justify-center","gap-2","cursor-pointer",3,"click"],["name","skip-forward",3,"size"],[1,"px-4","py-2.5","bg-emerald-600","text-white","rounded-lg","hover:bg-emerald-700","transition-colors","font-medium","flex","items-center","justify-center","gap-2","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"bg-slate-700/50","rounded-lg","border","transition-all"],[1,"p-3"],[1,"flex","items-start","gap-3"],[1,"flex","items-center","cursor-pointer","mt-1"],["type","checkbox",1,"w-5","h-5","rounded","border-slate-500","bg-slate-800","text-emerald-500","focus:ring-emerald-500","focus:ring-offset-0","cursor-pointer",3,"change","checked"],[1,"flex-1"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-mono","text-amber-400","font-semibold","text-lg"],[1,"text-xs","px-2","py-1","rounded-full"],[1,"text-xs","text-gray-400","mb-2"],[1,"mt-3","pt-3","border-t","border-slate-600","grid","grid-cols-1","md:grid-cols-3","gap-3"],[1,"text-gray-500"],[1,"font-mono","bg-slate-800","px-2","py-0.5","rounded","ml-1","text-gray-300"],[1,"block","text-xs","text-gray-400","mb-1"],["type","text","placeholder","Ej: Fecha de Pago",1,"w-full","px-3","py-1.5","bg-slate-800","border","border-slate-600","rounded","text-white","text-sm","focus:outline-none","focus:ring-1","focus:ring-emerald-500",3,"input","value"],[1,"w-full","px-3","py-1.5","bg-slate-800","border","border-slate-600","rounded","text-white","text-sm","focus:outline-none","focus:ring-1","focus:ring-emerald-500",3,"change","value"],["value","TEXTO"],["value","NUMERICO"],["value","FECHA"],["type","text",1,"w-full","px-3","py-1.5","bg-slate-800","border","border-slate-600","rounded","text-white","text-sm","focus:outline-none","focus:ring-1","focus:ring-emerald-500",3,"input","value","placeholder"],[1,"px-4","py-2.5","bg-emerald-600","text-white","rounded-lg","hover:bg-emerald-700","transition-colors","font-medium","flex","items-center","justify-center","gap-2","cursor-pointer","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"w-4","h-4","border-2","border-white/30","border-t-white","rounded-full","animate-spin"],["name","plus-circle",3,"size"],[1,"absolute","inset-0","bg-black/60","backdrop-blur-sm"],[1,"relative","bg-slate-800","rounded-2xl","p-8","shadow-2xl","border","border-slate-700","max-w-md","w-full","mx-4"],[1,"flex","flex-col","items-center","gap-6"],[1,"relative"],[1,"w-16","h-16","border-4","border-slate-600","rounded-full"],[1,"absolute","top-0","left-0","w-16","h-16","border-4","border-blue-500","rounded-full","border-t-transparent","animate-spin"],[1,"text-center"],[1,"text-xl","font-bold","text-white","mb-2"],[1,"text-gray-400","text-sm"],[1,"w-full","bg-slate-700","rounded-full","h-2","overflow-hidden"],[1,"bg-gradient-to-r","from-blue-500","to-cyan-400","h-full","rounded-full","animate-pulse",2,"width","100%"],[1,"text-sm","font-semibold","text-gray-300","mb-3"],["name","layers",1,"inline","mr-1",3,"size"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-3"],[1,"p-4","bg-slate-800","rounded-xl","border","border-slate-700","hover:border-blue-500","transition-all","text-left","cursor-pointer",3,"click"],[1,"flex","items-center","gap-3","mb-2"],[1,"w-10","h-10","bg-blue-600/20","rounded-lg","flex","items-center","justify-center"],["name","calendar",1,"text-blue-400",3,"size"],[1,"font-semibold","text-white"],[1,"text-xs","text-gray-400"],[1,"text-xs","text-gray-500"],[1,"p-4","bg-slate-800","rounded-xl","border","border-slate-700","hover:border-emerald-500","transition-all","text-left","cursor-pointer",3,"click"],[1,"w-10","h-10","bg-emerald-600/20","rounded-lg","flex","items-center","justify-center"],["name","calendar-range",1,"text-emerald-400",3,"size"],[1,"p-4","bg-slate-800","rounded-xl","border","border-slate-700","hover:border-amber-500","transition-all","text-left","cursor-pointer",3,"click"],[1,"w-10","h-10","bg-amber-600/20","rounded-lg","flex","items-center","justify-center"],["name","trending-up",1,"text-amber-400",3,"size"],[1,"bg-slate-900/80","backdrop-blur","rounded-xl","shadow-lg","border","border-slate-800","overflow-hidden"],[1,"mt-6","bg-slate-900/80","backdrop-blur","rounded-xl","p-4","shadow-lg","border",3,"border-emerald-500/50","border-red-500/50"],[1,"p-4","border-b","border-slate-800"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-bold","text-white"],[1,"text-sm","text-gray-400","mt-1"],[1,"flex","gap-2"],[1,"px-3","py-2","bg-slate-700","text-gray-300","rounded-lg","hover:bg-slate-600","transition-all","text-sm","cursor-pointer"],[1,"px-4","py-2","bg-emerald-600","text-white","rounded-lg","hover:bg-emerald-700","transition-all","font-medium","cursor-pointer","text-sm","flex","items-center","gap-2"],["name","plus",3,"size"],["type","file","accept",".xlsx,.xls",1,"hidden",3,"change","multiple"],[1,"p-4"],[1,"border-2","border-dashed","border-slate-700","rounded-xl","p-8","text-center"],[1,"px-3","py-2","bg-slate-700","text-gray-300","rounded-lg","hover:bg-slate-600","transition-all","text-sm","cursor-pointer",3,"click"],["name","trash-2",1,"inline","mr-1",3,"size"],[1,"w-16","h-16","bg-slate-800","rounded-full","flex","items-center","justify-center","mx-auto","mb-4"],["name","file-spreadsheet",1,"text-gray-600",3,"size"],[1,"text-white","font-semibold","mb-2"],[1,"space-y-3"],[1,"bg-slate-800","rounded-xl","p-4","border",3,"border-emerald-500/50","border-red-500/50","border-slate-700"],[1,"mt-6","pt-4","border-t","border-slate-700"],[1,"bg-slate-800","rounded-xl","p-4","border"],[1,"w-10","h-10","rounded-lg","flex","items-center","justify-center"],["name","check-circle",1,"text-emerald-400",3,"size"],["name","alert-circle",1,"text-red-400",3,"size"],["name","file-spreadsheet",1,"text-gray-400",3,"size"],[1,"font-medium","text-white"],[1,"flex","items-center","gap-2","mt-0.5"],[1,"px-2","py-0.5","rounded","text-xs","font-medium"],[1,"flex","items-center","gap-2"],[1,"text-xs","text-red-400","max-w-xs","truncate"],[1,"p-2","text-gray-400","hover:text-red-400","hover:bg-slate-700","rounded-lg","transition-all","cursor-pointer",3,"click"],["name","x",3,"size"],[1,"text-white","font-semibold"],[1,"px-6","py-2.5","bg-gradient-to-r","from-emerald-500","to-teal-600","text-white","rounded-lg","hover:from-emerald-600","hover:to-teal-700","transition-all","font-semibold","cursor-pointer","flex","items-center","gap-2","shadow-lg","shadow-emerald-500/20",3,"click"],["name","play",3,"size"],[1,"mt-6","bg-slate-900/80","backdrop-blur","rounded-xl","p-4","shadow-lg","border"],[1,"flex","items-center","gap-3","mb-3"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4","text-sm"],[1,"bg-slate-800","rounded-lg","p-3"],[1,"text-gray-400"],[1,"text-2xl","font-bold","text-white"],[1,"text-2xl","font-bold"],[1,"text-lg","font-bold","text-emerald-400"],[1,"w-10","h-10","bg-red-600/20","rounded-lg","flex","items-center","justify-center"],["name","alert-triangle",1,"text-red-400",3,"size"],[1,"text-lg","font-bold","text-red-400"],["name","alert-triangle",1,"text-amber-400","mx-auto","mb-3",3,"size"],[1,"text-lg","font-bold","text-amber-400","mb-2"],[1,"text-gray-400","mb-4"],["routerLink","/admin/maintenance/headers",1,"inline-flex","items-center","gap-2","px-4","py-2","bg-amber-600","text-white","rounded-lg","hover:bg-amber-700","transition-all","font-medium"],["name","settings",3,"size"]],template:function(i,a){i&1&&(C(0,"app-notifications"),h(1,Se,37,8,"div",0),h(2,Ee,14,1,"div",1),o(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6),C(8,"lucide-angular",7),r(),o(9,"div")(10,"h1",8),d(11,"Carga Consolidada de Datos"),r(),o(12,"p",9),d(13,"Importaci\xF3n de archivos de cartera CONTACTO TOTAL"),r()()()(),o(14,"div",10)(15,"div",11)(16,"div")(17,"label",12),C(18,"lucide-angular",13),d(19," Proveedor "),r(),o(20,"select",14),Y("ngModelChange",function(m){return k(a.selectedTenantId,m)||(a.selectedTenantId=m),m}),b("ngModelChange",function(m){return a.onTenantChange(m)}),o(21,"option",15),d(22,"Seleccione un proveedor..."),r(),P(23,Me,2,3,"option",15,$),r()(),o(25,"div")(26,"label",12),C(27,"lucide-angular",16),d(28," Cartera "),r(),o(29,"select",17),Y("ngModelChange",function(m){return k(a.selectedPortfolioId,m)||(a.selectedPortfolioId=m),m}),b("ngModelChange",function(m){return a.onPortfolioChange(m)}),o(30,"option",15),d(31,"Seleccione una cartera..."),r(),P(32,we,2,3,"option",15,$),r()(),o(34,"div")(35,"label",12),C(36,"lucide-angular",18),d(37," Subcartera "),r(),o(38,"select",17),Y("ngModelChange",function(m){return k(a.selectedSubPortfolioId,m)||(a.selectedSubPortfolioId=m),m}),b("ngModelChange",function(m){return a.onSubPortfolioChange(m)}),o(39,"option",15),d(40,"Seleccione una subcartera..."),r(),P(41,Ae,2,3,"option",15,$),r()()()(),h(43,je,40,24),h(44,Be,9,2,"div",19),r()()),i&2&&(l(),x(a.showUnregisteredColumnsDialog()?1:-1),l(),x(a.isLoading()?2:-1),l(6),u("size",20),l(10),u("size",14),l(2),R("ngModel",a.selectedTenantId),l(),u("value",0),l(2),N(a.tenants()),l(4),u("size",14),l(2),R("ngModel",a.selectedPortfolioId),u("disabled",a.selectedTenantId===0),l(),u("value",0),l(2),N(a.portfolios()),l(4),u("size",14),l(2),R("ngModel",a.selectedSubPortfolioId),u("disabled",a.selectedPortfolioId===0),l(),u("value",0),l(2),N(a.subPortfolios()),l(2),x(a.selectedSubPortfolioId>0?43:-1),l(),x(a.selectedSubPortfolioId>0&&!a.hasHeadersConfigured()?44:-1))},dependencies:[W,oe,ie,ne,te,Q,ee,q,G,Z,ce],styles:["[_nghost-%COMP%]{display:block}"]});let n=c;return n})();export{ut as ConsolidatedLoadComponent};
