import{a as u}from"./chunk-YQKVMPSG.js";import{b as l,c as g}from"./chunk-72Z2NTOL.js";import{ba as h,fa as m}from"./chunk-BDAG5FYU.js";var U=(()=>{let t=class t{constructor(e){this.http=e,this.baseUrl=`${u.gatewayUrl}/pagos-bcp`}cargarArchivo(e){let a=new FormData;return a.append("file",e),console.log("[BCP] Cargando archivo:",e.name),this.http.post(`${this.baseUrl}/cargar-archivo`,a)}cargarArchivoOh(e){let a=new FormData;return a.append("file",e),console.log("[OH] Cargando archivo Excel:",e.name),this.http.post(`${this.baseUrl}/cargar-archivo-oh`,a)}registrarPagoManual(e){return console.log("[BCP] Registrando pago manual:",e),this.http.post(`${this.baseUrl}/registrar-manual`,e)}verificarEstado(){return this.http.get(`${this.baseUrl}/status`)}listarPagosManuales(e={}){let a=new l;return e.documento&&(a=a.set("documento",e.documento)),e.banco&&(a=a.set("banco",e.banco)),e.medioAtencion&&(a=a.set("medioAtencion",e.medioAtencion)),e.fechaDesde&&(a=a.set("fechaDesde",e.fechaDesde)),e.fechaHasta&&(a=a.set("fechaHasta",e.fechaHasta)),e.page&&(a=a.set("page",e.page.toString())),e.size&&(a=a.set("size",e.size.toString())),console.log("[BCP] Listando pagos manuales con filtros:",e),this.http.get(`${this.baseUrl}/manuales`,{params:a})}actualizarPagoManual(e,a){return console.log("[BCP] Actualizando pago manual ID:",e,a),this.http.put(`${this.baseUrl}/manuales/${e}`,a)}eliminarPagoManual(e){return console.log("[BCP] Eliminando pago manual ID:",e),this.http.delete(`${this.baseUrl}/manuales/${e}`)}descargarReporteConciliacionPorFecha(e,a){let o=new l().set("fechaInicio",e);a&&(o=o.set("fechaFin",a)),console.log("[BCP] Descargando reporte de conciliaci\xF3n por fecha:",{fechaInicio:e,fechaFin:a}),this.http.get(`${this.baseUrl}/reporte-conciliacion/excel`,{params:o,responseType:"blob",observe:"response"}).subscribe({next:r=>{let n=a?`reporte-conciliacion-${e}-a-${a}.xlsx`:`reporte-conciliacion-${e}.xlsx`;this.procesarDescargaBlob(r,n)},error:r=>console.error("[BCP] Error descargando reporte:",r)})}procesarDescargaBlob(e,a){let o=e.body;if(!o){console.error("[BCP] No se recibi\xF3 el archivo");return}let r=e.headers.get("Content-Disposition"),n=a;if(r){let i=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(r);i&&i[1]&&(n=i[1].replace(/['"]/g,""))}let p=window.URL.createObjectURL(o),c=document.createElement("a");c.href=p,c.download=n,c.click(),window.URL.revokeObjectURL(p)}};t.\u0275fac=function(a){return new(a||t)(m(g))},t.\u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"});let s=t;return s})();export{U as a};
