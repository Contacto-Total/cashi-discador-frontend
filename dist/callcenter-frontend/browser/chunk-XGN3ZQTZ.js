import{a as I}from"./chunk-NCL4YEGI.js";import{Va as y,Wa as S}from"./chunk-OBC5CXPC.js";import{f as E}from"./chunk-AKFV6NFL.js";import{C as u,Gb as l,Hb as e,Ib as t,Jb as d,Sb as C,Ub as x,W as h,Wc as v,Xa as n,Xc as M,Yc as O,bb as f,bd as P,gc as i,hc as p,ib as _,ic as m,nb as b}from"./chunk-RD2OXGLD.js";function k(o,s){if(o&1&&(e(0,"div",8),d(1,"lucide-angular",9),i(2),t()),o&2){let a=x();n(),l("size",18),n(),m(" ",a.error)}}function z(o,s){o&1&&(e(0,"div",10),d(1,"div",11),e(2,"p"),i(3,"Cargando extensiones..."),t()())}function w(o,s){if(o&1&&(e(0,"tr")(1,"td",20),i(2),t(),e(3,"td"),i(4),t(),e(5,"td"),i(6),t(),e(7,"td"),i(8),t(),e(9,"td")(10,"span",21),i(11),t()(),e(12,"td",22),i(13),t()()),o&2){let a=s.$implicit,r=x(2);n(2),p(a.extension),n(2),p(a.fullName||a.displayName||"-"),n(2),p(a.ipAddress),n(2),p(a.port),n(2),l("ngClass",r.getStatusClass(a.status)),n(),m(" ",a.status," "),n(2),p(a.pingMs)}}function R(o,s){o&1&&(e(0,"tr")(1,"td",23),d(2,"lucide-angular",24),i(3," No hay extensiones registradas en este momento "),t()()),o&2&&(n(2),l("size",20))}function F(o,s){if(o&1&&(e(0,"div",12)(1,"div",13)(2,"h3"),d(3,"lucide-angular",14),i(4," Extensiones Registradas"),t(),e(5,"div",15),i(6),t()(),e(7,"div",16)(8,"table",17)(9,"thead")(10,"tr")(11,"th"),i(12,"Extensi\xF3n/Anexo"),t(),e(13,"th"),i(14,"Nombre"),t(),e(15,"th"),i(16,"IP"),t(),e(17,"th"),i(18,"Puerto"),t(),e(19,"th"),i(20,"Estado"),t(),e(21,"th"),i(22,"Respuesta"),t()()(),e(23,"tbody"),b(24,w,14,7,"tr",18)(25,R,4,1,"tr",19),t()()()()),o&2){let a=x();n(3),l("size",20),n(3),m(" Total: ",a.extensions.length," "),n(18),l("ngForOf",a.extensions),n(),l("ngIf",a.extensions.length===0)}}var q=(()=>{let s=class s{constructor(r,c){this.router=r,this.monitoringService=c,this.extensions=[],this.loading=!1,this.error=null}ngOnInit(){this.loadExtensions(),this.startPolling()}ngOnDestroy(){this.pollingSubscription&&this.pollingSubscription.unsubscribe()}loadExtensions(){this.loading=!0,this.error=null,this.monitoringService.getExtensionRegistrations().subscribe({next:r=>{this.extensions=r,this.loading=!1},error:r=>{console.error("Error loading extensions:",r),this.error="Error al cargar las extensiones registradas",this.loading=!1}})}startPolling(){this.pollingSubscription=u(5e3).pipe(h(()=>this.monitoringService.getExtensionRegistrations())).subscribe({next:r=>{this.extensions=r},error:r=>{console.error("Error polling extensions:",r)}})}goBack(){this.router.navigate(["/admin/campaigns"])}getStatusClass(r){return r==="REGISTRADO"?"status-registered":"status-unregistered"}};s.\u0275fac=function(c){return new(c||s)(f(E),f(I))},s.\u0275cmp=_({type:s,selectors:[["app-extensions-registry"]],decls:12,vars:5,consts:[[1,"extensions-container"],[1,"header"],[1,"btn-back",3,"click"],["name","arrow-left",3,"size"],["name","phone",3,"size"],["class","error-message",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","extensions-section",4,"ngIf"],[1,"error-message"],["name","x-circle",3,"size"],[1,"loading-state"],[1,"spinner"],[1,"extensions-section"],[1,"table-header"],["name","clipboard-list",3,"size"],[1,"info-badge"],[1,"table-container"],[1,"extensions-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"extension-cell"],[1,"status-badge",3,"ngClass"],[1,"ping-cell"],["colspan","6",1,"empty-row"],["name","inbox",3,"size"]],template:function(c,g){c&1&&(e(0,"div",0)(1,"div",1)(2,"button",2),C("click",function(){return g.goBack()}),d(3,"lucide-angular",3),e(4,"span"),i(5,"Volver a Campa\xF1as"),t()(),e(6,"h1"),d(7,"lucide-angular",4),i(8," Registro de Extensiones"),t()(),b(9,k,3,2,"div",5)(10,z,4,0,"div",6)(11,F,26,4,"div",7),t()),c&2&&(n(3),l("size",18),n(4),l("size",24),n(2),l("ngIf",g.error),n(),l("ngIf",g.loading&&g.extensions.length===0),n(),l("ngIf",!g.loading||g.extensions.length>0))},dependencies:[P,v,M,O,S,y],styles:[".extensions-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto;background:linear-gradient(to bottom right,#0f172a,#1e293b,#0f172a);min-height:100vh;color:#e2e8f0}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:30px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#f1f5f9;font-size:28px;font-weight:600}.btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background:#1e293b;color:#e2e8f0;border:1px solid #334155;border-radius:8px;cursor:pointer;font-size:14px;transition:all .3s}.btn-back[_ngcontent-%COMP%]:hover{background:#334155;border-color:#475569}.error-message[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid #EF4444;color:#ef4444;padding:12px 16px;border-radius:8px;margin-bottom:20px;font-size:14px}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px;color:#94a3b8}.spinner[_ngcontent-%COMP%]{border:4px solid #334155;border-top:4px solid #3B82F6;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.extensions-section[_ngcontent-%COMP%]{background:#1e293b;border:1px solid #334155;border-radius:12px;padding:20px}.table-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#f1f5f9;font-size:20px;font-weight:600}.info-badge[_ngcontent-%COMP%]{padding:6px 12px;background:#3b82f6;color:#fff;border-radius:6px;font-size:13px;font-weight:500}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.extensions-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.extensions-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#0f172a}.extensions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px;text-align:left;color:#94a3b8;font-size:13px;font-weight:600;border-bottom:2px solid #334155}.extensions-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #334155;transition:all .3s}.extensions-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#0f172a}.extensions-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;color:#e2e8f0;font-size:14px}.extension-cell[_ngcontent-%COMP%]{font-weight:600;color:#3b82f6}.ping-cell[_ngcontent-%COMP%]{font-weight:500;color:#10b981}.user-agent-cell[_ngcontent-%COMP%]{color:#94a3b8;font-size:12px}.empty-row[_ngcontent-%COMP%]{text-align:center;color:#94a3b8;padding:40px!important;font-size:16px}.status-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:6px;font-size:12px;font-weight:500;display:inline-block}.status-registered[_ngcontent-%COMP%]{background:#10b98133;color:#10b981;border:1px solid #10B981}.status-unregistered[_ngcontent-%COMP%]{background:#ef444433;color:#ef4444;border:1px solid #EF4444}@media (max-width: 768px){.extensions-container[_ngcontent-%COMP%]{padding:15px}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.table-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}}"]});let o=s;return o})();export{q as ExtensionsRegistryComponent};
