import{a as V,b as W,c as J,d as q}from"./chunk-IB2NHXXO.js";import{a as K,b as Q,c as X,d as Y,e as Z,f as tt,g as et,h as nt,i as it,j as at,k as ot}from"./chunk-YOUWZA5Z.js";import"./chunk-LHYR2XXE.js";import"./chunk-JCUQUAZ3.js";import{a as rt,b as ct}from"./chunk-NYU5KFCC.js";import"./chunk-NDEHQCFO.js";import"./chunk-EWTJORO2.js";import{P as R,R as j,T as F,U as H,V as G}from"./chunk-G76W7QED.js";import{a as B}from"./chunk-KKLO557Y.js";import"./chunk-2GTPXCMV.js";import{g as U,j as A}from"./chunk-AKFV6NFL.js";import{$ as P,C as O,Gb as f,Hb as i,Ib as e,Jb as x,Nb as g,Ob as u,Qb as D,Sb as b,Ub as _,Xa as l,Yc as L,bb as h,bd as N,da as E,f as S,fc as I,gc as n,hc as m,ib as T,ic as v,id as M,jc as k,jd as z,ka as y,la as w,md as C,nb as p,qc as $}from"./chunk-RD2OXGLD.js";var lt=(()=>{let r=class r{constructor(t){this.http=t,this.apiUrl=`${C.apiUrl}/contacts`}getAllContacts(t){let o=new M;return t&&(t.campaignId&&(o=o.set("campaignId",t.campaignId.toString())),t.status&&(o=o.set("status",t.status)),t.search&&(o=o.set("search",t.search)),t.page&&(o=o.set("page",t.page.toString())),t.size&&(o=o.set("size",t.size.toString()))),this.http.get(this.apiUrl,{params:o})}getContactById(t){return this.http.get(`${this.apiUrl}/${t}`)}createContact(t){return this.http.post(this.apiUrl,t)}updateContact(t,o){return this.http.put(`${this.apiUrl}/${t}`,o)}deleteContact(t){return this.http.delete(`${this.apiUrl}/${t}`)}getContactsByCampaign(t,o,c){let d=new M;return o!==void 0&&(d=d.set("page",o.toString())),c!==void 0&&(d=d.set("size",c.toString())),this.http.get(`${this.apiUrl}/campaign/${t}`,{params:d})}importContacts(t,o,c){let d=new FormData;return d.append("file",o),d.append("campaignId",t.toString()),d.append("mapping",JSON.stringify(c)),this.http.post(`${this.apiUrl}/import`,d)}getNextContact(t,o){return this.http.get(`${this.apiUrl}/next?campaignId=${t}&agentId=${o}`)}getActiveCall(t){return this.http.get(`${C.apiUrl}/autodialer/active-call/${t}`)}getActiveCallByExtension(t){return this.http.get(`${C.apiUrl}/autodialer/active-call/extension/${t}`)}getClienteDetalle(t){return this.http.get(`${this.apiUrl}/${t}/cliente-detalle`)}};r.\u0275fac=function(o){return new(o||r)(E(z))},r.\u0275prov=P({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var dt=a=>["/contacts",a,"edit"];function pt(a,r){a&1&&(i(0,"th",49),n(1,"Nombre"),e())}function gt(a,r){if(a&1&&(i(0,"td",50),n(1),e()),a&2){let s=r.$implicit;l(),k(" ",s.firstName," ",s.lastName," ")}}function ut(a,r){a&1&&(i(0,"th",49),n(1,"Tel\xE9fono"),e())}function ft(a,r){if(a&1&&(i(0,"td",50),n(1),e()),a&2){let s=r.$implicit;l(),m(s.phoneNumber)}}function ht(a,r){a&1&&(i(0,"th",49),n(1,"Email"),e())}function Ct(a,r){if(a&1&&(i(0,"td",50),n(1),e()),a&2){let s=r.$implicit;l(),m(s.email||"N/A")}}function xt(a,r){a&1&&(i(0,"th",49),n(1,"Estado"),e())}function bt(a,r){if(a&1&&(i(0,"td",50)(1,"mat-chip"),n(2),e()()),a&2){let s=r.$implicit,t=_();l(),I("status-chip "+t.getStatusClass(s.status)),l(),v(" ",t.getStatusLabel(s.status)," ")}}function _t(a,r){a&1&&(i(0,"th",49),n(1,"Intentos"),e())}function vt(a,r){if(a&1&&(i(0,"td",50),n(1),e()),a&2){let s=r.$implicit;l(),m(s.attempts||0)}}function Mt(a,r){a&1&&(i(0,"th",49),n(1,"Acciones"),e())}function St(a,r){if(a&1){let s=D();i(0,"td",50)(1,"button",51)(2,"mat-icon"),n(3,"edit"),e()(),i(4,"button",52),b("click",function(){let o=y(s).$implicit,c=_();return w(c.callContact(o))}),i(5,"mat-icon"),n(6,"call"),e()()()}if(a&2){let s=r.$implicit;l(),f("routerLink",$(1,dt,s.id))}}function Ot(a,r){a&1&&x(0,"tr",53)}function Pt(a,r){a&1&&x(0,"tr",54)}function Et(a,r){a&1&&(i(0,"div",55)(1,"mat-icon"),n(2,"contacts"),e(),i(3,"p"),n(4,"No hay contactos registrados"),e(),i(5,"button",56)(6,"mat-icon"),n(7,"add"),e(),n(8," Agregar Primer Contacto "),e()())}var Jt=(()=>{let r=class r{constructor(t,o,c){this.contactService=t,this.authService=o,this.themeService=c,this.contacts=[],this.displayedColumns=["name","phone","email","status","attempts","actions"],this.currentUser=null,this.isDarkTheme=!1,this.elapsedTime=0}ngOnInit(){return S(this,null,function*(){this.currentUser=yield this.authService.getCurrentUser(),this.themeSubscription=this.themeService.theme$.subscribe(t=>{this.isDarkTheme=t==="dark"}),this.timerSubscription=O(1e3).subscribe(()=>{this.elapsedTime++}),this.contactService.getAllContacts().subscribe(t=>{this.contacts=t})})}ngOnDestroy(){this.themeSubscription?.unsubscribe(),this.timerSubscription?.unsubscribe()}toggleTheme(){this.themeService.toggleTheme()}formatTime(t){let o=Math.floor(t/3600),c=Math.floor(t%3600/60),d=t%60;return`${o.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`}getContactsByStatus(t){return this.contacts.filter(o=>o.status===t).length}getStatusLabel(t){return{NEW:"Nuevo",PENDING:"Pendiente",CONTACTED:"Contactado",FAILED:"Fallido"}[t]||t}getStatusClass(t){return t.toLowerCase()}callContact(t){alert(`Iniciando llamada a ${t.firstName} ${t.lastName} (${t.phoneNumber})`)}};r.\u0275fac=function(o){return new(o||r)(h(lt),h(B),h(q))},r.\u0275cmp=T({type:r,selectors:[["app-contact-list"]],decls:123,vars:16,consts:[[1,"contacts-container"],[1,"header"],[1,"header-left"],[1,"app-icon"],[1,"header-info"],[1,"subtitle"],[1,"advisor-info"],[1,"label"],[1,"name"],[1,"header-right"],["mat-raised-button","",1,"theme-toggle",3,"click"],[1,"status-section"],[1,"status-label"],[1,"status-value","available"],[1,"timer"],[1,"time"],[1,"info-bar"],[1,"info-data"],[1,"value"],[1,"action-buttons"],["mat-raised-button","","routerLink","/contacts/new",1,"btn-add"],["mat-raised-button","","routerLink","/dialer",1,"btn-back"],[1,"main-content"],[1,"left-panel"],[1,"filter-tabs"],["label","\u{1F50D} Filtros"],[1,"tab-content"],[1,"section"],[1,"section-title"],[1,"filter-option"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value"],[1,"right-panel"],[1,"list-section"],[1,"section-header"],[1,"table-container"],["mat-table","",1,"contacts-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","phone"],["matColumnDef","email"],["matColumnDef","status"],["matColumnDef","attempts"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","table-row",4,"matRowDef","matRowDefColumns"],["class","no-data",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",1,"action-btn",3,"routerLink"],["mat-icon-button","",1,"action-btn","call-btn",3,"click"],["mat-header-row",""],["mat-row","",1,"table-row"],[1,"no-data"],["mat-raised-button","","color","primary","routerLink","/contacts/new"]],template:function(o,c){o&1&&(i(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"mat-icon"),n(5,"contacts"),e()(),i(6,"div",4)(7,"h1"),n(8,"Gesti\xF3n de Cobranza"),e(),i(9,"p",5),n(10,"\u{1F4CB} Gesti\xF3n de Contactos"),e()(),i(11,"div",6)(12,"span",7),n(13,"Asesor"),e(),i(14,"span",8),n(15),e()()(),i(16,"div",9)(17,"button",10),b("click",function(){return c.toggleTheme()}),i(18,"mat-icon"),n(19),e(),n(20),e(),i(21,"div",11)(22,"span",12),n(23,"Estado"),e(),i(24,"span",13),n(25," \u26AA DISPONIBLE "),e()(),i(26,"div",14)(27,"span",15),n(28),e()()()(),i(29,"div",16)(30,"div",17)(31,"span",7),n(32,"\u2726 TOTAL CONTACTOS"),e(),i(33,"span",18),n(34),e()(),i(35,"div",17)(36,"span",7),n(37,"Nuevos"),e(),i(38,"span",18),n(39),e()(),i(40,"div",17)(41,"span",7),n(42,"En Proceso"),e(),i(43,"span",18),n(44),e()(),i(45,"div",17)(46,"span",7),n(47,"Contactados"),e(),i(48,"span",18),n(49),e()(),i(50,"div",19)(51,"button",20)(52,"mat-icon"),n(53,"add"),e(),n(54," Nuevo Contacto "),e(),i(55,"button",21)(56,"mat-icon"),n(57,"arrow_back"),e(),n(58," Volver a Softphone "),e()()(),i(59,"div",22)(60,"aside",23)(61,"mat-tab-group",24)(62,"mat-tab",25)(63,"div",26)(64,"div",27)(65,"h3",28),n(66,"Estado"),e(),i(67,"div",29)(68,"label"),n(69,"Todos los estados"),e()()(),i(70,"div",27)(71,"h3",28),n(72,"\u{1F4CA} Estad\xEDsticas"),e(),i(73,"div",30)(74,"span",31),n(75,"Total:"),e(),i(76,"span",32),n(77),e()(),i(78,"div",30)(79,"span",31),n(80,"Nuevos:"),e(),i(81,"span",32),n(82),e()(),i(83,"div",30)(84,"span",31),n(85,"Pendientes:"),e(),i(86,"span",32),n(87),e()(),i(88,"div",30)(89,"span",31),n(90,"Contactados:"),e(),i(91,"span",32),n(92),e()()()()()()(),i(93,"main",33)(94,"div",34)(95,"div",35)(96,"mat-icon"),n(97,"list"),e(),i(98,"h3"),n(99,"Lista de Contactos"),e()(),i(100,"div",36)(101,"table",37),g(102,38),p(103,pt,2,0,"th",39)(104,gt,2,2,"td",40),u(),g(105,41),p(106,ut,2,0,"th",39)(107,ft,2,1,"td",40),u(),g(108,42),p(109,ht,2,0,"th",39)(110,Ct,2,1,"td",40),u(),g(111,43),p(112,xt,2,0,"th",39)(113,bt,3,3,"td",40),u(),g(114,44),p(115,_t,2,0,"th",39)(116,vt,2,1,"td",40),u(),g(117,45),p(118,Mt,2,0,"th",39)(119,St,7,3,"td",40),u(),p(120,Ot,1,0,"tr",46)(121,Pt,1,0,"tr",47),e(),p(122,Et,9,0,"div",48),e()()()()()),o&2&&(l(15),m((c.currentUser==null?null:c.currentUser.username)||"Usuario"),l(4),m(c.isDarkTheme?"wb_sunny":"nightlight"),l(),v(" ",c.isDarkTheme?"OSCURO":"CLARO"," "),l(8),m(c.formatTime(c.elapsedTime)),l(6),m(c.contacts.length),l(5),m(c.getContactsByStatus("NEW")),l(5),m(c.getContactsByStatus("PENDING")),l(5),m(c.getContactsByStatus("CONTACTED")),l(28),m(c.contacts.length),l(5),m(c.getContactsByStatus("NEW")),l(5),m(c.getContactsByStatus("PENDING")),l(5),m(c.getContactsByStatus("CONTACTED")),l(9),f("dataSource",c.contacts),l(19),f("matHeaderRowDef",c.displayedColumns),l(),f("matRowDefColumns",c.displayedColumns),l(),f("ngIf",c.contacts.length===0))},dependencies:[N,L,A,U,F,j,R,G,H,ot,K,X,et,Y,Q,nt,Z,tt,it,at,J,V,W,ct,rt],styles:[".contacts-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;background-color:var(--secondary-bg)}.header[_ngcontent-%COMP%]{background-color:var(--header-bg);color:var(--text-inverse);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;box-shadow:var(--shadow)}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.app-icon[_ngcontent-%COMP%]{background-color:#5da8e8;border-radius:8px;padding:8px;display:flex;align-items:center;justify-content:center}.app-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;color:#fff}.header-info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600}.header-info[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;font-size:12px;opacity:.9}.advisor-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-left:20px;border-left:1px solid rgba(255,255,255,.2)}.advisor-info[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:11px;opacity:.8}.advisor-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.theme-toggle[_ngcontent-%COMP%]{background-color:var(--theme-button-bg)!important;color:var(--theme-button-text)!important;font-weight:600;padding:0 20px;height:36px}.theme-toggle[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.status-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end}.status-label[_ngcontent-%COMP%]{font-size:11px;opacity:.8}.status-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600}.status-value.available[_ngcontent-%COMP%]{color:#10b981}.timer[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-size:24px;font-weight:600;padding:8px 16px;background-color:#0003;border-radius:4px}.info-bar[_ngcontent-%COMP%]{background-color:var(--client-bar-bg);border-bottom:1px solid var(--border-color);padding:16px 24px;display:flex;align-items:center;gap:32px;box-shadow:var(--shadow)}.info-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.info-data[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:11px;color:var(--text-secondary);text-transform:uppercase}.info-data[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--text-primary)}.action-buttons[_ngcontent-%COMP%]{margin-left:auto;display:flex;gap:12px}.btn-add[_ngcontent-%COMP%]{background-color:var(--button-primary)!important;color:#fff!important;font-weight:600}.btn-back[_ngcontent-%COMP%]{background-color:var(--button-secondary)!important;color:#fff!important;font-weight:600}.main-content[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:300px 1fr;gap:0;min-height:0}.left-panel[_ngcontent-%COMP%]{background-color:var(--panel-bg);border-right:1px solid var(--border-color);overflow-y:auto}.filter-tabs[_ngcontent-%COMP%]{height:100%}.tab-content[_ngcontent-%COMP%]{padding:20px}.section[_ngcontent-%COMP%]{margin-bottom:24px}.section-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--panel-text);margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid var(--border-color)}.filter-option[_ngcontent-%COMP%]{padding:8px 0}.filter-option[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:13px;color:var(--text-primary);cursor:pointer}.stat-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border-color)}.stat-label[_ngcontent-%COMP%]{font-size:12px;color:var(--text-secondary)}.stat-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--panel-text)}.right-panel[_ngcontent-%COMP%]{padding:24px;overflow-y:auto;background-color:var(--primary-bg)}.list-section[_ngcontent-%COMP%]{background-color:var(--secondary-bg);border:1px solid var(--border-color);border-radius:8px;padding:20px}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:20px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:var(--text-primary)}.section-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--accent-info)}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.contacts-table[_ngcontent-%COMP%]{width:100%;background-color:transparent}.contacts-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--secondary-bg);color:var(--text-primary);font-weight:600;font-size:13px;padding:12px 16px;border-bottom:2px solid var(--border-color)}.contacts-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--text-primary);font-size:14px;padding:12px 16px;border-bottom:1px solid var(--border-color)}.table-row[_ngcontent-%COMP%]{transition:background-color .2s}.table-row[_ngcontent-%COMP%]:hover{background-color:var(--secondary-bg)}.status-chip[_ngcontent-%COMP%]{font-size:11px;font-weight:600;padding:4px 12px;border-radius:12px}.status-chip.new[_ngcontent-%COMP%]{background-color:#60a5fa;color:#fff}.status-chip.pending[_ngcontent-%COMP%]{background-color:#fbbf24;color:#1a1a1a}.status-chip.contacted[_ngcontent-%COMP%]{background-color:#10b981;color:#fff}.status-chip.failed[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.action-btn[_ngcontent-%COMP%]{color:var(--text-secondary);transition:color .2s}.action-btn[_ngcontent-%COMP%]:hover{color:var(--accent-info)}.call-btn[_ngcontent-%COMP%]:hover{color:var(--button-primary)}.no-data[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:var(--text-secondary)}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;opacity:.3;margin-bottom:16px}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin-bottom:20px}@media (max-width: 1024px){.main-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.left-panel[_ngcontent-%COMP%]{max-height:300px}}"]});let a=r;return a})();export{Jt as ContactListComponent};
