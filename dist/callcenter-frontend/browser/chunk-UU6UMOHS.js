import{a as H,b as Q}from"./chunk-GAAQRVXB.js";import"./chunk-ASSUDLFM.js";import{e as $}from"./chunk-CJDZYE6T.js";import{C as G,o as Y}from"./chunk-W3T2FXIS.js";import"./chunk-BTCFLAJC.js";import{d as V}from"./chunk-NO4444JX.js";import{D as L,c as j,e as A,j as O,z as B}from"./chunk-5CXVSPU7.js";import{ob as U,pb as N}from"./chunk-7OAV6HC2.js";import{a as W}from"./chunk-CVSECBKN.js";import{$a as a,Kb as s,Lb as t,Mb as n,Nb as p,Ub as v,Wb as u,Xa as I,Yb as m,ba as k,ca as C,dd as T,fa as S,fb as x,jd as F,kc as l,lc as w,ma as g,mb as _,na as b,nb as M,nc as E,pc as D,qc as z,rb as f,rc as P,rd as R}from"./chunk-3MKZGHO3.js";var K=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=M({type:e});static \u0275inj=C({imports:[Y]})}return e})();var Z=(()=>{let o=class o{constructor(r){this.http=r,this.apiUrl=`${W.webServiceUrl}/cartas-cesion`}searchByDni(r){return this.http.get(`${this.apiUrl}/search`,{params:{dni:r}})}getViewUrl(r){return`${this.apiUrl}/view/${r}`}getDownloadUrl(r){return`${this.apiUrl}/download/${r}`}downloadPdf(r){return this.http.get(`${this.apiUrl}/download/${r}`,{responseType:"blob"})}};o.\u0275fac=function(c){return new(c||o)(S(R))},o.\u0275prov=k({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();function X(e,o){if(e&1){let d=v();t(0,"button",23),u("click",function(){g(d);let c=m();return b(c.clearSearch())}),p(1,"lucide-angular",24),t(2,"span"),l(3,"Limpiar"),n()()}e&2&&(a(),s("size",18))}function ee(e,o){if(e&1&&(t(0,"div",25),p(1,"lucide-angular",26),t(2,"span"),l(3),n()()),e&2){let d=m();a(),s("size",18),a(2),w(d.errorMessage)}}function re(e,o){e&1&&(t(0,"div",27),p(1,"lucide-angular",28),t(2,"span"),l(3,"Ingrese el DNI del cliente (8 d\xEDgitos) para buscar su carta de cesi\xF3n"),n()()),e&2&&(a(),s("size",18))}function te(e,o){e&1&&(t(0,"div",39),p(1,"div",40),t(2,"p"),l(3,"Cargando PDF..."),n()())}function ie(e,o){if(e&1&&(t(0,"div",41),p(1,"iframe",42),n()),e&2){let d=m(2);a(),s("src",d.pdfUrl,I)}}function ae(e,o){if(e&1){let d=v();t(0,"div",29)(1,"div",8)(2,"div",30)(3,"div",31)(4,"div",32),p(5,"lucide-angular",33),n(),t(6,"div",34)(7,"h3"),l(8,"Carta Encontrada"),n(),t(9,"p"),l(10),n()()(),t(11,"button",35),u("click",function(){g(d);let c=m();return b(c.downloadPdf())}),p(12,"lucide-angular",36),t(13,"span"),l(14,"Descargar PDF"),n()()(),f(15,te,4,0,"div",37)(16,ie,2,1,"div",38),n()()}if(e&2){let d=m();a(5),s("size",20),a(5),E("DNI: ",d.cartaData==null?null:d.cartaData.dni," - ",d.cartaData==null?null:d.cartaData.filename),a(2),s("size",18),a(3),s("ngIf",d.loading),a(),s("ngIf",!d.loading&&d.pdfUrl)}}function ne(e,o){e&1&&(t(0,"div",43)(1,"div",8)(2,"div",44),p(3,"lucide-angular",45),t(4,"h3"),l(5,"Vista Previa del PDF"),n(),t(6,"p"),l(7,"Busque una carta de cesi\xF3n para visualizarla aqu\xED"),n()()()()),e&2&&(a(3),s("size",64))}var Re=(()=>{let o=class o{constructor(r,c){this.cartaCesionService=r,this.sanitizer=c,this.dni="",this.loading=!1,this.searching=!1,this.cartaFound=!1,this.errorMessage="",this.cartaData=null,this.pdfUrl=null}ngOnInit(){}searchCarta(){if(!this.dni||this.dni.trim().length!==8){this.errorMessage="Por favor ingrese un DNI v\xE1lido de 8 d\xEDgitos";return}if(!/^\d{8}$/.test(this.dni)){this.errorMessage="El DNI debe contener solo n\xFAmeros";return}this.searching=!0,this.loading=!0,this.errorMessage="",this.cartaFound=!1,this.pdfUrl=null,this.cartaCesionService.searchByDni(this.dni).subscribe({next:r=>{console.log("Carta encontrada:",r),this.cartaData=r,this.cartaFound=!0,this.searching=!1,this.loadPdf(r.filename)},error:r=>{console.error("Error buscando carta:",r),this.searching=!1,this.loading=!1,r.status===404?this.errorMessage=`No se encontr\xF3 carta de cesi\xF3n para el DNI: ${this.dni}`:r.status===400?this.errorMessage="DNI inv\xE1lido. Debe tener exactamente 8 d\xEDgitos":this.errorMessage="Error al buscar la carta de cesi\xF3n. Por favor intente nuevamente"}})}loadPdf(r){this.cartaCesionService.downloadPdf(r).subscribe({next:c=>{let i=window.URL.createObjectURL(c);this.pdfUrl=this.sanitizer.bypassSecurityTrustResourceUrl(i),this.loading=!1},error:c=>{console.error("Error cargando PDF:",c),this.loading=!1,this.errorMessage="Error al cargar el PDF para visualizaci\xF3n"}})}downloadPdf(){this.cartaData&&this.cartaCesionService.downloadPdf(this.cartaData.filename).subscribe({next:r=>{let c=window.URL.createObjectURL(r),i=document.createElement("a");i.href=c,i.download=this.cartaData.filename,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(c),console.log("PDF descargado:",this.cartaData.filename)},error:r=>{console.error("Error descargando PDF:",r),this.errorMessage="Error al descargar el PDF. Por favor intente nuevamente"}})}clearSearch(){this.dni="",this.cartaFound=!1,this.cartaData=null,this.pdfUrl=null,this.errorMessage="",this.searching=!1,this.loading=!1}onEnter(){this.searchCarta()}};o.\u0275fac=function(c){return new(c||o)(x(Z),x(V))},o.\u0275cmp=_({type:o,selectors:[["app-carta-cesion-viewer"]],decls:30,vars:12,consts:[[1,"carta-cesion-container"],[1,"header-section"],[1,"header-icon"],["name","file-text",1,"text-white",3,"size"],[1,"header-text"],[1,"two-column-layout"],[1,"left-column"],[1,"search-card"],[1,"card-content"],[1,"search-section"],[1,"input-group"],[1,"input-label"],[1,"input-wrapper"],["name","hash",1,"input-icon",3,"size"],["type","text","placeholder","Ej: 12345678","maxlength","8",1,"dni-input",3,"ngModelChange","keyup.enter","ngModel","disabled"],[1,"search-button",3,"click","disabled"],["name","search",3,"size"],["class","clear-button",3,"click",4,"ngIf"],["class","error-message",4,"ngIf"],["class","info-message",4,"ngIf"],[1,"right-column"],["class","pdf-viewer-card",4,"ngIf"],["class","pdf-placeholder-card",4,"ngIf"],[1,"clear-button",3,"click"],["name","x",3,"size"],[1,"error-message"],["name","alert-circle",3,"size"],[1,"info-message"],["name","info",3,"size"],[1,"pdf-viewer-card"],[1,"pdf-info-header"],[1,"pdf-info"],[1,"success-icon"],["name","file-check",3,"size"],[1,"pdf-info-text"],[1,"download-button",3,"click"],["name","download",3,"size"],["class","loading-container",4,"ngIf"],["class","pdf-container",4,"ngIf"],[1,"loading-container"],[1,"spinner"],[1,"pdf-container"],["frameborder","0",1,"pdf-iframe",3,"src"],[1,"pdf-placeholder-card"],[1,"placeholder-content"],["name","file-search",3,"size"]],template:function(c,i){c&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),p(3,"lucide-angular",3),n(),t(4,"div",4)(5,"h1"),l(6,"Cartas de Cesi\xF3n"),n(),t(7,"p"),l(8,"Buscar y visualizar cartas de cesi\xF3n por DNI"),n()()(),t(9,"div",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"label",11),l(16,"DNI del Cliente"),n(),t(17,"div",12),p(18,"lucide-angular",13),t(19,"input",14),P("ngModelChange",function(h){return z(i.dni,h)||(i.dni=h),h}),u("keyup.enter",function(){return i.onEnter()}),n()()(),t(20,"button",15),u("click",function(){return i.searchCarta()}),p(21,"lucide-angular",16),t(22,"span"),l(23),n()(),f(24,X,4,1,"button",17),n(),f(25,ee,4,2,"div",18)(26,re,4,1,"div",19),n()()(),t(27,"div",20),f(28,ae,17,6,"div",21)(29,ne,8,1,"div",22),n()()()),c&2&&(a(3),s("size",18),a(15),s("size",18),a(),D("ngModel",i.dni),s("disabled",i.searching),a(),s("disabled",i.searching||!i.dni||i.dni.length!==8),a(),s("size",18),a(2),w(i.searching?"Buscando...":"Buscar"),a(),s("ngIf",i.cartaFound),a(),s("ngIf",i.errorMessage),a(),s("ngIf",!i.cartaFound&&!i.searching&&!i.errorMessage),a(2),s("ngIf",i.cartaFound),a(),s("ngIf",!i.cartaFound))},dependencies:[F,T,L,j,A,B,O,$,G,Q,H,K,N,U],styles:[`.carta-cesion-container{padding:20px;max-width:1400px;margin:0 auto;background-color:#f8fafc;min-height:100vh;transition:background-color .3s ease}:root.dark .carta-cesion-container,body.dark-theme .carta-cesion-container{background-color:#0f172a}.header-section{display:flex;align-items:center;gap:12px;margin-bottom:20px;animation:fadeInDown .5s ease}@keyframes fadeInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.header-icon{width:40px;height:40px;background:linear-gradient(135deg,#3b82f6,#2563eb);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 4px 12px #3b82f64d;transition:all .3s ease}.header-icon:hover{transform:translateY(-2px);box-shadow:0 6px 16px #3b82f666}.header-text h1{font-size:24px;font-weight:700;color:#0f172a;margin:0;line-height:1.2;transition:color .3s ease}:root.dark .header-text h1,body.dark-theme .header-text h1{color:#f8fafc}.header-text p{font-size:14px;color:#64748b;margin:0;line-height:1.2;transition:color .3s ease}:root.dark .header-text p,body.dark-theme .header-text p{color:#94a3b8}.two-column-layout{display:grid;grid-template-columns:400px 1fr;gap:20px;align-items:start}.left-column{animation:slideInLeft .5s ease}.right-column{animation:slideInRight .5s ease}@keyframes slideInLeft{0%{opacity:0;transform:translate(-30px)}to{opacity:1;transform:translate(0)}}@keyframes slideInRight{0%{opacity:0;transform:translate(30px)}to{opacity:1;transform:translate(0)}}.search-card,.pdf-viewer-card,.pdf-placeholder-card{background-color:#fff;border:1px solid #e2e8f0;border-radius:16px;box-shadow:0 2px 8px #0000000f;transition:all .3s ease}.search-card:hover,.pdf-viewer-card:hover,.pdf-placeholder-card:hover{box-shadow:0 4px 16px #0000001a;transform:translateY(-2px)}:root.dark .search-card,:root.dark .pdf-viewer-card,:root.dark .pdf-placeholder-card,body.dark-theme .search-card,body.dark-theme .pdf-viewer-card,body.dark-theme .pdf-placeholder-card{background-color:#1e293b;border:1px solid #334155;box-shadow:0 2px 8px #0000004d}.card-content{padding:24px}.search-section{display:flex;flex-direction:column;gap:16px}.input-group{display:flex;flex-direction:column;gap:8px}.input-label{font-size:13px;font-weight:600;color:#475569;text-transform:uppercase;letter-spacing:.5px;transition:color .3s ease}:root.dark .input-label,body.dark-theme .input-label{color:#cbd5e1}.input-wrapper{position:relative;display:flex;align-items:center;background:#fff;border:2px solid #e2e8f0;border-radius:12px;padding:0 16px;height:52px;transition:all .3s cubic-bezier(.4,0,.2,1)}.input-wrapper:hover{border-color:#cbd5e1;box-shadow:0 4px 12px #0000000d;transform:translateY(-1px)}.input-wrapper:focus-within{border-color:#10b981;box-shadow:0 0 0 4px #10b9811a;transform:translateY(-1px)}:root.dark .input-wrapper,body.dark-theme .input-wrapper{background:#0f172a;border-color:#334155}:root.dark .input-wrapper:hover,body.dark-theme .input-wrapper:hover{border-color:#475569;box-shadow:0 4px 12px #0000004d}:root.dark .input-wrapper:focus-within,body.dark-theme .input-wrapper:focus-within{border-color:#10b981;box-shadow:0 0 0 4px #10b98126}.input-icon{color:#94a3b8;margin-right:12px;transition:all .3s ease;flex-shrink:0}.input-wrapper:focus-within .input-icon{color:#10b981;transform:scale(1.1)}:root.dark .input-icon,body.dark-theme .input-icon{color:#64748b}.dni-input{flex:1;background:transparent;border:none;outline:none;color:#0f172a;font-size:15px;font-weight:500;padding:0;transition:color .3s ease}.dni-input::placeholder{color:#94a3b8;opacity:.6}.dni-input:disabled{cursor:not-allowed;opacity:.6}:root.dark .dni-input,body.dark-theme .dni-input{color:#f8fafc}:root.dark .dni-input::placeholder,body.dark-theme .dni-input::placeholder{color:#64748b}.search-button,.clear-button,.download-button{height:52px;width:100%;display:flex;align-items:center;justify-content:center;gap:10px;font-weight:600;font-size:15px;border-radius:12px;border:none;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.search-button:before,.download-button:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:#ffffff4d;transform:translate(-50%,-50%);transition:width .6s,height .6s}.search-button:active:before,.download-button:active:before{width:300px;height:300px}.search-button{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;box-shadow:0 4px 12px #3b82f64d}.search-button:hover:not(:disabled){background:linear-gradient(135deg,#2563eb,#1d4ed8);box-shadow:0 6px 16px #3b82f666;transform:translateY(-2px)}.search-button:active:not(:disabled){transform:translateY(0);box-shadow:0 2px 8px #3b82f64d}.search-button:disabled{opacity:.5;cursor:not-allowed;transform:none}.clear-button{background:#fff;border:2px solid #e2e8f0;color:#64748b}.clear-button:hover{background:#f8fafc;border-color:#cbd5e1;color:#475569;transform:translateY(-2px)}:root.dark .clear-button,body.dark-theme .clear-button{background:#0f172a;border-color:#334155;color:#94a3b8}:root.dark .clear-button:hover,body.dark-theme .clear-button:hover{background:#1e293b;border-color:#475569;color:#cbd5e1}.download-button{width:auto;padding:0 24px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;box-shadow:0 4px 12px #10b9814d}.download-button:hover{background:linear-gradient(135deg,#059669,#047857);box-shadow:0 6px 16px #10b98166;transform:translateY(-2px)}.download-button:active{transform:translateY(0);box-shadow:0 2px 8px #10b9814d}.error-message,.info-message{display:flex;align-items:center;gap:12px;padding:14px 16px;border-radius:12px;font-size:14px;font-weight:500;animation:slideIn .3s ease;transition:all .3s ease}@keyframes slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.error-message{background:#fef2f2;border:2px solid #fecaca;color:#991b1b}.error-message lucide-angular{color:#dc2626}:root.dark .error-message,body.dark-theme .error-message{background:#ef44441a;border-color:#ef44444d;color:#fca5a5}.info-message{background:#eff6ff;border:2px solid #bfdbfe;color:#1e40af}.info-message lucide-angular{color:#3b82f6}:root.dark .info-message,body.dark-theme .info-message{background:#3b82f61a;border-color:#3b82f64d;color:#93c5fd}.pdf-info-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid #e2e8f0;animation:fadeIn .5s ease;transition:border-color .3s ease}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}:root.dark .pdf-info-header,body.dark-theme .pdf-info-header{border-color:#334155}.pdf-info{display:flex;align-items:center;gap:14px}.success-icon{width:44px;height:44px;background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 4px 12px #10b9814d;animation:scaleIn .5s cubic-bezier(.34,1.56,.64,1)}@keyframes scaleIn{0%{opacity:0;transform:scale(0)}to{opacity:1;transform:scale(1)}}.pdf-info-text h3{font-size:18px;font-weight:700;color:#0f172a;margin:0 0 4px;line-height:1.2;transition:color .3s ease}:root.dark .pdf-info-text h3,body.dark-theme .pdf-info-text h3{color:#f8fafc}.pdf-info-text p{font-size:13px;color:#64748b;margin:0;line-height:1.2;transition:color .3s ease}:root.dark .pdf-info-text p,body.dark-theme .pdf-info-text p{color:#94a3b8}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:16px}.spinner{width:48px;height:48px;border:4px solid #e2e8f0;border-top-color:#3b82f6;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}:root.dark .spinner,body.dark-theme .spinner{border-color:#334155;border-top-color:#3b82f6}.loading-container p{color:#64748b;font-size:15px;font-weight:500;transition:color .3s ease}:root.dark .loading-container p,body.dark-theme .loading-container p{color:#94a3b8}.pdf-container{width:100%;height:calc(100vh - 280px);min-height:600px;background:#f3f4f6;border-radius:12px;overflow:hidden;border:2px solid #e2e8f0;animation:fadeIn .5s ease;transition:all .3s ease}.pdf-container:hover{border-color:#cbd5e1}:root.dark .pdf-container,body.dark-theme .pdf-container{background:#0f172a;border-color:#334155}:root.dark .pdf-container:hover,body.dark-theme .pdf-container:hover{border-color:#475569}.pdf-iframe{width:100%;height:100%;border:none}.placeholder-content{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:100px 20px;text-align:center;color:#94a3b8;animation:fadeIn .5s ease}.placeholder-content lucide-angular{color:#cbd5e1;margin-bottom:24px;opacity:.5;animation:float 3s ease-in-out infinite}@keyframes float{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}:root.dark .placeholder-content lucide-angular,body.dark-theme .placeholder-content lucide-angular{color:#334155}.placeholder-content h3{font-size:20px;font-weight:600;color:#64748b;margin:0 0 8px;transition:color .3s ease}:root.dark .placeholder-content h3,body.dark-theme .placeholder-content h3{color:#94a3b8}.placeholder-content p{font-size:15px;color:#94a3b8;margin:0;transition:color .3s ease}:root.dark .placeholder-content p,body.dark-theme .placeholder-content p{color:#64748b}@media (max-width: 1024px){.two-column-layout{grid-template-columns:1fr}.pdf-container{height:500px;min-height:500px}}@media (max-width: 768px){.carta-cesion-container{padding:12px}.header-text h1{font-size:20px}.header-text p{font-size:13px}.card-content{padding:20px}.pdf-info-header{flex-direction:column;align-items:flex-start;gap:12px}.download-button{width:100%}.pdf-container{height:450px;min-height:450px}.placeholder-content{padding:60px 20px}}@media (prefers-reduced-motion: reduce){*,*:before,*:after{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}
`],encapsulation:2});let e=o;return e})();export{Re as CartaCesionViewerComponent};
