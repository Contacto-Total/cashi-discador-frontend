<nav class="navbar">
  <div class="navbar-container">
    <!-- Logo / Brand -->
    <div class="navbar-brand">
      <span class="brand-icon">ğŸ¦</span>
      <span class="brand-text">CASHI</span>
    </div>

    <!-- Navigation Items -->
    <div class="navbar-items">
      <!-- Monitoreo Dropdown -->
      <div class="nav-item-dropdown" (click)="toggleMonitoreoDropdown()">
        <button class="nav-item" [class.active]="isActive('/admin/monitoring') || isActive('/admin/campaign-monitoring')">
          <span class="nav-icon">ğŸ“Š</span>
          <span class="nav-text">Monitoreo</span>
          <span class="dropdown-arrow" [class.open]="isMonitoreoDropdownOpen">â–¼</span>
        </button>

        <!-- Dropdown Menu -->
        <div class="dropdown-menu" [class.show]="isMonitoreoDropdownOpen">
          <a class="dropdown-item" (click)="navigateTo('/admin/monitoring')" [class.active]="isActive('/admin/monitoring')">
            <span class="item-icon">ğŸ“</span>
            <div class="item-content">
              <span class="item-title">Llamadas Activas</span>
              <span class="item-desc">SupervisiÃ³n en vivo</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/campaign-monitoring')" [class.active]="isActive('/admin/campaign-monitoring')">
            <span class="item-icon">ğŸ“ˆ</span>
            <div class="item-content">
              <span class="item-title">MÃ©tricas en Tiempo Real</span>
              <span class="item-desc">Dashboard y discado</span>
            </div>
          </a>
        </div>
      </div>

      <!-- Carga de Datos Dropdown (Solo Admin) -->
      <div class="nav-item-dropdown" *ngIf="currentUser?.role === 'ADMIN'" (click)="toggleCargaDatosDropdown()">
        <button class="nav-item" [class.active]="isActive('/admin/data-load')">
          <span class="nav-icon">ğŸ“‚</span>
          <span class="nav-text">Carga de Datos</span>
          <span class="dropdown-arrow" [class.open]="isCargaDatosDropdownOpen">â–¼</span>
        </button>

        <!-- Dropdown Menu -->
        <div class="dropdown-menu" [class.show]="isCargaDatosDropdownOpen">
          <a class="dropdown-item" (click)="navigateTo('/admin/data-load/initial')" [class.active]="isActive('/admin/data-load/initial')">
            <span class="item-icon">ğŸ“¥</span>
            <div class="item-content">
              <span class="item-title">Carga Inicial de Mes</span>
              <span class="item-desc">ImportaciÃ³n mensual</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/data-load/daily')" [class.active]="isActive('/admin/data-load/daily')">
            <span class="item-icon">ğŸ“…</span>
            <div class="item-content">
              <span class="item-title">Carga Diaria</span>
              <span class="item-desc">ActualizaciÃ³n diaria</span>
            </div>
          </a>
        </div>
      </div>

      <!-- Mantenimiento Dropdown (Solo Admin) -->
      <div class="nav-item-dropdown" *ngIf="currentUser?.role === 'ADMIN'" (click)="toggleMantenimientoDropdown()">
        <button class="nav-item" [class.active]="isActive('/admin/maintenance')">
          <span class="nav-icon">âš™ï¸</span>
          <span class="nav-text">Mantenimiento</span>
          <span class="dropdown-arrow" [class.open]="isMantenimientoDropdownOpen">â–¼</span>
        </button>

        <!-- Dropdown Menu -->
        <div class="dropdown-menu" [class.show]="isMantenimientoDropdownOpen">
          <a class="dropdown-item" (click)="navigateTo('/admin/maintenance/tenants')" [class.active]="isActive('/admin/maintenance/tenants')">
            <span class="item-icon">ğŸ¢</span>
            <div class="item-content">
              <span class="item-title">Proveedores</span>
              <span class="item-desc">GestiÃ³n de tenants</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/maintenance/portfolios')" [class.active]="isActive('/admin/maintenance/portfolios')">
            <span class="item-icon">ğŸ’¼</span>
            <div class="item-content">
              <span class="item-title">Carteras</span>
              <span class="item-desc">GestiÃ³n de portfolios</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/maintenance/subportfolios')" [class.active]="isActive('/admin/maintenance/subportfolios')">
            <span class="item-icon">ğŸ“‘</span>
            <div class="item-content">
              <span class="item-title">Subcarteras</span>
              <span class="item-desc">GestiÃ³n de subportfolios</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/maintenance/headers')" [class.active]="isActive('/admin/maintenance/headers')">
            <span class="item-icon">ğŸ“‹</span>
            <div class="item-content">
              <span class="item-title">Config. Cabeceras</span>
              <span class="item-desc">ConfiguraciÃ³n de headers</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/maintenance/roles')" [class.active]="isActive('/admin/maintenance/roles')">
            <span class="item-icon">ğŸ­</span>
            <div class="item-content">
              <span class="item-title">Roles</span>
              <span class="item-desc">GestiÃ³n de roles</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/maintenance/users')" [class.active]="isActive('/admin/maintenance/users')">
            <span class="item-icon">ğŸ‘¥</span>
            <div class="item-content">
              <span class="item-title">Usuarios</span>
              <span class="item-desc">GestiÃ³n de usuarios</span>
            </div>
          </a>
          <a class="dropdown-item" (click)="navigateTo('/admin/maintenance/blacklist')" [class.active]="isActive('/admin/maintenance/blacklist')">
            <span class="item-icon">ğŸš«</span>
            <div class="item-content">
              <span class="item-title">Blacklist</span>
              <span class="item-desc">Lista de bloqueo</span>
            </div>
          </a>
        </div>
      </div>

      <!-- CampaÃ±as -->
      <button class="nav-item" (click)="navigateTo('/admin/campaigns')" [class.active]="isActive('/admin/campaigns')">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-text">CampaÃ±as</span>
      </button>

      <!-- Extensiones -->
      <button class="nav-item" (click)="navigateTo('/admin/extensions')" [class.active]="isActive('/admin/extensions')">
        <span class="nav-icon">ğŸ“</span>
        <span class="nav-text">Extensiones</span>
      </button>

      <!-- WhatsApp -->
      <button class="nav-item" (click)="navigateTo('/whatsapp')" [class.active]="isActive('/whatsapp')">
        <span class="nav-icon">ğŸ’¬</span>
        <span class="nav-text">WhatsApp</span>
      </button>
    </div>

    <!-- User Section -->
    <div class="navbar-user">
      <div class="user-info">
        <span class="user-icon">ğŸ‘¤</span>
        <span class="user-name">{{ currentUser?.username || 'Usuario' }}</span>
      </div>

      <!-- Theme Toggle Button -->
      <button class="btn-theme" (click)="toggleTheme()" title="Cambiar tema">
        <ng-container *ngIf="isDarkMode(); else lightMode">
          <lucide-angular name="sun" [size]="20" class="theme-icon"></lucide-angular>
          <span class="theme-text">Claro</span>
        </ng-container>
        <ng-template #lightMode>
          <lucide-angular name="moon" [size]="20" class="theme-icon"></lucide-angular>
          <span class="theme-text">Oscuro</span>
        </ng-template>
      </button>

      <button class="btn-logout" (click)="logout()">
        <span>ğŸšª</span>
        <span>Salir</span>
      </button>
    </div>
  </div>

  <!-- Backdrop for closing dropdown -->
  <div class="dropdown-backdrop" *ngIf="isMonitoreoDropdownOpen || isCargaDatosDropdownOpen || isMantenimientoDropdownOpen" (click)="closeDropdowns()"></div>
</nav>
